longdistance quantum key distribution based on the physical
loss control
n s kirsanov n r kenbaev a b sagingalieva d a kronberg v m vinokur
g b lesovik
terra quantum ag st gallerstrasse 16a ch9400 rorschach switzerland

arxiv210500035v1 quantph 30 apr 2021

may 4 2021
abstract
existing quantum cryptography is resistant against secrecybreaking quantum computers but
suffers fast decay of the signal at long distances the various types of repeaters of propagating
quantum states have been developed to meet the challenge but the problem is far from being solved
we step in the breach and put forth longdistance high secrecy optical cryptography creating the fast
quantum key distribution over distances up to 40000 kilometers the key element of the proposed
protocol is the physical control over the transmission line

1

introduction

existing quantum cryptography is robust against secrecybreaking quantum computers but is subject to the fast decay of the signal with the distances to amend the signal losses the various types
of repeaters of the propagating quantum states have been developed 116 but yet the long distance
transmission looks like an impossible task for existing protocols directly applying the principle of quantum irreversibility 1719 we step in the breach and put forth longdistance high secrecy cryptography
creating the fast quantum key distribution over the globe distances of about 40000 kilometers
on a practical level the information transfer efficiency both in classical and quantum cases is
hindered by the optical fiber losses the conventional approach to quantum communication is doublesuffering firstly the losses themselves harm efficiency secondly the commonly accepted concept is
that an eavesdropper eve can use all the transmission line losses to decipher the communication
successfully however the lion share of losses occurs due to rayleigh scattering of the signal propagating
through the optical fiber this propagation is similar to no small extent to the evolution of the
ensemble of particles experiencing scattering on the quenched disorder potential described by the kinetic
equation 20 generalizing the classical boltzmann equation this implies that the particle dynamics
is accompanied by the entropy growth and therefore irreversible as expressed by the second law of
thermodynamics taking that the line carries a scatterer per a wavelength we conclude that at least
about 109 quantum maxwell demonlike devices are required to collect photons scattered in a one
kilometer long fiber and to reverse and unify the dynamics of the related quantum states this makes
collection of the rayleighscattered information an impossible task these considerations supply us with
a new paradigm for establishing an innovative quantum key distribution qkd protocol based on the
physical control of the optical fiber line
in a basic optical qkd scheme electromagnetic states representing different bit values are transmitted
from the sender alice to the receiver bob which allows them to securely share a secret random
sequence as we have just pointed out the major irreversibilitys implication is that eve cannot collect
any useful information about the random bits from the scattering however the possibility of the local
rerouting of the part of the transmitted signal remains physically this can be implemented for example
by a local bending the fiber which leads to mixing of the major propagating mode with the higherorder
leaking modes this local imperfection in turn allows for eavesdropping on the information carried by
the major mode had the signal been classical this bending would have opened unlimited access to
the full content of the message for eve however any electromagnetic signal is quantized and can be
viewed as a sequence of photons the discreet statistics of photons imposes a major limitation on eves

1

edfa

edfa

edfa

bob

alice
eve

figure 1 schematics of the setup realizing the exemplary protocol alice encodes a random bit string
into a sequence of coherent pulses and sends it to bob via the optical fiber the pulses pass through
a sequence of optical amplifiers and the resulting signals are then received and measured by bob eve
can seize part of the signal for instance by bending the transmitting optical fiber and detecting the
transcending optical modes however alice and bob monitor the losses in the line and always know
the proportion of the signal stolen by eavesdropper importantly they can identify the exact losses
caused and exploited by eve this knowledge enables alice and bob to adopt the most efficient bit
ciphering and measurement scheme depending on how many photons eve intercepts alice picks certain
values of signal intensities which are optimal as far as the informational advantage over eve is concerned
in a concerted manner bob adjusts his measurement routine this in particular gives the authorized
parties additional leverage as far as postselection is concerned after transmitting and receiving the
random bit string alice and bob use an authenticated public classical channel to perform information
reconciliation increasing their informational advantage over eve and privacy amplification  with the
optimal parameters of ciphering and measurement these procedures allow to eradicate eves information
without sacrificing too many bits
ability to extract information from measuring seized signal if the initial signal contains on average
n photons and the local leakage is quantified by transparency re  only the small fraction of the signal
containing ne  re n photons comes to eve in the case of the coherent 
signal state the unavoidable
fluctuation of the photon number follows the poisson statistics
n

re n  therefore with the
e

decrease of re  the relative fluctuations grow as ne ne  1 re n  if for instance alice encodes bit
values into pulses with two different intensities high fluctuations make it difficult for eve to distinguish
them in turn if bob gets the signal pulse comprising nb photons for which fluctuations nb fi nb 
then even a singleshot measurement provides him with a highprobability reliable recognition of whether
the received signal represents 0 or 1 this establishes that the critical condition of security guarantee
is ensuring that bob gets the share sufficient for identifying the recognition of the signal while the
controlled value of re limits the distinguishability of the signal portion seized by eve
an efficient control over re rests on a careful analysis of the optical fibers state and the emergent
scattering matrix that can be accomplished by standard telecom technology methods particularly using
the optical timedomain reflectometry we propose an efficient technique for controlling the optical fiber
based on the direct measurement of the propagation of the signal from alice to bob this technique
together with the cascade signal amplification as a mean for preserving signal intensity lays the foundation
for our qkd protocol unlocking unprecedented key generation rates and global transmission distances

2

method description

we propose a method for longdistance qkd based on the signal amplification and physical control
of the transmission line see the schematics in fig1 two principal ideas behind the method are i
2

the random bits are encoded into nonorthogonal coherent pulses which are amplified by a cascade of
the inline optical amplifiers eg erbium doped fiber amplifiers edfas to achieve longdistance
transmission and ii alice and bob can determine the exact proportion of the signal stolen by the
eavesdropper eve and distinguish it from the natural losses in the line caused primarily by the rayleigh
scattering alice and bob use the knowledge about losses to accurately estimate their informational
advantage over eve which in turn allows them to pick the pulses intensities adopt the measurement
routine and perform postselection in the most efficient way leaving eve no information about the final
shared key
0 initial preparation the reflectometry methods allows to determine losses with high precision and
distinguish local losses which could be caused by eve from the intrinsic natural losses homogeneous across the whole line and caused mainly by the rayleigh and raman scattering as a part
of the initial equipment setting alice and bob determine the natural losses r0 in the transmission
line which cannot be caused by eve bob and alice share the value of r0 via the authenticated
classical communication channel
1 alice and bob determine a total signal loss rt in the communication channel via transmitting test
pulses after that they obtain the signal loss re caused by an eavesdropper by comparing the
intrinsic signal loss r0 with the total signal loss rt  bob and alice share the value of re via the
authenticated classical communication channel
for example let us consider a section of the communication channel which does not comprise
amplifiers if the intrinsic loss in this section is r0 and eve seizes a proportion re of the signal
then the total loss rt is determined from the equation 1  rt   1  re 1  r0  further below
we describe a beam splitter attack of eve 5 at a single location along the communication channel
the proposed method and our analysis presented further below also generalizes to the case where
eve intrudes the communication channel at several locations
2 using a physical random number generator possibly quantum alice generates a bit sequence of
length l
3 alice ciphers her bit sequence into a series of l coherent light pulses which she sends to bob the
bits 0 and 1 are defined by the coherent states 0 i  i and 1 i  i respectively  without
loss of generality assume that   r  and the value of  is chosen optimally given the known
specific value of re  this means that alice uses such coherent states that they correspond to the
maximum key generation speed with respect to the losses in the channel the intensity of the pulse
i is determined by the average photon number
hni  2 

1

4 the signal is amplified by a cascade of optical amplifiers installed equidistantly along the whole
optical line each amplifier compensates the losses in such a way that the amplified signal intensity
equals to the initial one as a coherent pulse passes through amplifiers its state becomes mixed
bob receives the signal and performs the homodyne measurement the parameters of which are
again determined by the known value of re 
5 alice and bob apply information reconciliation some of bobs measurements will have inconclusive
results and the corresponding bits must be discarded to do so bob announces positions of invalid
bits to alice publicly via an authenticated public classical channel
6 alice and bob estimate the error rate and perform the error correction procedure
7 alice and bob perform privacy amplification using a special protocol alice and bob produce a
shorter key which eve has no or negligibly small information about once again alice and bob
may need to use their authenticated public classical channel
8 alice and bob perform steps 1 to 7 until the length of the shared key is appropriate
the outlined protocol is based on phase ciphering however in the case of very long transmission
distances the preservation of the pulses polarization and the efficient phase reference transmission
necessary for homodyne detection may be challenging these practical difficulties can be lifted by
for example using intensity ciphering in which case the bit values are encoded into the two pulses
3

with different intensities this has already been mentioned in the introduction and is analyzed below in
section 31 in the main part of the paper we will concentrate primarily on the phase ciphering approach
which ensures faster information transmission in the forthcoming publication we will analyse in detail
the special measures necessary for compensating phase fluctuations hence improving considerably the
phase ciphering protocol

3

signal amplification

the crucial component of the proposed scheme is the cascade of amplifiers preserving the signal
intensity necessary for achieving long distance transmission we start this section with estimates illustrating how amplification impacts the signal fluctuations and the precision in detecting leakage we then
introduce the formal framework based on the pfunction representation and show how the signal state
evolves under the ideal amplification process after that we consider the practical case of amplification
in doped fibers with the associated losses in the channel we further show that a cascade of amplifiers can
be theoretically reduced to one effective amplifier  we will use this formal property in further sections
for the analysis of legitimate users informational advantage over the eavesdropper

31

preliminary estimates

the challenge to meet is reaching the global distances of the transmission exceeding 20000 km in
order to estimate possible enhancement of the transmission distance we use for illustrative purposes
simple and transparent estimates based on the robustness of the strength of our pulses let us estimate
the strength of our pulses that allows for their stable analogue amplifying transmitting the signal without distorting its shape and phase with the minimal generated noise and at the same time preserving
the degree of protection against eavesdropping a crucial component needed to ensure such an enhancement are just the standard telecom amplifiers preserving the analog signal including erbiumdoped fiber
amplifier and raman amplifier to give an idea how it works we present simple estimates leaving the
detailed description for the technical part of the paper
let us consider the control precision for the representative line of 20000 km in general the exact
optimal distance between amplifiers is to be calculated here for the estimate we take the standard
telecom practice distance of d  50 km on this distance the signal drops by factor of 10 the transmission
probability t  01 correspondingly the amplifying coefficient is to be g  10 suppose that the initial
14
14
 1013 on the 50 km end
photons which drops down to t  na
test signal carries na
t  01  10
t  10
a
14
14
an amplifier restores it back to g  t  nt  10  01  10  10
q but adds noise since photons follow
6
the poisson statistics the fluctuations before the amplifier are t  na
t  3  10  these fluctuations are
amplified with the factor g as well giving
q
7
a
ng
2
t  g t nt  3  10 

coming throughthe sequence of m amplifiers which add fluctuations independently the total fluctuation
raises by factor m  giving for 400 amplifiers on the 20000 km line the twentyfold fluctuation increase
the fluctuation on bobs end is thus

8
nb
m ng
3
t 
t  6  10 
at the end of the day we have
b
6
nb

t nt  6  10
min
re

4
6

this determines the minimum detectable leakage
 6  10  our qualitative considerations agree
with the rigorous calculations provided in sec 35
for illustrative purposes let us use the intensity ciphering instead of the phase ciphering if eve gets
 1 photons stealing signal in the vicinity of alice unity relative error would make it impossible for
her to distinguish between the different pulses provided that their intensities are of the same order a
min
pulse hard for eavesdropping must thus contain n  1re
 105 photons in this case the fluctuation
at bobs amounts to

n  gm n  104 
5
nn  01
4

6

this allows especially taking into account additional informational postprocessing measures exercised
by both bob and alice more elaborate encoding and measuring procedures the readable alice to bob
transmission that cannot be intercepted by eve the fact that scalability behaves as square root of the
line length enables us to execute a major breakthrough in safe communication sending the decipherable
signal over a global distance of 40000 km

32

pfunction and its evolution under amplification

let us introduce our theoretical framework for the rigorous description of losses and amplifications
consider a single photonic mode with bosonic operators  and  acting in the fock space to understand
the effect of the amplification on the bosonic mode state it is most convenient to use the pfunction
representation of the latter such representation allows to express any density operator as a quasimixture
of coherent states
z
  d2  p ih 
7
where d2   dre dim and the quasiprobability distribution p is not necessarily positive for
a given state described by density matrix  the pfunction can be written as
p  tr     
where

1
     2


z

d2  e



8

     

e

e



9

see 21 for details
phaseamplification is described by a quantum channel given by
ampgcosh2 g   7 ampg   trb g   0ih0b g
 

g  eg

b  b

10



where g is the interaction parameter characterizing the amplifier g  cosh2 g is the factor by which
the intensity of the input signal is amplified as we will explicitly see in the following formulae and
annihilation operator b corresponds to the auxiliary mode starting in the vacuum states an explicit
kraus representation of the channel can be written as

x

ampg  

kn kn

11

n0
n



g n

with kn  tanh
 coshg  see eg 22
n
to show how the pfunction of a state changes under the amplification process let us consider a
simple situation where the input signal is in the pure coherent state ih with the corresponding initial
pfunction pi    deltafunction on complex numbers after the amplification the pfunction
becomes
p   g  tr      ampg ih 
12

bearing in mind that
it is easy to see that

ampg   g  g  coshg  sinhgb 

13



1
  g2
p   g 
exp 

g  1
g1

14


in other words the output state is a 
mixture of normally distributed states centered around  gi the
width of the distribution is g  1 2

5

figure 2 a two loss or amplification channels can be reduced to one b loss and amplification
channels can be effectively rearranged c a series of losses and amplifiers can be reduced to one pair
of loss and amplification

33

amplification in doped fibers and losses

in eryt doped fiber the photonic mode propagates through the inverted atomic medium to keep
the medium inverted a seed laser of a different frequency copropagates with the signal photonic mode
in the fiber and is then filtered out at the output by means of wavelengthdivision multiplexing wdm
the interaction between the inverted atoms at position z and propagating light field mode  is precisely
given by the hamiltonian
h  i bz  bz 
15
where bz corresponds to a collective decay of one of the atoms at z hence the evolution of the signal
mode after its propagation through edfa is set by a composition of infinitesimal phaseamplifications
which as we show in the next subsection can be effectively reduced to a single amplification channel
in practice the performance of edfa suffers from technical limitations which come in addition to
the amplification limits on added quantum noise these limitations are mainly caused by two factors i
the atomic population may be not completely inverted throughout the media ii coupling imperfection
between the optical mode and edfa or optical fiber both of these mechanisms can be taken into
account as a loss channel acting on the state before the amplification as shown in 23
let us introduce the loss channel describing all possible losses in the line equation 13 describes
the action of amplifier on the annihilation operator in the heisenberg picture in the same way we can
express the canonical transformation associated with losses
  
  cos  sin
losst   




 t   1  t 

16

2

t  cos 
where  is the interaction parameter t is the proportion of the transmitted signal the annihilation
  e   
operator  corresponds to the initially empty mode which the lost photons go to and 


34

composition of amplifiers and losses

in our cryptographic scheme the amplification is used to recover the optical signal after it suffers
from losses longdistance qkd requires a cascade of amplifiers in which case signals evolution is
determined by a sequence of multiple loss and amplification channels in this section we prove that
any such sequence can be mathematically reduced to a composition of one loss and one amplification
channels we will later adopt this simple representation for the informational analysis of our protocol

6

statement 1 two loss or amplification channels can be reduced to one
first we show that a pair of loss or amplification channels can be effectively reduced to the one
channel see fig2a to that end let us consider two consequent loss channels
  
  
losst2  losst1    
1 2  2 1
p
p
 losst1  t2   1  t2 2 
p
p
p
 t2 t1   t2 1  t1 1  1  t2 2
p
p
 t2 t1   1  t1 t2 
where we defined operator

p

t2 1  t1 1  1  t2 2 

 

1  t1 t2

17

18

acting on the vacuum state and satisfying the canonical commutation relation     1 we can thus
represent two channels in a form of one effective channel
losst2  losst1  losst t1 t2 

19

the same reasoning applies to amplifiers
ampg2  ampg1  ampgg2 g1 

20

statement 2 loss and amplification channels can be effectively rearranged
let us show that a composition of an amplification channel followed by a loss channel can be mathematically replaced with a pair of certain loss and amplification channels acting in the opposite order
see fig2b consider the transformation corresponding to the amplification followed by the loss
 0  
 
losst 0  ampg0    g0 
 g




 ampg0  t 0   1  t 0 
p
p

 t 0 g0   1  t 0   t 0 g0  1b 

21

in the case of the opposite order we have
      

ampg  losst    
g 
 g


 losst  g  g  1b 
p


 t g  g1  t   g  1b 

22

it is easy to see that the two transformations are identical if
losst 0  ampg0  ampg  losst
g0 t 0

g0  1t 0  1
g  g0  1t 0  1
t 

23

in other words the two types of channels commute provided that the parameters are modified in
accord with these relation in particular the parameters in the equation above are always physically
meaningful g  1 0  t  1 meaning that we can always represent loss and amplification in form of a
composition where loss is followed by amplification the converse is not true

7

statement 3 a series of losses and amplifiers can be reduced to one pair of loss and
amplification
let us finally show that a sequence of loss and amplification channels can be mathematically represented as one pair of loss and amplification see fig2c consider the transformation
m  ampg  losst m 

24

corresponding to the series of m identical loss and amplification channels for which we want to find a
simple representation according to statement 2 we can effectively move all losses to the right end of the
composition ie permute the channels in such a way that all the losses act before amplification every
time a loss channel with transmission probability ti is moved before an amplifier with amplification
factor gi  the parameters are transformed in accord with eq 23
ti 7 ti1 

gi ti

gi  1ti  1

25

gi 7 gi1  gi  1ti  1
in our sequence we can pairwise transpose all neighbouring loss with amplifier starting with the first
amplifier and the second loss after repeating this operation m  1 times bearing in mind statement
1 we find that
m  ampg0  ampg1      ampgm 1
 losstm 1  losstm 2      losst0

26

 ampg  losst 
where
t 

m
1
y

ti 

i0

g 

m
1
y

27
gi 

i0

ie a series of losses and amplifiers is equivalent to the loss channel of transmission t followed by the
amplifier with amplification factor g 
note now that the value   gi ti  gt cannot be changed by permutations let us define
fi  gi  1ti  1

28

and bear in mind that
fi1  gi1  1ti1  1 

fi  1
tg  1  
fi



fi  1
fi


 1

29

we can write
ti1 

tg

fi

30

gi1  fi 
and
g  g

m
2
y

fi 

i0

t t gm 1
t gm
t  qm 2


g
i0 fi

31

let us find the explicit form of g and t by solving the recurrence relation define an and bn through
the relation
an
fn1 

32
bn
8

then
fn1 

  1fn  
  1an1  bn1


fn
an1

33

it follows from 32 and 33 that bn1  an and
an1    1an  bn    1an  an1 

34

we see that the solution of this equation has a form
an  c1  c2 n 

35

where c1 and c2 are the constants which are determined by f0  g1t 1 we take a1  g1t 1
and a0  1 and obtain
g  1t
t 1
c2 

36
c1 
gt  1
gt  1
2
notably the product m
n0 fn appearing in the final expression becomes relatively simple
m
2
y
n0

fn 

m
2
y
n0

am 1
an1

an
a0

37

g  1gt m  gt  1


ggt  1
and we have
m  ampg  losst m  ampg  losst 
g  1gt m  gt  1

gt  1
t gm
t 

g

g 

38

the case of t g  1 is particularly interesting as the average intensity of the transmitted signal
remains preserved which is different from the total output intensity as it has the noise contribution
in the limit g  1t we have
g  gm 1  t   t 
t

t 
m 1  t   t

35

39

fluctuations

let us calculate the fluctuation of the number of photons in a pulse after it passes through a sequence
of m loss regions and amplifiers let 2 be the input intensity as follows from 7 and 14 the average
number of photons n in the output signal is
n  h i  2  g  1

40

where g and t are given by eq 39 the variance of the output photon number is
n2  h 2 i  h i2  gm 1  t gm 1  t   1  2 2gm 1  t   1

41

in the limit 2 fl gm fl 1 we obtain the same result as we got from the qualitative considerations in
sec 31

42
n  ngm 

9

4

control of the transmission line

to monitor the eavesdroppers activity alice sends at appropriate intervals special test pulses
individual or many see the discussion below and crosschecks the intensities with bob the test pulses
should comprise a large number of photons but must not however damage bobs detection equipment
by producing and analysing the corresponding scattering matrix alice and bob can determine the losses
in the channel to prevent an inconspicuous eves intrusion into the optical fiber the physical loss control
should be conducted constantly and should not halt even during the pauses in the key distribution we
emphasize that the authorized parties can discriminate between the losses of the general origin and losses
that are caused and can be exploited by eve
if the optical fiber is properly installed it should not have points of significant inflections and crude
junctions then most of the intrinsic natural losses in the line occur due to rayleigh scattering such
losses are distributed across the whole line therefore eve cannot pick up the dissipated signal effectively
unless she has an antenna covering a significant part of the line moreover as we discussed in the
introduction the effective deciphering of the dissipated signal requires a multitude of maxwell demonlike devices which is not practically feasible the only option remaining to the eavesdropper is to take
away part of the signal deliberately that is to create and exploit the losses additional to the natural
ones namely by bending the optical fiber intentionally alice and bob can identify and measure such
artificial losses to do that they must first determine the magnitude of losses not associated with the
eavesdroppers activity this can be done by measuring the losses appearing homogeneously across the
whole line before the beginning of the protocol after that alice and bob can precisely determine
the newly appearing local leaks of the signal with proportion re  possibly intercepted by eve this
knowledge ensures the most efficient ciphering and measurements routines determining in turn the
postselection procedure
in the case that eve knows the parameters of the test pulses she can completely seize them and send
the fake ones to mask her presence in order to prevent that alice should parametrize the test sequences
randomly and compare the parameters with bob only after he measures the pulses this arrangement
would force eve to first measure the pulses and then reproduce them which in turn would prolong the
transmission such a delay can be easily detected by alice and bob possible testing protocols
1 individual pulses alice sends a single testing pulse the parameters of which are chosen randomly
the preparation of the pulse implies generating an auxiliary random bit sequence and translating
it into the random intensity phase length and shape of the pulse after bob measures the test
pulse he verifies its parameters with alice and they determine the losses in the channel
2 sequence of pulses alice sends a sequence of test pulses in which she encodes an auxiliary random
sequence this involves generating an auxiliary random sequence and ciphering it in a sequence of
pulses bob measures the pulses verifies the encoded message with alice after what they determine
the losses
let s be the length of the signal pulse and t be the total length of a sequence of test pulses test
pulses may look completely like the signal ones but their sequence must contain much more photons
than one signal pulse both types of pulses can be characterized by the same constant power eg
p  20 mw but t must be much greater than s  eg t  1 ms and s  1 ns the average number
p t
14
of photons in the test pulse is na
t  h  10  where  is the light frequency the measurement
8
error on bobs side is determined by eq 42 nb
t  6  10  the test pulse allows to detect leakage of
magnitudes
re  tt  nt hnt i  6  106 
43
similar control and analysis of the reflected signal must be performed on alices end

5

measurement scheme
the state of the optical signal can be described in terms of its quadratures given by operators
  

2
i  
p 

2
q 

10

44

figure 3 optical phase diagram of states corresponding to bit values 0 and 1 after they pass through
the
 sequence of losses and amplifications the two output states constitute gaussians centered at
 1  re  where re is the proportion of signal stolen by eve
these operators represent the real and imaginary parts of the signals complex amplitude and by measuring one of the quadratures one can distinguish between different signals
bob needs to distinguish between two states 0 i  i and 1 i  i with   r transformed by
losses and amplifiers  two gaussians with centers laying on the real axis qaxis of the optical phase
space see the phase diagram displayed in fig 3  and for this he measures the qquadrature bob does
his measurements by means of homodyne detection described by the following operators
z
dq qi hq 

0 


z

45
dq qi hq 

1 


fail  i  0  1 
where qi is the eigenstate of q and the parameter  is tuned by bob depending on the amount of losses
possibly stolen by eve see the discussion below here 01 determines the bit value 01 whereas fail
is associated with the bad outcome and the respective bit must be discarded by alice and bob on the
stage of postselection by looking at fig 4 one can see that fail corresponds to the phase space region
where the two states gaussians overlap the most and thus the associated outcome is inconclusive

6

error estimate and correction

after the measurements and postselection procedure of discarding invalid bits alice and bob must
perform error correction procedure the quadrature value q obtained from homodyne measurement allows to estimate the probability of error in the corresponding bit  one can easily compute the conditional
error probability for every q in reality the error rate is also determined by channel imperfections and
eves detrimental activities therefore in practice instead of the theoretical prognosis the error correction procedure should be mainly predicated on the direct measurement of an error eg by disclosing
a part of the raw key to observe the error
one option for the practical error estimation is to disclose one half of the raw key but if the raw
key is long enough already a relatively short part can provide an accurate error estimate according to
this method alice and bob use their public authenticated channel to select a number of bit positions in
the raw key and publicly announce the corresponding bit values then using bayes theorem they can
make a guess about the expected error rate for the remaining part of the raw key alternatively instead
of the bit values alice and bob can disclose the parity bits for some selected blocks of raw key positions
this method gives a better estimate for small error rate values but is worse for high error rates the
decision about the block size can be made taking into account the theoretical estimates based on the
observed values of q for example if the raw error estimate is approximately 6 blocks of length 10 can
be used since the probability for parity bits mismatch in this case is approximately 36 which is large
but still below 50 meaning that the parity data reveal a lot of information about the real error rate
11

figure 4 schematic representation of the measurement operators employed by bob the two signal
states are gaussians overlapping the most in the region of phase space corresponding to fail  therefore
alice and bob consider the associated outcome inconclusive and discard it on the postselection stage
the outcomes associated with 0 and 1 are considered conclusive the value of  is varied to perform
the most efficient postselection procedure as far as the final key generation rate is concerned
after estimating the error rate alice and bob can carry out the error correction procedure to do
that they can use the lowdensity paritycheck ldpc codes 24 the input for such codes are the
probabilities of zero or one at each bit position and the syndrome of the correct bit string  the set of
parity bits which are sufficient to correct the errors taking into account the a priori probabilities for each
position ldpc codes are particularly good for error correction after homodyne measurement since the
measurement result q itself allows to calculate the probabilities for correct and erroneous results
after alice and bob correct errors in a possibly small part of the raw key they have to take into
account the number of errors in this part to yield a more accurate error estimate for the remaining
key we propose the following adaptive procedure alice and bob first take a relatively short subset
of the original raw key which size depends on the codewords length eg 1000 bits and apply error
correcting procedure which is designed for high error rates eg 10 in the case that the preliminary
crude estimation gave just 5 error probability after correcting error in this small subset alice and
bob know the number of errors therein and have a better error rate estimate for the remaining part
of the key then they should take another short eg once again 1000 bits subset and perform error
correction according to the new improved error rate estimate and so on with each iteration the error
estimate becomes more accurate making the error correction procedure more efficient this method can
be applied without having initial error estimate at all which can save alice and bob a large part of the
raw key
the error correction procedure discloses some information about the key for linear codes like ldpc
codes one syndrome bit discloses no more than one bit of information about the key thus the syndrome
length is appropriate upper bound for the information leakage

7

privacy amplification

although after the error correction procedure alice and bob share the same bit string which is
still correlated with eve thus it cannot be used as the final secret key the privacy amplification
procedure 2527 aimed at eradicating eves information produces a new shorter bit string this new
string can finally be used as a secret key as eve does not possess any or almost any information about
it
to eliminate the eavesdropper information alice and bob can for instance use universal hashing
method 28 this method requires them to initially agree on the family h of hash functions h  h
at the privacy amplification stage they randomly select such a function h  0 1l1  0 1l2 from this
12

figure 5 a beam splitter attack on the protocol eve seizes part of the signal somewhere along the
optical line b scheme equivalent to a the losses and amplifiers before and after the point of eves
intervention are represented by two pairs of loss and amplification channels defined by the parameters
t1  g1  and t2  g2  respectively
family that it maps the original bit string of length l1 to the final key of length l2  if eve is estimated
to have e bits of information about the raw key l2 must be equal to l1  e
one example of h is the toeplitz matrices family 29 alice and bob can use a random binary
toeplitz matrix t with l1 rows and l2 columns then they represent their bit string as a binary vector
v and the final key k is given by
k  t  v

8

eves attack

in this section we demonstrate how the protocol works in the case where eve performs the beam
splitter attack seizing the part of the signal somewhere along the optical line as shown in fig 5a we
will use the term beam splitter in referring to the point of eves intervention into the line the beam
splitter is ideal meaning that there is no reflection in alices direction if the signal intensity incident
to the beam splitter is 1 then intensity re goes to eve and 1  re goes to bobs direction
quantum cryptography also studies attacks exercising the partial blocking of the signal and the
subsequent unauthorised substitution of the blocked part however any attack like this will inevitably
and permanently even if eve at some point decides to disconnect from the line affect the scattering
matrix of the transmission line and hence will be detected by the legitimate users therefore we do
not concentrate on this kind of attacks here furthermore at this point we accept that the attacks
specifically focusing on amplifiers can be reduced to the beam splitter kind of attacks the associated
subtleties and details will be the subject of our forthcoming publication

81

losses and amplifiers

the proportion of the transmitted signal on the distance d between two neighbouring amplifiers is
determined by
t  10d 
46
where   150 km1 is the parameter of losses typical for the optical fibers as was mentioned before
the amplification factor of each amplifier is g  1t  let dabae be the distance between alice and
bob alice and eve then the numbers of amplifiers before and after the beam splitter m1 and m2 are
given by
m1  dae d

47

m2  dab  dae d

48

13

as we showed previously the scheme can be simplified by reducing the losses and amplifications before
and after the beam splitter to two loss and aplification pairs with the parameters t1  g1  and t2  g2 
respectively
1
10d
t
 g1 


d
d
m1 1  t   t
1  10
dae d  10
t1
1
t
10d
 g2 
t2 


d
d
m2 1  t   t
1  10
dab  dae d  10
t2
t1 

82

49

evolution of systems state

let us describe the progressive evolution of the combined systems state the initial state of alices
random bit a  her random number generator  and the corresponding signal s is given by
ias 

1
1
0i h0a  i hs  1i h1a  i hs 
2
2

50

as the signal undergoes transformations associated with losses and amplifications the state of the assystem just before the signal passes the beam splitter is given by
z
1


0i
h0

d2 pt1 g1  i hs
as
a
2
z
51
1
 1i h1a  d2 pt1 g1  i hs 
2
defining

as  

1
1
0i h0a  i hs  1i h1a  i hs 
2
2

52

we can rewrite eq 51 as

as 

z

d2 pt1 g1 
as 

53

just after the signal passes the beam splitter the state of the joint system comprising alices random
bit a the signal going to bob s and signal seized by eve e is described by
z


d2 pt1 g1 
54
ase
ase 
where





1
0i h0a   1  re i h 1  re s   re i h re e
2
55




1
 1i h1a   1  re i h 1  re s   re i h re e 
2
and re is the proportion of signal stolen by eve after the signal undergoes the second sequence of losses
and amplifiers and just before it is measured by bob the state of the joint system is
z
bob

d2 pt1 g1 bob
56
ase
ase 

ase  

with
bob
ase  

z



1 x
ai haa 
d2 p1r t 1a g  i hs  1a re i h1a re e 
2
2
e
2 a01

57
bob receives the signal measures it and together with alice performs postselection which lays in
discarding the bits associated with the failoutcome by communicating through the classical channel
the probability that bobs measurement outcome is b  0 1 given that alice sent bit is a  0 1
can be written as
h

i z
58
pba  trase 2  ai haa  b  1e bob
 d2 pt1 g1 p1a  ba
ase

14

where

z
p1a  ba 

d2 p1r

a
e t2 1 g2

 h b is 

59

thus the probability of a conclusive outcome which means that the bit will not be discarded on the
stage of postselection is
z
x p b0  p b1
1 x
px 
pba  d2 pt1 g1 

60
2
2
b01

ab01

the final state of alices random bit a bobs memory device storing the measurement outcome b
and the signal stolen by eve e after the postselection ie conditional to the successful measurement
outcome is
z
fabe 

where

d2 pt1 g1 fabe 


x


1
p b0
fabe   0i h0a  
bi hbb    re i h re e
2
px
b01


x


p b1
1
 1i h1a  
bi hbb    re i h re e 
2
px

61



62

b01

83

probabilities

to obtain the probabilities pba a b  0 1 we must first calculate hqi2 
r


z
z
 

1
2 2req2
1
ip  2 q
ipqq
2
dpe
i 
dp h e
i 
e

hqi  h
2
2

after substituting hqi2 into eqs 58 59 we obtain
i



p
 h

2    g1 t1 g2 t2 1  re 
1
 
1  erf  p
p00 
2
1  2g2  1  2g2 t2 1  re g1  1 

63

64

i



p
 h

2    g1 t1 g2 t2 1  re 
1
 
p10 
1  erf  p
2
1  2g2  1  2g2 t2 1  re g1  1 

65

i



p
 h

2    g1 t1 g2 t2 1  re 
1
 
p01 
1  erf  p
2
1  2g2  1  2g2 t2 1  re g1  1 

66

i



p
 h

2    g1 t1 g2 t2 1  re 
1
 
1  erf  p
p11 
2
1  2g2  1  2g2 t2 1  re g1  1 

67

where
2
erfx  


zx

2

et dt

68

0

84

eves information

hereafter we will use the concepts of the quantum von neumann entropy and conditional entropy
for quantum system x with the density matrix x the entropy is defined as
hx x  tr x log x  

15

69

where log  log2  for the pair of quantum systems x and y  with the states of xsystem and the
joint system described by the density matrices x and xy  respectively the conditional entropy can be
written as
hxy y x  hxy xy   hx x
70
let us estimate eves information about the raw key per 1 bit after postselection but before the
error correction stage
ia e  hfa a  hfae ae  1  hfae ae

71

conditional entropy hfae ae is determined by the final density matrix of aesystem which given
eq 61 and the fact that
p 00  p 10  p 01  p 11
72
can be written as
fae  trb fabe 
with
fae  

z

d2 qx fae 

73





1
1
0i h0a   re i h re e  1i h1a   re i h re e 
2
2
p 00  p 10pt1 g1 
qx  

px

74

to find the lower bound of eves entropy and therefore estimate the maximum of her information
about the key we consider a situation where eve has some auxiliary register of variable  re  and
introduce the joint aere state
z
x


1
f
75
aere 
d2 qx 
aihaa  1a re ih1a re e  regihregre 
2
a01
here the registers states satisfy hregreg0 i   2   0  we note that first by tracing out the
register we recover the original state of aesystem
trre faere  fae 

76

and second the monotonicity of conditional entropy implies
hfae ae  hfaer aere   hfaer aere   hfer ere 
e

e

77

e

the latter inequality simply states that after discarding the register eve can only lose information about
the sent bit to this end hfaer aere  is the lower bound of hfae ae
e

matrix faere can be rewritten as
xz



f
aere 
d2  qx i i ihi   regihregre 

78

i


where i



and i i are the eigenvalues and eigenstates of fae  we thus yield
xz


hfaer aere   
d2 qx i logqx i   c
e

i



xz
zi







d2 qx i logqx   logi   c
z

2

d qx  logqx  

79
2

d qx 

x


i


logi 

c

i

z


d2 qx  logqx  

z

d2 qx hfae  ae  c

where c is an additional correcting term which we do not need to calculate explicitly in the same way
we obtain
z
z
hfer ere    d2 qx  logqx   d2 qx hfe  e  c
80
e

16

combining the two expressions we obtain
hfae ae  hfaer aere   hfaer aere   hfer ere 
e
e
e
z
2
 d qx hfae  ae  hfe  e
z
 d2 qx hfae  ae


z


1  h re   re i
2
 1  d qx h
2

z
2
1  e2 re 
2

 1  d  qx  h
2

81

hp  p logp  1  p log1  p

82

where
is the binary entropy now we can use the jensens inequality
hhxi  hhxi  1  hhxi  1  hhxi
where hxi 

r

d2  qx  x
2

1  he2 re  i
2

hfae ae  1  h
2

where he2 re  i 

he

2 re 2

83

r


84

2

d2  qx  e2 re   we find



2re g1 t1 2
12re 1



p


h
i
1re g2 t2 g1 t1 
21  2re 1   
12re 1

1
e
1  erf p
i
px1  2re 1 
2
22  1  21  re g2 t2 1  2re 22  11

i
h
p

1re g2 t2 g1 t1 
21

2r




e
1
12re 1
1
 erf p

2
22  1  21  re g2 t2 1  2re 22  11


85

where 12  g12  1
by substituting eq 85 into eq 84 and using eq 71 we obtain the upper bound for eves information

85

bobs error rate

let us estimate bobs error rate bobs information per 1 bit about the key after postselection but
before error correction is given by
ia b  hfa a  hfab ab  1  hfab ab
should ideally be equal to 1
hfab ab

86

bobs error rate is therefore determined by the conditional entropy
hfab ab  hfab ab  hfb b

87



x pba
pba
log

hfab ab  
2px
2px

88



x pba  0  pba  1
pba  0  pba  1
hfb b  
log

2px
2px

89

it follows from eq 61 that

ab01

b01

and the probabilities pba and px are given by eqs 6467 and 60 notice that postselection is
symmetric
p00  p10  p01  p11  px
90

17

100

dab  1000 km d  10 km t  063
dae  50 km
dae  250 km

2

10
10

100

dae  20 km
dae  80 km
dae  200 km

2

dae  500 km
dae  980 km

10

2

10

4

10

4

6

10

6

10

6

8

10

8

10

8

lfl
10

dae  500 km
dae  990 km

lfl

10

4

10

dab  1000 km d  20 km t  040

10

000

001

002

re

003

004

005

dab  1000 km d  30 km t  025
dae  30 km
dae  90 km
dae  300 km
dae  480 km
dae  930 km

lfl

10

100

dae  10 km

10

10

000

001

002

re

003

004

005

10

10

000

001

002

re

003

004

figure 6 lf l as function of re for different values of distance d between two neighbouring amplifiers
a d  10 km b d  20 km c d  30 km dab  1000 km is fixed the optimal parameters
    10 for re  001 and     104 for re  000 we see that the final rate depends on eves
position in the line the closer she is to bob small dae  the more information she knows about the bit
sequence due to the correlations imposed by the amplifiers
then


hfab ab  h

p00
px




91

  b  1 but
after the error correction procedure bobs information about the key becomes ia
eves information increases and one can estimate it as
  e  ia e  hf ab  1  min hf ae  hf ab
ia
ab
ae
ab

9

92

key rate

now we can estimate the length lf of the final key after postselection error correction and privacy
amplification




  e  pxl  min hf ae  hf ab 
lf  pxl  1  ia
93
ae
ab
where l is the length of the random bit string originally generated by alice if l is understood as the
number of bits generated in a unit of time then eq 93 reflects the final key generation rate this
equation in its explicit form which is too cumbersome to be written here includes two parameters  the
amplitude of signal  and the measurement parameter   which alice and bob can vary depending on
re to ensure the best rate eg by numerically maximizing the function in eq 93 furthermore the
equation also includes the distance d between two neighboring amplifiers and the distances dab and
dae between the participants of the action  these are parameters which we consider fixed
figure 6 plots lf l as function of re for different values of distance d between two neighbouring
amplifiers for every value of re the parameters  and  are such that they maximize lf l since
there are correlations imposed by the amplifiers for eve it is beneficial to intercept signal near bob
the secure and fast communication can be established if lf l  106 provided that the initial random
number generation rate l  1 gbits thus alice and bob can allow eve to steal no more than few
percent
figure 7 shows lf l as function of re for large dab in the assumption that we can technically
measure re with theoretically allowed precision we see that no matter from what point in the line eve
steals the signal the precision detection of local losses allow for the secure communication over global
distances  20 000 km

references
1 h j kimble the quantum internet nature 453719810231030 jun 2008 doi101038
nature07127
18

005

dab  10000 km d  50 km g  10 m  200

dab  20000 km d  50 km g  10 m  400

dab  40000 km d  50 km g  10 m  800

10

10

10

06

50 km
1000 km
2500 km
5000 km
9000 km

04
02

dae
dae
dae
dae
dae

08
06







50 km
1000 km
2500 km
5000 km
10000 km

2

4

re 10

6

5

8

10

06

04

04

02

02







50 km
5000 km
10000 km
20000 km
30000 km

00

00
0

dae
dae
dae
dae
dae

08

lfl

lfl

08







lfl

dae
dae
dae
dae
dae

0

2

4

re 10

6

5

8

10

0

2

4

re 10

6

5

8

figure 7 lf l as function of re for different values of distance dab between alice and bob a
dab  10 000 km b dab  20 000 km c dab  40 000 km d  50 km is fixed the scales of the
plot imply the theoretically allowed loss detection precision the optimal parameters     102 for
re  105  and     104 for re  0
2 nicolas sangouard christoph simon hugues de riedmatten and nicolas gisin quantum repeaters
based on atomic ensembles and linear optics rev mod phys 8313380 mar 2011 doi
101103revmodphys8333
3 christoph simon hugues de riedmatten mikael afzelius nicolas sangouard hugo zbinden and
nicolas gisin quantum repeaters with photon pair sources and multimode memories phys rev
lett 9819190503 may 2007 doi101103physrevlett98190503
4 lm duan m d lukin j i cirac and p zoller longdistance quantum communication with
atomic ensembles and linear optics nature 4146862413418 nov 2001 doi10103835106500
5 hj briegel w dr j i cirac and p zoller quantum repeaters the role of imperfect local
operations in quantum communication phys rev lett 812659325935 dec 1998 doi10
1103physrevlett815932
6 pieter kok colin p williams and jonathan p dowling construction of a quantum repeater with
linear optics phys rev a 682022301 aug 2003 doi101103physreva68022301
7 l childress j m taylor a s srensen and m d lukin faulttolerant quantum communication
based on solidstate photon emitters phys rev lett 967070504 feb 2006 doi101103
physrevlett96070504
8 p van loock t d ladd k sanaka f yamaguchi kae nemoto w j munro and y yamamoto
hybrid quantum repeater using bright coherent light phys rev lett 9624240501 jun 2006
doi101103physrevlett96240501
9 tiejun wang siyu song and gui lu long quantum repeater based on spatial entanglement
of photons and quantumdot spins in optical microcavities phys rev a 856062311 jun 2012
doi101103physreva85062311
10 nicolas sangouard romain dubessy and christoph simon quantum repeaters based on single
trapped ions phys rev a 794042340 apr 2009 doi101103physreva79042340
11 koji azuma hitoshi takeda masato koashi and nobuyuki imoto quantum repeaters and computation by a single module remote nondestructive parity measurement phys rev a 856062309
jun 2012 doi101103physreva85062309
12 m zwerger w dr and h j briegel measurementbased quantum repeaters phys rev a
856062326 jun 2012 doi101103physreva85062326
13 w j munro k a harrison a m stephens s j devitt and kae nemoto from quantum
multiplexing to highperformance quantum networking nature photonics 411792796 nov 2010
doi101038nphoton2010213
19

10

14 liang jiang j m taylor kae nemoto w j munro rodney van meter and m d lukin
quantum repeater with encoding phys rev a 793032325 mar 2009 doi101103physreva
79032325
15 w j munro a m stephens s j devitt k a harrison and kae nemoto quantum communication without the necessity of quantum memories nature photonics 611777781 nov 2012
doi101038nphoton2012243
16 andrzej grudka karol horodecki michal horodecki pawel horodecki marcin pawlowski and
ravishankar ramanathan free randomness amplification using bipartite chain correlations phys
rev a 903032322 sep 2014 doi101103physreva90032322
17 g b lesovik i a sadovskyy m v suslov a v lebedev and v m vinokur arrow of
time and its reversal on the ibm quantum computer scientific reports 914396 mar 2019
doi101038s41598019407656
18 n s kirsanov a v lebedev m v suslov v m vinokur g blatter and g b lesovik entropy
dynamics in the system of interacting qubits journal of russian laser research 392120127
mar 2018 doi101007s1094601896980
19 g b lesovik a v lebedev i a sadovskyy m v suslov and v m vinokur htheorem in
quantum physics scientific reports 6132815 sep 2016 doi101038srep32815
20 evgenii mikhailovich lifshitz and lev petrovich pitaevskii physical kinetics course of theoretical
physics pergamon oxford 1981 translated from the russian by j b sykes and r n franklin
url httpscdscernchrecord99987
21 w vogel dg welsch and s wallentowitz quantum optics an introduction wiley 2001 url
httpsbooksgooglerubooksid5jfhaqaaiaaj
22 pavel sekatski bruno sanguinetti enrico pomarico nicolas gisin and christoph simon cloning
entangled photons to scales one can see phys rev a 825053814 nov 2010 doi101103
physreva82053814
23 bruno sanguinetti enrico pomarico pavel sekatski hugo zbinden and nicolas gisin quantum cloning for absolute radiometry phys rev lett 1058080503 aug 2010 doi101103
physrevlett105080503
24 djc mackay djcm kay and cambridge university press information theory inference
and learning algorithms cambridge university press 2003 url httpsbooksgooglebi
booksidakumj4pnemc
25 charles h bennett gilles brassard and jeanmarc robert privacy amplification by public discussion siam j comput 172210229 apr 1988 doi1011370217014
26 charles h bennett gilles brassard claude crpeau and ueli m maurer generalized privacy
amplification ieee transactions on information theory 41619151923 1995
27 gilles brassard and louis salvail secretkey reconciliation by public discussion in workshop on
the theory and application of cryptographic techniques on advances in cryptology eurocrypt
93 page 410423 berlin heidelberg 1994 springerverlag
28 j lawrence carter and mark n wegman universal classes of hash functions journal of computer
and system sciences 182143154 1979
29 hugo krawczyk lfsrbased hashing and authentication in annual international cryptology conference pages 129139 springer 1994

20

