convergence discrete dipole approximationtheoretical analysismaxim yurkinfaculty science section computational science university amsterdamkruislaan 403 1098 sj amsterdam netherlandsinstitute chemical kinetics combustion siberian branch russian academysciences institutskaya 3 novosibirsk 630090 russiamyurkinscienceuvanlvaleri p maltsevinstitute chemical kinetics combustion siberian branch russian academysciences institutskaya 3 novosibirsk 630090 russianovosibirsk state university pirogova str 2 630090 novosibirsk russiaalfons g hoekstrafaculty science section computational science university amsterdamkruislaan 403 1098 sj amsterdam netherlandsalfonsscieneuvanlabstractperformed rigorous theoretical convergence analysis discrete dipoleapproximation dda prove errors measured quantity bounded sumlinear quadratic term size dipole d range ddaapplicability linear term significantly smaller cubically noncubically shaped scatterers small d errors cubically shaped particlessmaller noncubically shaped relative importance linear termdecreases increasing size convergence dda large scatterersquadratic common range d extensive numerical simulations carriedwide range d finally discuss number new developments ddaconsequences convergencekeywords discrete dipole approximation nonspherical particle light scattering convergenceanalysis accuracyocis code 2905850 2602110 00044301 introductiondiscrete dipole approximation dda wellknown method solve lightscattering problem arbitrary shaped particles introduction purcellpennypacker1 improved constantly formulation dda summarizeddraine flatau2 10 years ago widely applications3partly publicly available highquality userfriendly code ddscat4modern improvements dda discussed section 2f existresearch stage widely real applicationsdda directly discretizes volume scatterer applicable arbitraryshaped particles drawback discretization extreme computationalcomplexity dda significantly decreased advanced numericaltechniques25 usual application strategy dda single computationdiscretization chosen based available computational resourcesempirical estimates expected errors34 error estimates based limitednumber benchmark calculations3 external light scattering probleminvestigation error estimates evident drawbacks betteralternative available results analytical analysis errors computationalelectromagnetics known 67 typically consider surface integralequations best knowledge analysis volume integralequations ddausually errors dda studied function size parameter scatterer xconstant different total numbers dipoles n 28 small numberpapers directly present errors versus discretization parameter d size singledipole917 range d typically studied papers limited 5 times differenceminimum maximum values exception papers1112 15times plots errors versus discretization parameter illustrateperformance new dda formulation compare conclusionsconvergence properties dda function d based plotsknowledge theoretical analysis dda convergence performedlimited empirical studies appeared literaturepaper perform theoretical analysis dda convergence refiningdiscretization section 2 derive rigorous theoretical bounds error measuredquantity scatterer section 3 present extensive numerical results ddacomputations 5 different scatterers different discretizations resultsdiscussed section 4 support conclusions theoretical analysis formulateconclusions paper section 5 followup paper18 referpaper 2 theoretical convergence results extrapolation techniqueincrease accuracy dda computations2 theoretical analysissection analyze theoretically errors dda computations formulatevolume integral equation internal electric field operator counterpartsection 2a discretization section 2b section 2c contains integral discretizedformulae measured quantities final goal light scattering simulationderive main results section 2d consider errors traditional ddaformulation2 shape errors considered separately section 2e finallysection 2f discuss recent dda improvements viewpointconvergence theoryaintegral equationpaper assume expi t time dependence fields scattererassumed dielectric magnetic magnetic permittivity 1 electricpermittivity assumed isotropic nonisotropic permittivity significantly complicatederivations principally change main conclusion section 2 eqs 70general form integral equation governing electric field insidedielectric scatterer following1920er e r d 3 r g r r r er mv0 r l v0 r r erv v0e r er incident total electric field location r r r 1 4susceptibility medium point r r relative permittivity v volumeparticle general volume contains points susceptibilityzero v0 smaller volume v0 v r v0 v0 g r r free spacedyadic greens function definedg r g r k 2 rr 1 ikr 3 rrg r r k 2r 2r 2r 2identity dyadic k c free space wave vector r r r r rr r dyadic defined r r r r cartesian components vectortensor gr scalar greens functionexpikrg rm following integral associated finiteness exclusion volume v0mv0 r d 3 r g r r r er g s r r r erg s r r static limit k 0 g r r1 1 3 rrg s r rr 3r 2l socalled selfterm dyadicl v0 r d 2 rn rn external viewed r normal surface v0 point req 1 rewritten operator form followse eince h 1 l1 v c 3 functions v c3 finite l1norm e h 2subspace h1 containing functions satisfy maxwell equations free spacelinear operator h 1 h 2 sobolev norm physically sound basedfiniteness energy electric field621 use l1norm detailed discussionassumptions electric field performed section 2dbdiscretizationsolve eq 1 numerically discretization following way20 let v uvi1vi v j 0 j n denotes number subvolumes dipoles assuming r vichoosing v0 vi eq 1 rewrittener e r d 3 r g r r r er m vi r l vi r r erj v jset eq 8 exact fixed point ri inside vi centerchosen r ri setusual approximation20 considering e constant inside subvolumeer eri e r ri r vieq 8 rewrittene e iinc g ijv j j e j m li eijee ri l l vi rim d 3 r g ri r g s ri rg ijd 3r g ri rv j vjapproximation formulations ddag ij 0 g ri r jassumption implicitly formulations start replacing scattererset point dipoles originally purcell pennypacker1 cubicalspherical cell vi ri located center cell l calculatedanalytically yielding22lieq 10 eqs 13 14 completely neglecting m equivalentoriginal dda purcell pennypacker pp1 diagonal terms eq 10equivalent wellknown clausiusmossotti cm polarizability point dipolesmodifications introduced dda prescriptions discussed section 2fmatrix notation eq 10 readsd e d e incded eincd elements c 3 vectors size n element 3d complexvector d nn matrix element 33 tensor d sizedipole operator notation eq 8 r ri followsae ri e ri edefine discretization error functionh id ae ri d e 0de0d exact field centers dipoles e i0d eri contrast edapproximation obtained solution eq 15 neglect numericalerror appears solution eq 15 acceptable errorcontrolled errors comparing eqs 15 17immediately obtain error internal fields discretization ede d e d e 0 d d h dcmeasured quantitieshaving determined internal electric fields scattered fields cross sectionscalculated scattered fields obtained taking limit r integral eq 123expikresca rfnikrn r r unit vector scattering direction f scattering amplitudefn ik 3 n n d 3 r expikr n rervidifferential scattering properties amplitude mueller scatteringmatrices asymmetry parameter cos easily derived fn calculatedincident polarizations24 consider incident polarized plane wavee r e 0 expik rk ka direction incidence e 0 1 assumed scatteringextinction cross sections csca cext derived scattering amplitude23csca 2 d fncext 2 fa e 0denote complex conjugation expression absorption cross section cabsdirectly uses internal fields23c abs 4k d 3 r im r ervivalues internal field centers dipoles known eqs 2024 approximated ppf n ik 3 n n vi e id exp ikri ncabs 4k vi im e idcorrections eq 26 discussed section 2feqs 20 component 24 generalized e functionalnecessarily linear approximatede d e d dcorresponds eqs 25 26 respectively error d consistsepartsd e d e 0 d d e 0 d d e dcomes discretization similar eq 17 second errorsinternal fieldsderror analysissection perform error analysis pp formulation dda improvementsdda discussed section 2fassume cubical subvolumes size d assume shapeparticle exactly described cubical subvolumes cubically shapedscatterer smooth function inside v exact assumptions formulatedextension theory shapes satisfy conditions presentedsection 2e regions different values smooth insideregion analysis valid interfaces inside v considered wayouter boundary v fix geometry scattering problem incidentfield interested variation discretizationcharacterized single parameter d reasons clear sequelassume kd 2 bound limiting dda generallyinapplicable2switch dimensionless parameters assuming k 1 equivalentmeasuring distances units 1 k unit electric field chosen arbitraryconstant derivations use sets constants ci 113basic constants depend discretization d depend directlyproblem parameters size parameter x kreq req volumeequivalent radius mshape incident field contrary c1c94 auxiliary valuesnumerical constants derived terms constantsdependencies ci explicitly derived paper easily obtainfollowing derivations section main motivation vastconstants instead order magnitude formalism explicitderivation limited application constants final resultdepend basic constants qualitative analysis dependenciesperformed end section noted main theoretical resultsconcerning dda convergence boundedness errors quadratic function cf eq 70formulated applied consideration constants simplerderivation enables additional conclusions related behaviorspecific error termstotal number dipoles discretize scatterern 1d 3assume internal field e times differentiablederivatives bounded inside ver 2 er 3 er 4 er 5 er 6r vassumption acceptable interfaces inside v esmooth function denotes euclidian l2 norm 3d objects vectorstensors use l1norm 1 ndimensional vectors matricesfunctions operators eq 30 immediately implies e l1 v requiresatisfies eq 30 constants 711 state estimate normg r derivatives easily obtain eq 2 r 1 g r satisfieseq 30 constants c1c5 r 2g r c6 r 3 g r c7 r 4 g r c8 r 5 g r c9 r 6g r c10 r 7state auxiliary facts later let vc cube size dcenter origin fr times differentiable function inside vcd 3r f r f 0 c11d 2 max f rrvcd 3 vcd2 2d r f r f 0f r r 0 c12 d 4 max f rrvcd vceqs 32 33 corollary expanding f taylor series odd orders taylorexpansion vanish cubical symmetrygoal estimate h d starting eq 17 write h idh id d 3 r g ri r p r d 3 g ij 0 p j m vi rij v jintroduced polarization vector concisenesspr r er pi prievident pr satisfies eq 30 constants c13c17 start estimatingm vi ri substituting taylor expansion prp r p 0 r p 0r r pr r0r r eq 4 givesm vi ri d 3 r g r g s r pi1 3d rg r r r pr rnorms terms estimatedd rg r gr piipi d 3 rg r c18 d 23 vr r p r r 3c d r g r rd rg rc19 d 2eq 38 follows directly definitions eqs 2 5 derive eq 39eq 31 fact r r 3r 2 finally eqs 3739 leadm vi ri c20 d 2estimate sum eq 34 consider separately cases 1 dipole j liescomplete shell dipole define shell 2 j lies distant shell dipolerij r j ri 1 3 j fall cases fig 1 defineshell s1i cubical dipole set dipoles touch including touching pointsecond shell s2i set dipoles touch outer surface shelllth shell sli set dipoles lie boundary cubesize 2l 1d center coinciding center original dipole shellcomplete elements lie inside volume scatterer v shell called distant1vacuumkmaxscattererfig 1 partition scatterers volume regions relative dipoleshell elements satisfy rij 1 order l k max 1 d let ki orderincomplete shell indicator close dipole surfacedemand k k max separate cases 1 2 described j fallcase satisfy rij 2 exact value constant slightly larger 3 dependsd number dipoles shell sl incomplete nsl estimatedn s l 2l 1 3 2l 1 3 c 21l 2sum error dipoles lie complete shellsk 1d 3r g r rpr d 3g 0 pl 1 js l v jshell eq 42 complete divided pairs dipolessymmetric center shell j j convenience set ri 0 innersum eq 42 rewrittend 3r g rp r p r d 3g 0 p p2 js l vjintroduce auxiliary functionur pr pr p0satisfies following inequalities follows eq 30 pr taylor seriesur c22 r 2 ur c23 r ur c24eq 43 equivalentd 3 r g r ur d 3 g 0 ud 3 r g r d 3 g 0 pjs l v jsl v ju j ur j estimate term apply eq 32 functionintegral eqs 31 45 obtainmax g r ur c25 rij3rv ju j c26 d 5 rij 3 c27 d 2l 1j s lj s l v jeq 41 rij ld j s ld rg rur d gstraightforwardd rg r 3 d rg rjs l v jjs l v jjslg rij3 jslr rsums integralssatisfy cubical symmetry second eq 46 transformed2 3d 3r g r d 3g 0 p c28 d r g r d g rij c29 d l c30 d lj s l v jjs l v japply eq 33 derive second inequality use identity 2 g r g rfollowing inequalitiesg r c31r 1 g r c32 r 5derivation based eq 2 equivalencesubstituting eqs 48 51 eq 42 obtaink 1d 3r g r rpr d 3g 0 p c c ln k d 2l 1 js l v jfact k id 1consider second sum eq 34 rij 1 applyeq 32 use eq 30 pr g r finally invoke eq 29d 3r g r rpr d 3g 0 pc35d 5 nc35d 5 c36 d 2j rij 1 v jj rij 1analyze sum eq 34 sum shellsincomplete use symmetry considerations apply eq 33function integral proceed analogous derivation eq 51identity2 g r g rassumed k 1 obtain2 g r p r r rij c37 rij4max g rp r c38 rij7rv jleadsd 3r g r rp r d 3g 0 p c dl 2 c l 539j s l v janalogous eq 53p j c41dk 1 c42 k 4l k j s l v jcollecting eqs 40 53 54 59 finally obtainh id c 41 dk 1 c 42 k 4 c 43 c 44 ln k d 2k maxd rg r rpr d gn k ck maxh id c 43 c 44 ln k max nd 21k 1dk 1 c 42 k 4nk number dipoles order incomplete shell equal kclearn k n1 12 nd12 surface volume ratio scatterer finally obtainh d n c 43 c 45 ln d d 2 c 46 dterm eq 63 determined dipoles lie surfacedipoles deep comes k4 term eq 61 rapidly decreasesmoving surface define surface errors associated linear termeq 63 numerical simulation section 0 term small comparedterms typical values d significant small valuesdeq 18 directly obtaine d dhdassume bounded solution eq 7 uniquely exists e h 2assume e 1 e 13 assumptions equivalent factexists finite operator 1 bounded d discretizationexpectlim dd 01 13eq 65 intuitively correct rigorous prove feasible lies outsidescope paper intuitive understanding consult paper rahola25studied spectrum discretized operator scattering sphereshowed converge spectrum integral operator decreasing dnoted convergence spectrum implies convergencespectral l2 norm operator necessarily convergence l1normeq 65 considered assumption implies exists d0d d 0d 1c 47c47 arbitrary constant larger 13 d0 depends choiceexample c47 2 13 lead large d0 rigorous estimate d0feasible e dsatisfies constrain h deq 63 constantsc48c50estimate errors measured quantities start discretizationerror eq 28 examining eqs 20 24 eq 32directly applied leadinge d e 0d c51d 5 c52 d 2second eq 28 estimatedd e0d d e d c53d 3 eid c53d 3 e d c54 c55 ln d d 2 c56 deq 29 estimation error cabs additionally uses facteid c57 eid c57 max eidd 2combining eqs 67 68 obtain final result sectiond c58 c55 ln d d 2 c56 dimportant remember derivation performed constant x m shapeincident field 13 basic constants 113 1 eq 29 characterizes totalvolume scatterer depends x 711 eq 30 r easilyobtained given function r completely trivial common casehomogenous scatterers 12 surface volume ratio eq 62 depends shapescatterer inversely proportional x feasible certain simple shapesobtain values constants 26 eq 30 requires exact solutioninternal fields constants definitely depend parameters scatteringproblem dependencies rapidly varying especially near resonanceregions true 13 l1norm inverse integral operator eq 65finally important constant d0 depends parametersexpect large d 0 2 problemsvariation neglectedproceeding introduce discretization parameter y m kd employcommonly formula proposed draine8 exact dependence mimportant conclusions valid constant m replacing d ysignificantly change dependence constants eq 69 dependm basic constants 211 13 leadsy c59 c60 ln y y 2 c61 yfeasible rigorous conclusions variation constantseq 70 varying parameters constants depend 26 13 turndepend complex way parameters scattering problemconclusion general trend dependencyfollowing derivation eq 70 observe c61 proportional 12c59 c60 directly depend contributionsindependent 12 general trend decrease ratio c61 c59increasing x parameters fixed mathematical justificationintuitively evident fact surface errors significant larger particlesanalysis results numerical simulations section 0 neglectvariation logarithm eq 70 states error bounded quadratic functiony d d 0 mind derivation lead optimal errorestimation overestimates error improved example constants 26 usually largest inside small volume fraction scatterer near surfaceinternal resonance regions rest scatterer internal electric fieldderivatives bounded significantly smaller constants order errorestimated correctly numerical simulationsimportant note eq 70 imply y signed valueactually depends y quadratic function later case smally section 0 detailed discussion paper 2 coefficients linearquadratic terms y different signs lead zero error nonzero y y exists unfortunately different measured quantityeshape errorssection extend error analysis presented section 2d shapesdescribed exactly set cubical subvolumes perform discretizationway section 2b vi cubical v denotesdipole lies boundary volume v set ri center cubecircumscribing vi break regularity lattice standard pp prescription usesequal volumes vi d 3 eqs 10 14 25 26 discretization changesshape particle little bit estimate errors introduced boundarydipoles errors added obtained section 2d startestimating h d consider h id vd 3r g r rp r d 3g 0 pjv v jreduction eq 34 v h id plus error selftermhidhidd 3rg r rpr d 3g 0 p m v r l v r 4 ejv v jjlet defineh ijsh d 3r g ri rp r d 3g ij 0 p jh sheiii m vi ri l vi riestimate terms eq 73 separately actually significantcancellation error order magnitude valueseq 30 pr g r eq 31 leadsc62 d 3 rij 3 rij 2rij 1c63 destimate h shii assume surface scatterer plane scale sizedipole finite radius curvature changes constants followingexpressions proveh iish c64need consider term eq 74 coming unity tensorbounded constantmvi ri d 3r g ri r g s ri r pr d 3rg s ri rpr prifunction integral bounded c 65 r risecond integralri vi truem vi ri c66 dri vi introduce auxiliary point r symmetric ri particle surfaceapply identitypr pri pr pr pr prisecond integral eq 77 taylor expansion p near r factr r r ri r vim vi ri c 67 d c 68 d 3 r g s ri rremaining integral proven equal l vi ri prove lefteqs 74 80 demonstrate l vi ri bounded constantpotential problem come subsurface vi particle surfaceclose ri subsurface assumed planar calculateintegral eq 6 infinite plane r ri r r 0 nl inf plane ri m d 2 rm2 22 32rbounded rest integral cube surface boundedconstant manifestation general fact definition l vi ridepend size shape volume finallyl vi ri c69eqs 74 78 80 prove eq 76eqs 75 76 obtainkmaxh h ij h ii c62 ns l l 3 c70 nd c71 c72 ln djvjv l 1changed order summation double sum splitsummation cubical shells l k max l k max groupedsum boundary dipoles eqs 41 62 inequalitycombining eqs 63 83 obtain total estimate h d scatterern c 43 c 45 ln d d c73 c72 ln d deq 66 immediately obtain estimate e dderivation errors measured quantities slightly modified comparedsection 2d presence shape errors eqs 67 68 changede d e 0d c51d 5 c74 d 3 c52 d 2 c75 de e c0 dd ec54 c55 ln d d 2 c76 c77 ln d dsecond term eq 85 comes surface dipoles errors ordervalues finally generalization eq 70y c59 c60 ln y y 2 c78 c79 ln y yshape errors reinforce surface errors linear term discretization errorgenerally decrease increasing size parameter x expectlinear term eq 87 significant higher values y eq 70derivations section principle extended interfaces insideparticle surface described exactly surface set cubesseparates regions r varies smoothly parts cubical dipoleinterface considered separately waychange main conclusion section eq87 constantsfdifferent dda formulationssection discuss different dda formulations modify error estimates derivedsections 2d 2eimprovements pp proposed literature concerned selfterm m vi ri radiative reaction correction rr8 digitized greensfunction dgf23 formulation lakhtakia lak2627 a1term method2829lattice dispersion relation ldr30 formulation peltoniemi pel31corrected ldr cldr32 provide expression m vi ri order d2rr order d3 instance ldr equivalentm vi ri b1 b2 m 2 b3 m 2 s d 2 2 3id 3 piremember assumed k 1 b1 b2 b3 numerical constants sconstant depends propagation polarization vectors incident fieldformulations exactly evaluate integral eq 39variation electric field known pel solves problemspherical dipole hopefully decrease constant eq 40decreasing overall error measured quantities formulationsexpected change order error d2 higher orderanalyze improvements rahmani chaumet bryant rcb3334surface corrected ldr scldr17 limited certain particle shapesexist improvements interaction term pp filtered coupled dipolesfcd12 integration greens tensor it35 rigorous analysis fcd errorsscope paper fcd designed reduce linear termeq 63 comes incomplete nonsymmetric shells fcdemploys sampling theory improve accuracy overall discretization regularcubical grids fcd improve accuracy single g ij calculation approximationintegral subvolumenumerically evaluates integral eq 12 pronounced effecterror estimate consider dipole j lth shell incomplete dipoled r g ri rpr d g ij p j d r g ri rpr p jc80 d 3 r r 2 max g ri r c81 d 3 r r 2 g ri r c82 dl 4r v jeq 36 taylor expansion greens tensor ordereq 89 states second term eq 58 completely eliminated linearterm eqs 69 70 surface errors convergence ddacubically shaped scatterers expected purely quadratic neglecting logarithmnon cubically shaped scatterers linear term reappears shapeerrors fcd modify selfterm effect basicallyformulationspapers aimed reduce shape errors101136 generalized semianalytical gsa method10 modifies dda scheme proposeaveraging susceptibility boundary dipoles analyze weighteddiscretization wd piller11 probably advanced method reduce shape errorsavailable todaywd modifies susceptibility selfterm boundary subvolume slightlymodify definition boundary subvolume sections 2b 2eautomatically account interfaces inside scatterer define vicubical possible interface inside particle surface crossing subvolume viassumed planar divides subvolume parts principal volume vi pcontaining center secondary volume vi s susceptibilities ipelectric fields eip e e si respectively electric fields considered constant insiderelated boundary condition tensor tie ti ewd susceptibility boundary subvolume replaced effective definedvi p ip vi s ti d 3gives correct total polarization cubical dipole effective selftermdirectly evaluated starting eq 4 considering e constant insidem vi ri d 3r g ri r g s ri r ip d 3r g ri r g s ri r ti eipiller evaluated integrals eq 92 numerically11smooth variation electric field susceptibility account definer r defined section 2e ti calculated surface rir pip pi pis e si ti epr pis c83 mins r rirviassumed eq 30 r er valid vi sstart estimating errors wd h shij cf eq 73hijsh d 3r g ri rpr gij 0 p jp d 3r g ri rpr gij 0 p jsv jpv jstaylor expansions pr near ri r vi p vi s correspondingly eq 93obtain main contribution comes derivative greens tensorleading cf eq 75c84 d 4 rij 4 rij 2h ijrij 1c85 dh shii following cf eq 74hshii m vi ri l vi ri pid 3r g ri r g s ri r pip d 3r g ri r g s ri r pis l vi ri ieeivisvid r g ri r pr p d r g ri r p r p d r g ri r p pl vi ri ei l vi ri pintegrals easily shown 85 d cf eq 77transformed l way eq 80h iish c86 d l vi p ri pip l vi s ri pis l vi ri eisecond term comes fact averaged l p l timesaveraged p error depends geometry interface inside vi generallyorder unity example plane interface described z zi taking limit 0gives error 2 pip pis z eq 81 wd principally improveerror estimate h shgiven eq 76 significantly decreaseconstant hand l vi p ri l vi s ri analytically evaluatedcube intersected plane wd improved reduce error h shiilinear d subject future researchproceeding analogous derivation eq 83 obtaink maxh d c84 n s l l 4 c87 c88 d c89 ndjv l 1shown scattering amplitude eq 25 error estimate giveneq 85 improved wd correctly evaluates zeroth order valueboundary dipoles leadinge d e 0d c51d 5 c90 d 4 c91d 2original paper piller specify expression cabs directapplication susceptibility provided wd eq 26 reduce ordererror compared exact eq 24 0 linearfunctions electric field consider separately vi p vi sequivalent replacing vi im e ei vi p im ip ei vi s im ti eiestimate eq 99 derived cabseqs 98 99 eq 86 derive final errorestimate wdy c92 c93 ln y y 2 c94 y100constant linear term compared eq 87 containlogarithm expected significantly smaller factors contributingeliminated wd wd potential improving feasiblecompletely eliminate linear term shape error accuracy evaluationinteraction term boundary dipole cf eq 94 improved integrationgreens tensor vi p vi s separately ruin blocktoeplitz structureinteraction matrix hinder fftbased algorithm solution linearcube kd8discretized sphere kd10sphere kd3 x10sphere kd10sphere kd30s11120scattering angle deg150180fig 2 s11 5 test cases logarithmic scale result kd 3 sphere multiplied10 convenienceequations5 comparable alternative fft nowadays methodinapplicableminor modifications expression cabs possible draine8 proposedmodification eq 26 widely modifiedchaumet et al35 cases expressions equivalentdifference order d3 neglected error analysis3 numerical simulationsadiscrete dipole approximationbasics dda method summarized draine flatau2 paper useldr prescription dipole polarizability30 widely nowadayspublicly available code ddscat 614 employ dipole size correction8 noncubically shaped scatterers ensure cubical approximation scatterercorrect volume believed diminish shape errors especially small scatterers2use standard discretization scheme described section 2e improvementsboundary dipoles important note conclusions valid ddaimplementation changes specific improvements discussedsection 2fcode amsterdam dda adda capable running cluster computersparallelizing single dda computation allows use practically unlimitednumber dipoles limited memory single computer3738relative error residual 10 8 stopping criterion iterative solution ddalinear tests suggest relative error measured quantitiesiterative solver 10 7 data shown neglected total relativeerrors simulations 10 6 10 5 section 0 details codepaper 2 dda simulations carried dutch national computecluster lisa39table 1 exact values qext 5 test casesparticlekd 8 cubediscretized kd 10 spherekd 3 spherekd 10 spherekd 30 sphererelative error s11qext44903916075339281985slope 077relative error s11slope 095maximum04590135180y kdmfig 3 relative errors s11 different angles maximum versus y kd 8cube b cubical discretization kd 10 sphere loglog scale linear fit maximumerrors shown m 15bresultsstudy test cases cube kd 8 spheres kd 3 10 30particle obtained cubical discretization kd 10 sphere 16 dipoles dtotal 2176 dipoles x equal sphere detailed description paper 2 ddenote diameter sphere edge size cube scatterers homogenousm 15 dda errors significantly depend m 14 limitsingle value study effects size shape scatterermaximum number dipoles d nd 256 values ndform 4567 2 p p integer discretized sphere ndrelative error s11maximum04590135180slope 105001slope 091relative error s11relative error s11slope 229y kdmfig 4 fig 3 kd 3 b kd 10 c kd 30 spheresmultiples 16 required exactly shape particle composednumber cubes minimum values nd 8 kd 3 sphere 16 cubekd 10 sphere discretized sphere 40 kd 30 spherecomputations use direction incidence parallel principal axescubical dipoles scattering plane parallel face cubical dipolespaper results extinction efficiency qext incident light polarizedparallel principal axes cubical dipoles phase function s11relative error qextcube kd8discretized sphere kd10sphere kd3sphere kd10sphere kd30slope 089001ykdmfig 5 relative errors qext versus y 5 test cases loglog scale linear fit 5finest discretizations kd 3 sphere showncommonly applications theory applies measured quantityinstance confirmed mueller matrix elements data shownexact results s11 5 test cases shown fig 2 spheresresult mie theory relative accuracy code used24 10 6cube discretized sphere extrapolation 5 finest discretizationsextrapolation technique presented paper 2 details obtainingresults including estimated errors use exact results analytical theoryunavailable shapes errors best discretization largerextrapolation use references computing real errors differencecomputed exact value single dda calculations justified realerrors significantly larger errors references paper 2general real errors obtained way uncertainty reference error exact valuesqext test cases presented table 1following results dda convergence fig 3 fig 4 presentrelative errors absolute values s11 different angles maximum errorversus y loglog scale cases maximum errors reached exactbackscattering direction sets points overlap deep minima happenintermediate values y values qext fig 5fact differences simulated reference values change sign nearvalues y paper 2 detailed description behavior solid lines linear fitspoints maximum error slopes lines depicted figuresfig 5 shows relative errors qext 5 studied cases loglog scale linear fit5 finest discretizations kd 3 sphere shown results numericalsimulations presented paper 24 discussionconvergence dda cubically shaped particles fig 3 shows following trendscurves linear quadratic parts nonmonotonic behavior errorsmanifestation fact signed difference approximated sum linearquadratic terms different signs transition regimesoccurs different y indicates relative importance linear quadraticcoefficients maximum errors close backscattering directionlinear term significant larger y smaller significantrange y studied scattering 90 results dda convergence spheres fig4 different behavior different sizes errors small kd 3 sphere convergepurely linear small deviation errors s11 90 large values y similarresults obtained kd 10 sphere significant oscillations superimposedgeneral trend convergence large kd 30 sphere quadratic fasterrange y studied significant oscillationscomparing fig 3 fig 4 especially fig 3b fig 4b showing resultsparticles deduce following differences dda convergencecubically noncubically shaped scatterers linear term cubically shaped scattererssignificantly smaller resulting smaller total errors especially small yconclusions size dependence significance linear termtotal errors perfect agreement theoretical predictions sections 2d2e errors noncubically shaped particles exhibit quasirandom oscillationspresent cubically shaped particles explained sharp variations shapeerrors changing y discussed details paper 2 oscillations kd 3 spherefig 4a small clearly present small sizeparticle featurelessness light scattering pattern surface structureimportant expect small shape errors results qext fig 5 fullysupport conclusions errors qext large sphere small values yunexpectedly smaller smaller spheres feature requires studymaking firm conclusions definitely similar tendency s11 cffig 4studied kd 8 porous cube obtained dividing cube27 smaller cubes removing randomly 9 conclusionsreported cube slightly higher overall errors data shownpaper traditional dda formulation2 numerical simulationsshowed section 2f modern improvements ddawd significantly change convergence behavior completelyeliminate linear term cubically shaped scatterers improve accuracyespecially small y wd significantly decrease shape total errors noncubically shaped particles significantly decrease amplitude quasirandom error oscillations takes account location interface insideboundary dipoles numerical testing dda convergence wd subjectfuture study5 conclusionbest knowledge conducted time rigorous theoreticalconvergence analysis dda range dda applicability kd 2 errors boundedsum linear quadratic term discretization parameter y linear termsignificantly smaller cubically noncubically shaped scattererssmall y errors cubically shaped particles smaller noncubically shapedrelative importance linear term decreases increasing size convergencedda large scatterers quadratic common range yconclusions verified extensive numerical simulationssimulations showed errors bounded quadraticfunction predicted section 2 actually good accuracy describedquadratic function y fact provides basis extrapolation technique presentedpaper 2theory predicts modern dda improvements wdsignificantly change convergence dda numerical testing predictionsleft future researchacknowledgementsthank gorden videen michiel min valuable comments earlier versionmanuscript anonymous reviewer helpful suggestions research supportednato science peace program grant sfp 977976references1 e m purcell c r pennypacker scattering adsorption light nonspherical dielectricgrains astrophys j 186 705714 19732 b t draine p j flatau discretedipole approximation scattering calculations j opt soc11 14911499 19943 b t draine discrete dipole approximation light scattering irregular targets lightscattering nonspherical particles theory measurements applications m mishchenko j whovenier l d travis eds academic press new york 2000 pp 1311454 b t draine p j flatau user guide discrete dipole approximation code ddscat 61httpxxxarxivorgabsastroph0409262 20045 j j goodman b t draine p j flatau application fastfouriertransform techniquesdiscretedipole approximation opt lett 16 11981200 19916 g c hsiao r e kleinman mathematical foundations error estimation numerical solutionsintegral equations electromagnetics ieee trans ant propag 45 316328 19977 k f warnick w c chew error analysis moment method ieee ant prop mag 46 385320048 b t draine discretedipole approximation application interstellar graphite grainsastrophys j 333 848872 19889 j hage j m greenberg r t wang scattering arbitrarily shaped particles theoryexperiment appl opt 30 11411152 199110 f rouleau p g martin new method calculate extinction properties irregularly shapedparticles astrophys j 414 803814 199311 n b piller influence edge meshes accuracy coupleddipole approximation optlett 22 16741676 199712 n b piller o j f martin increasing performance coupleddipole approximationspectral approach ieee trans ant propag 46 11261137 199813 n b piller coupleddipole approximation high permittivity materials opt comm 160 1014199914 g hoekstra j rahola p m sloot accuracy internal fields volume integral equationsimulations light scattering appl opt 37 84828497 199815 s d druger b v bronk internal scattered electric fields discrete dipole approximationj opt soc b 16 22392246 199916 y l xu b s gustafson comparison multisphere lightscattering calculationsrigorous solution discretedipole approximation astrophys j 513 894909 199917 m j collinge b t draine discretedipole approximation polarizabilities accountfinite wavelength target geometry j opt soc 21 20232028 200418 m yurkin v p maltsev g hoekstra convergence discrete dipole approximation iiextrapolation technique increase accuracy j opt soc 23 25922601 200619 lakhtakia strong weak forms method moments coupled dipole methodscattering timeharmonic electromagneticfields int j mod phys c 3 583603 199220 f m kahnert numerical methods electromagnetic scattering theory j quant spectrosc radiattransf 79 775824 200321 c p davis k f warnick physical interpretation sobolev norm error estimationappl comp electromagn soc j 20 144150 200522 d yanghjian electric dyadic greens function source region ieee proc 68 248263 198023 g h goedecke s g obrien scattering irregular inhomogeneous particles digitizedgreens function algorithm appl opt 27 24312438 198824 c f bohren d r huffman absorption scattering light small particles wiley newyork 198325 j rahola eigenvalues volume integral operator electromagnetic scattering siam jsci comp 21 17401754 200026 lakhtakia g w mulholland 2 numerical techniques lightscattering dielectricagglomerated structures j res nat inst stand technol 98 699716 199327 j hage j m greenberg model opticalproperties porous grains astrophys j 361251259 199028 c e dungey c f bohren lightscattering nonspherical particles refinement coupleddipole method j opt soc 8 8187 199129 h okamoto light scattering clusters a1term method opt rev 2 407412 199530 b t draine j j goodman clausiusmossotti wavepropagation polarizable pointlattice discrete dipole approximation astrophys j 405 685697 199331 j peltoniemi variational volume integral equation method electromagnetic scattering irregulargrains j quant spectrosc radiat transf 55 637647 199632 d gutkowiczkrusin b t draine propagation electromagnetic waves rectangular latticepolarizable points httpxxxarxivorgabsastroph0403082 200433 rahmani p c chaumet g w bryant coupled dipole method exact longwavelengthlimit improved accuracy finite frequencies opt lett 27 21182120 200234 rahmani p c chaumet g w bryant importance localfield correctionspolarizable particles finite lattice application discrete dipole approximation astrophys j607 873878 200435 p c chaumet sentenac rahmani coupled dipole method scatterers largepermittivity phys rev e 70 036606 200436 k f evans g l stephens microwave radiativetransfer clouds composed realisticallyshaped ice crystals 1 single scattering properties j atmos sci 52 20412057 199537 g hoekstra m d grimminck p m sloot large scale simulations elastic light scatteringfast discrete dipole approximation int j mod phys c 9 87102 199838 m yurkin k semyanov p tarasov v chernyshev g hoekstra v p maltsevexperimental theoretical study light scattering individual mature red blood cells scanningflow cytometry discrete dipole approximation appl opt 44 52495256 200539 description national compute cluster lisa httpwwwsaranluserinfolisadescription 2005