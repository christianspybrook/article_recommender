l imit laws large k th nearest neighbor ballsarxiv210500038v1 mathpr 30 apr 2021p reprintnicolas chenavieruniversit du littoral cte dopale50 rue f buisson 62228 calaisnicolaschenavierunivlittoralfrnorbert henzeinstitute stochasticskarlsruhe institute technology kitenglerstr 2 d76133 karlsruhenorberthenzekitedumoritz ottoinstitute mathematical stochasticsotto von guericke university magdeburguniversittsplatz 2 d39106 magdeburgmoritzottoovgude4 2021bstractlet x1 x2 xn sequence independent random points rd common lebesguedensity f conditions f obtain poisson limit theorem nnumber large probability kthnearest neighbor balls x1 xn result generalizes theorem 22 10 refers special case k 1 proof completely differentemploys chenstein method instead method moments obtain rateconvergence poisson approximation1 introduction main resultsstarting point paper following result 10 let x x1 xn sequence independentidentically distributed iid random points rd defined common probability space passume distribution x denoted absolutely continuous respect lebesgue measuredenote density f writing k k euclidean norm rd putting xn x1 xnlet rin minj6ijn kxi xj k distance xi nearest neighbor set xn xilet 1 denote indicator function set write bx r y rd kx yk r closed ballcentered x radius r finally lett log n o1 bxi rincndenote number exceedances probability volumes nearest neighbor balls larger thresholdt log nn main result 10 theorem 22 paper states weak conditiondensity f fixed t rcn poexptn denotes convergence distribution po poisson distribution parameter 0maximum probability content nearest balls denoted pn t log nncn 0 immediately obtain gumbel limit limn pnpn log n t exp expt pnmsc 2010 subject classifications primary 60f05 secondary 60d05key words phrases binomial point process large kthnearest neighbor balls chenstein method poisson convergencegumbel distributionlimit laws large kthnearest neighbor ballsstate sufficient condition f guarantees 1 let supp x rd bx r 0 r 0denote support theorem 22 10 requires 0 1 cmax 0r s 0 x z supp kx zk maxr s bx r bz sbx r bz sbz sbz 2s cmax bz sconditions hold suppf compact set k f f 0f f x fx kdensity f x bounded bounded away zeropurpose paper generalize 1 kthnearest neighbors derive rate convergencepoisson approximation number exceedancesstating main results notation fixed k n 1 denote rink euclideandistance xi kthnearest neighbor xn xi write bxi rink kthnearest neighborball centered xi radius rink fixed t rvnk vnk tletcnkt log n k 1 log log n logk 11 bxi rink vnkdenote number exceedances probability contents kthnearest neighbor balls threshold vnk defined3threshold vnk sense universal dealing number exceedances probability contents kthnearest neighbor balls end suppose generality considered far x x1 x2iid random elements taking values separable metric space s retain notations distributionx bx r y s x y r closed ball radius r centered x sdistribution assumey s x y r 0x s r 0consequence distances xi xj j 1 n different probability1 n fixed k n 1 surely unique kthnearest neighbor xiretain notations rink distance xi kthnearest neighbor xn xi bxi rinkball centered xi radius rink notice condition 5 excludes discrete metric spaces section4 17 function spaces like space c0 1 continuous functions 0 1 supremummetric wiener measurefollows sequences n0 bn n0 real numbers write obn cbn n 1positive constant ctheorem 11 x1 x2 iid random elements metric space s 5 holds sequencecnk satisfieslog log necnk e olog nparticular mean number exceedances cnk converges et n goes infinity markovs inequalityresult implies tightness sequence cnk n1 subsequence converges distributionresult states convergence cnk poisson distribution s rd k k 2 holds endlet dt v y z total variation integervalued random variables y zdt v y z 2 sup py pzlimit laws large kthnearest neighbor ballstheorem 12 let z poisson random variable parameter et x x1 x2 iid rd densityf distribution x compact support 0 1d satisfies 2 nlog log ndt v cnk z olog ntheorem 12 generalization theorem 22 10 k 1 provides rate convergencepoisson approximation cnk theorem stated particular case support 0 1dthink extended measure support general convex body sake readibilitymanuscript deal generalizationremark 13 study extremes kthnearest neighbor balls classical stochastic geometryapplications 16 section 4 15 bounds total variation distance process poisson pointslarge kthnearest neighbor ball respect intensity measure poisson process obtainedparallel work results extended bobrowski et al kantorovichrubinstein distancegeneralized binomial process section 62 paper submitted 5 results5 15 rely palm couplings thinned poissonbinomial process employ distances point processesderive bound total variation distance number large kthnearestneighbor balls poissondistributed random variable approach permits build arguments classical poisson approximation theory 2asymptotic independence property stated lemma 22 results considerably shortertechnical prooflet pnk max1in bxi rink maximum probability content kthnearest neighbor ballscnk 0 pnk vnk obtain following corollarycorollary 14 conditions theorem 12lim p npnk log n k 1 log log n logk 1 t gtt rgt exp expt distribution function gumbel distributionremark 15 euclidean case density f continuous bxi rink approximately equalf xi d rinkd d2 1 d2 volume unit ball rd additional smoothnessassumptions f 2 11 12 provedlim p max f xi d min rinkkxi kkd vnk gti1nk support distance kxi kk xi boundary k important overcomeedge effects effects dominate asymptotic behavior maximum kthnearest neighbor distancesk d 8 9 fact 11 proved convergence factorial momentsenk1 f xi d min rinkkxi kkd vnkcorresponding factorial moments random variable poisson distribution poetenkpo et proof theorem 12 completelymethod moments 6 cdifferent thereof based chenstein method provides rate convergence2 proofs21 proof theorem 11proof symmetrye cnkn p bx1 r1nk vnkn e p bx1 r1nk vnk x1fixed x s lethx r p x x rr 0limit laws large kthnearest neighbor ballsdistribution function x x condition 5 function hx continuous probabilityintegral transform 4 p 8 random variablehx x x bx x xuniformly distributed unit interval 0 1 uj hx x xj1 j 1 n 1 u1 un1iid random variables uniform distribution 0 1 conditionally x1 x random variablebx1 r1nk distribution ukn1 u1n1 un1n1 order statisticsu1 un1 distribution depend x wellknown relationdistribution order statistics uniform distribution 0 1 binomial distribution 1 p16x n 1sj 1 sn1jpukn1 sx n 1 jvnk 1 vnk n1je cnk nsummand j k 1 equalsy nin 1 k1vnk 1 vnk nknvnk k11 vnk nkk 1taylor expansions 3 yieldsnvnk log n o log log nlog nk 1exp t k 1 log log n o1 vnkstraigthforward computationsn 1 k1log log nvnk 1 vnk nk et olog nremaining summands right hand 7 readily seenx n 1 jn 1 k1n1jvnk 1 vnko n1 vnknvnkk 1 nkconvention sum equals 0 k 1 computations 3 followssum equals o 1 log n concludes proof theorem 11remark 21 proof given conditioned realizations x x1 distributionhx x x bx x x depend x obtain byproductp bx1 r1nk vnkn1 jvnk 1 vnk n1jx1 x2 xn independent x2 xn iid according x1 arbitrary distribution bn means bn 1 n22 proof theorem 12main idea derive theorem 12 discretize supp 0 1d finitely small setsemploy chenstein method apply method check asymptotic independence propertylocal property ensures high probability exceedances appear neighborhoodintroduce properties recall result arratia et al 2 chenstein methodlimit laws large kthnearest neighbor ballsasymptotic independence property fix 0 writing floor function partition 0 1dset vn nnd subcubes subsets cubes equal size boundary points common nn n logn1 subcubes indexed set 1 nn d j j1 jd jm1 nn m 1 d slight abuse notation identify cube index letxn j 6enjvnevent subcubes contains points xn event en extensivelystochastic geometry derive central limit theorems deal extremes 3 6 7 play crucial rolerest paper following lemma captures idea asymptotic independenceheart developmentlemma 22 0 p enc nproof subadditivity independence followsp xn jp encjvnp x1 6 jjvn1 jjvnexpnjjvnr inequality holds log1 x x x 0 1 f f 0 kj j f d f j writing m cardinality finite set mexp nf jp encjvnvn exp f log n1vn nlog n1 follows n p enc 0 nlocal property define metric d vn putting dj j max1sd js js differentsubcubes j j dj j 0 j vn let sj r j vn dj j r ball subcubes radius rcentered j j vnmj max bxi rinkinxi jconvention mj 0 xn j conditionally event en provided dj j 2k 1random variables mj mj independent lemma 22 referred asymptotic independence propertyconditionally event en occurs high probability extremes mj mj attained subcubessufficiently distant independentfollowing lemma claims high probability exceedances occur neighborhoodlemma 23 notation b mina b b r letrn supp xi xi sj 2k bxi rink bxi ri nk vnkjvn i6i nrn on1 log n2d nasslightnotation identified family subcubes sj 2k j vn dj j 2kabusesetj j vn dj j 2kprepare proof lemma 23 following result gives volume ddimensional ballslimit laws large kthnearest neighbor ballslemma 24 x b0 2d1arccoskxk2kxkd1 pb0 1 bx 1 2 d 11 kxk2proof calculate volume b0 1 bx 1 sum volumes following congruentsets b given set points b0 1 bx 1 closer0 xsecond change roles 0 x set b union cone c radius 1 kxk22height kxk2 apex origin set d b0 1 s s simplicial cone external anglearccoskxk2 elementary geometry obtain volumes c d givenkxkd1 parccoskxk21 kxk22d d 1finishes proof lemmaproof lemma 23 z 0 1d letrnk z infr 0 bz r vnkwriting ya number points finite set y random points rd fall borel setbz rnk z vnkxn bz rnk z k 1following assume rnk xi rnk xi cost factor 2 distinguishcases xi bxi rnk xi xi sj 2k bxi rnk xi distinction cases givesp xi xi sj 2k bxi rink bxi ri nk vnk2p xi xi sj 2k rnk xi rnk xi bxi rink bxi ri nk vnk2p xi sj 2k xi bxi rnk xi rnk xi rnk xibxi rink bxi ri nk vnk2p xi sj 2k xi sj 2k bxi rnk xi rnk xi rnk xibxi rink bxi ri nk vnkbound summands 8 9 separately xi xi independent 8 takes form1rnk y rnk x pxn xi xi xby rnk y k 1sj2kbxrnk xxn xi xi ybx rnk x k 1 dy dxy bx rnk x probability integrand figuring boundedpxn xi xi rnk y k 1xn xi xi bx rnk x k 2pxn xi xi rnk y k 1xn xi xi bx rnk x rnk y k 2random vectorxn xi xi rnk y xn xi xi bx rnk x rnk ynegatively quadrant dependent 13 section 31 equation 11 upper boundpxn xi xi rnk y k 1pxn xi xi bx rnk x rnk y k 2pxn xi xi rnk y k 1pxn xi xi bx rnk x rnk x k 2inequality holds rnk y rnk x analogously remark 21 probabilityk1n2 jvnk 1 vnk n2jpxn xi xi rnk y k 1limit laws large kthnearest neighbor ballsprobability 12 givenx n 2n2lbx rnk x rnk x 1 bx rnk x rnk xstep estimate bx rnk x rnk x f x f 0 x 0 1dhomogeneity ddimensional lebesgue measure obtainbx rnk x rnk x f bx rnk x rnk xf rnk xd b0 1 brnk x1 y x 1f rnk xd b0 1 brnk x1 y x 1 dy bx rnk x lemma 24 yieldsbx rnk x rnk xd12 arccoskx yk2rnk xkx ykd1f rnk x d 11 kx yk2rnk x2drnk xinf s0 s1 1 2 arccoss 0 c0 0bx rnk x rnk x c0 kx ykrnk xd1x sj 2k y bx rnk xequation 13 bound f x f x 0 11rnk y rnk xp xn xi xi bx rnk x rnk x k 1 dybxrnk xn2l1 c0 kx ykrnk xd1c0 kx ykrnk xd1bxrnk xintroduce spherical coordinates obtainn2lx n 2 z rnk xtd1 dt1 c0 trnk xd1f ddc0 trnk xd1x n 2 z rnk xf ddc0 trnk xd1 exp n 2 l log1 c0 trnk xd1 td1 dtx n 2 z rnk xf ddc0 trnk xd1 exp c0 n 2 ltrnk xd1 td1 dtline follows inequality log s s 1 s 0 apply change variablest c0 n 2 l1 rnk x1d ss c0 n 2 ltrnk xd1shows upper bound takes formz c0 n2lrnk xdx n 2d1df dd cdsld1 es dsuse bounds f d rnk xd vnk n2nl l fact integral figuring 14 convergesn expression 14 bounded c1 n1 log n1d c1 positiveconstant consequently 8 boundedc1 n1 log n1d sj 2ksuppxn xi xi rnk y k 1ysj2kc2 n3 log n2dc2 0limit laws large kthnearest neighbor ballsanalogy reasoning 9 given integral1rnk y rnk x p xn xi xi xby rnk y k 1sj2ksj2kbxrnk xpxn xi xi bx rnk x rnk y k 1 dy dxybx rnk x rnk x rnk y lower boundbx rnk x rnk ybx rnk xf d rnk xd vnk constant c3 0bx rnk x rnk y c3 vnkp xn xi xi bx rnk x rnk y k 1x n 2n2lc3 vnk 1 c3 vnkc3k1k 1log nexp n log1 c3 vnkn log s s 1 s 0 16 boundedc4 nc3 sj 2k2pxn xi xi rnk y k 1supysj2kc5 4k 12dlog n22n3c3c4 c5 positive constants summing 6 n follows 15 17 rnon1 log n2d n finishes proof lemma 23poisson approximation result based chenstein method paragraph recall poisson approximation result arratia et al 2 based chenstein method end considerfinite countable collection y 0 1valued random variables let p py 1 0p py 1 y 1 suppose set b containsset b regarded neighborhood consists set indices y y independent finallyx xx xp b3p p b 2e ey p y 6 bb1b6btheorem 25 theorem 1 2 let wy assume ew 0dt v w po 2b1 b2 b3proof theorem 12 recall vnk 3 cnk 4bnk1 mj vnkjvnfollowing lemma claims number cnk exceedances close number subcubesbnk cbnk approximated poisson random variableexists exceedance clemma 26bnk o log n1dpcnk 6 cbnk poecbnk o log n1db dt v climit laws large kthnearest neighbor ballsbnk et oc eclog log nlog nproof assertion direct consequence lemma 23 inequalitiesbnk p j vn l st xi xl j bxi rink bxl rlnk vnkpcnk 6 cx xp xi xl j bxi rink bxl rlnk vnkjvn i6lnrnlog n1prove b apply theorem 25 collection y mj jvn recall conditionally event enrandom variables mj mj independent provided dj j 2k 1 slight abuse notationomit condition en event occurs probability tending 1 n lemma 22 ratepolynomial terms 18x xpjjpj pj b2b1jvn j6j sj2kjvn j sj2kpj pmj vnk pjj pmj vnk mj vnkterm b3 figuring 18 equals 0 conditionally en random variable mj independent fieldmj j 6 sj 2k according theorem 25bnk poecbnk 2b1 b2dt v cfist deal b1 assertion notice j vn symmetry obtainpj pxi j bxi rink vnkn p x1 j bx1 r1nk vnkn pbx r1nk vnk x1 xf x dxnf j pbx r1nk vnk x1 xe1 r1nk vnknf jpbxe1 independent x2 xn uniform distribution j invoking remark 21 probabilityxfiguring line asymptotically equal et n n j o log n1 npj clog n1c constant depend j vn log n1 sj 2k 4k 1 summingj j givesx x log n1 2log n1b1 c 2jvn j sj2kdeal b2 notice j j vn j sj 2kpjj pxi j xi sj 2k bxi rink bxi ri nk vnki6i ni6i nxi xi sj 2k bxi rink bxi ri nk vnklimit laws large kthnearest neighbor ballssubadditivity taking supremum obtainx xsupb2p xi xi sj 2k bxi rink bxi ri nk vnkjvn j sj2kjvni6i n4k 1d rnlog n1concludes proof baccording lemma 23 term equals o log nprove c observebnk et ecbnk ecnk ecnk etbnktheorem 11 summand o logloglogn n cnk cbnk ecnk ecnk cbnk1 mj vnk1 bxi rink vnkjvnjvn1 xi j11bxi rink vnk 1 1 mj vnkx xp xi xi j bxi rink bxi ri nk vnkjvn i6i nvn rnconcludes proof lemma 26according lemma 23 term equals o log ntheorem 123 concluding remarksdealing limit laws large kthnearest neighbor distances sequence iid random points rddensity f values bounded region k modification kthnearest neighbor distances6 introducing boundary distances kxi kk condition f bounded away zeroadopted 11 12 crucial boundary effects play decisive role 8 9kthnearest neighbor balls large probability volume need introduce kxi kk openproblem theorem 12 continues hold densities bounded away zerosecond open problem refers theorem 11 states convergence expectations cnk settingfinitedimensional case cnk nonnegative sequence cnk k tight markovs inequalityconditions underlying distribution ensure convergence distribution random elementmetric spacereferences1 ahsanullah m nevzzorov vb shakil m 2013 introduction order statistics atlantis pressamsterdam paris beijing2 arratia r goldstein l gordon l 1990 poisson approximation chenstein method statist sci5 4034343 avram f bertsimas d 1993 central limit theorem geometrical probability ann appl probab3410331046 19934 biau g devroye l 2015 lectures nearest neighbor method springer new york5 bobrowski o schulte m yogeshwaran d 2021 poisson process approximation stabilizationpalm coupling available httpsarxivorgabs210413261limit laws large kthnearest neighbor balls6 bonnet g chenavier n 2020 maximal degree poissondelaunay graph bernoulli 26 9489797 chenavier n robert c y 2018 cluster size distributions extreme values poissonvoronoitessellation ann appl probab 286 329133238 dette h henze n 1989 limit distributionof largest nearestneighbour link unit dcube jappl probab 2667809 dette h henze n 1990 peculiar boundary phenomena extremes rth nearest neighbor linksstatist prob lett 1038139010 gyrfi l henze n walk h 2019 limit distribution maximum probability nearest neighborball j appl probab 56 57458911 henze n 1982 limit distribution maxima weighted rthnearestneighbour distances j applprobab 1934435412 henze n 1983 ein asymptotischer satz ber den maximalen minimalabstand von unabhngigen zufallsvektoren mit anwendung auf einen anpassungstest im rp und auf der kugel asymptotic theorem maximum minimum distance independent random vectors application goodnessoffit test rpsphere metrika 30245259 german13 joagdev k proschan f 1983 negative association random variables applications ann stat1128629514 g penrose m d 2017 lectures poisson process cambridge university press ims textbook15 otto m 2020 poisson approximation poissondriven point processes extreme values stochasticgeometry available httpsarxivorgpdf200510116pdf16 penrose m d 1997 longest edge random minimal spanning tree ann appl probab 72 34036117 zubkov n orlov o p 2018 limit distributions extremal distances nearest neighbor discretemath appl 28189199