entangling quantum generative adversarial networksmurphy yuezhen niu1 alexander zlokapa2 1 michael broughton1sergio boixo1 masoud mohseni1 vadim smelyanskyi1 hartmut neven1arxiv210500080v1 quantph 30 apr 2021google ai quantum venice ca 90291 usadivision physics mathematics astronomy caltech pasadena ca 91125 usagenerative adversarial networks gans widely adopted semisupervisedunsupervised machine learning methods highdefinition image video audio generationwork propose new type architecture quantum generative adversarial networks entangling quantum gan eqgan overcomes limitations previously proposed quantumgans leveraging entangling power quantum circuits eqgan guarantees convergencenash equilibrium minimax optimization discriminator generator circuitsperforming entangling operations generator output true quantum dataeqgan additional robustness coherent errors demonstrate effectiveness eqgan experimentally google sycamore superconducting quantum processoradversarially learning efficient representations quantum states prepare approximate quantum random access memory qram demonstrate use applications including trainingquantum neural networksintroductiongenerative adversarial networks gans 1widely adopted generative machine learning methods achieving stateoftheart performancevariety highdimensional complex tasks includingphotorealistic image generation 2 superresolution 3molecular synthesis 4 given access training dataset s xi sampled underlying datadistribution pdata x gan generate realistic examples outside s certain probability distributions generated quantum computers thought classicallyhard sample plausible conjectures 57learning generate samples classicalgan formidably hard 8 workfocus developing fully quantum mechanical gantrue data given quantum statetask learn generator circuit reproduce quantum state following frameworkgan discriminator circuit presentedtrue data fake data generatorgenerator discriminator trained adversarially 9 generator attempts fool discriminatordiscriminator attempts correctly distinguishtrue fake data focus quantum datapresent viable applications resulting machinelearning architecture context classical datarecent work quantum gan qugan 10 11proposed direct analogy classical gan architecture designing generator discriminatorcircuits proposed quganconverge certain cases oscillates finite set states mode collapsegeneral suffers nonunique nash equilibriummotivates new entangling quantum gan eqganuniquely quantum twist providingdiscriminator true fake data allowdiscriminator entangle true fake dataprove convergence eqgan globaloptimal nash equilibrium numerical experiments confirm eqgan converges problem instancesqugan failedeqgan favorable convergence properties task learning quantum circuit generateunknown quantum state solved entirelysupervised approach adversarially trainingdiscriminator distinguish fake realdata freeze discriminator perform exact swap test measuring state fidelitytrue fake data replicate original state absence noise gate errors implementation discriminator cause convergenceincorrect optimum adversarial approach eqgan robust errorssimpler supervised learning approach trainingquantum machine learning models require extensivetime compute gradients current quantum hardwareresilience gate errors drifting training process especially valuable noisy intermediatescalequantum nisq era quantum computingfinally provide applications eqganbroader context quantum machine learningclassical data attractive quantummachine learning algorithms require quantum randomaccess memory qram 12 learning shallowquantum circuit generate superposition classicaldata eqgan create approximateqram demonstrate application qramquantum neural networks 13 improving performance quantum neural network classificationtaskprior artgan comprises parameterized generative network gg z discriminator network dd zgenerator maps vector sampled input distribution z p0 z data example gg z transforming p0 z new distribution pg z fake datadiscriminator takes input sample x givesprobability dd x sample realdata fake generative network trainingcorresponds minimax optimization problemalternate improving discriminators ability distinguish realfake samples improvinggenerators ability fool discriminator specificallysolve ming maxd v g d cost function vv g d expdata x log dd xezp0 z log 1 dd gg zg d capacity approachspace arbitrary functions proven ref 1global optimum minimax game existsuniquely corresponds pg x pdata xmultilayer perceptron parameterize dg dimensionality functional spaceincreased replacing classical neural networksquantum neural networks general caseclassicaldata represented density matrixpi ihi pi 0 1 positive boundedreal numbers orthogonal basis statesproposal quantum gan qugan 10 11generative network defined quantum circuit uoutputs quantum state u g 0 u ginitial state 0 discriminator takes realdata fake data performs positive operator valued measurement povm defined toutcome determines probability data trueoperator f outcome determines probabilitydata fake t 1 f 1 1discriminator predicts probability unknowninput state true data measuring expectationvalue tdd trtconvergence eqganensure convergence unique nash equilibriumpropose new minimax optimization problemdiscriminator directly analogous discriminator classical gan evaluatingfake true data individually optimal discriminator provided access true datainput state g prepared generator circuit parameterized g permited perform measurement joint certain parametervalue gives fidelity measurement inputsdfid gtr 12 g 12notice comparison eq 3 linear function input states optimal statecertificationproblem 14 evaluating quantum generative modelslet discriminator d d g represent probability measuring state 0i end discriminating circuit exist parameters dopt realizeperfect swap test d dopt g 21 21 dfid gd sufficiently expressive reach optimal discriminator optimization traditional swaptest nqubit states requires twoqubit gatesspan 2n qubits implementation quantumdevice local connectivity incurs prohibitive overheadcircuit depth implement discriminator parameterized destructive ancillafree swaptest 15 eqgan architecture adversarially optimizes generation state g learningfidelity measurement d fig 1define minimax cost function closerclassical gan eq 1following ref 11 qugan solves minimax gamemin max trt trt gcost function eq 3 overshootingsubsequent generator update t oppositeleads oscillation generatordiscriminator possibly preventing convergencecase infinite oscillation supplementary materialunfortunately minimax optimization converge good nash equilibrium closeoptimal hesltrom measurement operator tp close orthogonal true quantumdata opposite step trainingtry align generator state t minimizemin max v g d min max1 d d gd d g parameterization swaptest result nash equilibrium exists desired location consider swap test circuitansatz discriminator u d expid cswapmatrix exponentiation perfect controlledswap gate angle d ansatz inputstate ih ih transformdiscriminator circuithu d h0ia iisin d1ia ii ii 0ia eid cos d ii sin d iigiven circuit ansatz defined predefined range swap angle maximum valuedistinguishing arbitrary states uniquelyachieved perfect swap test angle 2 particularly probability measuring state 0iend parameterized swap test depends swapangle accordingd d g1 cos2 d sin2 d dfid g 7discriminator aims decrease probablitymeasuring 0i minimize eq 7 getting closed 2 corresponds perfect swap testgiven dfid g 1 step generator maximize dfid g moving closer truedata ultimately generator improvegu dfig 1 eqgan architecture generator varies g fooldiscriminator discriminator varies d distinguishstate optimal discriminator performs swaptest global optimum eqgan occurs ginclude ancilla qubit figure clarityimplement destructive ancillafree swap test 15cost function defined eq 5 assumeinput states g pure statessimplicity example provided eq 6assume pure state input supplementary material discuss proposal eqgan accommodate mixed state input replacing purestate fidelity mixed state fidelity measurement discriminator architectures chosenensure existence nash equilibrium experiments presented use hardwareefficientansatz designed correct dominant coherent gate errors poorly chosen circuit parameterizationyield nonconvex loss function landscapedifficult optimize gradient descentissue shared qugan difficulty expressing arbitrary unitaries shallow quantum circuitsclassical gans eqganarchitecture successfully converges problem instancesunreachable fully trained properly parameterized qugan supplementary materiallearning suppress errorsimproved robustness eqgangate errors compared straightforwardswap test approach learning unknown quantumstate adversarially training parameterized swap test discriminator eqganperfect swap test applied iterationfrozen discriminator cause generatorcircuit converge true data swap testensures unique global optimumpresence gate errors swap testunique global optimum offset truedata eqgan agnostic precise parameterization perfect swap test appropriate ansatzlearn correct coherent errors observed nearterm quantum hardware particular gate parameters conditional z phase single qubit z phaseswap angles twoqubit entangling gate driftoscillate time scale o10 minutes 16 17unknown systematic timedependent coherenterrors provides significant challenges applicationsquantum machine learning gradient computationupdate requires measurementslarge deviations singlequbit twoqubit zrotation angles largely mitigated including additional singlequbit z phase compensations effectiveness importance systematic error mitigation recently demonstrated success achieving thestateofart accuracy energy estimationfermionic molecules 18 learning discriminatorcircuit closest true swap test adversarial learning eqgan provides useful paradigmbroadly applicable improving fidelitynearterm quantum algorithmssuppose adversarial discriminator unitary givenu d u dopt corresponds perfect swaptest absence noise given tracepreservingcompletely positive noisy channel e discriminatorreplaced new unitary operation d supervised approach apply approximate swap testgiven dopt adversarial swap test generically perform better exist parameters dd u dopt 2 dopt u dopt 2discriminator defines loss landscape optimizedgenerator g produced eqgan convergestate closer possible supervised approach parameterization noisy unitarygeneral mitigate errors0 z x z hu dextremaldiscriminator lossz hz hperfect swapfig 2 eqgan experiment learning singlequbit statediscriminator u d constructed free z rotationangles suppress cz gate errors allowing generator gconverge closer true data state varying xz rotation anglesfig 3 comparison eqgan perfect swap testphysical quantum device experimentally confirmeqgan converges higher state overlap learningcorrect errors additional singlequbit rotationsconverged eqgan dashed line coincidesiteration discriminator loss minimizedapplication qramexample consider task learning superposition 12 0i 1i quantum device noisefig 2 discriminator defined swap testcz gate providing necessary twoqubit operationlearn correct gate errors discriminatoradversarially learns angles singlequbit z rotationsinsert directly cz gate eqganobtains state overlap significantly betterperfect swap test fig 3 methodsstay optimal point typical noisygradient measurements minimax optimizationafterconvergence nash equilibrium discretizationinduce perturbations nonzero higherorder gradients lead training deviate global optimum 19report average error multiple runseqgan perfect swap test experimental device tablequantum machine learning applications requirequantum random access memory qram load classical data superposition 12 particularly setclassical data described empirical distribution pi possible input data quantummachine learning algorithmsprequireconversionpi quantum state pi superposition orthogonal basis states representing single classical data entry amplitude proportionalsquare root classical probability pi preparing superposition arbitrary set n statestakes operations best ruins exponential speedup given suitable ansatz useeqgan learn state approximately equivalentsuperposition dataqml modelperfect swapeqganminimum error state fidelity24 05 10406 02 104table comparison eqgan perfect swap testsycamore quantum device error eqgan1 state fidelity significantly lowerperfect swap test demonstrating successful adversarialtraining errorsuppressed swap test uncertaintiesstandard deviationsclass 0 ansatzb class 1 ansatzfig 4 variational qram ansatzes generating peakslearning parameters 20 class 0 corresponds centeredpeak class 1 corresponds offset peakconclusionempirical pdfb variational qramfig 5 twopeak total dataset sampled normal distributions n 120 variational qram trainingdataset n 60 variational qram obtainedtraining eqgan generate state shallowpeak ansatz approximate exact superposition statestraining test datasets n 60balanced classesdemonstrate variational qram considerdataset peaks sampled different gaussiandistributions exactly encoding empirical probabilitydensity function requires deep circuit multiplecontrol rotations similarly preparing gaussian distribution device planar connectivity requires deepcircuits supplementary material selectshallow circuit ansatzes fig 4 generate concatenated exponential functions approximate symmetricpeak 20 trained approximate empiricaldata distribution variational qram closely reproduces original dataset fig 5training dataexact samplingvariational qramaccuracy53 669 2table ii test accuracy n 60 quantum neural network qnn trained samples trainingdataset n 60 single epoch trained variational qram equal number circuit evaluationsqnn trained variational qramdirect access original dataset accuracy evaluated raw dataset uncertainties standarddeviationsproof principle qram quantum machine learning context train quantum neuralnetwork 13 compute hinge loss consideringdata entry individually encoded quantum circuit considering class individually encodedsuperposition variational qram givennumber circuit evaluations compute gradientssuperposition converges better accuracy endtraining despite approximate distribution table iimotivated limitations preexisting quantum ganarchitectures literature propose eqganarchitecture overcome issues nonconvexitymode collapse adopt parameterization hilbertschmidt norm cost function oppose tracedistance based optimality hilbertscmidt normstatecertification problems similar advantageshilbertschmidt norm shown quantum embedding designs quantum kernel learning 21approaches quantum gan improve quantumgans convergence properties notably recent worksuggests certain cost functions wasserstein metric provide robust convergence 22eqgans shallow discriminator effective suppressing device errors ensures robust convergence running laboratory quantumcomputers making eqgan particularly relevantnearterm applications quantum computing demonstrate experimental applicaitoneqgan googles cloud quantum computersimproving classification accuracy classical dataqram work opens new directions utilizing quantum generative models achieve quantumspeedup machine learning necessitates efficient highdelity preparation qramaz acknowledges support caltechs intelligentquantum networks technologies inqnet research program doehep quantised program grant quantum machine learning quantumcomputation frameworks qmlqcf hep awardnumber desc0019227authors contributed equally work1 goodfellow j pougetabadie m mirza b xud wardefarley s ozair courville y bengio advances neural information processing systems2014 pp 267226802 t salimans goodfellow w zaremba v cheungradford x chen x chen advances neural information processing systems edited d leem sugiyama u luxburg guyon r garnettcurran associates 2016 vol 29 pp 22342242url httpsproceedingsneuripsccpaper2016file8a3363abe792db2d8761d6403605aeb7paperpdf3 c ledig l theis f huszar j caballero cunningham acosta aitken tejani j totz z wanget al proceedings ieee conference vision pattern recognition cvpr 20174 e putin asadulaev y ivanenkov v aladinskiy b sanchezlengeling aspuruguzikzhavoronkov journal chemical informationmodeling 58 1194 2018 pmid 29762023httpsdoiorg101021acsjcim7b00690 url httpsdoiorg101021acsjcim7b006905 s boixo s v isakov v n smelyanskiy r babbushn ding z jiang j m martinis h neven arxivpreprint arxiv160800263 20166 s aaronson arkhipov proceedingsfortythird annual acm symposium theorycomputing association computing machinerynew york ny usa 2011 stoc 11 p 333342isbn 9781450306911 url httpsdoiorg101145199363619936827 f arute k arya r babbush d bacon j c bardinr barends r biswas s boixo f g s l brandaod buell et al nature 574 505 2019 url httpsdoiorg101038s41586019166658 m y niu m dai l li odena z zhaov smelyanskyi h neven s boixo arxiv preprintarxiv201011983 20209 c szegedy w zaremba sutskever j bruna d erhan goodfellow r fergus arxiv preprintarxiv13126199 201310 pl dallairedemers n killoran phys rev98 012324 2018 url httpslinkapsorgdoi101103physreva9801232411 s lloyd c weedbrook phys rev lett 121040502 2018 url httpslinkapsorgdoi101103physrevlett12104050212 j biamonte p wittek n pancotti p rebentrostn wiebe s lloyd arxiv161109347 201613 e farhi h neven arxiv preprint arxiv180206002201814 c bdescu r odonnell j wright proceedings51st annual acm sigact symposium theorycomputing 2019 pp 50351415 j c garciaescartin p chamorroposada physrev 87 052330 2013 url httpslinkapsorgdoi101103physreva8705233016 f arute k arya r babbush d bacon j c bardinr barends r biswas s boixo f g brandao dbuell et al arxiv191011333 2019 url httpsarxivorgabs19101133317 f arute k arya r babbush d bacon j c bardinr barends bengtsson s boixo m broughton b bbuckley et al arxiv preprint arxiv201007965 202018 f arute k arya r babbush d bacon j c bardinr barends s boixo m broughton b b buckley dbuell et al science 369 1084 2020 issn 00368075url httpssciencesciencemagorgcontent3696507108419 brock j donahue k simonyan arxiv preprintarxiv180911096 201820 n klco m j savage phys rev 102012612 2020 url httpslinkapsorgdoi101103physreva10201261221 s lloyd m schuld ijaz j izaac n killoranarxiv preprint arxiv200103622 202022 b t kiani g d palma m marvian zw lius lloyd quantum earth movers distance new approach learning quantum data 2021 21010303723 v bergholm j izaac m schuld c gogolin m salam s ahmed j m arrazola c blank delgados jahangiri et al pennylane automatic differentiation hybrid quantumclassical computations 202018110496824 l mescheder geiger s nowozin proceedings 35th international conference machine learning edited j dy krausepmlr stockholmsmssan stockholm sweden 2018vol 80 proceedings machine learning research pp34813490 url httpproceedingsmlrpressv80mescheder18ahtml25 s aaronson complexity quantum statestransformations quantum money black holes2016 160705256mode collapse example quganprovide concrete example mode collapseoriginal qugan architecture 10 11 consider truedata state generator initialized statestate defined1 cos6 x sin6 y1 cos6 sin6generatordiscriminatortraining eqganoriginal qugan architecture shownoscillate indefinitely example constructedmain text fig 6 provide numerical experimentsdemonstrate successful convergenceproposed eqgan architecturestate fidelity wrt true datamaximizing eq 3 helstrom measurementdecomposing 2 discriminatort p 12 optimizing spacedensity matrices generator rotate paryallel t giving 0 12 iterationdiscriminator attempts perform new helstrommeasurement distinguish 0 resultst 0 p 0 generator realigns matchnew measurement operator 00straightforward qugantrained fully solve minimax optimization problemiteration converge instead oscillate states 0nash equilibrium minimax game fig 6qugan performance modecollapsepihi obtained positivespectral decomposition t kfold composition t existencek 1 t k sufficient ensureoscillation k states n qubitsachieve preparing target initialstate separated angle 3 generalizedbloch spherequgan partial trainingqugan trainingeqgan partial trainingeqgan training100120iterationlossfig 7 comparison qugan 10 11 eqgan learning state given eq 8 training denotes traininggenerator 50 epochs discriminator 50 epochsiteration partial training denotes 1 epoch iteration qugan remains unstable eqgantraining training configuration100training episodes150200fig 6 performance qugan 10 11 learning statedefined eq 8 initialization given eq 9 modecollapse manifests oscillation generator discriminator loss converging global optimumimplementation based original architecture pennylane 23generally consider oscillation finite set states let function tp denote optimal helstrom measurementfig 7 illustrate subtlety oscillatory analysis presented main text gan formalism generator discriminator iteratively optimizegiven loss function optimization allowedconverge extremum loss functionqugan architecture specifically result determinedhelstrom measurement case indefinite oscillation shown case learningstate constructed main text oscillationstates 0 result constant state overlap 34iterative optimization procedureoptimal helstrom measurementpartly completed generator discriminatorallowed extremize loss functionselection hyperparameters observe oscillation states continues fig 7 leading unstabletraining qugan architecture comparisonhyperparameters perform eqgan architecture steadily approaches true data stateunstable training difficult overcome classical gan architectures 24 advances understanding prevent nonconvergence consequential quantum classical machine learninghelp ensure stable training eqgan architecture introduce training procedure capitalizes fact discriminator convergeswap test optimal nash equilibriumtraining generator discriminatorbeginning pretrain eqgan supervisedsetting phase discriminator frozenparameters perfect swap testunitary dopt imperfect swap test generator trained loss converges secondphase training discriminator allowed vary adversarially generator seeking parametersd context gate errors second phaseyield unitary closer true swap test exampleshown fig 3 main text physical quantum devices replicated fig 8 showingphases training benefit adversarial swaptest presence noiseeqgan discriminator architectureimplement ancillafree swap test performstate discrimination fig 9 evaluate swaptest sycamore quantum device decomposecn ot gate hczi h operations usenative cz gate discussed main text czgate unstable errors effectively modeledz rotations unknown angle qubiteqgan formalism overcome singlequbitphase error applying rz gates directlycz operation adversarial training free angles optimized gradient descent mitigatetwoqubit gate error convergence propertiesprovided generative adversarial frameworkdiscriminator provably converges best state discriminator possible motivates early stoppingshown fig 3 discriminator loss indicatesbest state discriminator achievedfig 9 ancillafree swap test 3qubit statesrewriting controlledswap operation cnot toffoligates replacing computational basis operations classical post processing swap test performedancillary classical bitqnn architecturefrozenadversarialdiscriminator discriminatorperfect swapfig 8 comparison eqgan perfect swap testsimulated noise model normally distributed noisesinglequbit rotations applied systematic bias awayzero causing swap test force convergenceincorrect stateseek demonstrate empirical difference performance training quantum neural networkqnn individual examples classical datasetsuperposition data obtained pretrained eqgan use native cz twoqubit gateimplement rank4 entangling gate g given1 00 00 ei 0 0g0 0 ei 00 00 1decomposed shown fig 10planar connectivity sycamore quantumdevice implement qnn shown fig 11fourqubit data staterz 2 rx 2 rz 2z rx zrz 2 rx 2 rz 2fig 10 decomposition twoqubit entangling gate gqnn ansatz eq 100 xdatafig 11 quantum neural network architecture leftcorresponding layout sycamore device right fourqubit data state constructed circuits shownfig 4 placed datai state blue qubitsreadout qubit orange performs parameterized twoqubit interactions shown fig 10estimator parameter query outputqnn averaged 10 trials reduce statisticalfluctuations qnns final learning rates 10393sampling 10183 superposition evaluated 50 trials obtain final performance reported table ii computed standard deviationsadversarial learning errorsmain text discusses benefit adversariallearning noisy case automatic suppressiondevice errors provide additional motivationadversarial learning noiseless caseparticular construct example perfectswap test fails adversarial learning successfully generates true data state fig 12qnn trained ways trainedsampling shown training example iterationref 13 superposition shown superpositionentire class iteration discussedmain text superposition methodology useexact superposition training dataset insteaduses shallow approximation obtained pretrainingeqgan prepare symmetric concatenationexponential functions approximate peak minimal circuit depth comparison preparing gaussiandistribution n qubits requires n1controlled rotations decomposed 2n1 cz gatesuse native gate basis fig 10 20 additionalswap operations required prepare stateplanar architecture given empirical datasetprepare exact superposition data followingstate preparation procedure proposedref 25 requires ncontrolled rotations leading exponential dependence number qubits versions qram shownfig 14ensure fair comparison permit equal number queries quantum device consequentlyn 60 examples 30 examples class trainingsampling performed 1 epoch 60 corresponding60 iterations performed quantum device training superposition evaluates superposition class 30 times classesaccessing quantum device 60 iterationsadditionally bayesian optimization tune different learning rates sampling superpositionmethodologies simulation optimize adamlearning rates 104 101 10 random parameter tries 40 evaluations gaussian processstate fidelity wrt true data100095090perfect swap085eqgan080075070100150200250300iterationfig 12 demonstration vanishing gradient perfect swap test convergence eqganswap test trained gradient descent eqganachieves state overlap 097z xfig 13 generator data circuit vanishing gradient given data defined x z rotations 2generator initialized zero anglesgiven generator ansatz shown fig 13 definedata state angles 0 0 2 corresponding rotations rx 0 rz 0 generatoroptimizes angles achieving state overlapp general gradient state overlap2 2 cos2 cos2 initializing genera4tor 0 gradient higher derivatives overlap vanish noiseless supervisedlearning approach perfect swap test evalexponential peak ansatzb gaussian peak ansatz0 y0 y0 yh ry hh ryh ryconth ryx zz hx zz hh ryh ryx zx zz hc exact superpositionh ry hh ry hh ry hh ryx zcontx zh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ryx zz hz xh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ry hh ryfig 14 qram ansatzes n 4 qubits planar connectivity exponential peaks 3 twoqubit gates b gaussiandistribution 21 twoqubit gates c exact superposition 57 twoqubit gates adopt ansatz circuit depthscales polynomially qram n qubits b c scale exponentially nuate gradient state overlap measurement gradient descent fail converge correct valueshand allowing discriminatorchange issue vanishing gradient circumventedgenerator learns data state fig 12simplicity use discriminator architecturesuppressing errors parameters optimized vanilla stochastic gradient descent eqgan learning rate schedule manually tunedverify selection learning rate allows perfectswap test9 convergeprobabilistic mixture quantum state sampling pi prepare associated stateobviates possible double exponential overheadlearning quantum channel transform fixedinitial state desired mixed state illustratedfig 15eqgan pure stateb eqgan mixed statehybrid eqgan mixedstateclassical gans use random latent vectorgenerate fake data quantum gan proposedexisting literature require random input comes price especiallygoal learn quantum data mixed stateshown fig 15 factor overhead numberqubits needed mixedstate learning basedchois theoremcloser look mathematical nature mixedstate points efficient representationhybrid classicalquantum network mixed state repp2nresented generic form i1 pi ihispecified classical probability distribution pi2n discrete variables corresponding set quantumstates diagonalize density matrix naturally efficiently represent classicalrepresentation pi classical neural networkquantum circuit prepares state given parameter set gi way able outputfig 15 diagram eqgan architecture based quantum swap tests eqgan learning generatepurestate quantum data b eqgan learninggenerate mixedstate quantum data true input datarepresented fake input data preparedunitary circuit ug discriminator qnn realizes unitary transformation represented ua jointly truedata fake data ancillary qubit measurementancillary qubit cost function similarlyeqgan defined main text