flowpacket hybrid traffic classificationclassaware network routingsayantan chowdhury ben liang ali tizghadam ilijc albaneseuniversitytoronto canadateluscanadaarxiv210500074v1 csni 30 apr 2021abstractnetwork traffic classification machine learning techniques widely studiedexisting schemes classify entire traffic flows major limitations practicalitynetwork router packets need processed minimum delay classifier waitend flow decision furthermore complicated machine learning algorithmcomputationally expensive implement inside router paper introduceflowpacket hybrid traffic classification fphtc router makes decision packet basedrouting policy designed transferring learned knowledge flowbasedclassifier residing outside router analyze generalization bound fphtcadvantage regular packetbased traffic classification present experimental resultsrealworld traffic dataset illustrate classification performance fphtcrobust traffic pattern changes deployed limited computational resourcentroductiontraffic classification critical operation networks aspectsnetwork management qualityofservice guarantee security concerns large segmentnetwork traffic encrypted recent years traditional methods classification protocolbased approach content comparison longer appropriate 1 contrast machine learningalgorithms identify traffic flows high accuracy statistical features 26classaware routing network routers need conduct traffic classificationforwarding traffic common machine learning algorithms computationallyexpensive routers example deep neural networks known provideaccurate classification outcomes computationally intensive train needupdated frequently adapt changing traffic pattern time importantly statisticalfeatures required flowbased traffic classification techniques available realtimeclassification general statistical features variance packet length extractedend flow lengths packets observed usefulrouter route packets flow arrive little delay possibleauthors proposed early recognition traffic classes observing subset packetsflow 79 cause significant delay router generally needs processmillions packets fraction secondnaive alternative pure packetbased traffic classification packet observedclassified immediately classifier wait stream packets flow routerlook simple features embedded packet header quick decision packetpacketbased traffic classification requires fast lookup packet headers amenablepractical implementation highspeed routers key drawback approachclassification performance poor absence detailed statistical featuresavailable flowbased classificationmotivates combine advantages flowbased packetbased traffic classification propose novel flowpacket hybrid traffic classification fphtc methodlowcomplexity routing policy packet classification router designed assistanceflowbased classifier resides outside router best knowledge existsprior work considers hybrid form flowbased packetbased methods networktraffic classification routercontributions summarized followspropose fphtc generates lowcomplexity routing policy appliedincoming packets router routing policy enables classaware routing simpleincoming trafficflowstraffic mirrortraffic selectorflowbasedtraffic classifierdeep packetinspectionlabeledflowslabeledpacketspacketbasedrouting policydesignerpacketbasedrouting policyflowbasedtraffic classifierdesignerrouterclassawarerouting outputfigure 1 diagram illustrating fphtc frameworkfeatures directly read packet header generate routingpolicy exploiting knowledge learned highly accurate flowbased classifier residingoutside router routing policy constructed decision tree trained packetslabeled flowbased classifier fphtc employ flowbased classifier labelnumber packets resulting routing policy highly accuratefphtc deployed online learning setting new routing policyupdated router performance current routing policy fallscertain threshold changes traffic pattern achieved adaptively retrainingflowbased classifier routing policy receiving feedback routingpolicy update requiredprovide theoretical justification performance advantage fphtc regular packetbased traffic classification terms generalization bound enables exploringtradeoff cost labeling data training flowbased classifiergeneralization bound routing policyconduct extensive experiments aggregate dataset 43590 encrypted traffic flows10 11 train gradient boosted tree models xgboost 12 lightgbm 13flowbased classifier compare performance fphtc regular packetbasedtraffic classification different training dataset sizes observe substantial performance gainfphtcrest paper structured follows concept fphtc presented section iidifferent components fphtc routing policy design update proceduresection iii provides analytical comparison fphtc regular packetbased trafficclassification terms generalization bound section iv present experimental setupclassification performance fphtc section v concludes paperii f lowpacket h ybrid t raffic c lassificationpropose fphtc router needs conduct classaware traffic processing sectionprovide detailed description scheme diagram illustrating overall frameworkfphtc given fig 1core components fphtc1 router router accepts incoming stream packets processes accordingservice classes routing policy basic structure function routing policywelldefined prior works packet classification 14 15 work focusgenerate routing policy rules training machine learning model packetbased trafficclassification chosen header fields packet features inputslearning model packet classified learning model determine cos examplechosen header fields source ip address destination ip address source port numberdestination port number possible actions route packetdelay sensitive delay moderate delay tolerant2 flowbased traffic classifier flowbased traffic classifier resides outside routerpowerful equipment handle heavy computation required sophisticated machinelearning techniques complex highly accurate machine learning model classifytraffic flow terms cos packets trained number bidirectional tcpflows set flowlevel statistical features extracted raw datasetmethods possible generate training dataset flowbased traffic classifierwork ultimately interested online classification handle changing traffic patterntime propose use continuously updated recording past traffic specificallyuse traffic mirror traffic selector shown fig 1 separate selected small portionincoming traffic flows selected flows labeled deep packet inspection dpimodule according cos true cos labels obtained dpi train flowbasedclassifier note dpi replace role flowbased classifierflows prohibitive cost delay common encrypted trafficrole flowbased traffic classifier designer includes data preprocessing hyperparameterselection finally training flowbased classifier flowbased classifier traineduse infer cos labels incoming flows captured traffic mirror packetsbelonging flow tagged cos label flow note cos labels generatedway flowbased classifier late routing labeled packetsachieves create packetlevel dataset training packetbased routingpolicy explained3 packetbased routing policy designer packetbased routing policy designer takes labeledpackets flowbased classifier input outputs routing policy router specifically routing policy designer trains packetbased classifier labeled packetstraining datasetwork use binary decision tree learning model packetbased classifierdecision tree path root node routing policy rule obtain routingpolicy rules router routing policy designer needs train decisiontree packetlevel dataset furthermore note number routing policy rules equalsnumber leaf nodes decision tree provides easy way control sizerouting policy routing policy designer limit maximum number leaf nodestraining decision treeb construction routing policyconstruction routing policy fphtc involves transferring learned knowledgeflowbased classifier routing policy designer machine learning literature knowledgedistillation 16 17 technique simple student model trained predictions suppliedhighly accurate complex teacher model fphtc train decision tree routingpolicy designer predictions flowbased classifier training targets essencerouting policy designer tries approximate performance flowbased classifierflowbased classifier trained flowlevel statistical features routing policydesigner uses features read directly packet headerclear learned routing policy perform worse flowbased classifier giventraffic data training unlabeled training data availablelabeled dpi label data samples flowbased classifiersubstantially enlarge training dataset routing policy designer decision treerouting policy designer trained larger dataset flowbased classifierperformance routing policy close flowbased classifier importantlyrouting policy created fphtc utilizes information learned powerful flowcollect datalabeldpislot 1slot 2trainflowbasedclassifierslot 3collectdatalabelflowbasedclassifierslot 4slot 5designroutingpolicyslot 6slot 7updateroutingpolicyrouterslot 8time slotsfigure 2 fphtc online settingbased classifier substantially outperform regular packetbased classifier trainedsmall labels generated dpic routing policy update procedure online settingpractical data pattern incoming traffic changes time newapplications appearing network changing user behavior design fphtcdynamically update routing policy timefig 2 illustrate modules sequentially function continuous stream trafficgiven time slot collect label small portion incoming traffic flows dpitrain flowbased classifier continue collect flows trainingrouting policy flowbased classifier trained use label collected flowslabeled dpi routing policy designer trains decision tree generate routingpolicy updated routerimportant question repeat steps update routing policytime slot traffic data pattern change frequently routing policy updatetime slot waste resources retrain flowbased classifier labeling costdpi expensive costeffective solution update routing policytraffic pattern altered significantly inferred measuring performancedeterioration router feedback signal generated example based increasepacket drop congestion indicate routing policy update necessary demonstrateadaptiveness fphtc online setting section iviii c omparison w ith r egular packet based t raffic c lassificationhighlight benefit combining flowbased packetbased traffic classification fphtccompare regular packetbased traffic classification help flowbasedclassifier section provide theoretical justification fphtc performs betterregular packetbased traffic classificationregular packetbased traffic classification decision tree routing policy designer trainedtrue labels packets contrast fphtc flowbased classifier requires truelabels fair comparison maintain training dataset size regular packetbased traffic classifier equal training dataset size flowbased classifier fphtcmeasured terms number flowslet n number flows training dataset routing policy designer fphtcrecall flows labeled flowbased classifier flowbased classifier trainedfraction flows labeled dpi cost labeling flowdpi cdpi total cost ncdpi increasing lead accurate flowbasedclassifier fphtc ultimately accurate routing policy resultgreater cost labeling flows exists tradeoff carefully analyzedsuppose h hypothesis set classifier capacity measure hc f hfunction learned classifier n training samples f ground truth targetfunction generalization bound expressed follows 17rf rf or expected loss o term estimation error approximationerror rate learning given onr difficult nonseparable problems r 21represents slow rate learning contrast easy separable problems trainedclassifier makes training error r 1 represents fast rate learning 17fphtc flowbased classifier routing policy designer play role teacherstudent respectively let hfl hypothesis set flowbased classifier capacitymeasure hfl c let ffl hfl function learned flowbased classifier f groundtruth fraction flows training generalization boundflowbased classifier givenhfl cflrffl rf ofl approximation error flowbased classifier use common assumptionrate learning sophisticated teacher inversely proportional sizetraining dataset on1similarly let hrp hypothesis set routing policy designer fphtc capacitymeasure hrp c let frp hrp function determined routing policy designerhrp crfrp rffl orprp approximation error routing policy student learns teacherspredictions decision boundary original classification problem translatedsmoother student aided teachers predictions learns faster ratetrue labels rate learning represented parameter 05 1combining 2 3rfrp rf rfrp rffl rffl rfhrp chfl cflrp ohrp c hfl crp flngives generalization bound fphtc note bound improves increasesstep optimization consider weighted sum generalizationbound dpi labeling cost functionhrp c hfl crp fl ncdpik constant proportionality minimize c differentiate 5 wrt setderivative equal zero finally obtain optimal fphtckhfl c 1n1 cdpic kregular packetbased traffic classification hypothesis set hrp representscapability router function fpk hrp chosen approximate ground truthf help teacher bound regular packetbased traffic classifierfollowshrp crfpk rf opkpk approximation error regular packetbased traffic classifier studenttrained true labels case classification problem difficult rate learningslower on12 comparing 7 4 fphtc outperforms regular packetbasedtraffic classification following inequality holdshrp chrp c hfl cpknlet explain reasonable 8 hold traffic classification problemteacher highly complex flowbased classifier student simple decision tree trainedrouting policy designer hfl c hrp c fphtc viewedinstance hintons knowledge distillation framework 16 case feature spacesteacher student different furthermore flowbased classifier trainedflowlevel statistical features routing policy designed based smallernumber packetlevel features approximation error routing policylargerflowbased classifier 8 fl rp pk furthermore 05n n 1 hfl c hrp c large valuehfl c balanced parametersnote intrinsic parameter control controlhandclose 1 benefit hand smalln n approaches zero difference 05 lost moderatesatisfy 8 allow fphtc outperform regular packetbased traffic classificationiv e xperimental e valuationsection discuss experimental setup evaluate performancefphtc compare regular packetbased traffic classification demonstrate impactstraining dataset size online settingdataset learning modelsuse combined realworld traffic traces iscx vpnnonvpn 2016 10 18 iscxtornontor 2016 11 19 contains pcap files 43590 encrypted tcp bidirectional flows8 application types group 8 application types 3 cos categories shown table 1flowbased classification extract 268 features tcp flow current set featuresincludes source destination ip addresses addition list 266 features 6remove flows payload dataset use 90 rest datasettraining dataset plus 10 testing experiments require different trainingdataset sizes use randomly selected subset training dataset training datasetsbalanced applying sklearnutilsresample function scikitlearn v0213 20number training samples cos class machine learning modelsimplemented python 383 use balanced test accuracy main performance metricaverage proportion correctly classified samples class performance metricaffected imbalance datasetrouting policy designer takes labeled packets input 4 features source ip addressdestination ip address source port number destination port number 32bit ipv4 addressesconverted decimal numbers feature values given set labeled flows obtaincorresponding set unique packets having 4 features note 4 features guaranteepackets particular tcp flow mapped routing outputnote traffic dataset structured type data known gradientboosted tree ensemble appropriate learning model 21 use stateoftheart gradientboosted tree ensembles xgboost 12 lightgbm 13 flowbased classifier experiments xgboost model trained 100 trees ensemble learning rate 03maximum depth tree limited 6 lightgbm use gradientbased onesidesampling goss boosting method number trees ensemble 100 numberleaves maximum depth restricted 31 unlimited respectively learning rate remainscos labelapplication typedelay sensitivechat voipdelay moderateaudio videodelay tolerantftp mail p2p webtable 1 application types cos labelsflowbased classifier lightgbmflowbased classifier xgboostfphtc lightgbmfphtc xgboostregular packetbased traffic classificationbalanced test accuracy80077575072570067565062550001000015000200002500030000flows training dataset routing policy designer fphtc35000figure 3 balanced test accuracy vs n size training dataset routing policy designerfphtc 90 confidence intervalrouting policy designer trains single cart predictions flowbased classifiertraining targets use decision tree classifier balanced class weights entropycriterion choosing best split parameters maximum depth maximum leafnodes determine structure tree kept unlimitedb impact size training datasetsperformance fphtc shown fig 3 1000 flows training datasetflowbased classifier present balanced test accuracy fphtc 90 confidence intervalobserve increases training dataset size routing policy designer increasedrecall training dataset generated flowbased classifier theoreticallimit size contrast training dataset size regular packetbased traffic classifierremains flowbased classifier observe fphtc outperformsregular packetbased traffic classification training dataset routing policy designerlarge performance gain fphtc larger flowbased classifierregular packetbased traffic classifier trained small training dataset exampleflowbased classifier lightgbm routing policy designer trained 1000flows maximum number available flows training dataset containing 34473 flowsrespectively fphtc 9 accurate regular packetbased traffic classificationfphtc significantly improves accuracy low data regimenote performance fphtc strictly ascending fig 3 34473unique flows available dataset training increased training datasetsize routing policy designer observed larger gain fphtc regular packetbasedtraffic classification lightgbm flowbased classifier performs slightlybetter xgboost present results lightgbm flowbasedclassifier rest experimentstable 2 training dataset sizes present balanced test accuracy flowbasedclassifier lightgbm regular packetbased traffic classifier fphtc n 34473experiment repeated 10 randomly chosen training test sets averageaccuracy listed note significant gap accuracy flowbasedclassifier regular packetbased traffic classifier gap especially largesmall training dataset gap features observed flowbased classifierflowstraining datasetflowbasedclassifierfphtcregularpacketbased1000795974996593500089598485789710000922787138385table 2 balanced test accuracy vs flows training dataset flowbased classifierregular packetbased classifierbalanced test accuracyfphtcregular packetbased traffic classificationflowbased classifiertime slotsfigure 4 performance fphtc online setting traffic pattern changing 10 timeslotsregular packetbased traffic classifier confirms rationale workroom improvement routing policy utilize knowledge learned flowbasedclassifier furthermore observe fphtc substantially reduce gap especiallytraining data smallc classification performance fphtc online settingfinally implement routing policy update procedure fphtc online settingexperiment simply use test accuracy routing policy feedback signal accuracydropped accuracy threshold end time slot retraining flowbasedclassifier routing policy update begin time slot training stops accuracycrosses accuracy threshold consecutive improvement accuracysaturation thresholdsimulate neverending stream traffic shuffling training dataset randomlyrun experiment 30 time slots change data pattern 10 time slotssimulate traffic pattern change use subset 5 application types incomingtraffic 10 time slots pick subset 5 application types generate incomingtraffic test traffic pattern changed time slot 0 time slot 10 time slot 20changing applications time shown table 3time slot retraining needed 1000 flows selected labeleddpi training flowbased classifier 10000 flows labeled trainedflowbased classifier routing policy design use accuracy threshold 80saturation threshold 1 experiment fig 4 illustrates balanced test accuracy drops10 time slots traffic pattern change retraining begins routing policyupdated observe gradual increase test accuracy test accuracy saturatedrouting policy update stops observe flat line test accuracy observefphtc substantially outperforms regular packetbased traffic classification online settingv c onclusionpaper propose flowpacket hybrid traffic classification fphtc enableslowcomplexity highly accurate packetbased classification network router fphtcapplication types datasettime slot 0audio ftp video voip webtime slot 10ftp mail p2p video voiptime slot 20audio chat ftp mail webtable 3 change traffic pattern timesophisticated flowbased classifier residing outside router uses highdimensional flowlevel featuresachieve high classification accuracy routing policy designer generates simple routingpolicy router based small number packetlevel features utilizing knowledgeflowbased classifier discuss routing policy updates online setting keeps fphtcrobust traffic pattern change time experimental results confirms learnedknowledge flowbased classifier substantially improve performance routingpolicyr eferences1 m finsterbusch c richter e rocha j muller k hanssgen survey payloadbased traffic classificationapproaches ieee communications surveys tutorials vol 16 2 pp 11351156 20142 moore d zuev internet traffic classification bayesian analysis techniques proc acm sigmetricsint conf measurement modeling systems 20053 t auld moore s f gull bayesian neural networks internet traffic classification ieee transactionsneural networks vol 18 1 pp 223239 20074 m roughan s sen o spatscheck n duffield classofservice mapping qos statistical signaturebasedapproach ip traffic classification proc acm sigcomm conference internet measurement 20045 p wang s lin m luo framework qosaware traffic classification semisupervised machine learningsdns proc ieee international conference services computing scc 20166 s chowdhury b liang tizghadam explaining classofservice oriented network traffic classificationsuperfeatures proc acm conext workshop big data machine learning artificial intelligence datacommunication networks bigdama 20197 l bernaille r teixeira early recognition encrypted applications proc passive active networkmeasurement 20078 t t t nguyen g armitage p branch s zander timely continuous machinelearningbased classificationinteractive ip traffic ieeeacm transactions networking vol 20 6 pp 18801894 20129 g xie m iliofotou r keralapura m faloutsos nucci subflow practical flowlevel trafficclassification proc ieee infocom 201210 g drapergil lashkari m mamun ghorbani characterization encrypted vpn traffic timerelated features proc international conference information systems security privacy icissp 201611 lashkari g drapergil m mamun ghorbani characterization tor traffic time based featuresproc international conference information security privacy icissp 201712 t chen c guestrin xgboost scalable tree boosting proc acm sigkdd international conferenceknowledge discovery data mining 201613 g ke q meng t finley t wang w chen w ma q ye t liu lightgbm highly efficient gradientboosting decision tree proc neural information processing systems nips 201714 p gupta n mckeown packet classification multiple fields sigcomm comput commun rev vol 29 4p 147160 199915 algorithms packet classification netwrk mag global internetwkg vol 15 2 p 2432 200116 g hinton o vinyals j dean distilling knowledge neural network proc nips deep learningrepresentation learning workshop 201517 d lopezpaz b schlkopf l bottou v vapnik unifying distillation privileged information procinternational conference learning representations iclr 201618 iscx vpnnonvpn 2016 online available httpswwwunbcacicdatasetsvpnhtml19 iscx tornontor 2016 online available httpswwwunbcacicdatasetstorhtml20 f pedregosa et al scikitlearn machine learning python journal machine learning research vol 12 pp28252830 201121 r bekkerman present future kdd cup competition outsiders perspective 2015 onlineavailable httpswwwlinkedincompulsepresentfuturekddcupcompetitionoutsidersronbekkerman