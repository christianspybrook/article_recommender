STOCHASTIC LIE GROUP INTEGRATORS∗

arXiv:0704.0022v1 [math.NA] 31 Mar 2007

SIMON J.A. MALHAM AND ANKE WIESE
Abstract. We present Lie group integrators for nonlinear stochastic differential equations with
non-commutative vector fields whose solution evolves on a smooth finite dimensional manifold. Given
a Lie group action that generates transport along the manifold, we pull back the stochastic flow on
the manifold to the Lie group via the action, and subsequently pull back the flow to the corresponding
Lie algebra via the exponential map. We construct an approximation to the stochastic flow in the
Lie algebra via closed operations and then push back to the Lie group and then to the manifold,
thus ensuring our approximation lies in the manifold. We call such schemes stochastic Munthe-Kaas
methods after their deterministic counterparts. We also present stochastic Lie group integration
schemes based on Castell–Gaines methods. These involve using an underlying ordinary differential
integrator to approximate the flow generated by a truncated stochastic exponential Lie series. They
become stochastic Lie group integrator schemes if we use Munthe-Kaas methods as the underlying
ordinary differential integrator. Further, we show that some Castell–Gaines methods are uniformly
more accurate than the corresponding stochastic Taylor schemes. Lastly we demonstrate our methods
by simulating the dynamics of a free rigid body such as a satellite and an autonomous underwater
vehicle both perturbed by two independent multiplicative stochastic noise processes.
Key words. stochastic Lie group integrators
AMS subject classifications. 60H10, 60H35, 93E20

1. Introduction. We are interested in designing Lie group numerical schemes
for the strong approximation of nonlinear Stratonovich stochastic differential equations of the form
d Z t
X
yt = y0 +
Vi (yτ , τ ) dWτi .
(1.1)
i=0

0

Here W 1 , . . . , W d are d independent scalar Wiener processes and Wt0 ≡ t. We suppose
that the solution y evolves on a smooth submanifold M of Rn and Vi : M × R+ →
T
i = 0, 1, . . . , d, are smooth vector fields which in local coordinates are Vi =
PM,
n
j
j=1 Vi ∂yj . The flow-map φt : M → M of the integral equation (1.1) is defined as
the map taking the initial data y0 to the solution yt at time t, i.e. yt = φt ◦ y0 .
Our goal in this paper is to show how the Lie group integration methods developed
by Munthe-Kaas and co-authors can be extended to stochastic differential equations
on smooth manifolds (see Crouch and Grossman [8] and Munthe-Kaas [36]). Suppose
we know that the exact solution of a given system of stochastic differential equations
evolves on a smooth submanifold M of Rn , but we can only find the solution pathwise
numerically. How can we ensure that our approximate numerical solution also lies in
the manifold?
Suppose we are given a finite dimensional Lie group G and Lie group action Λy0
that generates transport across the manifold M from the starting point y0 ∈ M via
elements of G. Then with any given elements ξ in the Lie algebra g corresponding
to the Lie group G, we can associate the infinitesimal action λξ using the Lie group
action Λy0 . The map ξ 7→ λξ is a Lie algebra homomorphism from g to X(M),
the Lie algebra of vector fields over the manifold M. Further the Lie subalgebra
{λξ ∈ X(M) : ξ ∈ g} is isomorphic to the finite dimensional Lie algebra g with the
same structure constants (see Olver [38], p. 53 and Marsden and Ratiu [33], p. 318).
∗ Maxwell Institute for Mathematical Sciences and School of Mathematical and Computer Sciences,
Heriot-Watt University, Edinburgh EH14 4AS, UK. (30/3/2007)

1

2

Malham and Wiese

Conversely, suppose we know that the Lie algebra generated by the set of governing vector fields Vi , i = 0, 1, . . . , d, on M is finite dimensional, call this XF (M). Then
we know there exists a finite dimensional Lie group G whose Lie algebra g has the
same structure constants as XF (M) relative to some basis, and there is a Lie group
action Λy0 such that Vi = λξi , i = 0, 1, . . . , d, for some ξi ∈ g (see Olver [38], p. 54 or
Kunita [26], p. 194). The choice of group and action is not unique.
In this paper we assume that there is a finite dimensional Lie group G and action
Λy0 such that our set of governing vector fields Vi , i = 0, 1, . . . , d, are each infinitesimal
Lie group actions generated by some element in g via Λy0 , i.e. Vi = λξi for some ξi ∈ g,
i = 0, 1, . . . , d. They are said to be fundamental vector fields. This means that we can
write down the set of governing vector fields Xξi for a system of stochastic differential
equations on the Lie group G that, via the Lie group action Λy0 , generates the flow
governed by the set of vector fields Vi on the manifold. The vector fields Vi on M are
simply the push forward of the vector fields Xξi on G via the Lie group action Λy0 .
Typically the flow on the Lie group also needs to be computed numerically. We thus
want the approximation to remain in the Lie group so that the Lie group action takes
us back to the manifold.
To achieve this, we pull back the set of governing vector fields Xξi on G to the set
of governing vector fields vξi on g, via the exponential map 'exp' from g to G. Thus
the stochastic flow generated on g by the vector fields vξi generates the stochastic flow
on G generated by the Xξi . The set of governing vector fields on g are for each σ ∈ g:
vξi ◦ σ ≡

∞
X

k=0

Bk (adσ )k ◦ ξi ,

(1.2)

where Bk is the kth Bernoulli number and the adjoint operator adσ is a closed operator
on g, in fact adσ ◦ ζ = [σ, ζ], the Lie bracket on g. Now the essential point is that
ξi ∈ g and so the series on the right or any truncation of it is closed in g. Hence
if we construct an approximation to our stochastic differential equation on g using
the vector fields vξi or an approximation of them achieved by truncating the series
representation, then that approximation must reside in the Lie algebra g. We can then
push the approximation in the Lie algebra forward onto the Lie group and then onto
the manifold. Provided we compute the exponential map and action appropriately, our
approximate solution lies in the manifold (to within machine accuracy). In summary,
for a given ξ ∈ g and any y0 ∈ M we have the following commutative diagram:
(Λy )∗

exp

g −−−−∗→ X(G) −−−0−→ X(M)
x
x
x
X
λ
vξ 

 ξ
 ξ
exp

g −−−−→

G

Λy

0
−−−−
→

M

We have implicitly separated the governing set of vector fields Vi , i = 0, 1, . . . , d,
from the driving path process w ≡ (W 1 , . . . , W d ). Together they generate the unique
Itô solution process y ∈ M to the stochastic differential equation (1.1). When there
is only one driving Wiener process (d = 1) the Itô map w 7→ y is continuous in
the topology of uniform convergence. When there are two or more driving processes
(d ≥ 2) the Universal Limit Theorem tells us that the Itô map w 7→ y is continuous
in the p-variation topology, in particular for 2 ≤ p < 3 (see Lyons [28], Lyons and
Qian [29] and Malliavin [32]). A Wiener path with d ≥ 2 has finite p-variation for

Stochastic Lie group integrators

3

p > 2. This means that from a pathwise perspective, approximations to y constructed
using successively refined approximations to w are only guaranteed to converge to
the correct solution y, if we include information about the Lévy chordal areas of
the driving path process. Note however that the L2 -norm of the 2-variation of a
Wiener process is finite. In the Lie group integration procedure prescribed above we
must solve a stochastic differential system on the Lie algebra g defined by the set
of governing vector fields vξi and the driving path process w ≡ (W 1 , . . . , W d ). In
light of the Universal Limit Theorem and with stepsize adaptivity in mind in future
(see Gaines and Lyons [17]), we for instance use in our examples order 1 stochastic
numerical methods-that include the Lévy chordal area-to solve for the flow on the
Lie algebra g.
We have thus explained the idea behind Munthe-Kaas methods and how they can
be generalized to the stochastic setting. The first half of this paper formalizes this
procedure.
In the second half of this paper, we consider autonomous vector fields and construct stochastic Lie group integration schemes using Castell–Gaines methods. This
approach proceeds as follows. We truncate the stochastic exponential Lie series expansion corresponding to the flow φt of the solution process y to the stochastic differential
equation (1.1). We then approximate the driving path process w ≡ (W 1 , . . . , W d ) by
replacing it by a suitable nearby piecewise smooth path in the appropriate variation
topology. An approximation to the solution yt requires the exponentiation of the
approximate truncated exponential Lie series. This can be achieved by solving the
system of ordinary differential equations driven by the vector field that is the approximate truncated exponential Lie series. If we use ordinary Munthe-Kaas methods as
the underlying ordinary differential integrator the Castell–Gaines method becomes a
stochastic Lie group integrator.
Further, based on the Castell–Gaines approach we then present uniformly accurate
exponential Lie series integrators that are globally more accurate than their stochastic
Taylor counterpart schemes (these are investigated in detail in Lord, Malham and
Wiese [27] for linear stochastic differential equations). They require the assumption
that a sufficiently accurate underlying ordinary differential integrator is used; that
integrator could for example be an ordinary Lie group Munthe-Kaas method. In
the case of two driving Wiener processes we derive the order 1/2, and in the case
of one driving Wiener process the order 1 uniformly accurate exponential Lie series
integrators. As a consequence we confirm the asymptotic efficiency properties for
both these schemes proved by Castell and Gaines [8] (see Newton [37] for more details
on the concept of asymptotic efficiency). We also present in the case of one driving
Wiener process a new order 3/2 uniformly accurate exponential Lie series integrator
(also see Lord, Malham and Wiese [27]).
We present two physical applications that demonstrate the advantage of using
stochastic Munthe-Kaas methods. First we consider a free rigid body which for example could model the dynamics of a satellite. We suppose that it is perturbed by
two independent multiplicative stochastic noise processes. The governing vector fields
are non-commutative and the corresponding exact stochastic flow evolves on the unit
sphere. We show that the stochastic Munthe-Kaas method, with an order 1 stochastic
Taylor integrator used to progress along the corresponding Lie algebra, preserves the
approximate solution in the unit sphere manifold to within machine error. However
when an order 1 stochastic Taylor integrator is used directly, the solution leaves the
unit sphere. The contrast between these two methods is more emphatically demon-

4

Malham and Wiese

strated in our second application. Here we consider an autonomous underwater vehicle
that is also perturbed by two independent multiplicative stochastic noise processes.
The exact stochastic flow evolves on the manifold which is the dual of the Euclidean
Lie algebra se(3); two independent Casimirs are conserved by the exact flow. Again
the stochastic Munthe-Kass method preserves the Casimirs to within machine error.
However the order 1 stochastic Taylor integrator is not only unstable for large stepsizes, but the solution drifts off the manifold and makes a dramatic excursion off to
infinity in the embedding space R6 .
Preserving the approximate flow on the manifold of the exact dynamics may be a
required property for physical or financial systems driven by smooth or rough paths-
for general references see Iserles, Munthe-Kaas, Nørsett and Zanna [21], Hairer, Lubich
and Wanner [19], Elworthy [12], Lyons and Qian [29] and Milstein and Tretyakov [34].
Stochastic Lie group integrators in the form of Magnus integrators for linear stochastic
differential equations were investigated by Burrage and Burrage [5]. They were also
used in the guise of Möbius schemes (see Schiff and Shnider [39]) to solve stochastic
Riccati equations by Lord, Malham and Wiese [27] where they outperformed direct
stochastic Taylor methods. Further applications where they might be applied include:
backward stochastic Riccati equations arising in optimal stochastic linear-quadratic
control (Kohlmann and Tang [24]); jump diffusion processes on matrix Lie groups
for Bayesian inference (Srivastava, Miller and Grenander [40]); fractional Brownian
motions on Lie groups (Baudoin and Coutin [3]) and stochastic dynamics triggered
by DNA damage (Chickarmane, Ray, Sauro and Nadim [10]).
Our paper is outlined as follows. In Section 2 we present the basic geometric setup,
sans stochasticity. In particular we present a generalized right translation vector field
on a Lie group that forms the basis of our subsequent transformation from the Lie
group to the manifold. Using a Lie group action, this vector field pushes forward
to an infinitesimal Lie group action vector field that generates a flow on the smooth
manifold. In Section 3 we specialize to the case of a matrix Lie group and using
the exponential map, derive the pullback of the generalized right translation vector
field on the Lie group to the corresponding vector field on the Lie algebra. To help
give some context to our overall scheme, we provide in Section 4 illustrative examples
of manifolds and natural choices for associated Lie groups and actions that generate
flows on those manifolds. Then in Section 5 we show how a flow on a smooth manifold
corresponding to a stochastic differential equation, can be generated by a stochastic
flow on a Lie algebra via a Lie algebra action. We explicitly present stochastic MuntheKaas Lie group integration methods in Section 6. We start the second half of our
paper by reviewing the exponential Lie series for stochastic differential equations in
Section 7. We show in Section 8 how to construct geometric stochastic Castell–Gaines
numerical methods. In particular we also present uniformly accurate exponential Lie
series numerical schemes that not only can be used as geometric stochastic integrators,
but also are always more accurate than stochastic Taylor numerical schemes of the
corresponding order. In Section 9 we present our concrete numerical examples. Finally
in Section 10 we conclude and present some further future applications and directions.
2. Lie group actions. Suppose M is a smooth finite dimensional submanifold
of Rn . We use X(M) to denote the Lie algebra of vector fields on the manifold M,
equipped with the Lie–Jacobi bracket [U, V ] ≡ U * ∇V − V * ∇U , for all U, V ∈ X(M).
Let G denote a finite dimensional Lie group.
Definition 2.1 (Lie group action). A left Lie group action of a Lie group G on a
manifold M is a smooth map Λ : G × M → M satisfying for all y ∈ M and R, S ∈ G:

Stochastic Lie group integrators

5

(1) Λ(id, y) = y; (2) Λ(R, Λ(S, y)) = Λ(RS, y). We denote Λy ◦ S ≡ Λ(S, y).
Hereafter we suppose y0 ∈ M is fixed and focus on the action map Λy0 : G→M.
We assume that the Lie group action Λ is transitive, i.e. transport across the manifold
from any point y0 ∈ M to any other point y ∈ M can always be achieved via a group
element S ∈ G with y = Λy0 ◦ S (Marsden and Ratiu [33], p. 310).
We define the Lie algebra g associated with the Lie group G to be the vector space
of all right invariant vector fields on G. By standard construction this is isomorphic
to the tangent space to G at the identity id ≡ idG (see Olver [38], p. 43 or Marsden
and Ratiu [33], p. 269).
Definition 2.2 (Generalized right translation vector field). Suppose we are
given a smooth map ξ : M→g. With each such map ξ we associate a vector field
Xξ : G → X(G) defined as follows

Xξ ◦ S ≡ ∂τ exp τ ξ(Λy0 ◦ S) S τ =0
for S ∈ G, where 'exp' is the usual local diffeomorphism exp : g → G from a neighbourhood of the zero element o ∈ g to a neighbourhood of id ∈ G.
Definition 2.3 (Infinitesimal Lie group action). We associate with each vector
field Xξ : G→X(G) a vector field λξ : M→X(M) as the push forward of Xξ from G to
M by Λy0 , i.e. λξ ≡ Λy0 ∗ Xξ , so that if S ∈ G and y = Λy0 ◦ S ∈ M, then
λξ ◦ y ≡ ∂τ Λy0 ◦ γ(τ )|τ =0 ,

where γ(t) ∈ G, γ(0) = S and ∂τ γ(τ ) = Xξ ◦ γ(τ ) (the flow generated on G by the
vector field Xξ starting at S ∈ G). Naturally, as a vector field λξ is linear, and also
λξ ◦ y ≡ LXξ ◦ Λy0 ◦ S ,
the Lie derivative of Λy0 along Xξ at S ∈ G.
Remarks.
1. Our definition for the generalized right translation vector field Xξ on G is
motivated by the standard right translation vector field used to identify g, the vector
space of right invariant vector fields on G, with Tid G, the tangent space to G at the
identity. When ξ ∈ g is constant, Xξ ∈ X(G) is right invariant and a Lie bracket
on Tid G can be defined via right extension by the corresponding Lie–Jacobi bracket
for the vector fields Xξ on X(G). Unless ξ ∈ g is constant, Xξ is not in general
right invariant. For further details see Varadarajan [43], Olver [38], or Marsden and
Ratiu [33].
2. The infinitesimal generator map ξ 7→ λξ from g to X(M) is a Lie algebra
homomorphism. If we identify g as the vector space of left invariant vector fields on G
this map becomes an anti-homomorphism. The Lie–Jacobi bracket as defined above
gives the right (rather than left) Lie algebra stucture over the group of diffeomorphisms
on M. If in addition we take the Lie–Jacobi bracket to be minus that defined above-
associated with the left Lie algebra structure-then the infinitesimal generator map
becomes a homomorphism again. See for example Marsden and Ratiu [33], p. 324 or
Munthe-Kaas [36].
3. A comprehensive study of the systematic construction of symmetry Lie groups
from given vector fields can be found in Olver [38].
4. We assumed above that the vector fields Xξ and λξ are autonomous. However
all results in this and subsequent sections up to Section 7 can be straightforwardly
extended to non-autonomous vector fields generated by ξ : M × R→g with (y, t) 7→
ξ(y, t) for all y ∈ M and t ∈ R.

6

Malham and Wiese

5. The map Λ(S) : M→M defined by y 7→ Λ(S) ◦ y ≡ Λy ◦ S represents a
flow on
 M. Hence if y = Λ(S) ◦ y0 , the push forward of λξ by Λ(S) is given by
Λ(S) ∗ λξ ≡ λAdS ξ (Marsden and Ratiu [33], p. 317).
6. If the action is effective/faithful then the map S 7→ Λ(S) from G to Diff(M),
the group of diffeomorphisms on M, is one-to-one. If the action is free so that Λy0
is one-to-one and the only fixed point is the identity element id ∈ G, then Λy0 is a
diffeomorphism (see Marsden and Ratiu [33], p. 310).
3. Pull back to the Lie algebra. For ease of presentation, we will assume in
this section that G is a matrix Lie group. Recall that the exponential map exp : g → G
is a local diffeomorphism from a neighbourhood of o ∈ g to a neighbourhood of id ∈ G.
Let vξ : g→g be the pull back of the vector field Xξ : G→X(G) from G to g via the
exponential mapping exp : g→G, i.e. vξ ◦ σ ≡ exp∗ Xξ ◦ σ. If σ ∈ g then

vξ ◦ σ = dexp−1
(3.1)
σ ◦ ξ Λy0 ◦ exp σ .

Here dexp−1
σ : g→g is the inverse of the right-trivialized tangent map of the exponential
dexpσ : g→g defined as follows. If β(τ ) is a curve in g such that β(0) = σ and
β ′ (0) = η ∈ g then dexp : g × g→g is the local smooth map (Varadarajan [43], p. 108)
dexpσ ◦ η ≡ ∂τ exp β(τ )|τ =0 exp(−σ)


exp(adσ ) − id
=
◦η.
adσ
Note that as a tangent map dexpσ : g→g is linear. The inverse operator dexp−1
σ is the
operator series (1.2) generated by considering the reciprocal of dexpσ .
To show that (3.1) is true, if exp : g→G with σ 7→ S = exp σ, and β(τ ) ∈ g with
β(0) = σ and ∂τ β(τ ) = vξ ◦ β(τ ), then:
exp∗ vξ ◦ S = ∂τ exp β(τ )|τ =0

= dexpσ ◦ vξ ◦ σ exp(σ)
≡ Xξ ◦ S .
Since 'exp' is a diffeomorphism in a neighbourhood of o ∈ g, this push forward calculation establishes the pull back (3.1) for all σ ∈ g in that neighbourhood.

4. Illustrative examples. Suppose the vector field V : M × R→X(M) generates a flow solution yt ∈ M starting from y0 ∈ M, where M is a smooth submanifold
of Rn . Then assume there exists a:
1. Lie group G with corresponding Lie algebra g;
2. Lie group action Λy0 : G→M for which a starting point y0 ∈ M is fixed;
3. Vector field λξ : M × R→X(M) such that: V ≡ λξ , i.e. V is a fundamental
vector field corresponding to the action Λy0 .
Let us suppose G is a matrix Lie group (or can be embedded into a matrix Lie
group, for example the Euclidean group SE(3) is naturally embedded into the special
linear group SL(4; R)). We have for all S ∈ G and t ∈ R,

(4.1)
Xξ (S, t) ≡ ξ Λy0 (S), t S .

If V = λξ for some ξ : M→g, some Lie group G and corresponding action Λy0 , then
the flow generated by Xξ on G drives the flow generated by V on M. In each of the
examples below, given the manifold M, we present a natural Lie group and action
associated with the manifold structure, and identify vector fields which generate flows
on the manifold via the Lie group.

Stochastic Lie group integrators

7

Stiefel manifold Vn,k . Suppose M = Vn,k ≡ {y ∈ Rn×k : y T y = I}. Take
G = SO(n), the special orthogonal group, and Λy0 (S) ≡ Sy0 , the action of left
multiplication. The corresponding Lie algebra g = so(n). Then by direct calculation
λξ (y) = ξ(y, t) y. Hence if the given vector field V (y, t) = ξ(y, t) y, then the push
forward of the flow generated by Xξ (S, t) on G in (4.1) is the flow generated by V on
M. Note that the unit sphere S2 ∼
= V3,1 , i.e. S2 is just a particular Stiefel manifold.
In Section 9 as an application, we consider rigid body dynamics evolving on S2 .
Isospectral manifold Sn . Suppose M = Sn = {y ∈ Rn×n : y T = y}, the set of
n × n real symmetric matrices. Take G = O(n), the orthogonal group and Λy0 (S) ≡
Sy0 S T , which is an isospectral action (Munthe-Kaas [36]). The corresponding Lie
algebra is g = so(n). Again, by direct calculation λξ (y) = ξ(y, t) y − y ξ(y, t). Hence
if the given vector field V (y, t) = ξ(y, t) y − y ξ(y, t), then the push forward of the flow
generated by Xξ (S, t) on G in (4.1), is the flow generated by V on M.

∗ ∼
Dual of the Euclidean algebra se(3)∗ . Suppose M = se(3)
= R3 , the dual

of the Euclidean algebra se(3) of the Euclidean group SE(3) = (s, ρ) ∈ SE(3) : s ∈
SO(3), ρ ∈ R3 . Take G = SE(3) so g = se(3) and Λ ≡ Ad∗ : G × g∗ →g∗ , the
coadjoint action of G on g∗ . Then by direct calculation λξ (y) = −ad∗ξ (y). Since
λξ (y) in linear in ξ and −λξ (y) ≡ λ−ξ (y), it follows that if V (y) = ad∗ξ (y), then

the push forward of the flow generated by X−ξ (S, t) = −ξ Λy0 (S), t S on G is the
flow generated by V on M. For more details see Section 9 where we investigate the
dynamics of an autonomous underwater vehicle evolving on se(3)∗ .

Grassmannian manifold Gr(k, n). The Grassmannian manifold M = Gr(k, n)
is the space of k-dimensional subspaces of Rn . Take G = GL(n), the general linear
matrix group, where if S ∈ GL(n), we identify


α β
S=
,
γ δ
where the block matrices α, β, γ and δ are sizes k × k, k × (n − k), (n − k) × k and
(n − k) × (n − k), respectively (see Schiff and Shnider [39]; Munthe-Kaas [36]). We
choose the action of GL(n) on Gr(k, n) to be the generalized Möbius transformation
Λy0 (S) = (αy0 + β)(γy0 + δ)−1 . Hence if


a(t) b(t)
ξ(t) =
,
c(t) d(t)
then direct calculation reveals that λξ (y) = a(t)y + b(t) − yc(t)y − yd(t). Hence if the
given vector field V (y) = a(t)y + b(t) − yc(t)y − yd(t), then the push forward of the
flow generated by Xξ (S, t) = ξ(t) S on G is the flow generated by V on Gr(k, n).
5. Stochastic Lie group integration. We show that if a Lie group action
Λ : G × M→M exists, then for y0 ∈ M fixed, the Lie algebra action Λy0 ◦ exp : g→M
carries a flow on g to a flow on M.
Theorem 5.1. Suppose there exists a Lie group action Λ : G × M→M. Then if
there exist an Itô process σ ∈ g and a stopping time T∗ such that on [0, T∗ ), σ satisfies
the stochastic differential equation
σt =

d Z
X
i=0

0

t

vξi ◦ στ dWτi ,

(5.1)

8

Malham and Wiese

then the Itô process y = Λy0 ◦ exp σ ∈ M satisfies the stochastic differential equation
on [0, T∗ ):
yt = y0 +

d Z
X
i=0

t

0

λξi ◦ yτ dWτi .

(5.2)

Proof. Using Itô's lemma, if σt ∈ g satisfies (5.1) then Λy0 ◦ exp σt satisfies
Λy0 ◦ exp σt = Λy0 ◦ exp o +

d Z
X
i=0

t

0

Lvξi ◦ Λy0 ◦ exp στ dWτi .

Now recall that for each i = 0, 1, . . . , d, Xξi is the push forward of vξi from g to G via
the exponential map, and that λξi is the push forward of Xξi from G to M via Λy0
and so the Lie derivative
Lvξi ◦ Λy0 ◦ exp σt ≡ λξi ◦ yt .
Then since yt = Λy0 ◦ exp σt , we conclude that y ∈ M is an Itô process satisfying the
stochastic differential equation (5.2).
Corollary 5.2. Suppose that for each i = 0, 1, . . . , d there exists ξi : G→g such
that the vector field Vi : M→X(M) and λξi : M→X(M) can be identified, i.e.
Vi ≡ λξi .

(5.3)

Then the push forward by 'Λy0 ◦exp' of the flow on the Lie algebra manifold g generated
by the stochastic differential equation (5.1) is the flow on the smooth manifold M
generated by the stochastic differential equation (5.2), whose solution can be expressed
in the form yt = Λy0 ◦ exp σt .
Remark. If the action is free then 'Λy0 ◦ exp' is a diffeomorphism from a neighbourhood of o ∈ g to a neighbourhood of y0 ∈ M.
6. Stochastic Munthe-Kaas methods. Assuming that the vector fields in our
original stochastic differential equation (1.1) are fundamental and satisfy (5.3), then
stochastic Munthe-Kaas methods are constructed as follows:
1. Subdivide the global interval of integration [0, T ] into subintervals [tn , tn+1 ].
2. Starting with t0 = 0, repeat the next two steps over successive intervals
[tn , tn+1 ] until tn+1 = T .
3. Compute an approximate solution σ̂tn ,tn+1 to (5.1) across [tn , tn+1 ] using a
stochastic Taylor, stochastic Runge–Kutta or Castell–Gaines method.
4. Compute the approximate solution ytn+1 ≈ Λytn ◦ exp σ̂tn ,tn+1 .
Note that by construction σ̂tn ,tn+1 ∈ g because the stochastic differential equation (5.1) (or any stochastic Taylor or other sensible approximation) evolves the solution locally on the Lie algebra g via the vector fields vξi : g→g. Suitable methods
for approximating the exponential map to ensure it maps g to G appropriately can be
found in Iserles and Zanna [22]. Then by construction ytn+1 ∈ M.
For example, with two Wiener processes and autonomous vector fields vξi ◦ σ, an
order 1 stochastic Taylor Munthe-Kaas method is based on

σ̂tn ,tn+1 = J0 v0 + J1 v1 + J2 v2 + 12 J12 v12 + J12 v2 v1 + J21 v1 v2 + 21 J22 v22 ◦ o , (6.1)
evaluated at the zero element o ∈ g. Typically 'dexp−1
σ ' is truncated to only include
the necessary low order terms to maintain the order of the numerical scheme.

Stochastic Lie group integrators

9

Remark. It is natural to invoke Ado's Theorem (see for example Olver [38] p. 48):
any finite dimensional Lie algebra is isomorphic to a Lie subalgebra of gl(n) (the
general linear algebra) for some n ∈ N. However as Munthe-Kaas [36] points out,
directly using a matrix representation for the given Lie group might not lead to the
optimal computational implementation (other data structures might do so).
7. Exponential Lie series. The stochastic Taylor series is known in different
contexts as the Neumann series, Peano–Baker series or Feynman–Dyson path ordered
exponential. If the vector fields in the stochastic differential equation (1.1) are autonomous (which we assume henceforth), i.e. for all i = 0, 1, . . . , d, Vi = Vi (y) only,
then the stochastic Taylor series for the flow is
φt =

∞
X
X

m=0 α∈Pm

Jα1 ***αm (t) Vαm * * * Vα1 .

Here Pm is the set of all combinations of multi-indices α = (α1 , . . . , αm ) of length m
with αi ∈ {0, 1, . . . , d} and
Z t
Z τm−1
dWταm1 * * * dWτα1m
Jα1 ***αm (t) ≡
***
0

0

are multiple Stratonovich integrals.
The logarithm of φt is the exponential Lie series, Magnus expansion (Magnus [30])
or Chen–Strichartz formula (Chen [9], Strichartz [41]). In other words we can express
the flow map in the form φt = exp ψt , where
ψt =

d
X
i=0

Ji (t)Vi +

d
X

1
2 (Jji

i,j=0

− Jij )(t)[Vi , Vj ] + * * *

is the exponential Lie series for our system, and [* , *] is the Lie–Jacobi bracket on
X(M). See Yamato [44], Kunita [25], Ben Arous [1] and Castell [7] for the derivation
and convergence of the exponential Lie series expansion in the stochastic context;
Strichartz [41] for the full explicit expansion; Sussmann [42] for a related product
expansion and Lyons [28] for extensions to rough paths.
Let us denote the truncated exponential Lie series by
X
Jα cα ,
(7.1)
ψ̂t =
α∈Qm

where Qm denotes the finite set of multi-indices α for which kJα kL2 is of order up to
and including tm , where m = 1/2, 1, 3/2, . . .. The terms cα are linear combinations
of finitely many (length α) products of the smooth vector fields Vi , i = 0, 1, . . . , d.
The following asymptotic convergence result can be established along the lines of the
proof for linear stochastic differential equations in Lord, Malham and Wiese [27]; we
provide a proof in Appendix A.
Theorem 7.1. Assume the vector fields Vi are Lipschitz continuous and satisfy
kVi (y)k22 ≤ c (1 + kyk22) for all y ∈ M, i = 0, 1, . . . , d and some c > 0. Then for t ≤ 1,
the flow exp ψ̂t ◦ y0 is square-integrable, where ψ̂t is the truncated Lie series (7.1).
Further, if y is the solution
of the stochastic differential equation (1.1), there exists a

constant C m, ky0 k2 such that

yt − exp ψ̂t ◦ y0 L2 ≤ C m, ky0 k2 tm+1/2 .
(7.2)

10

Malham and Wiese

8. Geometric Castell–Gaines methods. Consider the truncated exponential
Lie series ψ̂tn ,tn+1 across the interval [tn , tn+1 ]. We approximate higher order multiple
Stratonovich integrals across each time-step by their expectations conditioned on the
increments of the Wiener processes on suitable subdivisions (Gaines and Lyons [17]).
An approximation to the solution of the stochastic differential equation (1.1) across
the interval [tn , tn+1 ] is given by the flow generated by the truncated and conditioned
exponential Lie series ψ̂tn ,tn+1 via

ytn+1 ≈ exp ψ̂tn ,tn+1 ◦ ytn .

Hence the solution to the stochastic differential equation (1.1) can be approximately
computed by solving the ordinary differential system (see Castell and Gaines [8];
Misawa [35])
u′ (τ ) = ψ̂tn ,tn+1 ◦ u(τ )

(8.1)

across the interval τ ∈ [0, 1]. Then if u(0) = ytn we will get u(1) ≈ ytn+1 . We
must choose a sufficiently accurate ordinary differential integrator to solve (8.1)-we
implicitly assume this henceforth.
The set of governing vector fields Vi , i = 0, 1, . . . , d, prescribes a map from the
driving path process w ≡ (W 1 , . . . , W d ) to the unique Itô solution process y ∈ M to
the stochastic differential equation (1.1). The map w 7→ y is called the Itô map. Recall
that we assume the vector fields are smooth. When there is only one driving Wiener
process (d = 1) the Itô map is continuous in the topology of uniform convergence
(Theorem 1.1.1. in Lyons and Qian [29]). When there are two or more driving processes (d ≥ 2) the Universal Limit Theorem (Theorem 6.2.2. in Lyons and Qian [29])
tells us that the Itô map is continuous in the p-variation topology, in particular for
2 ≤ p < 3. A Wiener path with d ≥ 2 has p-variation with p > 2, and the p-variation
metric in this case includes information about the Lévy chordal areas of the path
(Lyons [28]). Hence we must choose suitable piecewise smooth approximations to the
driving path process w. The following result follows from the corresponding result for
ordinary differential equations in Hairer, Lubich and Wanner [19] (p. 112) as well as
directly from Chapter VIII in Malliavin [32] on the Transfer Principle.
Lemma 8.1. A necessary and sufficient condition for the solution to the stochastic differential equation (1.1) to evolve on a smooth submanifold M of Rn up to a
stopping time T∗ is that Vi (y, t) ∈ Ty M for all y ∈ M, i = 0, 1, . . . , d.
Hence the stochastic Taylor expansion for the flow φt is a diffeomorphism on M.
However a truncated version of the stochastic Taylor expansion for the flow φ̂t will not
in general keep you on the manifold, i.e. if y0 ∈ M then φ̂t ◦ y0 need not necessarily
lie in M. On the other hand, the exponential Lie series ψt , or any truncation ψ̂t of
it, lies in X(M). By Lemma 8.1 this is a necessary and sufficient condition for the
corresponding flow-map exp ψ̂t to be a diffeomorphism on M. Hence if u(0) = ytn ∈
M, then ytn+1 ≈ u(1) ∈ M. When solving the ordinary differential equation (8.1),
classical geometric integration methods, for example Lie group integrators such as
Runge–Kutta Munthe-Kaas methods, over the interval τ ∈ [0, 1] will numerically
ensure ytn+1 stays in M. Additionally, as the following result reveals, numerical
methods constructed using the Castell–Gaines Lie series approach can also be more
accurate (a proof is provided in Appendix B).
Theorem 8.2. In the case of two independent Wiener processes and under the
assumptions of Theorem 7.1, for any initial condition y0 ∈ M and a sufficiently small

Stochastic Lie group integrators

11

fixed stepsize, the order 1/2 Lie series integrator is globally more accurate in L2 than
the order 1/2 stochastic Taylor integrator. In addition, in the case of one Wiener
process, the order 1 and 3/2 uniformly accurate exponential Lie series integrators

2
(1)
generated by ψ̂tn ,tn+1 = J0 V0 + J1 V1 + h12 [V1 , [V1 , V0 ]] and

2
(3/2)
ψ̂tn ,tn+1 = J0 V0 + J1 V1 + 21 (J10 − J01 )[V0 , V1 ] + h12 [V1 , [V1 , V0 ]] ,
respectively, are globally more accurate in L2 than their corresponding stochastic Taylor integrators.
Remarks.
1. The result for ψ̂ (3/2) is new. That the order-1/2 Lie series integrator (for two
Wiener processes) and the order 1 integrator generated by ψ̂ (1) are uniformly more
accurate confirms the asymptotically efficient properties of these schemes proved by
Castell and Gaines [8]. The proof follows along the lines of an analogous result for
linear stochastic systems considered in Lord, Malham and Wiese [27].
2. Consider the order 1/2 exponential Lie series with no vector field commutations. Solving the ordinary differential equation (8.1) using an (ordinary) Euler
Munthe-Kaas method and approximating dexp−1
σ ≈ id is equivalent to the order 1/2
stochastic Taylor Munthe-Kaas method (for the same Lie group and action).
9. Numerical examples.
9.1. Rigid body. We consider the dynamics of a rigid body such as a satellite
(see Marsden and Ratiu [33]). We will suppose that the rigid body is perturbed by two
independent multiplicative stochastic processes W 1 and W 2 with the corresponding
vector fields Vi (y) ≡ ξi (y) y, for i = 0, 1, 2, with ξi ∈ so(3). If we normalize the initial
data y0 so that |y0 | = 1 then the dynamics evolves on M = S2 . We naturally suppose
G = SO(3), and Λy0 (S) ≡ Sy0 so that λξi (y) = ξi (y) y, and we can pull back the
flow generated by V on M to the flow on G generated by Xξi (S, t) = ξi Λy0 (S) S,
i = 0, 1, 2. We use the following matrix representation for the ξi (y) ∈ so(3):


0
−y3 /αi,3 y2 /αi,2
ξi (y) =  y3 /αi,3
0
−y1 /αi,1  ,
−y2 /αi,2 y1 /αi,1
0
where the constants αi,j for j = 1, 2, 3 are chosen so that the vector fields Vi and
matrices ξi do not commute for i = 0, 1, 2: α0,1 = 3, α0,2 = 1, α0,3 = 2, α1,1 = 1,
α1,2 = 1/2, α1,3 = 3/2, α2,1 = 1/4, α2,2 = 1, α2,3 = 1/2. The vector fields Vi satisfy
the conditions of Theorem 7.1 since the manifold is compact in this case.
We will numerically solve (1.1) using three different order 1 methods: stochastic
Taylor, stochastic Taylor Munthe-Kaas based on (6.1) and Castell–Gaines (a standard non-geometric Runge–Kutta method is used to solve the ordinary differential
equation (8.1)). The vector field compositions Vi Vj needed for the stochastic Taylor
and Castell–Gaines methods are readily computed. For the Munthe-Kaas method we
note that we have vξi ◦ o = ξi (y0 ) and
vξi vξj ◦ o = Â(y0 , y0 ; αi , αj ) − 21 [ξi (y0 ), ξj (y0 )] .
Here o ∈ so(3) is the zero element on the Lie algebra, and for all y, z ∈ R3 we define

 y2 z3
y 3 z2 1 
α2 − α3  β1
y z
y z
A(y, z; α, β) ≡  α3 31 − α1 13  β12  ,
y 2 z1 1
y1 z2
α1 − α2
β3

12

Malham and Wiese

0

−2

log(distance from manifold)

−4

−6

−8

−10
Stochastic Taylor
Castell−Gaines
Munthe−Kaas

−12

−14

−16

0

1

2

3

4

5
time

6

7

8

9

10

Fig. 9.1. Rigid body: We show the log-distance of the approximate solution to the unit sphere
as a function of time for each of the methods. Below we show the approximate solutions as a function
of time for the stochastic Taylor (blue) and Munthe-Kaas methods (magenta). The trajectory starts
at the top right and eventually drifts over the left horizon.

Stochastic Lie group integrators

13

and ˆ : R3 →so(3) denotes the vector space isomorphism σ 7→ σ̂ where


0
−σ3 σ2
0
−σ1  .
σ̂ ≡  σ3
−σ2 σ1
0
Note that ŷ z ≡ y ∧ z (see Marsden and Ratiu [33]). Note also since σ ∈ so(3),
exp σ ∈ SO(3) can be conveniently and cheaply computed using Rodrigues' formula
(see Marsden and Ratiu [33] or Iserles et al. [21]).
2
In Figure 9.1 we show the distance from
√ manifold S of each the three approx√ the
imations; we start with initial data y0 = ( 2, 2, 0)T . The stochastic Taylor MuntheKaas method can be seen to preserve the solution in the unit sphere to within machine
error. We also see that the stochastic Taylor method clearly drifts off the sphere as
the integration time progresses, as does the non-geometric Castell-Gaines method-
which does however remain markedly closer to the manifold than the stochastic Taylor
scheme.
9.2. Autonomous underwater vehicle. The dynamics of an ellipsoidal autonomous underwater vehicle is prescribed by the state y = (π, p) ∈ se(3)∗ where
π ∈ so(3)∗ is its angular momentum and p ∈ (R3 )∗ its linear momentum (see Holmes,
Jenkins and Leonard [20], Egeland, Dalsmo and Sørdalen [13] and Marsden and
Ratiu [33]). We suppose that the vehicle is perturbed by two independent multiplicative stochastic processes. The governing vector fields are for i = 0, 1, 2:
Vi (y) = ad∗ξi ◦ y .

Here ξi (y) = ωi (y), ui (y) ∈ se(3) where ωi (y) = Ii−1 π and ui (y) = Mi−1 p are the
angular and linear velocity, and Ii = diag(αi,1 , αi,2 , αi,3 ) and Mi = diag(βi,1 , βi,2 , βi,3 )
are the constant moment of inertia and mass matrices, respectively. Explicitly for
ξ ∈ se(3) we have
ad∗ξ ◦ y ≡ (π ∧ ω + p ∧ u, p ∧ ω) .
The system of vector fields Vi , i = 0, 1, 2 represents the Lie–Poisson dynamics on
M = se(3)∗ (Marsden and Ratiu [33]). There are two independent Casimirs functions
Ck : se(3)∗ →R, k = 1, 2, namely C1 = π * p and C2 = |p|2 ; these are conserved by the
flow on se(3)∗ .
If G = SE(3) ∼
= SO(3) × R3 , then the coadjoint action of SE(3) on se(3)∗ ,
∗
∗
Ad : SE(3) × se(3) →se(3)∗ is defined for all S = (s, ρ) ∈ SE(3), where s ∈ SO(3)
and ρ ∈ R3 , and y ∈ se(3)∗ by: Λy ◦ S = Ad∗S −1 ◦ y ≡ sπ + ρ ∧ (sp), sp . The
corresponding infinitesimal action λ : se(3) × se(3)∗ →se(3)∗ for all ξ ∈ se(3) and y ∈
se(3)∗ is given by (see Marsden and Ratiu [33], p. 477)
λξ ◦ y = −ad∗ξ ◦ y .
Since ad∗ξ (y) = −λξ (y) = λ−ξ (y) the governing set of vector fields on se(3)∗ are
Vi (y) = λ−ξi ◦ y .
We can now pull back this flow on se(3)∗ to a flow on SE(3) via Λy0 . The corresponding flow on SE(3) is generated by the governing set of vector fields for i = 0, 1, 2:

X−ξi ◦ S = − ωi (y) ∧ s, ωi (y) ∧ ρ + ui (y) ,

14

Malham and Wiese

with y = Λy0 (S).

To aid implementation note that SE(3) = (s, ρ) ∈ SE(3) : s ∈ SO(3), ρ ∈ R3
embeds into SL(4; R) via the map


s ρ
S = (s, ρ) 7→
,
OT 1
where O is the three-vector of zeros. Also se(3) is isomorphic to a Lie subalgebra of
sl(4; R) with elements of the form


θ̂ ζ
σ = (θ, ζ) 7→
.
OT 0
Hence the governing vector fields on SE(3) are of the form Xξi = −ξi (y) S, where


ω̂i (π) ui (p)
ξi (y) =
.
OT
0

The governing vector fields on se(3) are vξi (σ) = −dexpσ ◦ ξi Λy0 (exp σ) . Again the
vector field compositions Vi Vj needed for the stochastic Taylor and Castell–Gaines
methods can be computed straightforwardly. Direct calculation also reveals that in
block matrix form


Â(π0 , π0 ; αi , αj ) + Â(p0 , p0 ; βi , αj ) A(π0 , p0 ; αi , βj )
vξi vξj ◦o =
− 21 [ξi (y0 ), ξj (y0 )] ,
OT
0
Here A(y, z; α, β) is defined as for the rigid body example. Note that the exponential
map expse(3) : se(3)→SE(3) is defined for all σ = (θ, ζ) ∈ se(3) by

expso(3) θ̂
expse(3) σ =
OT

f (θ)ζ
1



,

where expso(3) is the exponential map from so(3) to SO(3) which can be computed
using Rodrigues' formula and (see Bullo and Murray [4], p. 5)

f (θ) = I3×3 + (1 − cos kθk)θ̂/kθk2 + 1 − (sin kθk)/kθk θ̂2 /kθk2 .

In Figure 9.2 we show the distance from the manifold se(3)∗ of each the three approximations; in particular how far the individual trajectories stray
from the√Casimirs
√ √
√
C1 = π * p and C2 = |p|2 . We start with the initial data y0 = ( 2, 2, 0, 0, 2, 2)T .
As before the stochastic Taylor Munthe-Kaas method can be seen to preserve the
Casimirs to within machine error. We also see that the stochastic Taylor method
clearly drifts off the manifold as the integration time progresses, and at a particular
time depending on the Wiener path shoots off very rapidly away from the manifold.
Note also that for large stepsizes the stochastic Taylor method is unstable. However
the non-geometric Castell–Gaines and stochastic Munthe-Kaas methods still give reliable results in that regime.
10. Conclusions. We have established and implemented stochastic Lie group
integrators based on stochastic Munthe-Kaas methods and also derived geometric
Castell–Gaines methods. We have also revealed several aspects of these integrators
that require further investigation.

15

Stochastic Lie group integrators

10
Stochastic Taylor
Castell−Gaines
Munthe−Kaas

log(error in Casimirs)

5

0

−5

−10

−15

−20

0

0.5

1

1.5

2

2.5

time

Number of sampled paths=100
−0.6
Stochastic Taylor
Castell−Gaines
Munthe−Kaas

−0.7

log10(global error)

−0.8

−0.9

−1

−1.1

−1.2

−1.3
−3.2

−3.1

−3

−2.9

−2.8
−2.7
−2.6
log10(stepsize)

−2.5

−2.4

−2.3

−2.2

Fig. 9.2. Autonomous underwater vehicle: We show the log-distance of the approximate solution
to the two Casimirs C1 = π * p (dotted line) and C2 = |p|2 (solid line) as a function of time for each
of the methods. Below, we also show the global error as a function of stepsize.

1. We could construct a stochastic nonlinear Magnus method by approximating
the solution to the stochastic differential equation (5.1) on the Lie algebra using Picard
iterations (see Casas and Iserles [6]).
2. We would like to develop a practical procedure for implementing ordinary
Munthe-Kaas methods for higher order Castell–Gaines integrators. We need to de-

16

Malham and Wiese

termine the element ξ : M→g so that in (8.1) we have ψ̂ = λξ .
3. We need to determine the properties of the local and global errors for the
stochastic Munthe-Kaas methods. Also a thorough investigation of the stability properties of the stochastic Munthe-Kaas and Castell–Gaines methods is required. For
the autonomous underwater vehicle simulations they were both superior to the direct
stochastic Taylor method, especially for larger stepsizes. We also need to compare the
relative efficiency of the methods concerned, in particular to compare an optimally
efficient geometric Castell–Gaines method with the stochastic Munthe-Kaas method.
4. Although we have chiefly confined ourselves to driving paths that are Wiener
processes, we can extend Munthe-Kaas and Castell–Gaines methods to rougher driving paths (Lyons and Qian [29], Friz [15], Friz and Victoir [16]). Further, what happens when we consider processes involving jumps? For example Srivastava, Miller and
Grenander [40] consider jump diffusion processes on matrix Lie groups for Bayesian
inference. Or what if we consider fractional Brownian driving paths; Baudoin and
Coutin [3] investigate fractional Brownian motions on Lie groups?
5. Schiff and Shnider [39] have used Lie group methods to derive Möbius schemes
for numerically integrating deterministic Riccati systems beyond finite time removable
singularities and numerical instabilities. They integrate a linear system of equations
on the general linear group GL(n) which corresponds to a Riccati flow on the Grassmannian manifold Gr(k, n) via the Möbius action map. Lord, Malham and Wiese [27]
implemented stochastic Möbius schemes and show that they can be more accurate and
cost effective than directly solving stochastic Riccati systems using stochastic Taylor
methods. We would like to investigate further their effectiveness for stochastic Riccati equations arising in Kalman filtering (Kloeden and Platen [23]) and to backward
stochastic Riccati equations arising in optimal stochastic linear-quadratic control (see
for example Kohlmann and Tang [24]).
6. Other areas of potential application of the methods we have presented in this
paper are for example: term-structure interest rate models evolving on finite dimensional invariant manifolds (see Filipovic and Teichmann [14]); stochastic dynamics
triggered by DNA damage (Chickarmane, Ray, Sauro and Nadim [10]) and stochastic
symplectic integrators for which the gradient of the solution evolves on the symplectic
Lie group (see Milstein and Tretyakov [34]).
Acknowledgments. We thank Alex Dragt, Peter Friz, Anders Hansen, Terry
Lyons, Per-Christian Moan and Hans Munthe–Kaas for stimulating discussions. We
would also thank the anonymous referees, whose suggestions and encouragement improved the original manuscript significantly.
Appendix A. Proof of Theorem 7.1. We follow the proof for linear stochastic
differential equations in Lord, Malham and Wiese [27] (where further technical details
on estimates for multiple Stratonovich integrals can be found). Suppose ψ̂t ≡ ψ̂t (m)
is the truncated Lie series (7.1). First we show that exp ψ̂t ◦ y0 ∈ L2 . We see that
k
for any number k, ψ̂t ◦ y0 is a sum of |Qm |k terms, each of which is a k-multiple
product of terms Jα cα ◦ y0 . It follows that
ψ̂t

k

◦ y0

L2

≤



max kcα ◦ y0 k

α∈Qm

k

*

X

αi ∈Qm

kJα1 Jα2 * * * Jαk kL2 .

(A.1)

i=1,...,k

Note that the maximum of the norm of the compositions of vector fields cα ◦y0 is taken
over a finite set. Repeated application of the product rule reveals that for i = 1, . . . , k,

17

Stochastic Lie group integrators

each term 'Jα1 Jα2 * * * Jαk ' in (A.1) is the sum of at most 22mk−1 Stratonovich integrals
Jβ , where for t ≤ 1, kJβ kL2 ≤ 24mk−1 tk/2 . Since the right hand side of equation (A.1)
consists of |Qm |k 22mk−1 Stratonovich integrals Jβ , we conclude that,
ψ̂t

k

◦ y0

L2

≤



max kcα ◦ y0 k * |Qm | * 26m * t1/2

α∈Qm

k

.

Hence exp ψ̂t ◦ y0 is square-integrable.
Second we prove (7.2). Let ŷt denote the stochastic Taylor series solution, truncated to included terms of order up to and including tm . We have
yt − exp ψ̂t ◦ y0

L2

≤ yt − ŷt

L2

+ ŷt − exp ψ̂t ◦ y0

L2

.

We know yt ∈ L2 (see Lemma III.2.1 in Gihman and Skorohod [18]). Note that ŷt is a
strong approximation to yt up to and including terms of order tm , with the remainder
consisting of O(tm+1/2 ) terms (see Proposition 5.9.1 in Kloeden and Platen [23]).
It follows from the definition of the exponential Lie series as the logarithm of the
stochastic Taylor series, that the terms of order up to and including tm in exp ψ̂t ◦ y0
correspond with ŷt ; the error consists of O(tm+1/2 ) terms.
Appendix B. Proof of Theorem 8.2. Our proof follows along the lines of that
for uniformly accurate Magnus integrators for linear constant coefficient systems (see
Lord, Malham & Wiese [27] and Malham and Wiese [31]). Let φtn ,tn+1 and φ̂tn ,tn+1
denote the exact and approximate flow-maps constructed on the interval [tn , tn+1 ] of
length h. We define the local flow remainder as
Rtn ,tn+1 ≡ φtn ,tn+1 − φ̂tn ,tn+1 ,
and so the local remainder is Rtn ,tn+1 ◦ ytn . Let Rls and Rst denote the local flow
remainders corresponding to the exponential Lie series and stochastic Taylor approximations, respectively.
B.1. Order 1/2 integrator: two Wiener processes. For the global order 1/2
integrators we have to leading order Rls = 21 (J12 − J21 )[V2 , V1 ] and Rst = J12 V2 V1 +
J21 V1 V2 . Note that we have included the terms J11 V12 and J22 V22 in the integrators.
A direct calculation reveals that


1
E (Rst ◦ y0 )T Rst ◦ y0 = E (Rls ◦ y0 )T Rls ◦ y0 + h2m U T BU + O h2m+ 2 . (B.1)

Here m = 1/2 (for the order 1/2 integrators), U = (V2 V1 ◦ y0 , V1 V2 ◦ y0 )T ∈ R2n , and
B ∈ R2n×2n consists of n × n diagonal blocks of the form bij In×n where


1 1
b = 14
,
1 1

and In×n is the n×n identity matrix. Since b is positive semi-definite, the matrix B =
b⊗In×n is positive semi-definite. Hence the order 1/2 exponential Lie series integrator
is locally more accurate than the corresponding stochastic Taylor integrator.
B.2. Order 1 integrator: one Wiener process. For the global order 1 in1 2
h [V1 , [V1 , V0 ]] and
tegrators we have to leading order Rls = 21 (J10 − J01 )[V0 , V1 ] − 12
1 2
st
3
R = J10 V0 V1 + J01 V1 V0 + J111 V1 − 4 h (V1 V1 V0 + V0 V1 V1 ). The terms of order h2

18

Malham and Wiese

shown are significant when we consider the global error in Section B.4 below. The estimate (B.1) also applies in this case with m = 1 and U = (V0 V1 ◦y0 , V1 V0 ◦y0 , V13 ◦y0 )T ∈
R3n ; and B ∈ R3n×3n consists of n × n diagonal blocks of the form bij In×n where


3 3 3
1 
3 3 3 .
b = 12
3 3 5
Since b is positive semi-definite, the matrix B = b ⊗ In×n is positive semi-definite.
Hence the order 1 exponential Lie series integrator is locally more accurate than the
corresponding stochastic Taylor integrator.
B.3. Order 3/2 integrator: one
 Wiener process. The local flow remainders
are Rls = 61 J110 −2J101 +J011 − 12 h2 [V1 , [V1 , V0 ]] and Rst = J110 V0 V12 +J101 V1 V0 V1 +
J011 V12 V0 + J1111 V14 − 41 h2 (V1 V1 V0 + V0 V1 V1 ). The terms of order h2 shown are
significant when we consider the global error-but for a different reason this time-
see Section B.4 below. Again, the estimate (B.1) applies in this case with m = 3/2
and U = (V12 V0 ◦ y0 , V1 V0 V1 ◦ y0 , V0 V12 ◦ y0 , V14 ◦ y0 )T ∈ R4n ; and B ∈ R4n×4n consists
of n × n diagonal blocks of the form bij In×n where


11 8 10 12

8 8 12
1 8

b = 144
10 8 11 12 .
12 12 12 24
Again, B is positive semi-definite and the order 3/2 exponential Lie series integrator
is locally more accurate than the corresponding stochastic Taylor integrator.
B.4. Global error. We define the strong global error at time T associated with
an approximate solution ŷT as E ≡ kyT − ŷT kL2 . The exact and approximate solutions
can be constructed by successively applying the exact and approximate flow maps
φtn ,tn+1 and φ̂tn ,tn+1 on the successive intervals [tn , tn+1 ] to the initial data y0 . A
straightforward calculation shows that a for small fixed stepsize h,
E 2 = E (R ◦ y0 )T R ◦ y0 ,

(B.2)

P −1
up to higher order terms, where R ≡ N
n=0 φtn+1 ,tN ◦ Rtn ,tn+1 ◦ φt0 ,tn is the standard
accumulated local error contribution to the global error. The important conclusion is
that when we construct the global error (B.2), the terms of leading order in the local
flow remainders Rls or Rst with zero expectation lose only a half order of convergence
in this accumulation effect. Hence in the local flow remainders shown above, for the
terms of zero-expectation, the local superior accuracy for the Lie series integrators
transfers to the corresponding global errors (see Lord, Malham and Wiese [27] for
more details). Terms of non-zero expectation however, behave like deterministic error terms losing a whole order (in the local to global convergence); they contribute
to the global error through their expectations. Hence we include such terms of order h2 in the order 3/2 integrators above and they appear as the terms subtracted
from the remainders shown. For the order 1 integrators we do not need to include
the order h2 terms in the integrator to obtain the correct mean-square convergence.
However to guarantee that the global error for the exponential Lie series integrator
is always smaller than that for the stochastic Taylor scheme, we include this term in
the integrator.

Stochastic Lie group integrators

19

REFERENCES
[1] G. Ben Arous, Flots et series de Taylor stochastiques, Probab. Theory Related Fields, 81
(1989), pp. 29–77.
[2] F. Baudoin, An introduction to the geometry of stochastic flows, Imperial College Press, 2004.
[3] F.Baudoin and L. Coutin, Self-similarity and fractional Brownian motions on Lie groups,
arXiv:math.PR/0603199 v1, 2006.
[4] F. Bullo and R. M. Murray, Proportional derivative (PD) control on the Euclidean group,
CDS Technical Report 95-010, 1995.
[5] K. Burrage and P. M. Burrage, High strong order methods for non-commutative stochastic ordinary differential equation systems and the Magnus formula, Phys. D, 133 (1999),
pp. 34–48.
[6] F. Casas and A. Iserles, Explicit Magnus expansions for nonlinear equations, Cambridge NA
reports, 2005.
[7] F. Castell, Asymptotic expansion of stochastic flows, Probab. Theory Related Fields, 96
(1993), pp. 225–239.
[8] F. Castell and J. Gaines, An efficient approximation method for stochastic differential equations by means of the exponential Lie series, Math. Comp. Simulation, 38 (1995), pp. 13–19.
[9] K. T. Chen, Integration of paths, geometric invariants and a generalized Baker–Hausdorff
formula, Annals of Mathematics 65(1) (1957), pp. 163–178.
[10] V. Chickarmane, A. Ray, H. M. Sauro and A. Nadim, A model for p53 dynamics triggered
by DNA damage, SIAM J. Applied Dynamical Systems 6(1) (2007), pp.61–78.
[11] P. E. Crouch and R. Grossman, Numerical integration of ordinary differential equations on
manifolds, J. Nonlinear Sci. 3 (1993), pp. 1–33.
[12] K. D. Elworthy, Stochastic differential equations on manifolds, London Mathematical Society
Lecture Note Series 70, Cambridge University Press, 1982.
[13] O. Egeland, M. Dalsmo and O. J. Sørdalen, Feedback control of a nonholonomic underwater vehicle with a constant desired configuration, The International Journal of Robotics
Research 15(1) (1996), pp. 24–35.
[14] D. Filipović and J. Teichmann, On the geometry of the term structure of interest rates, Proc.
R. Soc. Lond. A 460 (2004), pp. 129–167.
[15] P. Friz, Continuity of the Itô-map for Hölder rough paths with applications to the support
theorem in Hölder norm, arXiv:math.PR/0304501 v2, 2003.
[16] P. Friz and N. Victoir, Euler estimates for rough differential equations, Preprint, 2006.
[17] J. G. Gaines and T. J. Lyons, Variable step size control in the numerical solution of stochastic
differential equations, SIAM J. Appl. Math., 57(5) (1997), pp. 1455–1484.
[18] I. I. Gihman, and A. V. Skorohod, The theory of stochastic processes III, Springer, 1979.
[19] E. Hairer, C. Lubich and G. Wanner, Geometric Numerical Integration, Springer Series
in Computational Mathematics, 2002
[20] P. Holmes, J. Jenkins and N. E. Leonard, Dynamics of the Kirchoff Equations I: coincident
centers of gravity and bouyancy, Preprint, 1997.
[21] A. Iserles, H. Z. Munthe-Kaas, S. P. Nørsett, and A. Zanna, Lie-group methods, Acta
Numer., (2000), pp. 215–365.
[22] A. Iserles and A. Zanna, Efficient computation of the matrix exponential by generalized polar
decompositions, SIAM J. Numer. Anal., 42(5) (2005), pp. 2218–2256.
[23] P. E. Kloeden and E. Platen, Numerical solution of stochastic differential equations,
Springer, 1999.
[24] M. Kohlmann and S. Tang, Multidimensional backward stochastic Riccati equations and applications, SIAM J. Control Optim., 41(6) (2003), pp. 1696–1721.
[25] H. Kunita, On the representation of solutions of stochastic differential equations, LNM 784,
Springer–Verlag, 1980, pp. 282–304.
, Stochastic flows and stochastic differential equations, Cambridge University Press, 1990.
[26]
[27] G. Lord, S. J.A. Malham and A. Wiese, Efficient strong integrators for linear stochastic
systems, 2006, Submitted to SINUM.
[28] T. Lyons, Differential equations driven by rough signals, Rev. Mat. Iberoamericana, 14(2)
(1998), pp. 215–310.
[29] T. Lyons and Z. Qian, System control and rough paths, Oxford University Press, 2002.
[30] W. Magnus, On the exponential solution of differential equations for a linear operator, Comm.
Pure Appl. Math., 7 (1954), pp. 649–673.
[31] S. J.A. Malham and A. Wiese, Universal optimal stochastic expansions, 2007, Preprint.
[32] P. Malliavin, Stochastic analysis, Grundlehren der mathematischen Wissenschaften 313,
Springer, 1997.

20

Malham and Wiese

[33] J. E. Marsden and T. S. Ratiu, Introduction to mechanics and symmetry, Second edition,
Springer, 1999.
[34] G. N. Milstein and M. V. Tretyakov, Stochastic numerics for mathematical physics,
Springer, 2004.
[35] T. Misawa, A Lie algebraic approach to numerical integration of stochastic differential equations, SIAM J. Sci. Comput., 23(3) (2001), pp. 866–890.
[36] H. Munthe-Kaas, High order Runge–Kutta methods on manifolds, Appl. Numer. Math., 29
(1999), pp. 115–127.
[37] N. J. Newton, Asymptotically efficient Runge–Kutta methods for a class of Itô and
Stratonovich equations, SIAM J. Appl. Math., 51 (1991), pp. 542–567.
[38] P. J. Olver, Applications of Lie groups to differential equations, Graduate texts in mathematics 107, Springer–Verlag, 1986.
[39] J. Schiff and S. Shnider, A natural approach to the numerical integration of Riccati differential equations, SIAM J. Numer. Anal., 36(5) (1999), pp. 1392–1413.
[40] A. Srivastava, M. I. Miller and U. Grenander, Jump-diffusion processes on matrix Lie
groups for Bayesian inference, preprint, 2000.
[41] R. S. Strichartz, The Campbell–Baker–Hausdorff–Dynkin formula and solutions of differential equations, J. Funct. Anal., 72 (1987), pp. 320–345.
[42] H. J. Sussmann, Product expansions of exponential Lie series and the discretization of stochastic differential equations, in Stochastic Differential Systems, Stochastic Control Theory,
and Applications, W. Fleming and J. Lions, eds., Springer IMA Series, Vol. 10 (1988),
pp. 563–582.
[43] V. S. Varadarajan, Lie groups, Lie algebras, and their representations, Springer, 1984.
[44] Y. Yamato, Stochastic differential equations and nilpotent Lie algebras, Z. Wahrsch. Verw.
Gebiete, 47(2) (1979), pp 213–229.

