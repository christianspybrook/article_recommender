IFT-UAM/CSIC-21-46

Tensor Renormalization Group for interacting quantum fields
Manuel Campos, Germán Sierra and Esperanza López
Instituto de Fı́sica Teórica UAM/CSIC, C/ Nicolás Cabrera 13-15, Cantoblanco, 28049 Madrid, Spain

arXiv:2105.00010v1 [quant-ph] 30 Apr 2021

We present a new tensor network algorithm for calculating the partition function of interacting quantum field
theories in 2 dimensions. It is based on the Tensor Renormalization Group (TRG) protocol, adapted to operate
entirely at the level of fields. This strategy was applied in Ref.[1] to the much simpler case of a free boson,
obtaining an excellent performance. Here we include an arbitrary self-interaction and treat it in the context
of perturbation theory. A real space analogue of the Wilsonian effective action and its expansion in Feynman
graphs is proposed. Using a λ φ 4 theory for benchmark, we evaluate the order λ correction to the free energy.
The results show a fast convergence with the bond dimension, implying that our algorithm captures well the
effect of interaction on entanglement.

Tensor network techniques have been crucial to study
strongly coupled spin systems relevant to condensed matter
and statistical physics2−43 . The application of these techniques to quantum fields presents the challenge of dealing
with infinite dimensional systems. Several strategies have
been pursued to this aim. The most obvious is to introduce
a truncation that brings back to the simpler framework of
finite dimensional Hilbert spaces. An opposite philosophy
has lead to the development of continuous versions of tensor networks44−51 . Tensor networks have also provided simple versions of the holographic principle within the AdS/CFT
correspondence52−59 .
Inspired on standard field theory techniques, a different
strategy was explored in1 . The main idea was to keep the continuous character of fields, treating them as the basic element
for the implementation of an adapted Tensor Renormalization
Group (TRG) protocol17 . The viability of this approach was
tested by evaluating the partition function of a free massive
boson on a 2-dimensional square lattice. The results exhibited
a very good numerical precision with moderate bond dimension, which in this case counts the number of fields per lattice
link. Remarkably the massless limit could be addressed without an increase in the bond dimension.
The strength of the method relies on the combination of
semi-analytic expressions and numerics that only involves finite dimensional matrices. This however is heavily based on
the gaussian nature of free fields. Therefore it was an open
question whether the same ideas are applicable to interacting
field theories. We show that the answer is affirmative. Moreover, the semi-analytical character of the method exhibits important aspects of the interplay between interaction and entanglement.
The paper is organized as follows. We set the basis of our
proposal in Section 1. Section 2 reviews the application to free
fields. Section 3 contains a brief summary of the Wilsonian
approach to quantum fields theories. Interaction is introduced
in Section 4 in the context of perturbation theory. The structure of the TRG for interacting quantum fields is analized in
Section 5. We explore the numerical performance of the protocol in Section 6. Section 7 presents a summary of results
and discusses further lines of research. Technical details are
consigned to appendices. An implementation in Mathematica
of this adapted TRG newtwork can be found in the GitHub
repository60 .

I.

A TENSOR NETWORK FOR QUANTUM FIELDS

The aim of this paper is to present a new framework for
a real space renormalization group (RG) analysis of quantum
field theories. It will combine the main guidelines of a conventional particle physics approach to quantum field theory61,62
with the introduction of a classification of degrees of freedom
based on entanglement. The main focus of study will be the
partition function, whose RG analysis will be formulated in
terms of fields x ∈ R. In the spirit of lattice field theory, the
spacetime will be discretized.
We will work in two dimensions and consider a scalar field
theory with Lagrangian
1
1
L = (∂ x)2 + m2 x2 + λ v(x) ,
2
2

(1)

where m is the boson mass and λ a coupling constant. For
concrete numerical evaluations we will choose v(x) = x4 , but
otherwise we keep the potential generic. We will study a discretized version of this theory living on a square lattice with
unit spatial and temporal steps. The field variables are assigned to the lattice links while the statistical or Boltzmann
weights are carried by the vertices
.

(2)

The weights W0 (xi ) are given by
1

4

= e− 2 ∑i=1

2
(xi −xi+1 )2 + m2 xi2 +λ v(xi )





.

(3)

The partition function of the so defined vertex model is
Z

Z=

∏

i∈links

dxi ×

∏

W0 j (xi ) .

(4)

j∈vertices

The evaluation of the partition function will be done by
means of an adapted Tensor Renormalization Group protocol
(TRG) that reduces iteratively the size of the lattice. The TRG
for finite dimensional systems is based on the singular value
decomposition (SVD) of the Boltzmann weights17
W = UL DUR+ ,

(5)

2
where UL,R are unitary matrices, with UR+ denoting the adjoint of UR , and D is a diagonal matrix containing the singular
values of W . This decomposition has the following graphical
representation

.

(6)

The tensor W can be analogously decomposed along the opposite diagonal. The variables in the new tilted links have
a one to one correspondence with the singular values of W .
Therefore they have a natural hierarchy based on entanglement. This allows to discard those with the weakest contribution. After the splitting (6) the old variables are summed over,
eliminating degrees of freedom associated with short range
entanglement. The number of lattice links is reduced in this
process by a factor of two
.

(7)

Our proposal of a tensor network for quantum field theories
can be summarized in a simple idea: apply the SVD splitting not to the Boltzmann weights, but to their exponent. This
allows to treat fields as the basic elements, and to deal with
finite tensors instead of functions while preserving the continuous character of the Boltzmann weights.

II.

TRG FOR FREE FIELDS

Let Wn denote the Boltzmann weights of the discretized boson model at a given coarse graining level

= Wn (xi ) .

(8)

where xi = (xi1 , . . . , xiχn ) is the set of fields carried by each
lattice link. We will refer to χn as the bond dimension of the
tensor network. In analogy with (6), we are searching for a
factorization of the form
Z

Wn (xi ) =

dp Vn (x1 , x2 ; p)Vn+ (p; x4 , x3 ) .

(9)

The variables p = (p1 , . . . , pχn+1 ), necessary for the splitting
of Wn , are associated with the internal tilted link in (6). We
require that p j ∈ R in order to interpret them as fields. Thus
χn+1 will be the bond dimension of the new links. In this simple implementation of the TRG, x-fields on straight links and
p-fields on tilted links alternate along the coarse graining iterations. The symmetries of the model allow to make a choice of
basis for the fields such that all cubic weights, independently
of their orientation, share the same expression. This choice
has been assumed in (9).

A.

Gaussian SVD

We consider first the implementation of this approach on
the initial weights W0 (3). The mass and interaction terms in
the Lagrangian (1) do not contribute to the coupling of fields
across lattice links. The only obstruction to a trivial splitting
of W0 is the factor


1
2
2
(10)
e− 2 (x2 −x3 ) +(x1 −x4 ) .
Remarkably a simple Fourier transform is enough to realise
the scheme proposed in (9)
1
2
1
e− 2 (x1 −x4 ) = √
2π

Z

1 2

d p1 e ip1 (x1 −x4 )− 2 p1 .

(11)

An analogous expression holds for the mixing between x2,3
after introducing a second splitting field p2 . Hence the bond
dimension is doubled in this process. While a single field lives
at the links of the original lattice, χ0 = 1, the new tilted links
carry two, χ1 = 2.
This simple mechanism is enough for the real space RG
analysis of free field theories1 . In the absence of interaction,
the weights (3) are gaussian. The splitting (11) respects this
property. We can thus write the Boltzmann weights at any
coarse graining level n as
1

Wn (x) = Fn e− 2 x Mn x ,

(12)

with Mn a 4χn × 4χn matrix and Fn a numerical factor. From
now on boldface symbols without indices will denote collectively all fields involved in the expression under consideration.
The argument of the Boltzmann weights are x-type fields for n
even and p-type fields for n odd. For convenience and without
loss of generality we have chosen the former to write down the
general expression (12). A basis can be chosen1 where Mn has
the form

 

An 0
Bn −Bn
Mn =
+
,
(13)
0 An
−Bn Bn
where An and Bn are real, non-negative, symmetric matrices,
and Mn acts on x = (x1 , x2 , x4 , x3 ). For the initial weights W0
the previous matrices are given by


m2
1 −1
A0 =
+
12 ,
B0 = 12 .
(14)
−1 1
2
The 2 × 2 block structure of (13) reflects the LR factorization that we need to implement in order to move to the next
coarse graining level. With respect to the splitting (6), we have
x = (xL , xR ) with xL = (x1 , x2 ) and xR = (x4 , x3 ). Generalizing (10), the piece of the Boltzmann weights responsible for
LR mixing is
1

e− 2 (xL −xR ) Bn (xL −xR ) .

(15)

Because of the mentioned properties of Bn , its SVD reduces
to Bn = Un DnUnT with Un an orthogonal matrix. Using this

3
decomposition, we can apply again a Fourier transformation
to rewrite (15) as
1
p
χ
(2π) n+1 det Dn

Z

1

−1 p

dp e i(xL −xR )Un p − 2 p Dn

Numerical results

The free energy per site of the discretized free boson model
,

(16)
f =−

which implements the desired factorization. The splitting
fields p are in one to one correspondence with the singular values of Bn . In this way the TRG machinery is moved from the
Boltzmann weights to their exponent, where fields are treated
as the basic elements.
We add for completeness the expression of Vn
=

B.

1

1

−1 p

fn e− 2 x An x + ixUn p − 4 p Dn

.

(17)

It holds for cubic weights with any of the four possible orientations. The normalization constant fn is defined by the relation
p
Fn = ρn fn2 ,
ρn = (2π)χn+1 det Dn .
(18)
This factorization mechanism was named gaussian SVD1 .
In Appendix A we analyze the relation between the gaussian
and the standard SVD, which for the Boltzmann weights (12)
can be carried out explicitly. We show that the latter is also
governed by the singular values of the matrix Bn . Therefore
the gaussian SVD is not a different way of evaluating the LR
mixing, which the standard SVD has been proved to do in an
optimal way. Instead it provides a method to organize the infinite set of singular values obtained when working with continuous functions, grouping them into a finite number of subsets
associated with fields.
We include a summary of the first two steps of the TRG

1
log Z ,
N

(21)

where N is the number of lattice sites and Z is the partition
function (4), was used to test the numerical performance of
this adapted TRG protocol1 . The coarse graining process
trades space time degrees of freedom by link variables. The
exponential increase in the bond dimension that (20) describes
is not numerically sustainable. Truncation was implemented
by discarding small singular values of the LR mixing matrix
Bn , together with their associated splitting fields. Fig.1 shows
the results obtained with different maximal number of fields
per link. An average precision of 10−8 was achieved with
χmax = 64 across a wide range of boson masses. Remarkably
no increase in the bond dimension was necessary to access
small masses. This allowed to evaluate the central charge of
the CFT emerging in the massless limit. The value c = 1 was
reproduced to within a 10−5 error.
δf0
0.01
10

2
4

-4

8
16

10-6

32
64

10-8
10-4

10-3

0.01

0.1

1

m

Figure 1. Relative error in the free energy per site, δ f = fT RGfex− fex , as
a function of the boson mass for different maximal bond dimensions.
A lattice with N = 240 sites has been considered, such that the exact
free energy fex can be replaced by its N → ∞ limit.

It was also proven that the coarse graining process attains
an infrared fixed point at the right length scale set by the boson
mass, even for small bond dimension. Recall that each field
encodes an infinite subset of the singular values resulting from
a standard SVD, described in (A16). This subset contains arbitrarily small entries, which might explain why working in
terms of fields retains relevant long distance information for
any bond dimension.

.

(19)

The singular value matrices D2n+1 turn out to have half of
their diagonal entries equal to zero. The would be splitting
fields associated with them can be readily discarded. As a consequence, the bond dimension doubles when evolving from xfields to p-fields but keeps constant from p to x-fields1 . Therefore
χ2n = 2n .

(20)

III.

THE EFFECTIVE ACTION

The treatment of interaction will be inspired in the standard
approach to quantum field theories. Searching for numerical
efficiency is not our only motivation. We aim at obtaining
new insights based on entanglement, and for that it is convenient to make a natural connection with the commonly used
techniques and concepts.
We will start reviewing some basic facts about effective
field theories61,62 . Let us consider a theory defined at a ultraviolet (UV) momentum scale Λ by the Lagrangian (1). The

4
partition function of the theory is given by
Z

Z

Dφ e−S[φ ] ,

Z=
[0,Λ]

S[φ ] =

dξ L[φ ] ,

(22)

is the real space analogue of the Wilsonian effective action,
with n playing the role of the UV cutoff Λ0 . Preserving the
structure of (12), we define
1

where the variables ξi denote spacetime directions. Let Λ0 < Λ
be a smaller scale. The field φ contains slow modes with a
momentum smaller than Λ0 , and fast modes with momentum
in the interval [Λ0 , Λ]. We denote them as φ< and φ> respectively. The action S[φ ] can be divided into a quadratic part S0 ,
and S1 which collects the interaction terms
S[φ< , φ> ] = S0 [φ< ] + S0 [φ> ] + λ S1 [φ< , φ> ] .

(23)

Quadratic cross terms between φ< and φ> have been disregarded because these fields are orthogonal upon integration.
Replacing (23) into (22) and integrating the fast modes yields
Z

Dφ< e−Seff [φ< ] .

Z=

(24)

Wn (x) = e− 2 x Mn x Fn (x) .

The matrix Mn encodes all λ -independent quadratic terms, being the counterpart of L0 [φ< ]. The function Fn contains the
effects of interaction and therefore relates to Sint [φ< ].
A.

Real space Feynman diagrams

We analyze in this Section the new features introduced by
interaction, focussing in the first TRG iteration. The initial
weights W0 of the discretized interacting model were given in
(3). The matrix M0 is constructed from A0 and B0 in (14), and
the function F0 is
λ

where Seff [φ< ] = S0 [φ< ] + Sint [φ< ] is the Wilsonian effective
action at the scale Λ0 . The term Sint is derived from the expectation value of S1 taken with the quadratic action of the fast
fields
e−Sint [φ< ] =

Z

Dφ> e−S0 [φ> ]−λ S1 [φ< ,φ> ] .

4

F0 (x) = e− 2 ∑i=1 v(xi ) ,

(30)

with x = (x1 , .., x4 ). The dependence of F0 on xi trivially factorizes. Anticipating the LR splitting needed to move to the
next coarse graining level, we define

(25)

When λ is small, the average (25) can be evaluated by
means of a perturbative expansion. Its contribution to the effective action at each order in λ is described by a sum of connected Feynman diagrams whose internal lines are φ> propagators. We use double lines for φ> propagators and solid lines
for φ< external legs. Feynman diagrams will be depicted in
red for avoiding confusion with the tensor network structure
of the discretized model. Taking as example a λ φ 4 theory,
some diagrams at second order in perturbation theory are

(29)

F0 (x) = ρ0 f0 (xL ) f0 (xR ) ,

(31)

where xL labels the fields at two contiguous links entering W0
and xR those at the other two complementary links. A constant
ρ0 has been introduced for convenience as in (18). It is the
normalization factor of the Fourier transform (16), which in
this case equals 2π.
Following Section II.B for the factorization of the gaussian
cross terms in W0 , the resulting cubic weights are
1

1 2

= e− 2 x A0 x+ixp− 4 p f0 (x) .
.

The integration of high momentum modes gives rise to terms
with any number of external legs.
IV.

(32)

(26)
The exponential prefactor reproduces (17) after taking into account that, since B0 = 12 , its SVD data U0 and D0 are also the
identity. Sewing together four cubic weights as shown in (19)
and integrating out the original x fields, we obtain

TRG FOR INTERACTING QUANTUM FIELDS

Guided by the previous formulation, we search for a real
space RG protocol that can be implemented by local operations. Namely, we want the partition function to be given at
each coarse graining level n by
Z=

∏

dxi ×

i∈links

∏

Wn, j (x) .

(27)

Z

1

dx e− 2 x Q0 x+ixC0 p

Wn, j (x) ,

4

(i)

∏ f0

(x) .

(34)

i=1

For concreteness we have chosen x-type fields to write down
this general expression. The Boltzmann weights Wn should
depend only on the fields living at contiguous links, as in (12).
The product

∏

W1 (p) = e− 4 p

j∈vertices

j∈vertices

(33)

which stands for
1 2

Z

,

(28)

The matrices Q0 and C0 , of dimensions 4 × 4 and 4 × 8 respectively, are readily constructed from A0 and U0 . Their concrete
expressions can be found in Appendix B.
The gaussian kernel of (34) can be further simplified by the
change of variables
x → x + iQ−1
0 C0 p .

(35)

5
It leads to the structure (29) for W1 with
1
M1 = 18 +C0T Q−1
0 C0 .
2

(36)

The first term on the rhs reproduces the gaussian factor in
front of the integral (34), and the second is generated by the
previous shift of variables. The function F1 encoding the effects of interaction is given by
Z

F1 (p) =

1

dx e− 2 x Q0 x

4

(i)

∏ f0

(x + iQ−1
0 C0 p) .

(37)

i=1

This expression can be considered a local analogue of (25),
with x and p identified with the fields φ> and φ< respectively.
We can therefore evaluate F1 with the same tools used for the
effective action. In particular, we might use a perturbative
expansion when the coupling constant is small.
Order by order in λ the integral (37) is gaussian and can
be easily performed. This is done by considering all possible
pairings of the xi variables and replacing
xi x j →

(Q−1
0 )i j

,

under the exchange of x and y, but otherwise arbitrary. This is
consistent with the symmetries of the lattice model. Although
F does not satisfy in general (31), it can be rewritten as
F(x, y) = ρ f (x, z) f (y, −z) ,

(41)

for some appropriate but not unique function f . A possible
although not necessarily convenient choice of f is
q
(42)
f (x, z) = ρ −1 F(x, x − z) .
Recall the main guidelines of the TRG protocol that we
wish to design. First, obtaining an SVD-like protocol that
classifies fields according to an entanglement criterium. Second, keeping the coarse graining process local. This requires
that no residual coupling between x and y, linked to the function F, remains after splitting. We will start by analyzing how
the transformation (11) fails to meet the latter condition. Upgrading z in (41) into an independent field, the general expression (40) can be restated as
ρ
2π

(38)

which is equivalent to the well known Wick's theorem. The
matrix Q−1
0 plays the role of the high momentum mode propagator. Using this, a set of Feynman rules can be defined in
terms of which to construct the real space analogue of Feynman diagrams. This is presented in Appendix C. The logarithm of F1 is given by a sum of so defined connected Feynman diagrams. For a λ φ 4 theory, schematically we will have

z = x−y ,

Z

b 2

dzd p e ip(x−y−z)− 2 z f (x, z) f (y, −z) .

(43)

Integrating p produces a delta function that imposes z = x − y,
and equality immediately follows. Let us invert the order of
integration and evaluate first the integral in z
ρ
2π

Z

b 2

dz e−ipz− 2 z f (x, z) f (y, −z) .

(44)

The functions f are brought out of the integral by promoting
them into a the differential operator
fˆ(x, ∂ p ) = f (x, z)|z=i∂ p .

log F1 ∝ 1 − λ

+... .

(39)

We have followed the same graphical notation as in (26): a
double line for the original fields x, living at the four inner
links on the lhs of (33), and a single line for the first level
fields p, carried by the four tilted links.
B.

Interacting SVD

The effects of interaction on the TRG protocol appear after
the first coarse graining integration. Contrary to F0 , the function F1 does not satisfy the trivial factorization (31). This is an
immediate consequence of the matrix Q0 not being diagonal.
The non-factorization of F1 is to be expected, since the contrary will imply that interaction has no effect on entaglement.
As a consequence of this, the LR splitting protocol has to be
revisited. To that aim we consider the following function of
two variables, which serves as a simplified version of the general weights (29)
b

2

e− 2 (x−y) F(x, y) .

The √
gaussian integral can then be explicitly evaluated. We set
ρ = 2πb such that numerical factors cancel, and obtain
1 2
fˆ(x, ∂ p ) fˆ(y, −∂ p ) e− 2b p .

The parameter b represents a singular value of the LR mixing
matrix B (15). The function F is assumed to be symmetric

(46)

When f is independent of z, as in (31), the standard Fourier
transform is recovered. In the general case, the fact that both
differential operators act on the same gaussian factor hinders
factorization.
This problem has a simple solution. We may double the
splitting fields such that each differential operator acts on a
different gaussian factor. This is achieved by considering
F(x, y) = ρ̃ f (x, z1 ) f (y, −z2 ) ,

z1,2 = x − y ,

(47)

with ρ̃ = ρ 2 /2. We upgrade again z1,2 into independent variables with the help of two Fourier fields p1,2 . Using this trick
(40) can be factorized as follows
Z

dp1dp2 V (x; p1, p2 ) V ∗ (y; p2, p1 ) ,

(48)

with
1

(40)

(45)

2)

V (x; p1, p2 ) = e ix(p +p



fˆ(x, ∂ p1 ) e−

(p1 )2
b



.

(49)

Notice that V depends on both splitting fields, albeit in an
asymmetrical manner.

6
C.

process. The resulting cubic weight V1 (p; x1, x2 ) is

Feynman diagrams and SVD

We have seen that the function F1 encoding the interaction
effects of the level one Boltzmann weights, admits a diagrammatic expansion. We analyze here how this feature behaves
under the factorization protocol.
Recall that the first TRG iteration exchanges the roles of the
x and p variables. Following (47), we define
F1 (pL , pR ) = ρ̃1 f1 (pL , z1 ) f1 (pR , −z2 ) ,

(50)

with ρ̃1 an appropriate constant and
z1 = z2 = pL − pR .

(51)

In order to understand the structure of f1 , we focus on a simple
example. Let us consider a contribution to F1 of the form
2

e−λ (pL *pR ) .

(52)

The argument of the exponential represents a connected Feynman diagram with four legs contributing at first order in perturbation theory. It has the same structure as the last graph in
(39). The splitting of the previous term according to (50) is
1 )]2

λ

e− 2 [pL *(pL −z

λ

2 )]2

e− 2 [pR *(pR +z

.

(53)

We observe that the four leg diagram is inherited by both factors. The coefficient weighting the diagram has been modified
such that the original term is recovered when substituting (51).
The undesired dependence on the fields pL,R has been replaced
with the help of the auxiliary variables z1,2 .
The previous example illustrates a general conclusion.
Connected Feynman diagrams in the expansion of F1 reappear in f1 with their topological structure unchanged. Therefore, since the former has a diagrammatic expansion so it does
the latter. As shown in (39) the logarithm of F1 only contains
connected Feynman diagrams. Expression (53) makes clear
that this property is also inherited by f1 . By induction, these
statements hold at all coarse graining levels.

V.

INTERACTION AND ENTANGLEMENT

The semi-analytical character of the coarse graining protocol that we have designed allows to obtain interesting results
on the interplay between interaction and entanglement already
before addressing its numerical implementation. That will be
the subject of this Section.

1

= e− 2 p A1 p+i pU1 (x
×



1 +x2 )

 1 −1 1 
fˆ1 p, ∂x1 e−x D1 x .

Generalizing (45), the differential operator fˆ1 is given by

fˆ1 p, ∂x1 = f1 (p, z)|z=iU1 ∂ 1 .
(55)
x

The matrices A1 , U1 and D1 governing the gaussian terms are
those already present in the free case (17).
The arrows in the magnified link stress the different roles
that the fields x1,2 play in the cubic weight. This is better
understood by considering the linear combinations
x̄ = x1 + x2 ,

x̂ = x1 − x2 .

A tale of two fields

We are ready to factorize the level one Boltzmann weights.
As explained above, two sets of splitting fields x1,2 are necessary. Upper indices will always make reference to the splitting

(56)

We will refer to them as even and odd variables respectively.
The λ -independent coupling of p with the splitting fields only
involves the even variables x̄. In the absence of interaction
the odd variables x̂ completely decouple, since multiplying
contributions from the L and R cubic weights we have
1 −1 x1 −x2 D−1 x2
1

e−x D1

1

−1

= e− 2 x̄ D1

x̄− 12 x̂ D−1
1 x̂

.

(57)

Therefore x̄ is the counterpart of the splitting fields already
present in the gaussian SVD, while x̂ allows to treat locally
the new entanglement ties created by interaction. Without interaction the latter become trivial.
Sewing four cubic weights (54) and following the steps presented in Section IV.A for the elimination of p, we obtain the
second level Boltzmann weights
1

W2 (x) = e− 2 x M2 x F2 (x) .

(58)

Here x stands for both splitting fields (x̄, x̂). Recall that the
gaussian prefactor only contains leading terms in the pertubative expansion, namely O(λ 0 ). Its exponent is given by

1
1
x M2 x = x̄ S1 +C1T Q−1
(59)
1 C1 x̄ + x̂ S1 x̂ ,
2
2
with S1 = 14 ⊗ D−1
1 diagonal, and Q1 and C1 constructed out
of A1 and U1 respectively as explained in Appendix B. The
expression in parenthesis is the same combination governing
the level one Boltzmann weights in the absence of interaction.
This shows the direct connection between x̄ and the fields
already present in the free network. We have disregarded
quadratic terms between even and odd variables. Indeed, relation (57) implies that they trivially cancel in the product of
Boltzmann weights (28) building up the partition function.
The effect of interaction is encoded in the function
F2 (x) = e u S1 u F̂2 (x̄, ∂u ) e−u S1 u

A.

(54)

u=x1

.

(60)

A variable u has been introduced in order to unambiguously
define the action of the derivatives inherited from fˆ1 . The
differential operator F̂2 (x̄, ∂u ) is given by
Z

4

1
(i)
dp e− 2 p Q1 p ∏ fˆ1 p + iQ−1
1 C1 x̄, ∂u .
i=1

(61)

7
This integral is the level one equivalent of (37). The expression (60) may seem unconventional. It is however reminiscent
of the Hermite polynomials
Hn (x) = (−1)n e x

2

d n −x2
e
.
dxn

(62)

Each monomial xk in Hn is to be related with a Feynman diagram with k external legs of type u. This introduces an additional structure in the set of Feynman diagrams, whose relevance we discuss below.
B.

General structure

The main feature of our protocol is the introduction of new
fields representing the effect of interaction on entanglement.
They first appear at the second coarse graining level, corresponding to the odd combination of the splitting fields.
We recall schematically the leading order structure of the
even and odd fields, x̄ and x̂ respectively, using the decomposition (13) of M2




A2x̄ 0
B2x̄ 0
A2 =
,
B2 =
.
(63)
0 A2x̂
0 0
The decoupling between even and odd variables, together with
the vanishing of the odd mixing matrix B2x̂ , shows the trivial
nature of x̂ at leading order O(λ 0 ). Namely, these fields just
represent decoupled degrees of freedom living at each link.
However they contribute in general to LR mixing through the
function F2 , and require an own set of splitting fields to continue the coarse graining process.
In the simplified splitting problem (40), the vanishing of
B2x̂ is equivalent to setting b = 0. It is thus a question whether
the factorization technique of Section III.B applies in this limiting situation, which moreover will be recurrent in subsequent iterations. In order to clarify this point we send b to zero
in (49), after renaming the splitting fields as q1,2 . The product
of the gaussian exponential and its associated normalization
factor ρ results then in a delta function
1 1 2
1
lim √ e− b (q ) = δ (q1 ) .
πb

b→0

(64)

Namely, the consequence of a vanishing b is the collapse into
a delta function of the probability distribution of q1 . In the
free case, a delta function implies that the associated field can
be trivially removed from the coarse graining process. In the
presence of interaction, this does not hold anymore.
We come back to the factorization of W2 (x). The splitting
fields for the even and odd variables x̄ and x̂ will be denoted
by p and q respectively. As just explained, the probability
distribution of fields q collapses into a delta function. The
level two cubic weights are then
1

= e− 2 x A2 x + i x̄U2 p̄ + i x̂ q̄ ×

 1 −1 1
fˆ2 x, ∂p1, ∂q1 e−p D2 p δ (q1) ,

(65)

with U2 and D2 the SVD data of B2x̄ . The differential operator fˆ2 induces derivatives of δ (q1). The delta derivatives can
not be evaluated right away. This has to be postponed to the
coarse graining integral that eliminates q. It will be done using
integration by parts, which is equivalent to work at the level
of the Hermite polynomials (62) instead of dealing with individual Feynman diagrams. In this way the fields q, in spite of
their singular distribution function, provide a regular and well
defined contribution to the propagation of entanglement.
Due to the need of doubling the splitting fields, the bond dimension of the TRG network with interaction increases twice
as fast an in the free case. However the different roles of the
even and odd combinations in perturbation theory induce a
clear distinction between fields. A reduced set of them will be
in direct correspondence with the fields already present in the
free network, inheriting from them their leading order structure. This set is given by
(66)

where the index in parenthesis labels the coarse graining level.
Hence x̄(2) refers to the corresponding fields in (59) and p̄(3)
to those in (65). The dots stand for the even combination of
splitting fields associated with the previous term in the chain.
The largest set of fields represents entanglement ties created
by interaction. At each coarse graining level a new family of
them is seeded by the odd counterpart of the variables (66)

(67)

In order to stress the structure organizing this set of fields, we
have renamed q in (65) as p(2,3) . All these fields have a trivial
leading order structure, as x̂(2) in (59). Many of them will
have a singular distribution function, as it is the case of p(2,3) ,
but this does not represent a harm for the TRG protocol.

C.

A perturbative bound on χ

In the previous section we have not made reference to the
order at which we want the perturbative expansion to stop.
This is however an important information for the TRG protocol, which sets a limit to the propagation of entanglement
mediated by odd variables and results in a reduction of the
large set of extra fields (67).
For n ≥ 2 it is best to analize the effects of the interaction
in terms of a differential operator F̂n (x̄, ∂u ), generalizing F̂2

8
in (60) and defined by an integral as in (61)

F̂n (x̄, ∂u ) =

.

(68)

Recall that u is an auxiliary variable which, after the evaluation of the derivatives, should be replaced by x1 introducing therefore a dependence on the odd variables. The operator F̂n admits an expansion in Feynman graphs, where the
graphs's external legs can carry components of the vector x̄
or the derivative ∂u . Let us assume that in order to move to
the next coarse graining level we factorize (68) along the axis
i : (1, 2)L -(3, 4)R . A generic connected diagram in the expansion of F̂n has the structure

within one iteration at second order in λ . It is straightforward
to generalize this reasoning to order N, with the result that at
larger N more ramifications in (67) become relevant. Equivalently, high orders in perturbation theory require a growing
number of extra fields to represent locally the effects of interaction. We consider this property a consistency check of our
proposal.
We shall end with a comment on the fields (66). It was
mentioned in Section II.A that before truncation kicks in, the
singular values matrices D2n+1 have half of their diagonal entries equal to zero. The probability distribution of the associated fields is thus a delta function. Although in the free case
these fields are trivially discarded, in the presence of interaction some of them become relevant and need to be kept. We
show in Appendix E that this only happens when conditions
(70) are met. Since these extra fields behave with respect to
the perturbative order as the odd variables do, we will not discuss them further.

(69)
VI.
(1,2)
The subgraph on the left originates from fˆn−1 and contributes
mL powers of the coupling constant. A corresponding statement holds for the subgraph on the right. After introducing the
necessary splitting fields, the previous graph will be inherited
by the cubic weights resulting from the factorization of (68)
as described in Section IV.C. Appendix D proves that splitting
fields associated with the odd variables x̂, such as q1,2 in (66),
are only required in diagrams satisfying

mL , mR ≥ 1 ,

mL + mR ≤ N ,

In the previous sections we have extended the TRG protocol
based on local operations formulated in terms of fields to include interactions. We will start here the analysis of its numerical performance using as benchmark a λ φ 4 theory. This theory has been studied with tensor networks techniques which
imply the discretization of the field variables in26,35,40,43,58 .

A.

Truncation

(70)

with N the order at which to cut the perturbative expansion.
Clearly these conditions cannot be met at first order in perturbation theory. Although doubling the splitting fields is necessary, at first order in λ the odd combinations represent short
range entanglement and their effect extinguishes within one
iteration
.

(71)

The upper row contains the fields (66) with a counterpart in
the free network. From the set (67) only the first item in each
tree is relevant. This drastic simplification is consistent with
the rather trivial nature of quantum corrections at order λ .
At second order in perturbation theory (70) implies
mL = mR = 1 .

NUMERICAL RESULTS

(72)

Thus if a Feynman diagram contributes to odd variable mixing in the n-th iteration, it will not do it at any subsequent
one. Indeed, as an individual diagram it fails to satisfy the
first condition (70), while as part of a larger diagram it will
be the second which fails. The fields involved at second order
include (71), plus secondary chains with that same structure
stemming from each element of the second row. Namely the
second level odd fields, such as p̂(2,3) in (67), get extinguished

The last question that needs to be addressed before implementing the TRG is truncation. In the free case truncation
consists in discarding small singular values of the matrix Bn .
As (64) shows, this is equivalent to approximate the probability distribution of the splitting fields related with small singular values by a delta function.
Perturbation theory treats in an asymmetrical way quadratic
terms and interaction, giving rise to a potential problem. Truncation is only justified for fields with small LR cross terms
from both the leading order gaussian prefactor and the Feynman diagrams. This only represents a problem for fields contributing non trivially at leading and higher order in λ , namely,
the set (66). These two conditions are a priori not related,
since fields with a delta function distribution can yet have a
relevant contribution to Feynman diagrams via delta derivatives. Checking their compatibility is the first issue in the numerical study of the TRG. We will work below at first order
in perturbation theory to simplify the analysis by focussing as
much as possible on the set (66).
When the TRG protocol is applied at first order in λ , there
is one-to-one correspondence between the leading order gaussian structure of the even fields, and their counterpart in the
free network. See Appendix E for details. Since the odd fields
do not contribute to the propagation of entanglement, they
play a secondary role. Motivated by this we will apply the
term bond dimension to the number of fields in (66), which

9
without truncation is given by (20). As for the criterium of
truncation, we will adopt the simplest choice and base it again
on the singular values of Bn .

B.

Partition function

We present the results on the numerical evaluation of the
free energy per site of a λ φ 4 theory
−

1
log Z = f0 + λ f1 + O(λ 2 ) .
N

(73)

Fig.2 shows the relative error in the first order correction f1 for
several maximal bond dimensions and masses. The relative
error of the leading term f0 is also included for comparison.
A remarkable feature of the TRG protocol is the capacity to
correctly estimate f0 in the massless limit without varying the
bond dimension. This property however does not extend to f1 ,
which requires a sustained increase in the bond dimension to
keep the precision as the mass lowers. On the other hand, the
convergence with χmax appears to be faster for f1 than for f0 .
Notice that the precision in f1 improves on that of f0 down to
m ≈ 0.06 with just χmax = 20.

δf0
⨯
0.01
10

-3

10

-4

δf1
1⨯
⨯
⨯

⨯

α=3.7

0.01

⨯
⨯

⨯
⨯

⨯

⨯

8

⨯ ⨯
⨯ ⨯
14

20

⨯

0.01 ⨯

⨯
10-4

10

-6

⨯
⨯

δf0

0.01

⨯
⨯
⨯

⨯
⨯

⨯
⨯
⨯

⨯
⨯

⨯
⨯
⨯

⨯
⨯

⨯
⨯
⨯

⨯
⨯

⨯ δf1
0.1

⨯
⨯
⨯
⨯
⨯

⨯
⨯
⨯

⨯
⨯

⨯

⨯

⨯
⨯

⨯

8
20

⨯
⨯

⨯ m
1

Figure 2. Relative errors δ f0 (dotted lines) and δ f1 (crosses) in the
free energy per site as a function of the mass and the bond dimension,
in a lattice of size N = 240 .

It is important to quantify the convergence of the TRG with
the bond dimension. The error in the leading term of the free
energy at fixed mass follows a power law, (χmax )−α . This is
observed in Fig.3a, where choosing as example m = 0.1 and
setting α = 3.7 we have obtained a very good fit of δ f0 . The
behaviour of δ f1 is plotted in Fig.3b at the same mass. The
error for small bond dimension, although larger than that of
the leading term, decreases exponentially fast. As the precision improves, the dependence on χmax turns into a power law
with exponent α = 7.3. This confirms the faster convergence
of δ f1 across all bond dimensions. A similar pattern holds at
other values of the mass. The smaller the mass, the bigger the
error at fixed bond dimension and the larger the range of χmax
were convergence is exponential.
In the same way that the singular values of Bn describe the
entanglement hierarchy at leading order, new quantities are
needed to characterize how interaction modifies it. To this aim
we will use the cubic weights, Vn . After the maximal bond
dimension is reached, they result from the factorization of the

⨯ ⨯

14

20

χmax

(74)

We will be interested in the cubic weights before implementing the truncation represented in second step. At first order in
the coupling constant, Vn can be written as


An − 21 12 ⊗D−1
n−1 x̄ + i x̄Un p̄

×
h
i

−1
1 −1 1
ĝn ∂p1 , x̄, ∂u e−u(12 ⊗Dn−1 ) u − p Dn p

(75)

u=x1

4

⨯

⨯

8

⨯

.

2

16

⨯

χmax

⨯

Boltzmann weights plus a truncation guided by the matrix Bn

= e− 2 x̄

⨯
⨯
⨯

10-4

Figure 3. Relative errors a) δ f0 and b) δ f1 as a function of the
bond dimension at m = 0.1. The blue lines represent a power law fit
(χmax )−α .

1

⨯
1 ⨯

α=7.3
⨯

.

The χmax ×χmax matrix Dn−1 and the 2χmax ×2χmax matrices
An , Un and Dn are precisely the same as in the free case. Upon
evaluating the derivatives ∂u , the differential operator ĝn will
transform into the level n generalisation of (55).
For a λ φ 4 theory, the operator ĝn can be represented in the
terms of the quartic polynomial
"
#


(0)
(2)
(4)
cn 1 + λ Tn + ∑ Tn,i j zi z j + ∑ Tn,i jkl zi z j zl zl
, (76)
i, j

i, j,k,l

where the vector z stands for (∂p1 , x̄, ∂u ). The leading order
constant cn has been factored out in the definition of the orderk tensors Tn (k) . Using these tensors we define
(2)

ωn,i =

1
χmax

(2)

∑ |Tn,i j | ,
j

(4)

ωn,i =

1
3
χmax

(4)

∑ |Tn,i jkl | ,

(77)

jkl

with i = 1, .., 2χmax running over the components of ∂p1 .
These quantities provide an estimate of the relevance of p1i
in transmitting the effect of interaction. The larger the bond
dimension, the smaller are some of the singular values in the
diagonal matrices Dn . If the derivatives ∂u and ∂p1 in (75)
were evaluated, small singular values would induce artificially
large entries in the previous tensors. Such large contributions
just mean that the probability distribution of the associated
fields is close to a delta function and, as discussed above, the
TRG protocol can deal with these objects.
The singular values of Bn and the above defined ω's are
plotted in Fig.4a for m = 0.1 at the coarse graining level n = 8.

10
We observe that the singular values follow a marked descending pattern. On the contrary the ω's start slightly increasing
and reach then a plateau extending up to i ' 10 . This implies
that interaction strengthens the first set of entanglement ties,
tending to make them equally relevant. However, although
the entanglement hierarchy is modified, it is not incompatible
with the leading order truncation criterium based on Bn . Indeed, the entries ωn,i with i > 14 present a clear decreasing
trend. The associated splitting fields can thus be discarded
with a small error both at the level of the leading and first order terms. This is in agreement with the good performance of
χmax = 16 for m = 0.1 seen in Fig.2. It is interesting to notice
the similarity between the ω's related to the two and four leg
tensors.
⨯⨯⨯⨯⨯⨯
⨯⨯⨯⨯⨯
⨯⨯⨯⨯
1 ⨯⨯
⨯⨯⨯⨯⨯⨯⨯⨯⨯⨯⨯
⨯⨯
⨯⨯⨯⨯⨯⨯⨯⨯⨯⨯⨯
⨯⨯
⨯⨯⨯
⨯⨯⨯⨯ ⨯⨯⨯⨯⨯⨯⨯
⨯⨯⨯⨯
⨯⨯⨯ ⨯⨯⨯⨯⨯
⨯⨯⨯⨯
⨯⨯
⨯
1
⨯⨯
⨯⨯⨯⨯
⨯ ⨯
⨯⨯ ⨯⨯⨯⨯ ⨯
⨯⨯
⨯ ⨯⨯ ⨯
⨯⨯ ⨯ ⨯⨯ ⨯
⨯⨯⨯⨯
⨯⨯⨯
⨯ ⨯⨯ ⨯
⨯⨯ ⨯ ⨯⨯ ⨯
⨯ ⨯ ⨯
⨯⨯
⨯ ⨯ ⨯
⨯
-8
⨯
⨯
⨯⨯ ⨯
⨯
⨯
10
⨯⨯
⨯⨯ ⨯
⨯ bn,i
⨯
⨯
⨯
⨯ ⨯
⨯⨯
-8
⨯ ⨯ ⨯ ⨯⨯
10
⨯⨯
⨯ ⨯ ⨯⨯ ⨯
⨯
(2)
⨯⨯
⨯⨯
⨯
⨯⨯
⨯ ωn,i
⨯ ⨯ ⨯ ⨯
⨯⨯
⨯
⨯
⨯
⨯
⨯
(4)
⨯
⨯⨯
⨯
10-16 ⨯ ωn,i
10-16
⨯
⨯⨯
⨯
i
i
0
10
20
30
0
10
20
30

Figure 4. Singular values of Bn and sum of tensor elements (77) for
a) m = 0.1 and b) m = 0.01 at the coarse graining level n = 8. The
number of b's and ω's at that level is 2χn = 32.

The behaviour shown in Fig.4a is general. Moreover, the
smaller the mass the more ω's should be taken into account
to obtain a good precision. This is observed in Fig.4b, which
suggests that including up to i ' 20 is necessary to reasonably
describe the first order effects when m = 0.01. The pattern of
the ω's also explains the two regimes seen in Fig.3b, exponential and power law, for the dependence of the relative error
δ f1 on the bond dimension. Only when χmax is large enough
to include all fields associated with similarly relevant values
of ω, the convergence changes from exponential to power law.
On the other hand, the singular values of Bn for m = 0.1 and
0.01 practically coincide. This agrees with the almost equal
leading order error δ f0 seen in Fig.2 for both masses.
C.

Indeed the RG flow of the gaussian weights (12) can be described by the evolution
Mn → MCDL ,

(79)

where the only non-zero entries of the matrix MCDL are those
described by the CDL vertex.
When the degrees of freedom running in each plaquette decouple from the others, it is simple to integrate them out. In
this sense the CDL is nothing but a redundant way to represent a trivial IR fixed point. This is confirmed by the ability
of the TRG to transform the free boson lattice into a CDL network as the coarse graining process surpasses the scale set by
the boson mass1 . Having into account that the lattice spacing
doubles every two TRG iterations, this happens when
n > 2 log2 m−1 .

(80)

We show in Fig.5a the RG evolution of the singular values of
Bn for χmax = 16 and m = 0.01. At n ' 18 half of the singular
values start to strongly decay. This signals the emergence of a
CDL structure, since contributions from fields at opposite corners trivially factorize. At the same time the CDL matrix (79)
freezes out, which is also observed in that figure. The value
n = 18 is in good agreement with the theoretical estimation
(80), whose rhs for m = 0.01 gives 13.3. Notice that the quotient between the correlation length, ξ ' m−1 , and the lattice
spacing at n = 18 is ' 0.2.
We are ready now to analyze the RG flow associated with
the first order correction to the free energy. The tensors defined in (76) encode the structure at first order in the perturbative expansion of the λ φ 4 theory. They should reach an IR
fixed point at the same scale as the singular values bn,i . A
modification of the IR scale (80) can only arise from an all
order resumation of perturbative effects, as that implied by
the usual RG equations. We are not addressing this issue here.
Consistently, we found that the two and four leg tensors freeze
out right after the leading gaussian structure reaches the CDL
fixed point.

CDL structure

The standard TRG has the drawback of not being fully able
to eliminate short range entanglement22 . The infrared (IR)
fixed point of gapped systems treated with this protocol is
given by a so-called corner double line structure (CDL)

(78)

Correlations in the CDL network are confined inside each plaquette. A SVD based coarse graining fails however to detect
this structure and promotes half of the CDL loops to the next
level. This problem is replicated by the free boson TRG1 .

Figure 5. RG flow of a) the singular values of Bn and b) the sum
of Tn (4) elements (77) for χmax = 16 and m = 0.01. The pink line
signals n = 8, the iteration where truncation begins with χmax = 16,
and the red line marks n = 18. These plots refer n even, horizontal
lattices. Analogous results describe n odd, tilted lattices.

The RG flow of the order λ terms can be portrayed with
the help of (77). We have plotted in Fig.5b the evolution of
the ω's associated with Tn (4) for χmax = 16 and m = 0.01.
Not only these quantities stabilise at the same time as bn,i , but
together with them, the corresponding half becomes zero. The

11
same result holds for Tn (2) . This implies that the associated p
in (75) are irrelevant to the factorization of both gaussian and
interacting cross terms. Hence the truncation in the second
step of (74) is automatic, which is a distinct characteristic of
the CDL structure.
Finally, we have checked that the two and four leg tensors
reproduce the CDL pattern of network connections. To that
aim we define the matrix
(2)

Ωi j = |Tn,i j | +

1
2
χmax

(4)

∑ |Tn,i jkl | .

(81)

k,l

Recall that its indices refer to (∂p1 , x̄, ∂u ). Contrary to (77),
we assume that the truncation in the second step of (74) has
been already implemented and the bond dimension in all links
is χmax . A non-zero entry Ωi j reflects that the Feynman diagrams connect components i and j. A graphical representation of this matrix is given in Fig.6 for χmax = 16, m = 0.01
and n = 24, when the CDL regime is clearly stablished for the
leading gaussian terms. The boxes defined by the thin black
lines have dimension χmax ×χmax , while the numbers on their
side label the links of the CDL cubic weight included in that
figure. The colour code describes the magnitude of the entries,
making clear the CDL structure. We obtain thus a unified picture of the RG flow at leading and first order in the coupling
constant.

Figure 6. Colour plot of the matrix (81) for χmax = 16, m = 0.01
and n = 24.

VII.

CONCLUSIONS

We have explored the formulation of a real space coarse
graining protocol for interacting QFT's based on local manipulations on continuous variables. Together with an entanglement rooted organisation of degrees of freedom, we have
used the standard Wilsonian approach as guideline. This led
to move the SVD analysis characteristic of real space RG algorithms from the Boltzmann weights, which describe the discretized QFT partition function, to their exponent or in other
words, to the free energy. Our motivation was to operate directly at the level of fields. Each field is a proxy for an infinite
subset of the singular values that would result from a standard
SVD. The strong structure that this automatically implies aims

to be an efficient theoretical tool, able to obtain insights that
are difficult for more numerical oriented algorithms.
We have developed a framework based on the TRG
network17 , which realises this program in the context of perturbation theory. Describing the effect of interaction in terms
of local manipulations requires the introduction of extra fields
with distinct properties. They have a trivial leading order
structure and their number increases with the order in perturbation theory at which we want to work. Due to the simple
nature of the associated quantum corrections, the role of these
additional fields at first order in the coupling constant is secondary. It would be therefore important to extend the detailed
numerical analysis we have performed here beyond first order.
The adapted TRG network evaluates the partition function
of a free boson with excellent precision and a numerical cost
independent of the boson mass1 . We have chosen a λ φ 4 theory to benchmark the performance at first order in perturbation theory. In this case the numerical cost increases at small
masses, but the results exhibit a fast convergence with the
bond dimension. Using the direct correspondence between
the field content of the free and first order networks, we have
analyzed how the interaction modifies the leading order entanglement hierarchy. The quantum corrections work towards
levelling off the pattern of marked decreasing relevance that
organizes the fields in the absence of interaction. This effect
involves a larger subset of fields the lower the mass is, explaining a dependence of the numerical cost on the mass which was
not present in the free network. Besides, we obtained a consistent picture of the RG flow at leading and first order. As
it is characteristic of standard TRG algorithms, a fixed point
with CDL structure was attained in the IR.
Tensor networks are designed to deal with any value of the
coupling constant. The perturbative approach we have followed here might seem thus limited. We believe however that
it is an important step towards a goal that is extremely difficult for QFT. Although beyond the scope of this paper, a
venue to include non-perturbative effects could be adding finite λ corrections to the gaussian structure that underlies the
algorithm. A modification of the leading order gaussian structure can also be relevant for improving the performance in the
limit of small masses. On the other hand, we would like to
stress that the perturbative framework is not essential for the
SVD protocol presented in Section IV.B.
Finally, there are other interesting and simpler generalizations of the adapted TRG protocol. In particular, the calculation of correlation functions and its application to field theories with fermions. We plan to address some of these issues in
the near future.
ACKNOWLEDGMENTS

We thank Pasquale Calabrese, José Melgarejo, Javier
Molina-Villaplana, Giuseppe Mussardo, Antoine Tilloy and
Erik Tonni for conversations. The work of M.C. is supported by a contract BES-2017-080586. We acknowledge
financial support from the grants PGC2018-095862-B-C21,
QUITEMAD+ S2013/ICE-2801 and SEV-2016-0597 of the
"Centro de Excelencia Severo Ochoa" Programme.

12

1
2

3
4

5

6
7
8

9

10

11
12

13

14
15

16

17

18
19
20

21

22

M. Campos, G. Sierra and E. Lopez, "Tensor renormalization
group in bosonic field theory," Phys. Rev. B 100, 195106 (2019).
I. Affleck, T. Kennedy, E. H. Lieb, and H. Tasaki, "Valence bond
ground states in isotropic quantum antiferromagnets", Commun.
Math. Phys., 115, 477 (1988).
S. R. White, "Density matrix formulation for quantum renormalization groups", Phys. Rev. Lett. 69, 2863 (1992).
M. Fannes, B. Nachtergaele, and R. F. Werner, "Finitely correlated states on quantum spin chains", Commun. Math. Phys. 144,
443 (1992).
A. Klümper, A. Schadschneider, and J. Zittartz "Matrix-productgroundstates for one-dimensional spin-1 quantum antiferromagnets", Europhys. Lett. 24, 293 (1993).
S. Östlund and S. Rommer, "Thermodynamic Limit of Density
Matrix Renormalization", Phys. Rev. Lett. 75, 3537 (1995).
T. Nishino. "Density Matrix Renormalization Group Method for
2D Classical Models". J. Phys. Soc. Jpn., 64, 3598 (1995).
T. Nishino and K. Okunishi, "Corner Transfer Matrix Algorithm
for Classical Renormalization Group", J. Phys. Soc. Jpn. 66, 3040
(1997).
J. Dukelsky, M.A. Martin-Delgado, T. Nishino, G. Sierra, "Equivalence of the Variational Matrix Product Method and the Density
Matrix Renormalization Group applied to Spin Chains", Europhys. Lett., 43, 457 (1998).
G. Sierra and M.A. Martin-Delgado "The Density Matrix Renormalization Group, Quantum Groups and Conformal Field Theory", Proceed. Workshop on the Exact Renormalization Group,
Faro (Portugal) 1998, arXiv:cond-mat/9811170.
G. Vidal, "Efficient Classical Simulation of Slightly Entangled
Quantum Computations", Phys. Rev. Lett. 91, 147902 (2003).
F. Verstraete, D. Porras, and J. I. Cirac, "DMRG and periodic
boundary conditions: a quantum information perspective", Phys.
Rev. Lett. 93, 227205 (2004).
F. Verstraete and J. I. Cirac, "Renormalization algorithms for
Quantum-Many Body Systems in two and higher dimensions",
arXiv:cond-mat/0407066v1 (2004).
U. Schollwöck, "The density-matrix renormalization group",
Rev. Mod. Phys. 77, 259 (2005).
V. Murg, F. Verstraete, and J. I. Cirac. "Efficient evaluation of partition functions of frustrated and inhomogeneous spin systems".
Phys. Rev. Lett., 95, 057206 (2005).
D. Pérez-Garcı́a, F. Verstraete, M. M. Wolf, J. I. Cirac, "Matrix product state representations", Quantum Inf. Comput. 7, 401
(2007).
M. Levin and C. P. Nave, "Tensor Renormalization Group Approach to Two-Dimensional Classical Lattice Models", Phys.
Rev. Lett. 99, 120601 (2007).
G. Vidal, "Entanglement Renormalization", Phys. Rev. Lett. 99,
220405 (2007).
V. Giovannetti, S. Montangero, R. Fazio, "Quantum MERA
Channels", Phys. Rev. Lett. 101, 180503 (2008).
F. Verstraete, J.I. Cirac, V. Murg, "Matrix Product States, Projected Entangled Pair States, and variational renormalization
group methods for quantum spin systems", Adv. Phys. 57,143
(2008).
R. N. C. Pfeifer, G. Evenbly, and G. Vidal, "Entanglement renormalization, scale invariance, and quantum criticality", Phys. Rev.
A 79, 040301 (2009).
Z.-C. Gu and X.-G. Wen, "Tensor-entanglement-filtering renormalization approach and symmetry-protected topological order",
Phys. Rev. B 80, 155131 (2009).

23

24

25

26
27

28
29

30

31

32

33

34

35

36

37
38

39

40

41
42

43
44

F. Pollmann, A. M. Turner, E. Berg, and M. Oshikawa, "Entanglement spectrum of a topological phase in one dimension", Phys.
Rev. B 81, 064439 (2010).
X. Chen, Z.-C. Gu, and X.-G. Wen, "Classification of gapped
symmetric phases in one-dimensional spin systems", Phys. Rev.
B 83, 035107 (2011).
N. Schuch, D. Pérez-Garcı́a, and J. I. Cirac, "Classifying quantum
phases using matrix product states and projected entangled pair
states", Phys. Rev. B 84, 165139 (2011).
Y. Shimizu, "Tensor renormalization group approach to a lattice
boson model", Mod. Phys. Lett. A 27, 1250035 (2012).
R. Orús, "A practical introduction to tensor networks: Matrix
product states and projected entangled pair states", Ann. Phys.
349, 117 (2014).
G. Evenbly and G. Vidal, "Tensor Network Renormalization",
Phys. Rev. Lett. 115, 180405 (2015).
G. Evenbly and G. Vidal, "Tensor network renormalization yields
the multi-scale entanglement renormalization ansatz", Phys. Rev.
Lett. 115, 200401 (2015).
S.-J. Ran, C. Peng, W. Li, M. Lewenstein, G. Su, "Criticality
in Two-Dimensional Quantum Systems: Tensor Network Approach", Phys. Rev. B 95, 155114 (2017).
M. Bal, M. Mariën, J. Haegeman, F. Verstraete, "Renormalization
group flows of Hamiltonians using tensor networks" Phys. Rev.
Lett. 118, 250602 (2017).
H. He, Y. Zheng, B. Andrei Bernevig, N. Regnault, "Entanglement Entropy From Tensor Network States for Stabilizer Codes",
Phys. Rev. B 97, 125102 (2018).
S. Singha Roy, H. Shekhar Dhar, A. Sen De, U. Sen, "Tensornetwork approach to compute genuine multisite entanglement in
infinite quantum spin chains", Phys. Rev. A 99, 062305 (2019).
M. C. Banuls, K. Cichy, H.-T. Hung, Y.-J. Kao, C.-J. D. Lin, Y.P. Lin, D. T.-L. Tan, "Phase structure and real-time dynamics of
the massive Thirring model in 1+1 dimensions using the tensornetwork method", PoS (LATTICE2019) 022.
D. Kadoh, Y. Kuramashi, Y. Nakamura, R. Sakai, S. Takeda and
Y. Yoshimura, "Tensor network analysis of critical coupling in
two dimensional φ 4 theory", JHEP 05 (2019), 184.
B. Vanhecke, J. Haegeman, K. Van Acoleyen, L. Vanderstraeten,
F. Verstraete, "A scaling hypothesis for matrix product states",
Phys. Rev. Lett. 123, 250604 (2019).
J. Garre-Rubio, "Symmetries in topological tensor network states:
classification, construction and detection", arXiv:1912.08597.
M. C. Banuls, M. P. Heller, K. Jansen, J. Knaute, V. Svensson,
"From spin chains to real-time thermal field theory using tensor
networks", Phys. Rev. Research 2, 033301 (2020).
Hui-Ke Jin, Hong-Hao Tu, Yi Zhou, "Efficient tensor network
representation for Gutzwiller projected states of paired fermions",
Phys. Rev. B 101, 165135 (2020)
C. Delcamp, A. Tilloy, "Computing the renormalization group
flow of two-dimensional φ 4 theory with tensor networks", Phys.
Rev. Research 2, 033278 (2020);
Q. Mortier, N.Schuch, F. Verstraete, J. Haegeman, "Resolving
Fermi surfaces with tensor networks", arXiv:2008.11176.
D. Poilblanc, M. Mambrini, F. Alet, "Finite-temperature symmetric tensor network for spin-1/2 Heisenberg antiferromagnets on
the square lattice", SciPost Phys. 10, 019 (2021).
B. Vanhecke, F. Verstraete, K. Van Acoleyen, "Entanglement scaling for λ φ24 ", arxiv.2104.10564.
F. Verstraete and J. I. Cirac, "Continuous matrix product states for
quantum fields", Phys. Rev. Lett. 104, 190405 (2010).

13
45

46

47
48

49
50

51
52
53
54

J. Haegeman, T. J. Osborne, H. Verschelde and F. Verstraete,
"Entanglement renormalization for quantum fields in real space",
Phys. Rev. Lett. 110, 100402 (2013).
D. Jennings, C. Brockt, J. Haegeman, T. J. Osborne and F. Verstraete, "Continuum tensor network field states, path integral representations and spatial symmetries", New J. Phys. 17, 063039
(2015).
A. Tilloy, J. I. Cirac "Continuous Tensor Network States for
Quantum Fields", Phys. Rev. X 9, 021040 (2019)
J. Cotlera, M. R. M. Mozaffar, A. Mollabashi, A. Naseh, "Renormalization Group Circuits for Weakly Interacting Continuum
Field Theories", Fortschr. Phys. 67, 1900038 (2019).
Q. Hu, A. Franco-Rubio, G. Vidal, "Continuous tensor network
renormalization for quantum fields", arXiv:1809.05176.
T. D. Karanikolaou, P. Emonts, A. Tilloy, "Gaussian Continuous
Tensor Network States for Simple Bosonic Field Theories" Phys.
Rev. Research 3, 023059 (2021). arXiv:2006.13143.
A.E. B. Nielsen, B. Herwerth, J. I. Cirac, and G. Sierra, "Field
tensor network states", Phys. Rev. B 103, 155130 (2021).
B. Swingle, "Entanglement renormalization and holography",
Phys. Rev. D 86, 065007 (2012).
J. I. Latorre and G. Sierra, "Holographic codes",
arXiv:1502.06618.
F. Pastawski, B. Yoshida, D. Harlow, and John Preskill, "Holographic quantum error-correcting codes: toy models for the
bulk/boundary correspondence", J. High Energy Phys. 2015, 149,

55

56

57

58

59
60
61

62
63

(2015).
J. Molina-Vilaplana, "Information geometry of entanglement
renormalization for free quantum fields", J. High Energ. Phys.
2015, 2 (2015).
M. Miyaji, T. Numasawa, N. Shiba, T. Takayanagi, K. Watanabe,
"cMERA as Surface/State Correspondence in AdS/CFT", Phys.
Rev. Lett. 115, 171602 (2015).
P. Caputa, N. Kundu, M. Miyaji, T. Takayanagi, and K. Watanabe, "Liouville action as path-integral complexity: from continuous tensor networks to AdS/CFT", J. High Energy Phys. 2017, 97
(2017).
R. Vasseur, A. C. Potter, Y.-Z. You, A. W. W. Ludwig, "Entanglement Transitions from Holographic Random Tensor Networks",
Phys. Rev. B 100, 134203 (2019).
A. Jahn, J. Eisert, "Holographic tensor network models and quantum error correction: A topical review", arXiv:2102.02619.
https://github.com/m-campos/interacting-trg.
K.G. Wilson, "Group and Critical Phenomena. I. Renormalization
Group and the Kadanoff Scaling Picture", Phys. Rev. B 4, 3174
(1971).
R. Shankar, "Renormalization Group Approach to Interacting
Fermions", Rev. Mod. Phys. 66, 129 (1994).
M. Abramowitz, I. A. Stegun, Handbook of Mathematical Functions with Formulas, Graphs, and Mathematical Tables. Applied
Mathematics Series 55 , New York, Dover Publications (1970).

Appendix A: SVD vs gaussian SVD

In this appendix we compare the standard SVD with the gaussian SVD employed throughout the paper as the basic mathematical tool to implement the gTRG. The SVD is equivalent to the Schmidt decomposition of a quantum state. We shall use this
correspondence in what follows.
1.

The Fourier transform as a continuous SVD

Let us start with eq.(11)
1

2

e− 2 (x1 −x2 ) =

Z

1 2
dp
√ eip(x1 −x2 )− 2 p ,
2π

(A1)

and define the state
|ψi =

Z

1

2

dx1 dx2 e− 2 (x1 −x2 ) |x1 i ⊗ |x2 i ,

(A2)

where |xi is a orthonormal basis in the Dirac sense, that is hx|x0 i = δ (x − x0 ). Eq.(A2) represents a pair of particles in a bound
state that using (A1) can be written as
√ Z
1 2
|ψi = 2π d p e− 2 p |pi ⊗ | − pi ,
(A3)
where the states
|pi ≡

Z

dx
√ eipx |xi ,
2π

(A4)

satisfy
hp|p0 i = δ (p − p0 ) .

(A5)

Eq.(A3) is the Schmidt decomposition of the state (A2) in the orthonormal basis |pi. Eq. (A1) is a continuous SVD, that is
1 2
nothing but the Fourier transform of e− 2 p . Notice that the norm of (A3) is hψ|ψi = 2π 3/2 δ (0) that reflects the translational
1
2
invariance of the two body wave function e− 2 (x1 −x2 ) .

14
2.

SVD of a normalized gaussian state

Let us next consider the function
a

2

2

W (x1 , x2 ) = ρe− 2 (x1 +x2 )+bx1 x2 ,

(A6)

that has the same form as eq.(12). We define the state
|W i =

Z

dx1 dx2 W (x1 , x2 )|x1 i ⊗ |x2 i ,

(A7)

that is normalized provided a > |b|, with the normalization factor ρ = π −1/2 (a2 −b2 )1/4 . The state (A2) corresponds to a = b = 1
that, as explained above, is normalized in the Dirac sense.
To find the Schmidt decomposition of (A7) we use the identity63


∞
un
1
u2
2u
2
√
(x
−
y)
,
(A8)
H
(x)H
(y)
=
xy
−
exp
n
n
∑ n
1+u
1 − u2
1 − u2
n=0 2 n!
where Hn (x) are the Hermite polynomials that give the eigenfunctions of the Hamiltonian of the harmonic oscillator H =
1
2
2
2 (−∂x + x ),
2
1
ψn (x) = √
Hn (x)e−x /2 .
1/2
n
π 2 n!

(A9)

Using (A9) one can write (A8) as

 2
x + y2 − 2uxy
.
∑ u ψn (x)ψn (y) = pπ(1 − u2 ) exp − 2(1 − u2 )
n=0
∞

1

n

(A10)

Comparing (A6) and (A10) we find
ax12 =

x2
,
1 − u2

ax22 =

y2
,
1 − u2

bx1 x2 =

uxy
,
1 − u2

(A11)

so that
 2
b
u =
.
a
2

(A12)

Let us write (A6) using the variables x and y
 2

x + y2 − 2uxy
1
,
W (x, y) = √ exp −
2(1 − u2 )
π

|u| < 1

where we took into account the Jacobian of the transformation. The state (A7) becomes
∞
p
|W i = 1 − u2 ∑ un |ni ⊗ |ni ,

(A13)

(A14)

n=0

where
|ni =

Z

dx ψn (x)|xi .

(A15)

Equation (A14) is the Schmidt decomposition of |W i in terms of the discrete Schmidt coefficients,
wn =

p
1 − u2 un ,

u = 0, 1, . . . , ∞ .

(A16)

Talking the trace over the left, or right, Hilbert space of the pure density matrix of (A14) gives
∞

ρ = trL |W ihW | = (1 − u2 ) ∑ u2n |nihn|

(A17)

n=0

whose von Neumann entropy is
S1 = − log(1 − u2 ) −
that diverges in the limit u2 → 1− .

u2 log u2
,
1 − u2

(A18)

15
3.

Gaussian SVD of a normalized gaussian state

Let us consider again the state (A7), and write (A6) as
1

2

2

b

2

W (x1 , x2 ) = ρe− 2 (a−b)(x1 +x2 )− 2 (x1 −x2 ) .
Using (A1) with x1,2 →

(A19)

√
bx1,2 , this equation reads
1

2

2

W (x1 , x2 ) = ρe− 2 (a−b)(x1 +x2 )

Z

d p ip(x1 −x2 )− 1 p2
2b
√
e
,
2πb

(A20)

that allow us to write (A7) as
ρ
|W i = √
2πb

Z

1

2

d p e− 2b p |p, a − bi ⊗ | − p, a − bi ,

(A21)

where
|p, a − bi =

Z

1

dx e− 2 (a−b)x

2 +ipx

|xi .

(A22)

These states are not orthogonal since
0

r

hp, a − b|p , a − bi =

0 )2
π − (p−p
e 4(a−b) .
a−b

(A23)

Equation (A21) looks like a continuous Schmidt decomposition similar to (A3), but it is not because the basis |p, a − bi is not
orthogonal when a > |b|. On the other hand, we saw above that the Schmidt decomposition of |W i involves an infinite number
of terms but is discrete (see (A14)). The gaussian SVD is an example of a look alike Schmidt decomposition that is forced upon
us by the condition of working with the exponent of the Boltzmann weights or the effective action in Quantum Field Theory.

Appendix B: Loop matrices

We will construct the matrices Qn and Cn that govern the gaussian kernel of the TRG coarse graining integrals. The leading
gaussian terms do not couple the fields with a counterpart in the free model, the set (66), with the new fields (67) introduced by
interaction. For the n = 2 matrices, this was made explicit in (63). Based on it, we will focus on the matrix blocks associated
with the set (66). They are given by the same expressions that apply to the free network. In order to simplify notation, we refer
to the free case in the following presentation.
In an appropriate basis, and up to a propotionality constant, the Boltzmann weights of the free model are described by

=

− 12 x Mn x

e

,


 

An 0
Bn −Bn
Mn =
+
.
0 An
−Bn Bn

(B1)

The 2 × 2 block structure of Mn corresponds to the choice x = (xL , xR ) with xL = (x1 , x2 ) and xR = (x4 , x3 ), motivated by a
subsequent splitting of Wn along the axis 12 − 34. The factorization of the Boltzmann weights is based on the SVD of Bn , which
rewrites this matrix as Un DnUnT . In general Un is a 2χn × χn+1 isometry. We have χn+1 ≤ 2χn , since some singular values in Dn
might be truncated because their number is larger than χmax or discarded because they vanish. The matrices An and Un have a
further interesting structure1


1
an −an
−1
An = 12 ⊗ Dn−1 +
,
−an an
2



1 un vn
Un = √
.
2 un −vn

(B2)

The matrix an is real symmetric and positive. Both an and Dn−1 have dimension χn ×χn . The isometries un and vn have real
+
entries and dimension χn × 12 χn+1 , satisfying u+
n un = vn vn = 1.

16
After splitting Wn into two cubic weights according to the 2 × 2 block structure in (B1), four cubic weights are sewed together
in order to obtain Wn+1 . The kernel of the coarse graining integral that eliminates the fields x in favour of the next level p is

1

e− 2 x Qn x+ixCn p ,

=

(B3)

where we have ignored again a multiplicative constant. The 4χn × 4χn matrix Q is readily built out of D−1
n−1 and an
−1
2
−1
0

2
−1
+
0
−1


Qn = 14 ⊗ D−1
n−1

0
−1
2
−1


−1
0
⊗ an .
−1
2

(B4)

It is convenient to decompose the matrix Cn into two components such that Cn p = Cn,L pL +Cn,R pR . The 4χn × 2χn+1 matrices
Cn,LR are constructed in terms of the isometries un and vn

−un −vn
1  0
0
CR = √ 
0
0
2
−un vn



un vn
0
0
1 u −vn −un vn 
CL = √  n
,
2 0 0 −un −vn
0 0
0
0


0 0
0 0 
.
un vn 
un −vn

(B5)

The zeroes in the last row of Cn,L reflect that x4 does not couple to pL and correspondigly for the second row of zeroes in Cn,R .
Generalizing (59) and (63), we obtain
An+1 =

i
1h
T −1
12 ⊗ D−1
n + (Cn,L −Cn,R ) Qn (Cn,L −Cn,R ) ,
2

T
Bn+1 = −Cn,L
Q−1
n Cn,R ,

(B6)

where from (B1) we have used
T
T
−1
Cn,L
Q−1
n Cn,L = Cn,R Qn Cn,R ,

T
T
−1
Cn,L
Q−1
n Cn,R = Cn,R Qn Cn,L .

(B7)

Appendix C: Feynman rules

We present the Feynman rules for building the diagrammatic expansion of F1 (37)
Z

F1 (p) =

1

dx e− 2 x Q0 x

4

(i)

∏ f0

(x + iQ−1
0 C0 p) .

(C1)

i=1

In analogy with the Wilsonian effective action reviewed in Section 3, double lines are used to represent the fields integrated over
(x ≡ fast fields) and single lines for the next level fields (p ≡ slow fields). The propagator of the fast fields is given by
,

(C2)

with i = 1, .., 4. The kinetic terms and spatial derivatives in the original lagrangian (1) render the matrix Q0 non-diagonal. As
a consequence Q−1
0 propagates linear combinations involving all four x-fields in the integral (C1). On the contrary, interaction
in the initial lattice only couples fields living on the same link. Using a λ φ 4 theory as example, the interaction vertex for the x
fields is
.

(C3)

17
The interaction vertices between fast and slow fields are obtained by dressing some double lines of the vertex (C3) with Q−1
0 C0

,

(C4)

and analogously for all other possible replacements of double by single lines. In order to avoid confusion, we use the letters
a, b, .. = 1, .., 8 to label the p fields of the level one tilted lattice. Due to the dressing Q−1
0 C0 , interaction couples p fields from
different lattice links. The interaction vertex of the level one Boltzmann weight W1 is

.

(C5)

The Feynman rules for constructing Fn with n > 1 are more involved due to the doubling of the splitting fields explained in
Section 4.B and the different roles of the fields in the sets (66) and (67). A sketch of the Feynman rules necessary for working at
first order in perturbation theory can be found in the readme document of the GitHub link60 .
Appendix D: A bound on odd fields

Odd variables can contribute to LR mixing via the functions Fn , which contain the effect of interaction on the Boltzmann
weights Wn . These functions are given by Hermite-like expressions, with the associated differential operator F̂n obtained from
an integral generalizing (61)

F̂n (x̄, ∂u ) =

Z

.

dp

(D1)

(i)
The arguments of function fˆn−1 live at the links intersected by the dotted circle: the shifted fields pi,i+1 and the derivatives ∂ui .
The latter generate a dependence of Fn on x̂i after evaluating the corresponding expression (60).
We assume that Wn will be subsequently factorized along the axis i : (1, 2)L -(3, 4)R . A generic connected Feynman diagram
in the expansion of F̂n has the form

.

(D2)

(i)
The subgraph on the left combines diagrams from fˆn−1 with i = 1, 2 and contributes mL powers of the coupling constant. It
has kL single line external legs, which can carry any field x̄ j but only u-derivatives with indices i = 1, 2. The same applies to
the subgraph on the right, with i = 3, 4, mR and kR . When mL or mR vanish all derivatives belong to the same L or R side.
A symmetric definition of the cubic weights emerging from Wn , namely Vn,L = Vn,R as in (9), is compatible with assigning a
diagram with mR or mL = 0 to Vn,L or Vn,R respectively. With this choice, factorization is achieved by just introducing splitting
fields for even variables. Hence, odd fields only require their own set of splitting fields in diagrams satisfying

mL , mR ≥ 1 ,

mL + mR ≤ N ,

(D3)

with N the order at which we want the perturbative expansion to stop.
Appendix E: A bound on even fields

Without truncation, the bond dimension in the free network doubles when progressing from the coarse graining level 2n to the
level 2n + 1, but remains the same from 2n + 1 to 2n + 2. Namely
χ2n+1 = 2χ2n ,

χ2n+2 = χ2n+1 .

(E1)

18
The reason behind this behaviour is the vanishing of half of the B2n+1 singular values1 , which leads to discard automatically the
associated splitting fields. This property is lost once χmax is reached and actives the truncation preventing the bond dimension
to further grow.
In the presence of interaction, a field can only be discarded when its contribution to entanglement is small both at the level of
the leading gaussian structure and the Feynman graphs. Related to that, in the section V.C we raised the question about the fate
of the fields inherited from the free network and related to vanishing singular values of B2n+1 . We will now prove that they do
not participate in the LR factorization of graphs with mL or mR equal to zero in the notation of (D2).
Since we are interested in odd coarse graining levels, the corresponding lattice fields will be of type p. Analogously to (D1),
the differential operator F̂2n+1 is schematically given by

F̂2n+1 (p̄, ∂u ) =

Z

.

dx

(E2)

For definiteness, we consider a Feynman graph in the expansion of F̂2n+1 with mR = 0. Such diagram only traces back to the
two cubic weights on the left side of the integrand. Its external legs carry the expressions

.

(E3)

The subindices 1, 2 of the u-derivatives refer to the tilted lattice links in (E2), while the subindices 1, 2, 3 in the linear combinations of the p̄ fields allude to the corresponding internal links. Contrary to the u-derivatives, these linear combinations involve
fields from the L and R sides and are the only source of LR cross terms in (E3). The leading gaussian structure does not mix
the fields which have a counterpart in the free network, the set (66), with the fields (67) required to keep the TRG manipulations
local. Therefore although both appear in the previous linear combinations, we can treat them separately. Using this, in the
following we focus on the former and disregard the latter.
It is natural to assign the graph (E3) to the cubic vertex V2n+1,L . The dependence on p̄R should be thus eliminated as explained
in Section IV.B. It results in the substitution



−1
−1
Q−1
2n C2n p̄ = Q2n C2n,L p̄L +C2n,R p̄R −→ Q2n (C2n,L +C2n,R ) p̄L + iC2n,R U2n+1 ∂x1 .

(E4)

All the matrices here are given by the expressions in Appendix B. In particular C2n,L and C2n,R are constructed in terms the
matrices u2n and v2n obtained from the SVD of B2n . Relations (E1) imply that in the absence of truncation, B2n has maximal
rank and thus u2n and v2n are orthogonal matrices instead of just isometries. In that case we have
1
0
T
C2n,L C2n,L = 
0
0


0
2
0
0

0
0
1
0


0
0
⊗ 1χ2n .
0
0

(E5)

The 4 × 4 matrix in the rhs refers to the four internal links in the integrand of (E2). It has rank three because C2n,L does not
couple the fields on the left external links with those on the fourth internal link. Let v be a singular vector of B2n+1 with zero
singular value. Multiplying (B6) by C2n,L , we obtain
Q−1
2n C2n,R v


1,2,3

=0.

(E6)

The rows of the matrix U2n+1 on the rhs of (E4) contain the singular vectors of B2n+1 . Let y1 denote the component of x1 related
to v. The previous equality implies that y1 decouples from the contribution of the graph (E3) to the cubic vertex V2n+1,L .
At first order in perturbation theory mL + mR = 1, and thus mL or mR must be zero. We chose again to assign the associated
Feynman diagram to the L or R cubic weights respectively. The splitting fields related to vanishing singular values of B2n+1 can
then be safely ignored. Therefore at first order in λ , the fields (66) and their leading order gaussian structure coincides precisely
with those of the free network.

19
Let us finally consider a generic Feynman diagram in the expansion of F̂2n+1 . Its external legs can carry

.

If this diagram contributes to V2n+1,L , the following term will appear in some of its external legs
 −1

(Q2n C2n,R v)4 ∂y1 .

(E7)

(E8)

The zero singular value of v does not impose the vanishing of the combination in brackets. Hence, although y1 is irrelevant for
(E3), it can be important to transmit the entanglement created by the general graph (E7). In that case the field y1 should not be
truncated. Analogous reasoning holds for y2 , the component of x2 related to v, when a general graph contributes to V2+1,R . The
even combination ȳ = y1 + y2 will enlarge then the set of fields (66) beyond those present in the free model.

