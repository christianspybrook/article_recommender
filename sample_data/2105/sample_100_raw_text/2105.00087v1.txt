A LOCAL TRACE FORMULA FOR p-ADIC INFINITESIMAL SYMMETRIC
SPACES: THE CASE OF GUO-JACQUET

arXiv:2105.00087v1 [math.RT] 30 Apr 2021

HUAJIE LI

Abstract. We establish an invariant local trace formula for the tangent space of some symmetric
spaces over a non-archimedean local field of characteristic zero. These symmetric spaces are studied
in Guo-Jacquet trace formulae and our methods are inspired by works of Waldspurger and Arthur.
Some other results are given during the proof including a noninvariant local trace formula, Howe's
finiteness for weighted orbital integrals and the representability of the Fourier transform of weighted
orbital integrals. These local results are prepared for the comparison of regular semi-simple terms,
which are weighted orbital integrals, of an infinitesimal variant of Guo-Jacquet trace formulae.

Contents
1. Introduction
2. Notation and preliminaries
3. Symmetric pairs
4. Weighted orbital integrals
5. The noninvariant trace formula
6. Howe's finiteness for weighted orbital integrals
7. Representability of the Fourier transform of weighted orbital integrals
8. Invariant weighted orbital integrals
9. The invariant trace formula
10. A vanishing property at infinity
References

1
4
7
17
21
27
33
41
47
52
55

1. Introduction
The Guo-Jacquet trace formula [15] is a promising tool to generalise Waldspurger's result [32] on the
relation between toric periods and central values of automorphic L-functions for GL2 to higher ranks.
It is inspired by Jacquet's new proof [19] of Waldspurger's theorem. Although such a formula has not
been established in full generality, its simple form was used by Feigon-Martin-Whitehouse [14] to obtain
some evidence for the conjecture of Guo-Jacquet. For applications, one needs to compare geometric sides
of Guo-Jacquet trace formulae for different symmetric pairs. Some local results on the comparison of
relative orbital integrals include Guo's fundamental lemma [15] and Zhang's smooth transfer [37].
In order to study the Guo-Jacquet trace formula and its comparison, one may begin with an infinitesimal variant. That is to say, we replace a symmetric space by its tangent space (called an infinitesimal
symmetric space). Such a variant should share some similarities with the geometric side of Guo-Jacquet
trace formula. It is simpler than the original formula because spectral objects are replaced by the
Fourier transform of geometric objects (cf. [33] and [8]). Moreover, by the method of descent dating
back to Harish-Chandra's works, the comparison at the infinitesimal level should imply the comparison
of geometric sides of original formulae (see [37] on the transfer of orbital integrals).
An infinitesimal variant of Guo-Jacquet trace formulae has been established in [25] and [26] via an
analogue of Arthur's truncation process in [2] (see also [8] for its Lie algebra variant). We actually consider
more general cases suggested by [36] and [28]. Most (namely regular semi-simple) terms appearing in
these formulae can be written as explicit weighted orbital integrals on infinitesimal symmetric spaces
over a number field (see [25, Theorem 9.2] and [26, Theorem 9.2]). They are noninvariant analogues of
ordinary orbital integrals (which can be compared locally thanks to [15] and [37]) and should be the next
Date: May 4, 2021.
1

objects to be compared. As the first evidence, the weighted fundamental lemma has been proved in [26,
Theorem 10.9] thanks to Labesse's work [23] on the base change for GLn .
The same philosophy of Waldspurger's work [34] on the endoscopic transfer has been followed by
Zhang [37] to prove the transfer of local orbital integrals on infinitesimal symmetric spaces of GuoJacquet. A simple form of the local trace formula [37, Lemma 6.5], Howe's finiteness for orbital integrals
[29, Theorem 6.1] and representability of the Fourier transform of orbital integrals [37, Theorem 6.1]
apart from a simple form of the global trace formula [37, Theorem 8.4 and p. 1875] and the fundamental
lemma [37, Lemma 5.18] at the infinitesimal level have been used in Zhang's proof. It is expected that
such a strategy should be extended to the weighted context. In fact, some successful attempts have
been made by Chaudouard in [9] and [10] on the stable base change. We would like to follow these
ideas in the comparison of local weighted orbital integrals on infinitesimal symmetric spaces of GuoJacquet. However, further study in noninvariant local harmonic analysis on infinitesimal symmetric
spaces is needed to achieve our goal. This paper aims to prepare some essential ingredients such as a
noninvariant local trace formula, Howe's finiteness for weighted orbital integrals, representability of the
Fourier transform of weighted orbital integrals and an invariant local trace formula. Our methods are
mainly inspired by the works of Waldspurger's [33] and Arthur's [5].
Let E/F be a quadratic field extension of non-archimedean local fields of characteristic zero. Denote
by D a central division algebra over F and by GLn,D the reductive group over F whose F -points are
GLn (D). We study two generalised cases of Guo-Jacquet trace formulae. The first case is (G, H),
where G := GL2n,D and H := GLn,D Ã— GLn,D denotes its diagonal subgroup by diagonal embedding.
Denote by s the tangent space of the symmetric space G/H at the neutral element, on which H acts by
conjugation. The second case is (Gâ€² , H â€² ), where Gâ€² is the group of invertible elements in a central simple
algebra gâ€² over F containing E, and H â€² is the centraliser of E Ã— in Gâ€² . Denote by sâ€² the corresponding
infinitesimal symmetric space. Notice that (G, H) and (Gâ€² , H â€² ) are the same symmetric pair after a base
change to an algebraic closure of F containing E. In the rest of the introduction and this paper, we shall
focus on results in the first case and provide complete proofs. The second case is similar in statements
and proofs, so we shall only state main results, point out additional ingredients and sketch necessary
steps for later use.
Before explaining the main results of this paper, we introduce some necessary notations. Let Î· be the
quadratic character of F Ã— /N E Ã— attached to E/F , where N is the norm map E Ã— â†’ F Ã— . For x âˆˆ G(F ),
we denote by Nrd(x) its reduced norm. Let Ccâˆž (s(F )) be the space of locally constant, compactly
supported, complex-valued functions on s(F ). Denote by srs âŠ† s the Zariski open subset consisting of
regular semi-simple elements (see Section 3.1). Let M0 be the group of diagonal elements in G, which
is a common minimal
Levi

 subgroup of G and H. A Levi subgroup of G containing M0 is said to be
0 1n
Ï‰-stable if Ï‰ :=
âˆˆ M . Denote by L G,Ï‰ (M0 ) the set of Ï‰-stable Levi subgroups of G. Suppose
1n 0
that M âˆˆ L G,Ï‰ (M0 ). Write m := Lie(M ) and MH := M âˆ© H. Let AM be the maximal F -split torus in
the centre of M . Denote by F G (M ) the set of parabolic subgroups of G containing M . This paper is
organised in the following way.
In Section 2, we fix some notations of local harmonic analysis and recall some facts of Arthur's (G, M )families, most of which can be found in [33, Â§I-II]. In particular, for M âˆˆ L G,Ï‰ (M0 ) and Q âˆˆ F G (M ),
Q
we define the local weight function vM
on G(F ) of main interest by (2.6.1).
In Section 3, we prepare some properties of infinitesimal symmetric spaces. Some of them are stated
for a general symmetric pair and most of them are relative avatars of classical works of Harish-Chandra
[17]. Preliminaries on symmetric pairs can be found in [29] and [1].
In Section 4, we define local weighted orbital integrals for the action of H(F ) on s(F ) and study their
properties. Let M âˆˆ L G,Ï‰ (M0 ) and Q âˆˆ F G (M ). For all f âˆˆ Ccâˆž (s(F )) and X âˆˆ (m âˆ© srs )(F ), we
define
Z
1/2
Q
Q
f (Ad(xâˆ’1 )(X))Î·(Nrd(x))vM
(x)dx,
JM
(Î·, X, f ) := |Ds (X)|F
HX (F )\H(F )

where |Ds (X)|F is the Weyl discriminant factor (see (3.1.1)) and HX denotes the centraliser of X in
Q
H. The distributions JM
(Î·, X, *) on s(F ) are local analogues of the global weighted orbital integrals
obtained in [25, Theorem 9.2].
In Section 5, we establish the noninvariant local trace formula. For f âˆˆ Ccâˆž (s(F )), we define its
Fourier transform fË† by (3.2.1). For M âˆˆ L G,Ï‰ (M0 ), let Tell (m âˆ© s) be a set of representatives for
MH (F )-conjugacy classes of M -elliptic Cartan subspaces in mâˆ©s (see Section 3.2). For f, f â€² âˆˆ Ccâˆž (s(F )),
2

we define
J G (Î·, f, f â€² ) :=

X

MâˆˆL G,Ï‰ (M0 )

|W0Mn ||W0GLn |âˆ’1 (âˆ’1)dim(AM /AG )

X

câˆˆTell (mâˆ©s)

|W (MH , c)|âˆ’1

Z

(câˆ©srs )(F )

G
JM
(Î·, X, f, f â€² )dX,
G
where W0Mn , W0GLn and W (MH , c) are certain Weyl groups (see Section 3.2), and JM
(Î·, X, f, f â€² ) is
defined by (5.1.1).

Theorem 1.1 (see Theorems 5.3 and 5.12). For all f, f â€² âˆˆ Ccâˆž (s(F )), we have the equality
J G (Î·, f, fË†â€² ) = J G (Î·, fË†, f â€² ).

This formula results from the Plancherel formula and an analogue of Arthur's truncation process in
[5]. We cannot deduce it via the exponential map as in [33, Â§V] for lack of a local trace formula for
symmetric spaces. One needs to return to the proof of [5] instead.
In Section 6, we show Howe's finiteness for weighted orbital integrals on s(F ). For r âŠ† s(F ) an open
compact subgroup, denote by Ccâˆž (s(F )/r) the subspace of Ccâˆž (s(F )) consisting of the functions invariant
by translation of r.
Proposition 1.2 (see Corollaries 6.6 and 6.9). Let r be an open compact subgroup of s(F ), M âˆˆ
L G,Ï‰ (M0 ) and Ïƒ âŠ† (m âˆ© srs )(F ). Suppose that there exists a compact subset Ïƒ0 âŠ† (m âˆ© s)(F ) such
that Ïƒ âŠ† Ad((MH )(F ))(Ïƒ0 ). Then there exists a finite subset {Xi : i âˆˆ I} âŠ† Ïƒ and a finite subset
{fi : i âˆˆ I} âŠ† Ccâˆž (s(F )/r) such that for all X âˆˆ Ïƒ and all f âˆˆ Ccâˆž (s(F )/r), we have the equality
X
G
G
G
JM
(Î·, X, f ) =
JM
(Î·, Xi , f )JM
(Î·, X, fi ).
iâˆˆI

The proof originates from Howe's seminal work [18] which is extended to weighted orbital integrals
on Lie algebras by Waldspurger. We modify the argument in [33, Â§IV] to make it apply to our case.
In Section 7, we show that the Fourier transform of weighted orbital integrals on s(F ) is represented
by locally integrable functions on s(F ).
Proposition 1.3 (see Propositions 7.2 and 7.10). Let M âˆˆ L G,Ï‰ (M0 ) and X âˆˆ (m âˆ© srs )(F ). Then
G
there exists a locally constant function ÄµM
(Î·, X, *) on srs (F ) such that for all f âˆˆ Ccâˆž (s(F )), we have
Z
âˆ’1/2
G
G
f (Y )ÄµM
(Î·, X, Y )|Ds (Y )|F dY.
JM
(Î·, X, fË†) =
s(F )

Its proof is similar to that in [33, Â§V] and makes use of the noninvariant trace formula and Howe's
finiteness for weighted orbital integrals.
G
(Î·, X, *)
In Section 8, we modify weighted orbital integrals to obtain Î·(Nrd(*))-invariant distributions IM
G,Ï‰
on s(F ) by (8.1.1) and (8.1.7), where M âˆˆ L
(M0 ) and X âˆˆ (m âˆ© srs )(F ). The method is close to
Arthur's standard one, but it is simpler here since there is no spectral object involved, which is also a
feature of [33]. By the above proposition and the construction via induction, there also exists a locally
âˆž
constant function Ã®G
M (Î·, X, *) on srs (F ) such that for all f âˆˆ Cc (s(F )), we have
Z
âˆ’1/2
s
G
f (Y )Ã®G
dY.
IM
(Î·, X, fË†) =
M (Î·, X, Y )|D (Y )|F
s(F )

In Section 9, we establish the invariant local trace formula. For f, f â€² âˆˆ Ccâˆž (s(F )), we define
Z
X
X
GLn âˆ’1
Mn
âˆ’1
G
â€²
dim(AM /AG )
|W (MH , c)|
I (Î·, f, f ) :=
|W0 ||W0 | (âˆ’1)
MâˆˆL G,Ï‰ (M0 )

câˆˆTell (mâˆ©s)

(câˆ©srs )(F )

G
G
IM
(Î·, X, fË†)IG
(Î·, X, f â€² )dX.

Theorem 1.4 (see Theorems 9.1 and 9.4). For all f, f â€² âˆˆ Ccâˆž (s(F )), we have the equality
I G (Î·, f, f â€² ) = I G (Î·, f â€² , f ).

This formula is deduced from the noninvariant local trace formula. We mainly consult [33, Â§VII] for
the proof.
In Section 10, we prove a vanishing property at "infinity" of the function Ã®G
M (Î·, *, Y ) on (m âˆ© srs )(F ),
where M âˆˆ L G,Ï‰ (M0 ), M 6= G and Y âˆˆ srs (F ). Denote by vF (*) the valuation on F .
3

Proposition 1.5 (see Propositions 10.1 and 10.4). Let M âˆˆ L G,Ï‰ (M0 ), M 6= G. Let X âˆˆ (m âˆ© srs )(F )
and Y âˆˆ srs (F ). Then there exists N âˆˆ N such that if Î» âˆˆ F Ã— satisfies vF (Î») < âˆ’N , we have
Ã®G
M (Î·, Î»X, Y ) = 0.

It is an analogue of [9, Proposition 2.2] and serves as a complement of the limit formula for the function
Ã®G
(Î·,
*, Y ) on srs (F ) in [37, Proposition 7.1], where Y âˆˆ srs (F ). In a subsequent paper, we shall prove
G
â€²
â€²
some relations between the functions Ã®G
M and their analogues for the case of (G , H ), which are related to
the comparison of Guo-Jacquet trace formulae at the infinitesimal level. The above vanishing property
will be used to construct some nice test functions whose Fourier transforms have vanishing nontrivial
weighted orbital integrals.
In the end, we remark that although we concentrate on the case of Guo-Jacquet here, many results
in this paper might be extended to other symmetric pairs, which can be seen from their proofs.
Acknowledgement. This is part of my thesis under the supervision of Pierre-Henri Chaudouard at
the UniversitÃ© de Paris. I am grateful to my thesis advisor for his constant support on this project
and particularly for answering my numerous questions about Waldspurger's and Arthur's papers on
the local trace formula. I would like to thank Jean-Loup Waldspurger for his valuable comments on
my manuscript which pointed out an error in an earlier version. I also thank RaphaÃ«l Beuzart-Plessis
for helpful discussions on general symmetric pairs during my revision of this article. This work was
supported by grants from RÃ©gion Ile-de-France.
2. Notation and preliminaries
2.1. Fields. Let F be a non-archimedean local field of characteristic zero. Denote by | * |F (resp. vF (*))
the normalised absolute value (resp. the valuation) on F and by OF the ring of integers of F . Fix a
uniformiser ÌŸ of OF . Let q be the cardinality of the residue field of OF .
2.2. Groups and the map HP . Let G be a (connected) reductive group defined over F . All algebraic
groups and algebraic varieties in this article are assumed to be defined over F until further notice. Fix
a Levi subgroup M0 of a minimal parabolic subgroup of G.
Denote by AG the maximal F -split torus in the centre of G. Define
aG := HomZ (X(G)F , R),
where X(G)F is the group of F -rational characters of G. Define the homomorphism HG : G(F ) â†’ aG
by
hHG (x), Ï‡i = log(|Ï‡(x)|F )

for all x âˆˆ G(F ) and Ï‡ âˆˆ X(G)F . Set aG,F := HG (G(F )), which is a lattice in aG .
Fix a maximal compact subgroup K = KG of G(F ) which is admissible relative to M0 in the sense
of [3, p. 9]; in other words, K is the stabiliser in G(F ) of a special point in the apartment associated
to AM0 of the Bruhat-Tits building of G. For a central division algebra D over F , we denote by GLn,D
the reductive group over F whose F -points are GLn (D). In this paper, when G = ResE/F GLn,Dâ€² with
Dâ€² being a central division algebra over a finite extension E of F , we choose M0 â‰ƒ (ResE/F Gm,Dâ€² )n to
be the subgroup of diagonal elements in G, and K = GLn (ODâ€² ) with ODâ€² being the ring of integers of
Dâ€² (see [35, p. 191] for example). Set W0G := NormG(F ) (M0 )/M0 (F ) to be the Weyl group of (G, M0 ),
where NormG(F ) (M0 ) denotes the normaliser of M0 in G(F ). It is known that any element in W0G admits
a representative in K.
By a Levi subgroup of G, we mean a group M containing M0 which is the Levi component of some
parabolic subgroup of G. For such a group M , set KM := M (F ) âˆ© K. Then the triplet (M, KM , M0 )
satisfies the same hypotheses as (G, K, M0 ). Denote by F G (M ), P G (M ) and L G (M ) the set of
parabolic subgroups of G containing M , parabolic subgroups of G with Levi factor M and Levi subgroups
of G containing M respectively.
For P âˆˆ F G (M0 ), let MP be the Levi component containing M0 and NP the unipotent radical. Denote
AP := AMP and aP := aMP whose dual R-linear space is denoted by aâˆ—P . Define a map HP : G(F ) â†’ aMP
by
HP (mnk) = HMP (m)
for all m âˆˆ MP (F ), n âˆˆ NP (F ) and k âˆˆ K. Let P âˆˆ P G (MP ) be the parabolic subgroup opposite to P .
For P âŠ† Q a pair of parabolic subgroups in F G (M0 ), the restriction X(MQ )F Ö’â†’ X(MP )F induces
Q
a pair of dual maps aP Ö‰ aQ and aâˆ—Q Ö’â†’ aâˆ—P . Let aQ
P be the kernel of the former map aP Ö‰ aQ . Set âˆ†P
4

âˆ¨
to be the set of simple roots for the action of AP on P âˆ© MQ . Denote by (âˆ†Q
P ) the set of "coroots" as
Q âˆ¨
Q
in [6, p. 26]. Then (âˆ†P ) is a basis of the R-linear space aP .

2.3. Heights. We fix a height function k * k : G(F ) â†’ R as in [5, Â§4]. It satisfies the following properties:
(1) kxk â‰¥ 1, âˆ€x âˆˆ G(F );
(2) kxyk â‰¤ kxkkyk, âˆ€x, y âˆˆ G(F );
(3) there exist constants c > 0 and N âˆˆ N such that kxâˆ’1 k â‰¤ ckxkN , âˆ€x âˆˆ G(F ).
If P âˆˆ F G (M0 ), for any x âˆˆ G(F ), we can choose mP (x) âˆˆ MP (F ), nP (x) âˆˆ NP (F ) and kP (x) âˆˆ K
such that x = mP (x)nP (x)kP (x). Then
(4) there exist constants c > 0 and N âˆˆ N such that kmP (x)k + knP (x)k â‰¤ ckxkN , âˆ€x âˆˆ G(F ).
We also fix a Euclidean norm (still denoted by k * k) on the R-linear space aM0 which is invariant
under the action of W0G on aM0 . Then
(5) there exist c1 , c2 > 0 such that
c1 (1 + log kyk) â‰¤ 1 + kHM0 (y)k â‰¤ c2 (1 + log kyk), âˆ€y âˆˆ M0 (F ).
In addition, we require that k * k is a norm on G(F ) in the sense of [22, Â§18.2]. This is possible. For
example, for G = GLn , by writing (g, g âˆ’1 ) = (gij , hij )1â‰¤i,jâ‰¤n , one may define kgk := sup{|gij |F , |hij |F }
i,j

for g âˆˆ G(F ). Since {gij , hij }1â‰¤i,jâ‰¤n is a set of generators for the ring of regular functions of G (viewed
as an affine variety over F ), this defines a norm in the sense of [22, Â§18.2] on GLn (F ). For general G,
one can choose an closed embedding G â†’ GLn over F and define the norm on G(F ) by the pull-back
of the norm on GLn (F ). By [22, Proposition 18.1.(2)], this defines a norm in the sense of [22, Â§18.2] on
G(F ).
2.4. Functions and distributions. Let g := Lie(G). More generally, we shall use a minuscule Fraktur
letter to denote the Lie algebra of its corresponding algebraic group. Denote by Ad the adjoint action
of G on itself or g. The adjoint action of g on itself is denoted by ad.
For a locally compact and totally disconnected topological space X (e.g. G(F ) or g(F )), denote
by Ccâˆž (X) the space of locally constant, compactly supported, complex-valued functions on X. For
f âˆˆ Ccâˆž (X), denote by Supp(f ) its support. Denote by Ccâˆž (X)âˆ— the space of distributions on X, i.e., the
linear dual of Ccâˆž (X).
Suppose that there is a left action of G(F ) on such an X. Then G(F ) acts on Ccâˆž (X) (or more
generally the space of complex functions on X) from the left by
g * f (x) := f (g âˆ’1 * x), âˆ€g âˆˆ G(F ), f âˆˆ Ccâˆž (X), x âˆˆ X.

Moreover, G(F ) acts on Ccâˆž (X)âˆ— from the left by

g * d(f ) := d(g âˆ’1 * f ), âˆ€g âˆˆ G(F ), d âˆˆ Ccâˆž (X)âˆ— , f âˆˆ Ccâˆž (X).

Let Î· : G(F ) â†’ CÃ— be a locally constant character. We say a function f âˆˆ Ccâˆž (X) (resp. a distribution
d âˆˆ Ccâˆž (X)âˆ— ) is Î·-invariant if g * f = Î·(g)f (resp. g * d = Î·(g)d) for all g âˆˆ G(F ). For trivial Î·, we simply
say that such a function (resp. distribution) is invariant.
2.5. Haar measures. Fix the Haar measure on K such that vol(K) = 1. Following [33, Â§I.4], for all
P âˆˆ F G (M0 ), we fix a Haar measure on NP (F ) such that
Z
exp(2ÏP (HP (n)))dn = 1,
NP (F )

where ÏP is the half of the sum of roots (with multiplicity) associated to the parabolic subgroup P
opposite to P . From [5, p. 12], for all M âˆˆ L G (M0 ), there are compatible Haar measures on G(F ) and
M (F ) such that for all P âˆˆ P G (M ) and f âˆˆ Ccâˆž (G(F )), we have
Z
Z
f (mnk)dkdndm.
f (x)dx =
G(F )

M(F )Ã—NP (F )Ã—K

We shall fix such measures.
For a F -split torus T , we choose the Haar measure on T (F ) such that the maximal compact subgroup
of T (F ) is of volume 1. For a general torus T , we choose the Haar measure on T such that the induced
measure on T (F )/AT (F ) satisfies vol(T (F )/AT (F )) = 1.
Notice that if M0 is a torus, we have associated to it two measures. However, it will be clear which
one should be used according to the context.
5

Fix open neighbourhoods Vg of 0 in g(F ) and VG of 1 in G(F ) such that the exponential map
exp : Vg â†’ VG induces a homeomorphism between them. Choose the unique Haar measure on g(F )
such that exp preserves the measures. Similarly, we obtain Haar measures on F -points of Lie algebras
of algebraic subgroups of G.
From the fixed Euclidean norm k * k on aM0 , we deduce measures on aM0 and its subspaces.
2.6. (G, M )-families. Following [3, p. 15], we define
Q âˆ¨ âˆ’1
Î¸PQ (Î») := vol(aQ
P /Z(âˆ†P ) )

Y

âˆ¨
Î±âˆ¨ âˆˆ(âˆ†Q
P)

Î»(Î±âˆ¨ ), âˆ€Î» âˆˆ iaâˆ—P ,

Q
Q âˆ¨
âˆ¨
where Z(âˆ†Q
P ) denotes the lattice in aP generated by (âˆ†P ) .
Suppose that M âˆˆ L G (M0 ) and that Q âˆˆ F G (M ). Let (cP )P âˆˆP G (M) be a (G, M )-family in the
sense of [3, p. 36]. By [3, Lemma 6.2], we can define
X
cP (Î»)Î¸PQ (Î»)âˆ’1 .
cQ
:=
lim
M
Î»â†’0

{P âˆˆP G (M):P âŠ†Q}

We sometimes write cM := cG
M if Q = G.
An important example is following. According to [3, p. 40-41], for x âˆˆ G(F ),
vP (Î», x) := eâˆ’Î»(HP (x)) , âˆ€Î» âˆˆ iaâˆ—M , P âˆˆ P G (M ),
is a (G, M )-family (denoted by (vP (x))P âˆˆP G (M) ). Then we obtain a function
X
Q
(2.6.1)
vM
(x) := lim
vP (Î», x)Î¸PQ (Î»)âˆ’1 , âˆ€x âˆˆ G(F ).
Î»â†’0

{P âˆˆP G (M):P âŠ†Q}

For a smooth function cP (Î») on iaâˆ—P , we can associate to it a smooth function câ€²P (Î») on iaâˆ—P as in
[3, (6.3) in Â§6]. Denote by câ€²P the value of câ€²P (Î») at Î» = 0. Let (cP )P âˆˆP G (M) and (dP )P âˆˆP G (M) be
two (G, M )-families, we define their product ((cd)P )P âˆˆP G (M) in the obvious way and have the following
product formula (see [3, Lemma 6.3])
X
(2.6.2)
(cd)M =
câ€²Q dQ
M.
QâˆˆF G (M)

G
2.7. The maps dG
M and s. Suppose that M âˆˆ L (M0 ). As in [4, p. 356], we define a map
G
G
dG
M : L (M ) Ã— L (M ) â†’ Râ‰¥0

such that for all (L1 , L2 ) âˆˆ L G (M ) Ã— L G (M ),
G
(1) dG
M (G, M ) = dM (M, G) = 1;
G
(2) dM (L1 , L2 ) = dG
M (L2 , L1 );
L1
L2
(3) dG
(L
,
L
)
=
6
0
if and only if aG
1
2
M
M = aM âŠ• aM .
Following [33, Â§II.4], we also choose a map (not unique)
s : L G (M ) Ã— L G (M ) â†’ F G (M ) Ã— F G (M )
such that for all (L1 , L2 ) âˆˆ L G (M ) Ã— L G (M ),
(4) s(L1 , L2 ) âˆˆ P G (L1 ) Ã— P G (L2 );
(5) if s(L1 , L2 ) = (Q1 , Q2 ), then s(L2 , L1 ) = (Q2 , Q1 );
(6) (splitting formula) if (cP )P âˆˆP G (M) and (dP )P âˆˆP G (M) are (G, M )-families, we have the equality
X
Q1 Q2
(cd)M =
dG
M (L1 , L2 )cM cM ,
L1 ,L2 âˆˆL G (M)

where (Q1 , Q2 ) := s(L1 , L2 );
(7) (descent formula) if (cP )P âˆˆP G (M) is a (G, M )-family and L âˆˆ L G (M ), we have the equality
X
â€²
â€² Q
cL =
dG
M (L, L )cM ,
Lâ€² âˆˆL G (M)

where Qâ€² denotes the second component of s(L, Lâ€² ).
6

3. Symmetric pairs
3.1. General cases. Following [1, Definition 7.1.1], by a symmetric pair, we mean a triple (G, H, Î¸)
where H âŠ† G are a pair of reductive groups, and Î¸ is an involution on G such that H is the subgroup of
fixed points of Î¸.
Suppose that (G, H, Î¸) is a symmetric pair. Let g := Lie(G) and h := Lie(H). Write dÎ¸ for the
differential of Î¸. Then
h = {X âˆˆ g : (dÎ¸)(X) = X}.
Define
S := {x âˆˆ G : xÎ¸(x) = 1},
on which G acts by
x * s := xsÎ¸(x)âˆ’1 , âˆ€x âˆˆ G, s âˆˆ S.
We have a symmetrization map G/H â†’ S defined by x 7â†’ xÎ¸(x)âˆ’1 which identifies the symmetric space
G/H with the G-orbit of the neutral element on S. The induced action of H on S is the conjugation by
H. Let s be the tangent space at the neutral element of S. Then
s = {X âˆˆ g : (dÎ¸)(X) = âˆ’X},

on which H acts by restriction of the adjoint action. Notice that
g = h âŠ• s.

For X âˆˆ s, denote by HX (resp. gX , hX , sX ) the centraliser of X in H (resp. g, h, s).
We say an element X âˆˆ s is semi-simple if the orbit Ad(H)(X) is Zariski closed in s. By [29, Fact A, p.
108-109], X âˆˆ s(F ) is semi-simple if and only if Ad(H(F ))(X) is closed in s(F ) in the analytic topology.
We say an element X âˆˆ s is regular if HX has minimal dimension. It is known that X âˆˆ s is regular
if and only if gX (or sX ) has minimal dimension (cf. [21, Proposition 7]). Denote by srs the subset
of s consisting of regular semi-simple elements in s. For X âˆˆ s, consider the characteristic polynomial
det(Î» âˆ’ ad(X)|g ). Denote by Ds (X) be the coefficient of the least power of Î» appearing nontrivially in
this polynomial. Then Ds (X) is an H-invariant polynomial on s. From [29, end of p. 107], we know
that X âˆˆ s is regular semi-simple if and only if Ds (X) 6= 0. Thus srs is a principal Zariski open subset
of s.
By a Cartan subspace of s, we mean a maximal abelian subspace for the Lie bracket c âŠ† s (defined
over F ) consisting of semi-simple elements. For such c, let creg := c âˆ© srs . By [24, Theorem 5.1 and
Corollary of Theorem 5.2], if c âŠ† s is a Cartan subspace, then the centraliser of c in s is c itself. By [24,
Corollary 2 of Theorem 3.2], if X âˆˆ srs (F ), then sX is a Cartan subspace of s. Hence, if X âˆˆ creg (F )
with c âŠ† s being a Cartan subspace, then sX = c because of the maximality. By [24, Corollary 2 of
Theorem 4.1], all Cartan subspaces of s are of the form sX where X âˆˆ srs (F ). By [31, p. 323], all Cartan
subspaces of s are conjugate by H over an algebraic closure of F . In particular, all Cartan subspaces of
s have the same dimension.
For a Cartan subspace c âŠ† s, denote by Tc the centraliser of c in H and set tc := Lie(Tc ). It is known
that if X âˆˆ creg (F ) with c âŠ† s being a Cartan subspace, then HX = Tc (see [29, p. 112]). Note that Tc
is not necessarily a torus in general (though it is always a torus in cases of main interest in this paper
thanks to Corollary 3.11.3)).
For X âˆˆ s(F ), we define the Weyl discriminant factor
1/2

|Ds (X)|F := |Ds (X)|F .

From the above discussion, we see that if X âˆˆ c(F ) with c âŠ† s being a Cartan subspace, then
1/2

|Ds (X)|F = | det(ad(X)|h/tc âŠ•s/c )|F .

(3.1.1)

For a Cartan subspace c âŠ† s, set W (H, c) := NormH(F ) (c)/Tc (F ) to be its Weyl group, where
NormH(F ) (c) denotes the normaliser of c in H(F ). Fix a set T (s) of representatives for H(F )-conjugacy
classes of Cartan subspaces in s, which is a finite set by [29, p. 105]. Then we have the Weyl integration
formula (see [29, p. 106])
Z
Z
Z
X
|W (H, c)|âˆ’1
|Ds (X)|F
(3.1.2)
f (X)dX =
f (Ad(xâˆ’1 )(X))dxdX
s(F )

câˆˆT (s)

creg (F )

Tc (F )\H(F )

for all f âˆˆ Ccâˆž (s(F )). Recall that the adjoint action induces a local isomorphism Î² : (Tc (F )\H(F )) Ã—
creg (F ) â†’ srs (F ) of F -analytic manifolds, whose image is open in srs (F ). Here we should use compatible
Haar measures on s(F ) and creg (F ), i.e., we require that Î² should preserve the measures. For particular
7

cases to be considered, we shall fix Haar measures on s(F ) in the following sections. Notice that we shall
not use the Haar measure on creg (F ) obtained via the exponential map.
The lemma below makes the definition of Fourier transform on s(F ) possible.
Lemma 3.1. Let (G, H, Î¸) be a symmetric pair. Then there exists a G-invariant Î¸-invariant nondegenerate symmetric bilinear form h*, *i on g. In particular, g = h âŠ• s is an orthogonal direct sum with
respect to h*, *i, and the restriction of h*, *i to h or s is non-degenerate.
Proof. This is [1, Lemma 7.1.9].



The following lemma is a special case of [38, Lemma 3.10], which is an analogue of Harish-Chandra's
compactness lemma [17, Lemma 25].
Lemma 3.2. Let Ïƒs be a compact subset of s(F ). Suppose that c is a Cartan subspace of s. Let Ïƒc be a
compact subset of creg (F ). Then
{x âˆˆ Tc (F )\H(F ) : Ad(xâˆ’1 )(Ïƒc ) âˆ© Ïƒs 6= âˆ…}

is relatively compact in Tc (F )\H(F ).

s
Proof. Choose an arbitrary X âˆˆ Ïƒc . We have HX = Tc . Let NAd(H)(X),X
be the normal space (see [1,
Notation 2.3.3]) to Ad(H)(X) in s at the point X. By [1, Proposition 7.2.1], since X âˆˆ s is semi-simple,
s
one has NAd(H)(X),X
â‰ƒ sX as HX -spaces. Note that since X âˆˆ creg , creg âŠ† sX is an Ã©tale Luna slice at
X in the sense of [1, Theorem A.2.3]. Thus we can apply [38, Lemma 3.10].


Denote by F [s]H the F -algebra of H-invariant polynomial functions on s. For c âŠ† s a Cartan subspace,
denote by F [c]W (H,c) the F -algebra of W (H, c)-invariant polynomial functions on c. An analogue of
Chevalley restriction theorem holds for symmetric spaces.
Lemma 3.3. 1) Let c be a Cartan subspace of s. The restriction
F [s]H â†’ F [c]W (H,c)

is an isomorphism.
2) The F -algebra F [s]H has a finite system of algebraically independent homogeneous generators.
Proof. See [30, Theorem 7 and Corollary of Theorem 8] and [29, Proposition 2.3].



The next lemma is an analogue of [17, Lemma 28].
Lemma 3.4. Let Ïƒ âŠ† s(F ) be a compact subset. Let c be a Cartan subspace of s. Then c(F ) âˆ©
Cl(Ad(H(F ))(Ïƒ)) is relatively compact in c(F ), where Cl denotes the closure of a subset in s(F ).
Proof. This is [37, Lemma 6.12], whose proof relying on Lemma 3.3 applies to an arbitrary symmetric
pair.

The following lemma is an analogue of [33, Lemme III.4].
Lemma 3.5. Let Ïƒ âŠ† s(F ) be a compact subset. Let c be a Cartan subspace of s and Tc the centraliser of
c in H. Then there exists cÏƒ > 0 such that for all x âˆˆ H(F ) and X âˆˆ creg (F ) satisfying Ad(xâˆ’1 )(X) âˆˆ Ïƒ,
we have
inf log kÏ„ xk â‰¤ cÏƒ sup{1, âˆ’ log |Ds (X)|F }.
Ï„ âˆˆTc (F )

Proof. Let k * kTc \H be any norm on (Tc \H)(F ) in the sense of [22, Â§18.2]. Applying the argument of
[22, Lemma 20.3] to the finite morphism
Î² : (Tc \H) Ã— creg â†’ srs

of affine algebraic varieties defined by Î²(x, X) := Ad(xâˆ’1 )(X), we show the inequality
log kxkTc \H â‰¤ cÏƒ sup{1, âˆ’ log |Ds (X)|F }.

By [22, Proposition 18.3], the quotient H â†’ Tc \H has the norm descent property in the sense of [22,
Â§18.6]. That is to say, the restriction of k * kTc \H to Tc (F )\H(F ) is equivalent to the abstract norm
inf Ï„ âˆˆTc (F ) kÏ„ * k on Tc (F )\H(F ).

The lemma below is an analogue of [17, Lemma 44].
Lemma 3.6. There exists Îµ > 0 such that the function |Ds (X)|âˆ’Îµ
F is locally integrable on c(F ) for any
Cartan subspace c of s.
8

Proof. See [38, Lemma 4.3].



Corollary 3.7. For any r â‰¥ 0, the function sup{1, âˆ’ log |Ds (X)|F }r is locally integrable on c(F ) for
any Cartan subspace c of s.
Proof. We have the elementary fact (cf. the proof of [22, Corollary 20.2]): for Îµ > 0 and r â‰¥ 0, there
exists c > 0 such that
sup{1, log y}r â‰¤ cy Îµ + 1, âˆ€y > 0.
Then it suffices to apply Lemma 3.6.



We say an element X âˆˆ s(F ) is nilpotent if 0 âˆˆ Cl(Ad(H(F ))(X)), where Cl denotes the closure of a
subset in s(F ). From [1, Lemmas 2.3.12 and 7.3.8], we know that X âˆˆ s(F ) is nilpotent if and only if it
is a nilpotent element in g. Denote by N s the set of nilpotent elements in s(F ), which is a cone. The
following lemma is an analogue of Jacobson-Morozov theorem.
Lemma 3.8. Let (G, H, Î¸) be a symmetric pair and X âˆˆ N s . Then there exists a group homomorphism
Ï† : SL2 (F ) â†’ G(F ) such that






0 1
0 0
t
dÏ†
= X, dÏ†
âˆˆ s(F ) and Ï†
âˆˆ H(F ), âˆ€t âˆˆ F Ã— .
0 0
1 0
tâˆ’1
Proof. This is [1, Lemma 7.1.11].



Let X âˆˆ srs (F ). The orbital integral of X is the distribution IX on s(F ) defined by
Z
1/2
f (Ad(xâˆ’1 )(X))dx.
(3.1.3)
âˆ€f âˆˆ Ccâˆž (s(F )), IX (f ) := |Ds (X)|F
HX (F )\H(F )

The next lemma is an analogue of Harish-Chandra's submersion principle [17, Theorem 11].
Lemma 3.9. Let I : srs (F ) â†’ C be a function. The following conditions are equivalent:
(1) I is locally constant, invariant by the adjoint action of H(F ) and of support included in Ad(H(F ))(Ïƒ)
with Ïƒ âŠ† srs (F ) a compact subset;
(2) there exists f âˆˆ Ccâˆž (srs (F )) such that
âˆ€X âˆˆ srs (F ), I(X) = IX (f ).
Proof. For c âˆˆ T (s), apply the argument of [11, Lemme 6.1] to the morphism
âˆ’1

defined by Î¦c (x, X) := Ad(x

Î¦c : (Tc (F )\H(F )) Ã— creg (F ) â†’ srs (F )
)(X). Then glue the results for all c âˆˆ T (s) together.



3.2. The case of (G, H). Let D be a central division algebra over F . Let g be the associative algebra
of 2n Ã— 2n matrices with entries in D. Denote by G := gÃ— = GL2n,D the group of invertible
 elements

1n
in g. Equipped with the Lie bracket, g is identified with the Lie algebra of G. Let Ç« :=
.
âˆ’1n
Denote by H the subgroup of fixed points of the involution Ad(Ç«) on G. Then H = GLn,D Ã— GLn,D is
diagonally embedded into G. Define
S := {x âˆˆ G : xAd(Ç«)(x) = 1}
and its tangent space at the neutral element
s := {X âˆˆ g : Ad(Ç«)(X) = âˆ’X}.
Then we have
and

g=hâŠ•s

1
dim g.
2
Let M0 be the group of diagonal elements in G, which is a common minimal Levi subgroup of G and H.
For a linear subspace v âŠ† g, we write vÃ— := v âˆ© G.
Note that the F -rank of G is 2n. Denote Gn := G, Hn := H and sn := s. Recall the following
description of semi-simple elements and descendants (see [1, Definition 7.2.2]).
dim s = dim h =

9

Proposition 3.10. The results below hold for F being any field of characteristic zero.
1) An element X of s(F ) is semi-simple if and only if it is H(F )-conjugate to an element of the form
ï£«
ï£¶
0 0 1m 0
ï£¬ 0 0 0 0 ï£·
ï£·
X(A) := ï£¬
ï£­ A 0 0 0 ï£¸
0 0 0 0

with A âˆˆ GLm (D) being semi-simple in the usual sense. More precisely, the set of H(F )-conjugacy
classes of semi-simple elements of s(F ) is bijective to the set of pairs (m, [A]) where 0 â‰¤ m â‰¤ n is an
integer and [A] is a semi-simple conjugacy class in GLm (D). Moreover, X(A) is regular semi-simple if
and only if m = n and A is regular semi-simple in GLn (D) in the usual sense.
2) Let X = X(A) âˆˆ s(F ) be semi-simple. Then the descendant (HX , sX ) (as a representation) is
isomorphic to
((GLm,D )A , (glm,D )A ) Ã— (Hnâˆ’m , snâˆ’m ),
where (GLm,D )A (resp. (glm,D )A ) denotes the centraliser of A in GLm,D (resp. glm,D ).

Proof. This is stated in [36, Proposition 5.2] for a non-archimedean local field of characteristic zero, but
its proof included in [20, Propositions 2.1 and 2.2] is valid for any field of characteristic zero.

Corollary 3.11. We have
1) srs âŠ† sÃ— ;
âˆš
2) for X âˆˆ srs , HX is a torus of dimension 21 dim g;
3) for c âŠ† s a Cartan subspace, Tc is a torus of dimension

1
2

âˆš
dim g.

Proof. 1) and 2) are clear from Proposition 3.10 applied to an algebraic closure of F . 3) results from 2)
since for c âŠ† s a Cartan subspace, Tc = HX for any X âˆˆ creg 6= âˆ….

Lemma 3.12. Let P be a parabolic subgroup of G. Then P âˆ© H is a parabolic subgroup of H if and only
if Ç« âˆˆ P . Moreover, if Ç« belongs to a Levi factor M of P , then M âˆ© H is a Levi factor of P âˆ© H.
Proof. One may consider all the groups over an algebraic closure of F . We first suppose that P âˆ© H is
a parabolic subgroup of H. Then Ç« âˆˆ Cent(H) âŠ† P âˆ© H, where Cent(H) denotes the centre of H. This
establishes one direction.
We now suppose that Ç« âˆˆ P . Denote by N the unipotent radical of P and let M be a Levi factor of P .
By the argument in the last paragraph of the proof of [25, Lemma 4.4], we show that Ç« is N -conjugate to
an element in M with the help of [2, Lemma 2.1] (actually we need its variant over a local field for the
characteristic function of a singleton here, whose proof is similar). Then replacing M by its N -conjugate
if necessary, we may assume that Ç« âˆˆ M .
Let G = GL(V ) for a vector space V = âŠ•1â‰¤iâ‰¤r Vi . Suppose that
and that

P = {g âˆˆ G : g(V1 âŠ• ... âŠ• Vi ) âŠ† V1 âŠ• ... âŠ• Vi , âˆ€1 â‰¤ i â‰¤ r}

M = {g âˆˆ G : g(Vi ) âŠ† Vi , âˆ€1 â‰¤ i â‰¤ r}.
Since Ç« âˆˆ M , we have Ç«(Vi ) âŠ† Vi for all 1 â‰¤ i â‰¤ r. Let Vi+ (resp. Viâˆ’ ) be the +1(resp. âˆ’1)-eigenspace of
Vi under the action of Ç«. For Ç«2 = 1, we have Vi = Vi+ âŠ•Viâˆ’ . Let V + := âŠ•1â‰¤iâ‰¤r Vi+ and V âˆ’ := âŠ•1â‰¤iâ‰¤r Viâˆ’ .
Then
H = {g âˆˆ G : g(V + ) âŠ† V + , g(V âˆ’ ) âŠ† V âˆ’ }.
Hence,
P âˆ© H = {g âˆˆ G : g(V1+ âŠ• ... âŠ• Vi+ ) âŠ† V1+ âŠ• ... âŠ• Vi+ , g(V1âˆ’ âŠ• ... âŠ• Viâˆ’ ) âŠ† V1âˆ’ âŠ• ... âŠ• Viâˆ’ , âˆ€1 â‰¤ i â‰¤ r}.

It means exactly that P âˆ© H is a parabolic subgroup of H and proves the other direction. Morover,
M âˆ© H = {g âˆˆ G : g(Vi+ ) âŠ† Vi+ , g(Viâˆ’ ) âŠ† Viâˆ’ , âˆ€1 â‰¤ i â‰¤ r}.

That is to say, M âˆ© H is a Levi factor of P âˆ© H.



0 1n
. For P âˆˆ F G (M0 ), we say that P is "Ï‰-stable" if Ï‰ âˆˆ P . Denote by F G,Ï‰ (M0 )
Set Ï‰ :=
1n 0
the subset of Ï‰-stable parabolic subgroups in F G (M0 ). For M âˆˆ L G (M0 ), we say that M is "Ï‰-stable"
if Ï‰ âˆˆ M . Notice that M is Ï‰-stable if and only if M = MP for some P âˆˆ F G,Ï‰ (M0 ). Denote by
L G,Ï‰ (M0 ) the subset of Ï‰-stable Levi subgroups in L G (M0 ). Let An be the group of diagonal matrices
in GLn , which is a minimal Levi subgroup of GLn . For Mn âˆˆ L GLn (An ), denote by Mn,D the reductive
10

group over F whose F -points are Mn (D) and let mn,D := Lie(Mn,D ); in particular, the notion An,D

Ã—
mn,D mn,D
makes sense. There is a bijection Mn 7â†’ M =
between L GLn (An ) and L G,Ï‰ (M0 ) (cf.
mn,D mn,D
[25, Proposition 5.2]). We shall always use the notation Mn to denote the preimage of M under this
bijection. Notice that if M âˆˆ L G,Ï‰ (M0 ) and Q âˆˆ F G (M ), then Q âˆˆ F G,Ï‰ (M0 ).
Suppose that M âˆˆ L G,Ï‰ (M0 ). If X âˆˆ m âˆ© s, then AM âŠ† HX . We say an element X âˆˆ (m âˆ© srs )(F ) is
M -elliptic if AM is the maximal F -split torus in HX (which is a torus by Corollary 3.11.2)). Denote by
(m âˆ© srs )(F )ell the set of M -elliptic elements in (m âˆ© srs )(F ). Write MH := M âˆ© H. For X âˆˆ (m âˆ© srs )(F ),
let [X]MH be the MH (F )-conjugacy class of X. Denote by Î“ell ((m âˆ© srs )(F )) the set of MH (F )-conjugacy
classes in (m âˆ© srs )(F )ell . If c âŠ† m âˆ© s is a Cartan subspace, then AM âŠ† Tc . We say a Cartan subspace
c âŠ† m âˆ© s is M -elliptic if AM is the maximal F -split torus in Tc (which is a torus by Corollary 3.11.3)).
Since (MH , m âˆ© s) appears as the product of some copies of the form (H, s) in lower dimensions (cf. [25,
Â§5.1]), we define W (MH , c) and T (m âˆ© s) as in Section 3.1. In our notation, we write (m âˆ© s)rs for the
Zariski open subset of m âˆ© s consisting of regular semi-simple elements with respect to the MH -action.
By Proposition 3.10 and its product form, we see that m âˆ© srs âŠ† (m âˆ© s)rs . Since a Cartan subspace
is generally the same as the centraliser of a regular semi-simple element, we also deduce that a Cartan
subspace of m âˆ© s is nothing but a Cartan subspace of s contained in m âˆ© s. Denote by Tell (m âˆ© s) the
subset of representatives that are M -elliptic Cartan subspaces in T (m âˆ© s).
Lemma 3.13. Let M âˆˆ L G,Ï‰ (M0 ) and [X]MH âˆˆ Î“ell ((m âˆ© srs )(F )).
1) Let M â€² âˆˆ L G,Ï‰ (M0 ) and [X â€² ]MHâ€² âˆˆ Î“ell ((mâ€² âˆ© srs )(F )) be such that X â€² is H(F )-conjugate to X.
Then there exists



wn
GL
: wn âˆˆ W0 n,D ,
wâˆˆ
wn
GLn,D

where W0

denotes the Weyl group of (GLn,D , An,D ), such that
(Ad(w)(M ), [Ad(w)(X)]Ad(w)(M)âˆ©H ) = (M â€² , [X â€² ]MHâ€² ).

2) The cardinality of
{(M â€² , [X â€² ]MHâ€² ) : M â€² âˆˆ L G,Ï‰ (M0 ), [X â€² ]MHâ€² âˆˆ Î“ell ((mâ€² âˆ© srs )(F )), X â€² is H(F )-conjugate to X}
is
|W0GLn ||W0Mn |âˆ’1 ,

where W0GLn (resp. W0Mn ) denotes the Weyl group of (GLn , An ) (resp. (Mn , An )).
Proof. 1) Let x âˆˆ H(F ) be such that Ad(x)(X) = X â€² . Then Ad(x)(HX ) = HX â€² . Since X âˆˆ (mâˆ©srs )(F )ell
and X â€² âˆˆ (mâ€² âˆ© srs )(F )ell , we have Ad(x)(AM ) = AM â€² and thus Ad(x)(M ) = M â€² . As x âˆˆ H(F ), we
â€²
â€²
is a maximal F -split torus, so there exists
have Ad(x)(MH ) = MH
. We see that Ad(x)(AM0 ) âŠ† MH
âˆ’1
â€²
â€²
â€² âˆ’1
m âˆˆ MH (F ) such that Ad(m x)(AM0 ) = AM0 . That is to say, wâ€² := mâ€² x âˆˆ NormH(F ) (AM0 ) =
NormH(F ) (M0 ), where NormH(F ) (AM0 ) denotes the normaliser of AM0 in H(F ). Now Ad(x)(AM ) = AM â€²
in [25, Â§9.1]
implies that Ad(wâ€² )(AM ) = AM â€² . Because M, M â€² âˆˆ L G,Ï‰ (M
0 ), it is shown
 that any


w
GL
n
: wn âˆˆ W0 n,D . Hence,
isomorphism AM â†’ AM â€² induced by W0H can be given by
w
n



wn
GL
: wn âˆˆ W0 n,D such that wâˆ’1 wâ€² âˆˆ CentW0H (AM ) = W0MH , where
there exists w âˆˆ
wn
CentW0H (AM ) denotes the centraliser of AM in W0H . We can check that such a w satisfies the condition
in the lemma.



wn
GLn,D
acts transitively on this set. Let
2) By 1), the group
: wn âˆˆ W0
wn



wn
GLn,D
: wn âˆˆ W0
wâˆˆ
wn
be such that
(Ad(w)(M ), [Ad(w)(X)]Ad(w)(M)âˆ©H ) = (M, [X]MH ).
Then w âˆˆ MH (F ). Thus the condition on w is equivalent to



wn
Mn,D
,
: wn âˆˆ W0
wâˆˆ
wn
11

M

where W0 n,D denotes the Weyl group of (Mn,D , An,D ). We see that the cardinality of the set in the
GL
M
lemma is |W0 n,D ||W0 n,D |âˆ’1 or |W0GLn ||W0Mn |âˆ’1 .

Proposition 3.14. For f âˆˆ Ccâˆž (s(F )), we have the equality
Z
Z
X
X
|W (MH , c)|âˆ’1
f (X)dX =
|W0Mn ||W0GLn |âˆ’1
s(F )

MâˆˆL G,Ï‰ (M0 )

creg (F )

câˆˆTell (mâˆ©s)

|Ds (X)|F

Z

AM (F )\H(F )

f (Ad(xâˆ’1 )(X))dxdX.
Proof. From [25, beginning of Â§9.2], any H(F )-conjugacy class in srs (F ) is the image of a class [X]MH âˆˆ
Î“ell ((m âˆ© srs )(F )) for some M âˆˆ L G,Ï‰ (M0 ). By Lemma 3.13, the Weyl integration formula (3.1.2) can
be written as the above equality (cf. [5, p. 16-17] and [33, (3) in Â§I.3]).

For Pn âˆˆ L GLn (An ), denote by Pn,D the algebraic group over F whose F -points are Pn (D) and let

Ã—
pn,D pn,D
pn,D := Lie(Pn,D ). There is a bijection Pn 7â†’ P =
between F GLn (An ) and F G,Ï‰ (M0 )
pn,D pn,D
(cf. [25, Proposition 5.2]). We shall always use the notation Pn to denote the preimage of P under this
bijection. Following [37, p. 1846], we shallfix the Haar measures
on some

 subspaces of s(F ) as follows.
m
m
nPn,D nPn,D
P
P
n,D
n,D
Let P âˆˆ F G,Ï‰ (M0 ). Then we have mP =
and nP =
. We have fixed
mPn,D mPn,D
nPn,D nPn,D
the Haar measures on mPn,D (F ) and nPn,D (F ) in Section 2.5. We shall choose the same Haar measure
for any of the four copies in mP (F ) or nP (F ) under these identifications. In particular, we obtain the
Haar measures on (mP âˆ© s)(F ) and (nP âˆ© s)(F ).
Lemma 3.15. Let Q âˆˆ F G,Ï‰ (M0 ). For Y âˆˆ (mQ âˆ© srs )(F ), the map

NQH (F ) â†’ (nQ âˆ© s)(F ), n 7â†’ Ad(nâˆ’1 )(Y ) âˆ’ Y
1/2

âˆ’1/2

is an isomorphism of F -analytic manifolds whose Jacobian is |Ds (Y )|F |DmQ âˆ©s (Y )|F

.

Proof. See [25, Lemma 8.1] for the isomorphism and the proof of [37, Proposition 6.3.(ii)] for the Jacobian.

Fix a continuous and nontrivial unitary character Î¨ : F â†’ CÃ— . Let h*, *i be the non-degenerate
symmetric bilinear form on g(F ) defined by
hX, Y i := Trd(XY ), âˆ€X, Y âˆˆ g(F ),
where Trd denotes the reduced trace on g(F ). It is invariant by the adjoint action of G(F ) and Ad(Ç«).
For f âˆˆ Ccâˆž (s(F )), define its normalised Fourier transform fË† âˆˆ Ccâˆž (s(F )) by
Z
Ë†
f (Y )Î¨(hX, Y i)dY,
(3.2.1)
âˆ€X âˆˆ s(F ), f (X) := cÎ¨ (s(F ))
s(F )

Ë†
where cÎ¨ (s(F )) is the unique constant such that fË†(X) = f (âˆ’X) for all f âˆˆ Ccâˆž (s(F )) and all X âˆˆ s(F ).
For any M âˆˆ L G,Ï‰ (M0 ), the restriction of h*, *i on m âˆ© s is non-degenerate. Then we can define similarly
the normalised Fourier transform of f âˆˆ Ccâˆž ((m âˆ© s)(F )).
Suppose that P âˆˆ F G,Ï‰ (M0 ). Let Î· be the quadratic character of F Ã— attached to a quadratic
extension E/F . Denote by Nrd the reduced norm on G(F ). For f âˆˆ Ccâˆž (s(F )), we define a function
(parabolic descent) fPÎ· âˆˆ Ccâˆž ((mP âˆ© s)(F )) by
Z
f (Ad(k âˆ’1 )(Z + U ))Î·(Nrd(k))dU dk
(3.2.2)
fPÎ· (Z) :=
KH Ã—(nP âˆ©s)(F )

for all Z âˆˆ (mP âˆ© s)(F ). We show that (fË†)Î·P = (fPÎ· )Ë† , so we shall denote it by fË†PÎ· without confusion. In
fact, the integral on (nP âˆ© s)(F ) and the Fourier transform commute by our choices of Haar measures
(see [33, Â§I.7]); the commutativity of the integral on KH and the Fourier transform results from the
H(F )-invariance of h*, *i.
The following result is an analogue of [17, Theorem 13].
Proposition 3.16. Let f âˆˆ Ccâˆž (s(F )). Then
Z
1/2
sup |Ds (X)|F
Xâˆˆsrs (F )

HX (F )\H(F )
12

|f (Ad(xâˆ’1 )(X))|dx < +âˆž.

Proof. It is proved in [37, Theorem 6.11] (see also [36, p. 77]) that for any fixed Cartan subspace c of s,
Z
1/2
s
|f (Ad(xâˆ’1 )(X))|dx < +âˆž.
sup |D (X)|F
Xâˆˆcreg (F )

HX (F )\H(F )

Since T (s) is a finite set and the orbital integral is constant on any H(F )-orbit, we obtain a uniform
bound for all X âˆˆ srs (F ).

The lemma below is an analogue of [17, Theorem 15].
âˆ’ 1 âˆ’Îµ

Lemma 3.17. There exists Îµ > 0 such that the function |Ds (X)|F 2

is locally integrable on s(F ).

Proof. Choose Îµ > 0 verifying the condition of Lemma 3.6. Let f âˆˆ Ccâˆž (s(F )) with f â‰¥ 0. By the Weyl
integration formula (3.1.2), we have
Z
Z
Z
X
1
âˆ’Îµ
âˆ’ 1 âˆ’Îµ
|W (H, c)|âˆ’1
|Ds (X)|F2
f (Ad(xâˆ’1 )(X))dxdX.
|Ds (X)|F 2 f (X)dX =
s(F )

creg (F )

câˆˆT (s)

ATc (F )\H(F )

The convergence of the right hand side results from Proposition 3.16 and Lemmas 3.4 and 3.6.



âˆ’ 21

Corollary 3.18. For any r â‰¥ 0, the function |Ds (X)|F sup{1, âˆ’ log |Ds (X)|F }r is locally integrable
on s(F ).
Proof. It is the same as the proof of Corollary 3.7.



3.3. The case of (Gâ€² , H â€² ). Let E be a quadratic extension of F . Let gâ€² be a central simple algebra over
F with a fixed embedding of F -algebras E Ö’â†’ gâ€² . Let hâ€² := Centgâ€² (E) be the centraliser of E in gâ€² . By
the double centraliser theorem (see [27, Theorem 3.1 in Chapter IV] for example), we know that hâ€² is a
Ã—
Ã—
central simple algebra over E and that dim hâ€² = 21 dim gâ€² . Denote by Gâ€² := gâ€² (resp. H â€² := hâ€² ) the
â€²
â€²
group of invertible elements in g (resp. h ), which is considered as a reductive group over F with Lie
algebra gâ€² (resp. hâ€² ). Let Î± âˆˆ E\F be such that Î±2 âˆˆ F . Then E = F (Î±) and Ad(Î±) is an involution on
Gâ€² independant of the choice of Î±. We see that H â€² is the subgroup of fixed points of Ad(Î±). Define
S â€² := {x âˆˆ Gâ€² : xAd(Î±)(x) = 1}

and its tangent space at the neutral element
Then we have

sâ€² := {Y âˆˆ gâ€² : Ad(Î±)(Y ) = âˆ’Y }.
gâ€² = hâ€² âŠ• sâ€²

and

dim sâ€² = dim hâ€² =

1
dim gâ€² .
2

Ã—

For a linear subspace vâ€² âŠ† gâ€² , we write vâ€² := vâ€² âˆ© Gâ€² .
Notice that if dim g = dim gâ€² , then after a base change to an algebraic closure of F containing E,
the symmetric pair (Gâ€² , H â€² ) is the same as the one (G, H) defined in Section 3.2. By Corollary 3.11, we
Ã—
see that sâ€²rs âŠ†
sâ€² and that for Y âˆˆ sâ€²rs (resp. câ€² âŠ† sâ€² a Cartan subspace), HYâ€² (resp. Tcâ€² ) is a torus of
âˆš
dimension 12 dim gâ€² .
fâ€² be a parabolic subgroup of Gâ€² . Then P
fâ€² âˆ© H â€² is a parabolic subgroup of H â€² if and
Lemma 3.19. Let P
â€²
â€²
f
f
fâ€² , then M
fâ€² âˆ© H â€² is a Levi factor of P
fâ€² âˆ© H â€² .
only if Î± âˆˆ P . Moreover, if Î± belongs to a Levi factor M of P

Proof. It is the same as the proof of Lemma 3.12, except that one replaces Ç« with Î±.



â€²

By the Wedderburn-Artin theorem, G is isomorphic to GLn,D for some positive integer n and some
central division algebra D over F . Since E embeds into gâ€² (F ), we see that n deg(D) is even, where
deg(D) denotes the degree of D. From the Noether-Skolem theorem (see [27, Theorem 2.10 of Chapter
IV] for example), up to conjugation by Gâ€² (F ), the emdedding H â€² Ö’â†’ Gâ€² is reduced to one of the two
cases below (see [12, Â§2.1 and Â§3.1] and [26, Â§3.4]).
Case I: if deg(D) is even, then (Gâ€² , H â€² ) = (GLn,D , ResE/F GLn,Dâ€² ), where Dâ€² := CentD (E) denoting
the centraliser of E in D is a central division algebra over E of degree deg(D)
. Let M0â€² â‰ƒ (ResE/F Gm,Dâ€² )n
2
â€²
n
â€²
(resp. Me0 â‰ƒ (Gm,D ) ) be the subgroup of diagonal elements in H (resp. Gâ€² ), which is a minimal Levi
â€²
fâ€² the unique element in L Gâ€² (M â€² ) such
subgroup of H â€² (resp. Gâ€² ). For M â€² âˆˆ L H (M0â€² ), denote by M
e
0

13

fâ€² âˆ© H = M â€² . Then the map M â€² 7â†’ M
fâ€² induces a bijection between L H â€² (M â€² ) and L Gâ€² (M â€² ) (cf.
that M
0
e
0
[26, Case I in Â§3.4]). Notice that we can identify AM â€² with AM
fâ€² .
Case II: if deg(D) is odd, then (Gâ€² , H â€² ) = (GLn,D , ResE/F GL n2 ,DâŠ—F E ), where D âŠ—F E is a central
n
division algebra over E of degree deg(D). Let M0â€² â‰ƒ (ResE/F Gm,DâŠ—F E ) 2 (resp. Me0â€² â‰ƒ (Gm,D )n ) be
the subgroup of diagonal elements in H â€² (resp. Gâ€² ), which is a minimal Levi subgroup of H â€² (resp. Gâ€² ).
â€²
â€²
â€²
Denote by L G (Me0â€² , M0â€² ) the subset of elements in L G (Me0â€² ) containing M0â€² . For M â€² âˆˆ L H (M0â€² ), denote
fâ€² the unique element in L Gâ€² (M â€² , M0â€² ) such that M
fâ€² âˆ© H = M â€² . Then the map M â€² 7â†’ M
fâ€² induces
by M
e
0

â€²

â€²

a bijection between L H (M0â€² ) and L G (Me0â€² , M0â€² ) (cf. [26, Case II in Â§3.4]). Notice that we can identify
AM â€² with AM
fâ€² .
â€²
fâ€² âˆ© sâ€²rs )(F )
fâ€² âˆ© sâ€² , then AM â€² âŠ† H â€² . We say an element Y âˆˆ (m
Suppose that M â€² âˆˆ L H (M0â€² ). If Y âˆˆ m
Y
â€²
is M -elliptic if AM â€² is the maximal F -split torus in HYâ€² (which is a torus by Corollary 3.11.2)). Denote
fâ€² âˆ© sâ€²rs )(F )ell the set of M â€² -elliptic elements in (m
fâ€² âˆ© sâ€²rs )(F ). For Y âˆˆ (m
fâ€² âˆ© sâ€²rs )(F ), let [Y ]M â€²
by (m
â€²
â€²
â€²
f âˆ© srs )(F )) the set of M â€² (F )-conjugacy classes
be the M (F )-conjugacy class of Y . Denote by Î“ell ((m
fâ€² âˆ© sâ€² is a Cartan subspace, then AM â€² âŠ† Tcâ€² . We say a Cartan subspace
fâ€² âˆ© sâ€²rs )(F )ell . If câ€² âŠ† m
in (m
â€²
â€²
â€²
â€²
f
c âŠ† m âˆ©s is M -elliptic if AM â€² is the maximal F -split torus in Tcâ€² (which is a torus by Corollary 3.11.3)).
fâ€² âˆ© sâ€² ) appears as the product of some copies of the form (H â€² , sâ€² ) in lower dimensions (cf.
Since (M â€² , m
fâ€² âˆ© sâ€² ) as in Section 3.1. In our notation, we write
[26, beginning of Â§5]), we define W (M â€² , câ€² ) and T (m
â€²
â€²
â€²
â€²
f
f
(m âˆ© s )rs for the Zariski open subset of m âˆ© s consisting of regular semi-simple elements with respect to
the M â€² -action. By a base change to an algebraic closure of F containing E and the relevant discussion
fâ€² âˆ© sâ€²rs âŠ† (m
fâ€² âˆ© sâ€² )rs and that a Cartan subspace of m
fâ€² âˆ© sâ€² is nothing but a
in Section 3.2, we see that m
fâ€² âˆ© sâ€² . Denote by Tell (m
fâ€² âˆ© sâ€² ) the subset of representatives that are
Cartan subspace of sâ€² contained in m
â€²
â€²
â€²
f
M -elliptic Cartan subspaces in T (m âˆ© s ).
â€²
fâ€² âˆ© sâ€²rs )(F )).
Lemma 3.20 (cf. Lemma 3.13). Let M â€² âˆˆ L H (M0â€² ) and [Y â€² ]M â€² âˆˆ Î“ell ((m
â€²
H
â€²
â€²
e âˆ© srs )(F )) be such that Y is H â€² (F )-conjugate to Y â€² . Then
1) Let M âˆˆ L (M0 ) and [Y ]M âˆˆ Î“ell ((m
Hâ€²
there exists w âˆˆ W0 such that

(Ad(w)(M â€² ), [Ad(w)(Y â€² )]Ad(w)(M â€² ) ) = (M, [Y ]M ).

2) The cardinality of
â€²

is

e âˆ© sâ€²rs )(F )), Y is H â€² (F )-conjugate to Y â€² }
{(M, [Y ]M ) : M âˆˆ L H (M0â€² ), [Y ]M âˆˆ Î“ell ((m
â€²

â€²

|W0H ||W0M |âˆ’1 .

Proposition 3.21. For f â€² âˆˆ Ccâˆž (sâ€² (F )), we have the equality
Z
Z
X
X
â€² â€² âˆ’1
â€²
Mâ€²
H â€² âˆ’1
|W (M , c )|
f (Y )dY =
|W0 ||W0 |
sâ€² (F )

M â€² âˆˆL H â€² (M0â€² )

f â€² (Ad(xâˆ’1 )(Y ))dxdY.

sâ€²

câ€²reg (F )

fâ€² âˆ©sâ€² )
câ€² âˆˆTell (m

|D (Y )|F

Z

AM â€² (F )\H â€² (F )

Proof. From [26, Lemma 9.1], any H â€² (F )-conjugacy class in sâ€²rs (F ) is the image of a class [Y ]M â€² âˆˆ
fâ€² âˆ© sâ€²rs )(F )) for some M â€² âˆˆ L H â€² (M0â€² ) in our case. By Lemma 3.20, the Weyl integration formula
Î“ell ((m

(3.1.2) can be written as the above equality (cf. [5, p. 16-17] and [33, (3) in Â§I.3]).
â€²
fâ€² ) such
fâ€² the unique element in F Gâ€² (M
In both of Case I and Case II, for P â€² âˆˆ F H (M0â€² ), denote by P
0
â€²
â€²
fâ€² ) (cf. [26,
fâ€² âˆ© H = P â€² . Then the map P â€² 7â†’ P
fâ€² induces a bijection between F H (M â€² ) and F G (M
that P
0
0
Â§3.4]). Let Ï„ âˆˆ DÃ— in Case I (resp. Ï„ âˆˆ GL2 (D) in Case II) be an element such that Ad(Î±)(Ï„ ) = âˆ’Ï„ .
â€²
Let P â€² âˆˆ F H (M0â€² ). Then we have mPfâ€² âˆ© sâ€² = mP â€² Ï„ = Ï„ mP â€² and nPfâ€² âˆ© sâ€² = nP â€² Ï„ = Ï„ nP â€² by [26,
Proposition 3.12]. We have fixed the Haar measures on mP â€² (F ) and nP â€² (F ) in Section 2.5. We shall
choose the same Haar measures on (mPfâ€² âˆ© sâ€² )(F ) and (nPfâ€² âˆ© sâ€² )(F ) using above identifications induced
by Ï„ . Such Haar measures depend on the choice of Ï„ .
â€²

â€²
Lemma 3.22. Let Qâ€² âˆˆ F H (M0â€² ). For X âˆˆ (mQ
fâ€² âˆ© srs )(F ), the map
â€²
âˆ’1
)(X) âˆ’ X
NQâ€² (F ) â†’ (nQ
fâ€² âˆ© s )(F ), n 7â†’ Ad(n
â€²

1/2

is an isomorphism of F -analytic manifolds whose Jacobian is |Ds (X)|F |D
14

â€²
mQ
fâ€² âˆ©s

âˆ’1/2

(X)|F

.

Proof. See [26, Lemma 8.1] for the isomorphism. The computation of its Jacobian is close to the proof
of [37, Proposition 6.3.(ii)].

Fix a continuous and nontrivial unitary character Î¨ : F â†’ CÃ— . Let h*, *i be the symmetric bilinear
form on gâ€² (F ) defined by
hY, Xi := Trd(Y X), âˆ€Y, X âˆˆ gâ€² (F ),
where Trd denotes the reduced trace on gâ€² (F ). It is non-degenerate, which can be seen after the base
change to an algebraic closure of F . It is also invariant by the adjoint action of Gâ€² (F ) and Ad(Î±). For
f â€² âˆˆ Ccâˆž (sâ€² (F )), define its normalised Fourier transform fË†â€² âˆˆ Ccâˆž (sâ€² (F )) by
Z
â€²
â€²
â€²
Ë†
(3.3.1)
âˆ€Y âˆˆ s (F ), f (Y ) := cÎ¨ (s (F ))
f â€² (X)Î¨(hY, Xi)dX,
sâ€² (F )

Ë†
where cÎ¨ (sâ€² (F )) is the unique constant such that fË†â€² (Y ) = f â€² (âˆ’Y ) for all f â€² âˆˆ Ccâˆž (sâ€² (F )) and all
â€²
fâ€² âˆ© sâ€² is non-degenerate. Then we can
Y âˆˆ sâ€² (F ). For any M â€² âˆˆ L H (M0â€² ), the restriction of h*, *i on m
fâ€² âˆ© sâ€² )(F )).
define similarly the normalised Fourier transform of f â€² âˆˆ Ccâˆž ((m
â€²
Hâ€²
â€²
â€²
âˆž â€²
Suppose that P âˆˆ F (M0 ). For f âˆˆ Cc (s (F )), we define a function (parabolic descent) fPâ€² â€² âˆˆ
âˆž
Cc ((mPfâ€² âˆ© sâ€² )(F )) by
Z
â€²
(3.3.2)
fP â€² (Z) :=
f â€² (Ad(k âˆ’1 )(Z + U ))dU dk
KH â€² Ã—(nPfâ€² âˆ©sâ€² )(F )

for all Z âˆˆ (mPfâ€² âˆ© sâ€² )(F ). By our choices of Haar measures (see [33, Â§I.7]) and the H â€² (F )-invariance of
h*, *i, we show that (fË†â€² )P â€² = (fPâ€² â€² )Ë† , which will be denoted by fË†â€² P â€² without confusion.
Proposition 3.23. Let f â€² âˆˆ Ccâˆž (sâ€² (F )). Then
Z
1/2
sâ€²
sup |D (Y )|F
Y âˆˆsâ€²rs (F )

â€² (F )\H â€² (F )
HY

|f â€² (Ad(xâˆ’1 )(Y ))|dx < +âˆž.
â€²

âˆ’1

â€²

Corollary 3.24 (cf. Corollary 3.18). For any r â‰¥ 0, the function |Ds (Y )|F 2 sup{1, âˆ’ log |Ds (Y )|F }r
is locally integrable on sâ€² (F ).
The rest of this section is devoted to the proof of Proposition 3.23. We shall follow the main steps
in [37, Â§6.3], which is similar to the proof of [17, Theorem 13], and only point out some additional
ingredients. Let n be the F -rank of Gâ€² . Denote Gâ€²n := Gâ€² , Hnâ€² := H â€² and sâ€²n := sâ€² . Recall that the F -rank
of Hnâ€² is n in Case I (resp. n2 in Case II). We shall use induction on n. For n = 1 in Case I (resp.
n = 2 in Case II), the proposition is evident since HYâ€² (F )\H â€² (F ) is compact in our case.
The following description of semi-simple elements and descendants (see [1, Definition 7.2.2]) is a
generalisation of [16, Lemma 2.1] (see also [37, Proposition 4.7]).
Proposition 3.25. 1) An element Y of sâ€² (F ) is semi-simple if and only if it is H â€² (F )-conjugate to an
element of the form


B 0
Y (B) :=
,
0 0
Ã—

â€²
-action. More precisely, the set of H â€² (F )with B âˆˆ sâ€²m (F ) being semi-simple with respect to the Hm
â€²
conjugacy classes of semi-simple elements in s (F ) is bijective to the set of pairs (m, [B]) where 0 â‰¤ m â‰¤ n
â€²
is an integer in Case I (resp. an even number in Case II) and [B] is a semi-simple Hm
(F )-conjugacy
â€² Ã—
class in sm (F ). Moreover, Y (B) is regular semi-simple if and only if m = n and B is regular semiÃ—
simple in sâ€² (F ).
2) Let Y = Y (B) âˆˆ sâ€² (F ) be semi-simple. Then the descendant (HYâ€² , sâ€²Y ) (as a representation) is
isomorphic to
â€²
â€²
(Hm,B
, sâ€²m,B ) Ã— (Hnâˆ’m
, sâ€²nâˆ’m ),

â€²
â€²
where Hm,B
(resp. sâ€²m,B ) denotes the centraliser of B in Hm
(resp. sâ€²m ).

Proof. 1) By the base change to an algebraic closure of F containing E, we see from [20, Proposition 2.1]
that an element Y âˆˆ sâ€² (F ) which is H â€² (F )-conjugate to Y (B) in the proposition is semi-simple. Now we
suppose
Y âˆˆ sâ€² (F ) is semi-simple. Since Y 2 âˆˆ hâ€² (F ), up to H â€² (F ) conjugation,
 that 
 wemay suppose
 that

A
0
A
0
A 0
Ã—
2
â€²
Y =
with A âˆˆ hm (F ) being semi-simple in the usual sense. From
Y =Y
,
0 0
0 0
0 0
15



B 0
we deduce that Y =
for some B âˆˆ sâ€²m (F ) such that AB = BA and some C âˆˆ sâ€²nâˆ’m (F ). As
0 C


A 0
Ã—
Y2 =
, we have B âˆˆ sâ€²m (F ). Because Y is semi-simple, it is shown in [20, p. 71] that Y and Y 2
0 0
have the same rank over an algebraic closure of F containing E. Then C = 0. We can also see from [20,
â€²
Proposition 2.1] that B is semi-simple with respect to the Hm
-action after the base change. We have
established the first statement.
Ã—
For the second statement, it suffices to notice that two such elements Y (B1 ) with B1 âˆˆ sâ€²m1 (F ) and
â€²
â€² Ã—
Y (B2 ) with B2 âˆˆ sm2 (F ) in the proposition are H (F )-conjugate if and only if m1 = m2 (denoted by
â€²
m) and B1 and B2 are Hm
(F )-conjugate.
The third statement follows from the base change or 2).
2) It can be shown by direct calculation.

Fix a Cartan subspace câ€² of sâ€² . The lemma below is an analogue of [17, Lemma 29].
â€²

Lemma 3.26. Let f â€² âˆˆ Ccâˆž (sâ€² (F ) âˆ’ N s ). Then
Z
â€²
1/2
sup |Ds (Y )|F

â€² (F )\H â€² (F )
HY

Y âˆˆcâ€²reg (F )

|f â€² (Ad(xâˆ’1 )(Y ))|dx < +âˆž.

Proof. We may apply the argument of [37, Lemma 6.14] relying on Lemma 3.4 and [38, Proposition 3.11],
which is an analogue of Harish-Chandra's semi-simple descent for orbital integrals [22, Lemma 16.1]. By
Proposition 3.25.2), it suffices to prove the boundedness of orbital integrals for
â€²
â€²
(Hm,B
, sâ€²m,B ) Ã— (Hnâˆ’m
, sâ€²nâˆ’m )

Ã—

â€²
with B âˆˆ sâ€²m (F ) being semi-simple with respect to the Hm
-action and 0 < m â‰¤ n. Since there exists an
â€²
â€²
â€²
â€²
Hm,B -equivariant linear isomorphism sm,B â†’ hm,B induced by Z 7â†’ ZB, the first factor (Hm,B
, sâ€²m,B ) is
covered by Harish-Chandra's work [17, Theorem 13] on classical orbital integrals on Lie algebras. Then
â€²
we conclude by applying the induction hypothesis to the second factor (Hnâˆ’m
, sâ€²nâˆ’m ).

â€²

Consider X0 âˆˆ N s . By the Jacobson-Morozov theorem for symmetric spaces (Lemma 3.8), there
exists a group homomorphism Ï† : SL2 (F ) â†’ Gâ€² (F ) such that






0 1
0 0
1 0
â€²
X0 = dÏ†
, Y0 := dÏ†
âˆˆ s (F ) and D0 := dÏ†
âˆˆ hâ€² (F ).
0 0
1 0
0 âˆ’1

Write râ€² := dim sâ€²Y0 and mâ€² := 12 Tr(ad(âˆ’D0 )|sâ€²Y ).
0

Lemma 3.27.
âˆš We have
1) râ€² â‰¥ 21 dim gâ€² ;
âˆš
2) râ€² + mâ€² > 14 dim gâ€² + 41 dim gâ€² .
Proof. It suffices to check these relations after a base change to an algebraic closure of F containing E.
Then the lemma is exactly [37, Proposition 4.4].

Let sâ€²bdd be the set of X âˆˆ sâ€² (F ) such that there exists an open neighbourhood Ïƒ â€² of X in sâ€² (F )
satisfying
Z
â€²
1/2
|f â€² (Ad(xâˆ’1 )(Y ))|dx < +âˆž
sup |Ds (Y )|F
â€²

for all f âˆˆ

â€² (F )\H â€² (F )
HY

Y âˆˆcâ€²reg (F )

Ccâˆž (sâ€² (F ))

â€²

â€²

with Supp(f ) âŠ† Ïƒ . The next lemma is an analogue of [17, Lemma 38].
â€²

Lemma 3.28. We have N s âˆ’ {0} âŠ† sâ€²bdd .
Proof. We may apply the argument of [37, Lemma 6.16] thanks to Lemma 3.27. We only sketch some
steps for convenience and omit the details. In fact, we use induction on râ€² , which is also dim hâ€²X0 by [37,
â€²
Lemma 3.2] and dim sâ€² = dim hâ€² = 12 dim gâ€² (cf. [37, Lemma 4.3]), for X0 âˆˆ N s âˆ’ {0}. Suppose that for
â€²
all X0â€² âˆˆ N s âˆ’ {0} satisfying hâ€²X â€² < râ€² , we have X0â€² âˆˆ sâ€²bdd . We need to show that X0 âˆˆ sâ€²bdd . Denote
â€²

0

â€²

â€²

â€²

by Nqs the union of all H â€² (F )-orbits in N s of dimension â‰¤ q. Then X0 âˆˆ N 1s dim gâ€² âˆ’râ€² âˆ’ N 1s dim gâ€² âˆ’râ€² âˆ’1 ,
â€²

â€²

2

2

and the induction hypothesis means that N s âˆ’ N 1s dim gâ€² âˆ’râ€² âŠ† sâ€²bdd . Fix t âˆˆ F Ã— with |t|F > 1 and then
2
construct an open H â€² (F )-invariant neighbourhood Ï‰0 of X0 in sâ€² (F ) as in the proof of [37, Lemma 6.16].
Let Y âˆˆ câ€²reg (F ) and f â€² âˆˆ Ccâˆž (Ï‰0 ). As in [37, (1) in p. 1853] and the first paragraph of the proof of [37,
16

â€²

Lemma 6.16], there exists fÎ±â€² 0 âˆˆ Ccâˆž (sâ€² (F )) such that Supp(fÎ±â€² 0 ) âˆ© N 1s dim gâ€² âˆ’râ€² = âˆ… and that (see (3.1.3)
2
for the notation)
1

Itâˆ’1 Y (f â€² ) = |t|F4

(3.3.3)

dim gâ€² + 14

âˆš
dim gâ€² âˆ’r â€² âˆ’mâ€²

(IY (f â€² ) + IY (fÎ±â€² 0 )).

By Lemma 3.26 and the induction hypothesis, we have
a :=

sup
Y

1
4

Denote c := |t|F
(3.3.3) that

â€²

dim g

+ 14

âˆš

dim gâ€² âˆ’r â€² âˆ’mâ€²

âˆˆcâ€²reg (F )

IY (|fÎ±â€² 0 |) < +âˆž.

< 1 (by Lemma 3.27 and |t|F > 1). By iteration, we deduce from

Itâˆ’d Y (f â€² ) = cd IY (f â€² ) +

X

ck Itkâˆ’d Y (fÎ±â€² 0 ).

X

ck Itk Y (fÎ±â€² 0 ).

1â‰¤kâ‰¤d

Replacing Y with td Y , we get
IY (f â€² ) = cd Itd Y (f â€² ) +

1â‰¤kâ‰¤d
â€²

By Lemma 3.4, we have lim Itd Y (f ) = 0. Then
dâ†’+âˆž

|IY (f â€² )| â‰¤ a
â€²

+âˆž
X

k=1

ck =

ac
.
1âˆ’c

â€²

As we may replace f by |f | in the above argument, we have completed the proof.
Proof of Proposition 3.23. We may use the argument in [17, Â§VI.7] to show that 0 âˆˆ
proposition follows from Lemmas 3.26 and 3.28.


sâ€²bdd .

Then the


4. Weighted orbital integrals
4.1. The case of (G, H). Let E/F be a quadratic field extension and Î· the quadratic character of
F Ã— /N E Ã— attached to it, where N is the norm map E Ã— â†’ F Ã— . For x âˆˆ H(F ), which is viewed as
an element in G(F ), we denote by Nrd(x) its reduced norm. Suppose that M âˆˆ L G,Ï‰ (M0 ) and that
Q âˆˆ F G (M ). For all f âˆˆ Ccâˆž (s(F )) and X âˆˆ (m âˆ© srs )(F ), we define the weighted orbital integral
Z
1/2
Q
Q
(4.1.1)
JM
(Î·, X, f ) := |Ds (X)|F
f (Ad(xâˆ’1 )(X))Î·(Nrd(x))vM
(x)dx.
HX (F )\H(F )

Recall that this definition depends implicitly on the choice of a maximal compact subgroup of G(F ),
Q
(x) is left-invariant by M (F ) and we have HX âŠ† MH for
which has been fixed in Section 2.2. Since vM
Q
X âˆˆ m âˆ© srs , we see that vM (x) is left-invariant by HX (F ). This integral is absolutely convergent since
the orbit Ad(H(F ))(X) is closed in s(F ), which ensures that the integrand is a compactly supported
(and locally constant) function on the homogeneous space.
Q
Q
Notice that for x âˆˆ MH (F ), we have JM
(Î·, Ad(xâˆ’1 )(X), f ) = Î·(Nrd(x))JM
(Î·, X,f ). Sometimes it is
0 A
convenient to introduce a transfer factor as in [37, Definition 5.7]: for X =
âˆˆ srs (F ), define
B 0
(4.1.2)

Îº(X) := Î·(Nrd(A)),

where Nrd(A) denotes the reduced norm of A âˆˆ GLn (D). Then we have Îº(Ad(xâˆ’1 )(X)) = Î·(Nrd(x))Îº(X),
Q
and thus the function Îº(*)JM
(Î·, *, f ) is constant on Ad(MH (F ))(X).
Though we mainly consider M âˆˆ L G,Ï‰ (M0 ), it is unharmful to extend our definition by (4.1.1) to all
Levi subgroups of the form M = Ad(w)(L), where L âˆˆ L G,Ï‰ (M0 ) and w âˆˆ W0H .
One may also extend in the obvious way the definition (4.1.1) of weighted orbital integrals to the
symmetric pair (L, LH , Ad(Ç«)), where L âˆˆ L G,Ï‰ (M0 ), since it appears as the product of some copies of
the form (G, H, Ad(Ç«)) in lower dimensions.
Proposition 4.1. Suppose that M âˆˆ L G,Ï‰ (M0 ) and that Q âˆˆ F G (M ).
Q
1) For X âˆˆ (m âˆ© srs )(F ) fixed, the support of the distribution JM
(Î·, X, *) is contained in the closed
orbit Ad(H(F ))(X).
Q
2) For f âˆˆ Ccâˆž (s(F )) fixed, the function JM
(Î·, *, f ) is locally constant on (m âˆ© srs )(F ). If c âŠ† m âˆ© s is
a Cartan subspace, the restriction of this function to creg (F ) vanishes outside a compact subset of c(F ).
17

3) If w âˆˆ NormH(F ) (M0 ), x âˆˆ MH (F ) and k âˆˆ KH , we have the equality
G
G
JAd(w)(M)
(Î·, Ad(wx)(X), Ad(k)(f )) = Î·(Nrd(wxk))JM
(Î·, X, f )

for all X âˆˆ (m âˆ© srs )(F ) and f âˆˆ Ccâˆž (s(F )).
4) For X âˆˆ (m âˆ© srs )(F ) and f âˆˆ Ccâˆž (s(F )), we have the equality
M

Î·
Q
),
JM
(Î·, X, f ) = JM Q (Î·, X, fQ

Î·
where fQ
âˆˆ Ccâˆž ((mQ âˆ© s)(F )) is defined by (3.2.2).
5) (Descent formula) If L âˆˆ L G,Ï‰ (M0 ), L âŠ† M and X âˆˆ (l âˆ© srs )(F ), we have
X
Î·
G
â€²
Lâ€²
JM
(Î·, X, f ) =
dG
L (M, L )JL (Î·, X, fQâ€² )
Lâ€² âˆˆL G (L)

for all f âˆˆ Ccâˆž (s(F )), where Qâ€² denotes the second component of s(M, Lâ€² ) (see Section 2.7).
6) (Non-equivariance) For X âˆˆ (m âˆ© srs )(F ), y âˆˆ H(F ) and f âˆˆ Ccâˆž (s(F )), we have the equality
X
M
Î·
G
JM
(Î·, X, Ad(y âˆ’1 )(f )) = Î·(Nrd(y))
),
JM Q (Î·, X, fQ,y
QâˆˆF G (M)

Î·
where fQ,y
âˆˆ Ccâˆž ((mQ âˆ© s)(F )) is defined by
Z
Î·
â€²
(4.1.3)
fQ,y
(Z) :=
f (Ad(k âˆ’1 )(Z + U ))Î·(Nrd(k))vQ
(ky)dU dk, âˆ€Z âˆˆ (mQ âˆ© s)(F ).
KH Ã—(nQ âˆ©s)(F )

Proof. 1) This is obvious from the definition.
2) Let Y âˆˆ (m âˆ© srs )(F ). Then c := sY âŠ† m âˆ© s is a Cartan subspace and Y âˆˆ creg (F ). Since
Ad(MH (F ))(creg (F )) is an open subset of (m âˆ© srs )(F ) (see [29, p. 105]), in order to prove the first
Q
statement, it suffices to find a neighbourhood U of Y in creg (F ) on which the function Îº(*)JM
(Î·, *, f )
is constant. We shall follow the proof of [22, Theorem 17.11]. Consider the function Ï† on creg (F ) Ã—
(Tc (F )\H(F )) defined by Ï†(X, x) := (Îºf )(Ad(xâˆ’1 )(X)). Then Ï† is locally constant but usually not
compactly supported. However, now choosing a compact neighbourhood Ïƒc of Y in creg (F ), we see from
Harish-Chandra's compactness lemma for symmetric spaces (Lemma 3.2) applied to Ïƒs := Supp(f ) that
the restriction of Ï† to Ïƒc Ã— (Tc (F )\H(F )) is compactly supported. By [22, Lemma 2.1], there exists an
open neighbourhood U of Y in Ïƒc such that Ï†(X, x) = Ï†(Y, x) for all X âˆˆ U and x âˆˆ Tc (F )\H(F ). It
Q
follows that the function Îº(*)JM
(Î·, *, f ) is constant on U .
The second statement is a corollary of Lemma 3.4.
3) The effect of Ad(w) is a consequence of our choice of Haar measures. The effect of Ad(x) results
G
from the left-invariance of vM
(x) by MH (F ). The effect of Ad(k) comes from the right-invariance of
G
vM (x) by KH . One should keep in mind the effect of Î·(Nrd(x)) in every step.
4) Write QH := Q âˆ© H âˆˆ F H (M0 ). One sees that MQH = MQ âˆ© H and that NQH = NQ âˆ© H.
Applying the change of variables x = mnk with m âˆˆ MQH (F ), n âˆˆ NQH (F ) and k âˆˆ KH in (4.1.1),
M
Q
since vM
(x) = vM Q (m), we have
Z
M
1/2
Q
f (Ad(mnk)âˆ’1 (X))Î·(Nrd(mk))vM Q (m)dkdndm.
JM
(Î·, X, f ) = |Ds (X)|F
(MQH ,X (F )\MQH (F ))Ã—NQH (F )Ã—KH

Applying Lemma 3.15 to Y = Ad(mâˆ’1 )(X), we deduce
Z
1/2
Q
mQ âˆ©s
JM (Î·, X, f ) =|D
(X)|F
M

f (Ad(k âˆ’1 )(Ad(mâˆ’1 )(X) + U ))

(MQH ,X (F )\MQH (F ))Ã—KH Ã—(nQ âˆ©s)(F )

Î·(Nrd(mk))vM Q (m)dU dkdm
Z
1/2
mQ âˆ©s
=|D
(X)|F

MQH ,X (F )\MQH (F )

M

Î·
fQ
(Ad(mâˆ’1 )(X))Î·(Nrd(m))vM Q (m)dm

M
Î·
).
=JM Q (Î·, X, fQ

5) It follows from (7) in Section 2.7 and 4).
6) By the change of variables, we see that
Z
1/2
G
JM
(Î·, X, Ad(y âˆ’1 )(f )) = |Ds (X)|F

HX (F )\H(F )
18

f (Ad(xâˆ’1 )(X))Î·(Nrd(xy))vM (xy)dx.

For x âˆˆ H(F ) and Q âˆˆ F G,Ï‰ (M0 ), let kQ (x) be an element in KH such that xkQ (x)âˆ’1 âˆˆ QH (F ). It
follows from the product formula (2.6.2) that (see the proof of [3, Lemma 8.2])
X
Q
â€²
vM (xy) =
vM
(x)vQ
(kQ (x)y).
QâˆˆF G (M)

As in 4), we write
G
JM
(Î·, X, Ad(y âˆ’1 )(f )) =Î·(Nrd(y))

X

QâˆˆF G (M)

1/2

|Ds (X)|F

â€²
vQ
(kQ (x)y)dx

=Î·(Nrd(y))

X

QâˆˆF G (M)

1/2

|Ds (X)|F

Z

HX (F )\H(F )

Q
f (Ad(xâˆ’1 )(X))Î·(Nrd(x))vM
(x)

Z

(MQH ,X (F )\MQH (F ))Ã—NQH (F )Ã—KH

M

â€²
(ky)dkdndm.
f (Ad(mnk)âˆ’1 (X))Î·(Nrd(mk))vM Q (m)vQ

Applying again Lemma 3.15 to Y = Ad(mâˆ’1 )(X), we obtain
Z
X
1/2
G
JM
(Î·, X, Ad(y âˆ’1 )(f )) =Î·(Nrd(y))
|DmQ âˆ©s (X)|F

(MQH ,X (F )\MQH (F ))Ã—KH Ã—(nQ âˆ©s)(F )

QâˆˆF G (M)

M

â€²
(ky)dU dkdm
f (Ad(k âˆ’1 )(Ad(mâˆ’1 )(X) + U ))Î·(Nrd(mk))vM Q (m)vQ
Z
X
1/2
Î·
=Î·(Nrd(y))
|DmQ âˆ©s (X)|F
fQ,y
(Ad(mâˆ’1 )(X))
MQH ,X (F )\MQH (F )

QâˆˆF G (M)
M

Î·(Nrd(m))vM Q (m)dm
X
M
Î·
=Î·(Nrd(y))
).
JM Q (Î·, X, fQ,y
QâˆˆF G (M)


Lemma 4.2. Suppose that M âˆˆ L G,Ï‰ (M0 ) and that Q âˆˆ F G (M ). Let Ïƒ âŠ† s(F ) be a compact
subset. There exist constants c > 0 and N âˆˆ N such that if x âˆˆ H(F ) and X âˆˆ (m âˆ© srs )(F ) satisfy
Ad(xâˆ’1 )(X) âˆˆ Ïƒ, then
Q
|vM
(x)| â‰¤ c sup{1, âˆ’ log |Ds (X)|F }N .
Proof. It is shown in the proof of [33, Lemme III.5] that there exist constants c1 > 0 and N âˆˆ N such
that for all x âˆˆ G(F ),
Q
|vM
(x)| â‰¤ c1 (1 + log kxk)N .
Suppose that x âˆˆ H(F ) and X âˆˆ (m âˆ© srs )(F ) satisfy Ad(xâˆ’1 )(X) âˆˆ Ïƒ. If we replace x by yx and X
by Ad(y)(X), where y âˆˆ MH (F ), the two sides in the inequality to be proved remain unchanged. Since
T (m âˆ© s) is a finite set, we may fix a Cartan subspace c âŠ† m âˆ© s and suppose that X âˆˆ creg (F ). Let
Ï„ âˆˆ Tc (F ) be such that
kÏ„ xk = â€² inf kÏ„ â€² xk.
Then

Ï„ âˆˆTc (F )

Q
Q
|vM
(x)| = |vM
(Ï„ x)| â‰¤ c1 (1 + log kÏ„ xk)N = c1 (1 +

Now it suffices to apply Lemma 3.5.

inf

Ï„ â€² âˆˆTc (F )

log kÏ„ â€² xk)N .


Corollary 4.3. Suppose that M âˆˆ L G,Ï‰ (M0 ) and that Q âˆˆ F G (M ). Let f âˆˆ Ccâˆž (s(F )). There exist
constants c > 0 and N âˆˆ N such that for all X âˆˆ (m âˆ© srs )(F ), we have
M

Î·
)| â‰¤ c sup{1, âˆ’ log |Ds (X)|F }N .
|JM Q (Î·, X, fQ

Proof. By Proposition 4.1.4) and Lemma 4.2 applied to Ïƒ = Supp(f ), we see that
Z
M
1/2
Q
Î·
|f (Ad(xâˆ’1 )(X))vM
(x)|dx
)| â‰¤|Ds (X)|F
|JM Q (Î·, X, fQ
HX (F )\H(F )
Z
1/2
â‰¤c sup{1, âˆ’ log |Ds (X)|F }N |Ds (X)|F
|f (Ad(xâˆ’1 )(X))|dx.
HX (F )\H(F )

Now we draw our conclusion by Proposition 3.16.


19

â€²

â€²

4.2. The case of (Gâ€² , H â€² ). Suppose that M â€² âˆˆ L H (M0â€² ) and that Qâ€² âˆˆ F H (M â€² ). For all f â€² âˆˆ
fâ€² âˆ© sâ€²rs )(F ), we define the weighted orbital integral
Ccâˆž (sâ€² (F )) and Y âˆˆ (m
Z
1/2
Qâ€²
Qâ€²
â€²
sâ€²
(4.2.1)
JM
f â€² (Ad(xâˆ’1 )(Y ))vM
â€² (Y, f ) := |D (Y )|F
â€² (x)dx.
â€² (F )\H â€² (F )
HY

Recall that this definition depends implicitly on the choice of a maximal compact subgroup of H â€² (F ),
which has been fixed in Section 2.2. By the base change to an algebraic closure of F containing E, we
â€²
fâ€² âˆ© sâ€²rs . Then v Q â€² (x) is left-invariant by H â€² (F ). This integral
see that HYâ€² âŠ† HYâ€² 2 âŠ† M â€² for Y âˆˆ m
Y
M
is absolutely convergent since the orbit Ad(H â€² (F ))(Y ) is closed in sâ€² (F ). Notice that for x âˆˆ M â€² (F ),
Qâ€²
Qâ€²
Qâ€²
âˆ’1
â€²
â€²
â€²
we have JM
)(Y ), f â€² ) = JM
â€² (Ad(x
â€² (Y, f ), i.e., the function JM â€² (*, f ) is constant on Ad(M (F ))(Y ).
One may extend in the obvious way the definition (4.2.1) to the symmetric pair (Leâ€² , Lâ€² , Ad(Î±)), where
â€²
Lâ€² âˆˆ L H (M0â€² ), since it appears as the product of some copies of the form (Gâ€² , H â€² , Ad(Î±)) in lower
dimensions.
â€²

â€²

Proposition 4.4. Suppose that M â€² âˆˆ L H (M0â€² ) and that Qâ€² âˆˆ F H (M â€² ).
â€²
fâ€² âˆ© sâ€²rs )(F ) fixed, the support of the distribution J Q â€² (Y, *) is contained in the closed orbit
1) For Y âˆˆ (m
M
Ad(H â€² (F ))(Y ).
Qâ€²
â€²
â€²
â€²
â€²
fâ€²
fâ€²
2) For f â€² âˆˆ Ccâˆž (sâ€² (F )) fixed, the function JM
â€² (*, f ) is locally constant on (m âˆ© srs )(F ). If c âŠ† m âˆ© s
â€²
is a Cartan subspace, the restriction of this function to creg (F ) vanishes outside a compact subset of
câ€² (F ).
3) If w âˆˆ NormH â€² (F ) (M0â€² ), x âˆˆ M â€² (F ) and k âˆˆ KH â€² , we have the equality
â€²

â€²

â€²
H
â€²
H
JAd(w)(M
â€² ) (Ad(wx)(Y ), Ad(k)(f )) = JM â€² (Y, f )

fâ€² âˆ© sâ€²rs )(F ) and f â€² âˆˆ Ccâˆž (sâ€² (F )).
for all Y âˆˆ (m
fâ€² âˆ© sâ€²rs )(F ) and f â€² âˆˆ Ccâˆž (sâ€² (F )), we have the equality
4) For Y âˆˆ (m
â€²

M

Q
Q
â€²
â€²
JM
â€² (Y, f ) = JM â€² (Y, fQâ€² ),
â€²

â€²
âˆž
â€²
where fQ
â€² âˆˆ Cc ((m fâ€² âˆ© s )(F )) is defined by (3.3.2).
Q

â€²
lâ€² âˆ© sâ€²rs )(F ), we have
5) (Descent formula) If Lâ€² âˆˆ L H (M0â€² ), Lâ€² âŠ† M â€² and Y âˆˆ (e
X
â€²
Hâ€²
â€²
â€²
L
â€²
JM
dH
â€² (Y, f ) =
Lâ€² (M , L)JLâ€² (Y, fQ )

LâˆˆL H â€² (Lâ€² )

for all f â€² âˆˆ Ccâˆž (sâ€² (F )), where Q denotes the second component of s(M â€² , L) (see Section 2.7).
fâ€² âˆ© sâ€²rs )(F ), y âˆˆ H â€² (F ) and f â€² âˆˆ Ccâˆž (sâ€² (F )), we have the equality
6) (Noninvariance) For Y âˆˆ (m
X
M â€²
Hâ€²
âˆ’1
â€²
JM
)(f â€² )) =
JM â€²Q (Y, fQ
â€² (Y, Ad(y
â€² ,y ),
Qâ€² âˆˆF H â€² (M â€² )

â€²
âˆž
â€²
where fQ
â€² ,y âˆˆ Cc ((m fâ€² âˆ© s )(F )) is defined by
Q
Z
â€²
â€²
â€²
f â€² (Ad(k âˆ’1 )(Z + U ))vQ
(4.2.2)
fQ
â€² (ky)dU dk, âˆ€Z âˆˆ (m fâ€² âˆ© s )(F ).
â€² ,y (Z) :=
Q
â€²
KH â€² Ã—(nQ
fâ€² âˆ©s )(F )

Proof. It is almost the same as the proof of Proposition 4.1, except that one needs to use Lemma 3.22
to show 4) and 6).

â€²

â€²

Lemma 4.5 (cf. Lemma 4.2). Suppose that M â€² âˆˆ L H (M0â€² ) and that Qâ€² âˆˆ F H (M â€² ). Let Ïƒ â€² âŠ† sâ€² (F ) be
fâ€² âˆ© sâ€²rs )(F )
a compact subset. There exist constants c > 0 and N âˆˆ N such that if x âˆˆ H â€² (F ) and Y âˆˆ (m
âˆ’1
â€²
satisfy Ad(x )(Y ) âˆˆ Ïƒ , then
â€²

â€²

Q
s
N
|vM
.
â€² (x)| â‰¤ c sup{1, âˆ’ log |D (Y )|F }
â€²

â€²

Corollary 4.6. Suppose that M â€² âˆˆ L H (M0â€² ) and that Qâ€² âˆˆ F H (M â€² ). Let f â€² âˆˆ Ccâˆž (sâ€² (F )). There exist
fâ€² âˆ© sâ€²rs )(F ), we have
constants c > 0 and N âˆˆ N such that for all Y âˆˆ (m
M

â€²

â€²

â€²
s
N
|JM â€²Q (Y, fQ
.
â€² )| â‰¤ c sup{1, âˆ’ log |D (Y )|F }

Proof. We may apply the argument of Corollary 4.3 with the help of Proposition 4.4.4), Lemma 4.5 and
Proposition 3.23.

20

5. The noninvariant trace formula
5.1. The case of (G, H). Suppose that M âˆˆ L G,Ï‰ (M0 ). For x, y âˆˆ G(F ), we define a (G, M )-family
(vP (x, y))P âˆˆP G (M) as in [5, (12.1) in Â§12] by
vP (Î», x, y) := eâˆ’Î»(HP (y)âˆ’HP (x)) , âˆ€Î» âˆˆ iaâˆ—M , P âˆˆ P G (M ),

where P âˆˆ P G (M ) is the parabolic subgroup opposite to P . Let E/F be a quadratic field extension
and Î· the quadratic character of F Ã— /N E Ã— attached to it. For f, f â€² âˆˆ Ccâˆž (s(F )) and X âˆˆ (m âˆ© srs )(F )ell ,
we define
(5.1.1)
Z
G
JM
(Î·, X, f, f â€² ) := |Ds (X)|F

f (Ad(xâˆ’1 )(X))f â€² (Ad(y âˆ’1 )(X))Î·(Nrd(xâˆ’1 y))vM (x, y)dxdy.

(AM (F )\H(F ))2

Proposition 5.1. Suppose that M âˆˆ L G,Ï‰ (M0 ) and that f, f â€² âˆˆ Ccâˆž (s(F )).
1) The integral (5.1.1) is absolutely convergent.
G
2) The function JM
(Î·, *, f, f â€² ) is locally constant on (m âˆ© srs )(F )ell .
G
3) If c âŠ† m âˆ© s is an M -elliptic Cartan subspace, the restriction of JM
(Î·, *, f, f â€² ) to creg (F ) vanishes
outside a compact subset of c(F ).
4) If w âˆˆ NormH(F ) (M0 ), x âˆˆ MH (F ) and k, k â€² âˆˆ KH , we have the equality
G
G
JAd(w)(M)
(Î·, Ad(wx)(X), Ad(k)(f ), Ad(k â€² )(f â€² )) = Î·(Nrd(kk â€² ))JM
(Î·, X, f, f â€² )

for all X âˆˆ (m âˆ© srs )(F )ell .
5) There exist constants c > 0 and N âˆˆ N such that for all X âˆˆ (m âˆ© srs )(F )ell , we have
G
|JM
(Î·, X, f, f â€² )| â‰¤ c sup{1, âˆ’ log |Ds (X)|F }N .

6) For all X âˆˆ (m âˆ© srs )(F )ell , we have
X
G
JM
(Î·, X, f, f â€² ) =

Î·

Î·
L2
L1
â€²
dG
M (L1 , L2 )JM (Î·, X, fQ )JM (Î·, X, f Q2 ),
1

L1 ,L2 âˆˆL G (M)

where (Q1 , Q2 ) := s(L1 , L2 ) (see Section 2.7).
Proof. The statements 1)-4) can be proved in the same way as the proof of analogous properties for
(4.1.1) in Section 4. Notice that the Î·(Nrd(*))-invariant effects coming from x and y may sometimes
cancel.
For x âˆˆ G(F ), we define a (G, M )-family (v P (x))P âˆˆP G (M) by
v P (Î», x) := eÎ»(HP (x)) , âˆ€Î» âˆˆ iaâˆ—M , P âˆˆ P G (M ).

Then vP (x, y) = v P (x)vP (y) as the product of (G, M )-families. Notice that for all Q âˆˆ P G (M ) and
x âˆˆ G(F ), we have
Q
vQ
M (x) = vM (x).

The statement 6) is a consequence of the splitting formula of (G, M )-families ((6) in Section 2.7) and

Proposition 4.1.4). It together with Corollary 4.3 implies the statement 5).
For f, f â€² âˆˆ Ccâˆž (s(F )), we define
Z
X
X
|W (MH , c)|âˆ’1
J G (Î·, f, f â€² ) :=
|W0Mn ||W0GLn |âˆ’1 (âˆ’1)dim(AM /AG )
creg (F )
(5.1.2)
câˆˆTell (mâˆ©s)
MâˆˆL G,Ï‰ (M0 )
G
JM
(Î·, X, f, f â€² )dX.

This expression is absolutely convergent by Proposition 5.1.5) and Corollary 3.7.
Remark 5.2. We have the equality
J G (Î·, f, f â€² ) = J G (Î·, f â€² , f ).
It results from the fact that for all M âˆˆ L G,Ï‰ (M0 ) and all x, y âˆˆ G(F ), we have vM (x, y) = vM (y, x).
Again, one may extend in the obvious way the definitions (5.1.1) and (5.1.2) to the symmetric pair
(L, LH , Ad(Ç«)), where L âˆˆ L G,Ï‰ (M0 ), since it appears as the product of some copies of the form
(G, H, Ad(Ç«)) in lower dimensions.
21

Theorem 5.3 (Noninvariant trace formula). For all f, f â€² âˆˆ Ccâˆž (s(F )), we have the equality
J G (Î·, f, fË†â€² ) = J G (Î·, fË†, f â€² ).
The rest of this section is devoted to the proof of Theorem 5.3.
Fix P0 âˆˆ P G (M0 ). Denote

G
a+
P0 := {T âˆˆ aM0 : Î±(T ) â‰¥ 0, âˆ€Î± âˆˆ âˆ†P0 }.

For T âˆˆ a+
P0 , write

d(T ) := inf Î±(T ),
Î±âˆˆâˆ†G
P

0

which is invariant under the translation by aG . Set R0 := (aM0 ,F + aG )/aG , which is a lattice in
aM0 /aG . For T âˆˆ R0 âˆ© (a+
P0 /aG ), we define a function u(*, T ) on AG (F )\G(F ) as in [5, p. 21], which is
the characteristic function of certain compact subset. To be precise, let CM0 (T ) be the convex hull in
aM0 /aG of
{TB : B âˆˆ P G (M0 )},
where TB denotes the unique W0G -translate of T which lies in a+
B . Then u(x, T ) is defined as the
characteristic function of the set of points
x = k1 mk2 , m âˆˆ AG (F )\M0 (F ), k1 , k2 âˆˆ KG ,

in AG (F )\G(F ) such that HM0 (m) lies in CM0 (T ).
Let f, f â€² âˆˆ Ccâˆž (s(F )). For x âˆˆ H(F ), we define
Z
f (X)f â€² (Ad(xâˆ’1 )(X))dX.
k(x, f, f â€² ) :=
s(F )

For T âˆˆ R0 âˆ© (a+
P0 /aG ), we define
â€²

T

K (Î·, f, f ) :=

Z

k(x, f, f â€² )Î·(Nrd(x))u(x, T )dx.

AG (F )\H(F )

Since AG (F )\H(F ) is a closed subgroup of AG (F )\G(F ), the restriction of u(x, T ) to AG (F )\H(F ) is
also compactly supported, and the above integral is absolutely convergent.
By the Weyl integration formula (Proposition 3.14), we obtain the geometric expansion
Z
X
X
|W (MH , c)|âˆ’1
K T (Î·, X, f, f â€² )dX,
K T (Î·, f, f â€² ) =
|W0Mn ||W0GLn |âˆ’1
MâˆˆL G,Ï‰ (M0 )

where
T

â€²

s

K (Î·, X, f, f ) :=|D (X)|F

creg (F )

câˆˆTell (mâˆ©s)

Z

AG (F )\H(F )

Z

f (Ad(xâˆ’1 )(X))f â€² (Ad(xy)âˆ’1 (X))Î·(Nrd(y))

AM (F )\H(F )

u(y, T )dxdy.
By the change of variables xy 7â†’ y, we can write
(5.1.3)
Z
T
â€²
s
K (Î·, X, f, f ) = |D (X)|F
f (Ad(xâˆ’1 )(X))f â€² (Ad(y âˆ’1 )(X))Î·(Nrd(xâˆ’1 y))uM (x, y, T )dxdy,
(AM (F )\H(F ))2

where
uM (x, y, T ) :=

Z

u(xâˆ’1 ay, T )da

AG (F )\AM (F )

is defined as in [5, p. 21].
For x, y âˆˆ G(F ) and T âˆˆ R0 âˆ© (a+
P0 /aG ), we define the second weight function vM (x, y, T ) as in [5, p.
30], which is left-invariant under the multiplication of AM (F ) on x or y. To be precise, let Î» âˆˆ aâˆ—M âŠ—R C
be a point whose real part Î»R âˆˆ aâˆ—M is in general position. For P âˆˆ P G (M ), set
âˆ¨
âˆ†Î»P := {Î± âˆˆ âˆ†G
P : Î»R (Î± ) < 0},

Î»
where Î±âˆ¨ is the "coroot" associated to Î± âˆˆ âˆ†G
P (see [6, p. 26]). Denote by Ï†P the characteristic function
Î»
â€²
â€²
â€²
Î»
of the set of T âˆˆ aM such that ÌŸÎ± (T ) > 0 for each Î± âˆˆ âˆ†P and that ÌŸÎ± (T ) â‰¤ 0 for each Î± âˆˆ âˆ†G
P âˆ’ âˆ†P ,
âˆ¨
G
G âˆ—
G
where {ÌŸÎ± : Î± âˆˆ âˆ†P } is the basis of (aP ) which is dual to {Î± : Î± âˆˆ âˆ†P }. Let

YP (x, y, T ) := TP + HP (x) âˆ’ HP (y), âˆ€P âˆˆ P G (M ).
22

The set YM (x, y, T ) = {YP (x, y, T ) : P âˆˆ P G (M )} is a (G, M )-orthogonal set in the sense of [5, p. 19].
Define
X
Î»
ÏƒM (T â€² , YM (x, y, T )) :=
(âˆ’1)|âˆ†P | Ï†Î»P (T â€² âˆ’ YP (x, y, T )), âˆ€T â€² âˆˆ aM /aG .
P âˆˆP G (M)

The function ÏƒM (*, YM (x, y, T )) is known to be compactly supported (see [5, p. 22]). Then vM (x, y, T )
is defined as the integral
Z
vM (x, y, T ) :=
ÏƒM (HM (a), YM (x, y, T ))da.
AG (F )\AM (F )

Now, we define the corresponding weighted orbital integral
(5.1.4)
Z
T
â€²
s
J (Î·, X, f, f ) := |D (X)|F
f (Ad(xâˆ’1 )(X))f â€² (Ad(y âˆ’1 )(X))Î·(Nrd(xâˆ’1 y))vM (x, y, T )dxdy.
(AM (F )\H(F ))2

Let c âŠ† m âˆ© s be an M -elliptic Cartan subspace. For Îµ > 0 and T âˆˆ aM0 ,F âˆ© a+
P0 with large kT k,
consider the domain near the singular set
c(Îµ, T ) := {X âˆˆ creg (F ) : |Ds (X)| â‰¤ eâˆ’ÎµkT k }.

Lemma 5.4. Fix an arbitary constant Îµ0 > 0. Fix a constant Îµâ€² > 0 satisfying the condition of Lemma
3.6. Let c âŠ† m âˆ© s be an M -elliptic Cartan subspace. Given Îµ > 0, there exists c > 0 such that for any
T âˆˆ aM0 ,F âˆ© a+
P0 with kT k â‰¥ Îµ0 ,
Z
Îµâ€² ÎµkT k
(|K T (Î·, X, f, f â€² )| + |J T (Î·, X, f, f â€² )|)dX â‰¤ ceâˆ’ 2 .
c(Îµ,T )

Proof. It is shown in [5, (4.8) in p. 31] that there exist c1 , d1 > 0 such that for all x, y âˆˆ G(F ) and
T âˆˆ aM0 ,F âˆ© a+
P0 with kT k â‰¥ Îµ0 ,
uM (x, y, T ) â‰¤ c1 (kT k + log kxk + log kyk)d1 .

For any a1 , a2 âˆˆ AM (F ), we deduce that

uM (x, y, T ) = uM (a1 x, a2 y, T ) â‰¤ c1 (kT k + log ka1 xk + log ka2 yk)d1 .

Since Tc (F )/AM (F ) is compact, there exists c2 > 0 such that
uM (x, y, T ) â‰¤ c2 (kT k +

inf

Ï„1 âˆˆTc (F )

log kÏ„1 xk +

inf

Ï„2 âˆˆTc (F )

log kÏ„2 yk)d1 .

Now let x, y âˆˆ H(F ) and X âˆˆ c(Îµ, T ), and assume that

f (Ad(xâˆ’1 )(X))f â€² (Ad(y âˆ’1 )(X)) 6= 0.

Let Ïƒ âŠ† s(F ) be a compact subset containing Supp(f ) âˆª Supp(f â€² ). From Lemma 3.5, there exists cÏƒ > 0
such that
inf log kÏ„1 xk, inf log kÏ„2 yk â‰¤ cÏƒ sup{1, âˆ’ log |Ds (X)|F }.
Ï„1 âˆˆTc (F )

Ï„2 âˆˆTc (F )

Therefore, there exists câ€²Ïƒ > 0 such that
(5.1.5)

uM (x, y, T ) â‰¤ câ€²Ïƒ (kT k âˆ’ log |Ds (X)|F )d1 .

By Proposition 3.16, there exists c3 > 0 such that
Z
1/2
(5.1.6)
|Ds (X)|F
|f (xâˆ’1 Xx)|dx â‰¤ c3
AM (F )\H(F )

and
(5.1.7)

|D

s

1/2
(X)|F

Z

AM (F )\H(F )

|f â€² (y âˆ’1 Xy)|dy â‰¤ c3

for all X âˆˆ creg (F ).
Putting the estimates (5.1.5), (5.1.6) and (5.1.7) into the definition (5.1.3) of K T (Î·, X, f, f â€² ), we
obtain the inequality
|K T (Î·, X, f, f â€² )| â‰¤ câ€²Ïƒ c23 (kT k âˆ’ log |Ds (X)|F )d1 .
By Lemma 3.6, for any subset B of creg (F ) which is relatively compact in c(F ), there exists cB > 0
such that
Z
âˆ’Îµâ€²
|Ds (X)|F
dX â‰¤ cB .
B

23

We deduce that for m âˆˆ Z,

m

vol(B âˆ© {X âˆˆ creg (F ) : |Ds (X)|F = q âˆ’ 2 }) â‰¤ cB q âˆ’

(5.1.8)

Îµâ€² m
2

.

câ€²B

We claim that for any B as above, there exists
> 0 such that
Z
Îµâ€² ÎµkT k
(kT k âˆ’ log |Ds (X)|F )d1 dX â‰¤ câ€²B eâˆ’ 2 .
Bâˆ©c(Îµ,T )

This is an analogue of the exercise in [5, p. 32] and we include here a proof for completeness. For
X âˆˆ c(Îµ, T ), we have
1
kT k â‰¤ âˆ’ log |Ds (X)|F .
Îµ
Therefore,

d Z
Z
1 1
s
d1
(kT k âˆ’ log |D (X)|F ) dX â‰¤ 1 +
(âˆ’ log |Ds (X)|F )d1 dX.
Îµ
Bâˆ©c(Îµ,T )
Bâˆ©c(Îµ,T )
Since
B âˆ© c(Îµ, T ) =
we have
Z

Bâˆ©c(Îµ,T )

k
mâ‰¥ 2ÎµkT
log q

(âˆ’ log |Ds (X)|F )d1 dX =

Applying (5.1.8), we obtain
Z

Bâˆ©c(Îµ,T )

a

X

m

(B âˆ© {X âˆˆ creg (F ) : |Ds (X)|F = q âˆ’ 2 }),

k
mâ‰¥ 2ÎµkT
log q



m log q
2

(âˆ’ log |Ds (X)|F )d1 dX â‰¤

d1

m

vol(B âˆ© {X âˆˆ creg (F ) : |Ds (X)|F = q âˆ’ 2 }).

X

k
mâ‰¥ 2ÎµkT
log q



m log q
2

d1

cB q âˆ’

Îµâ€² m
2

.

Now we can confirm our claim by noting the basic fact: for d > 0 and a > 1, there exists cd,a > 0 such
that
X md
x
â‰¤ cd,a aâˆ’ 2 , âˆ€x â‰¥ 0.
m
a
mâ‰¥x

Taking
we see that

Z

B = {X âˆˆ creg (F ) : K T (Î·, X, f, f â€² ) 6= 0},

c(Îµ,T )

|K T (Î·, X, f, f â€² )|dX â‰¤ câ€²Ïƒ c23 câ€²B eâˆ’

Îµâ€² ÎµkT k
2

.

This is half of the lemma.
It is proved in [5, p. 32] that there exist c4 , d2 > 0 such that for all x, y âˆˆ G(F ) and T âˆˆ aM0 ,F âˆ© a+
P0
with kT k â‰¥ Îµ0 ,
vM (x, y, T ) â‰¤ c4 (kT k + log kxk + log kyk)d2 .
By the same argument as before, we obtain
Z
Îµâ€² ÎµkT k
|J T (Î·, X, f, f â€² )|dX â‰¤ c5 eâˆ’ 2
c(Îµ,T )

for some c5 > 0. This establishes the other half of the lemma.



Lemma 5.5. Suppose that Î´ > 0. Then there exist c, Îµ1 , Îµ2 > 0 such that
|uM (x, y, T ) âˆ’ vM (x, y, T )| â‰¤ ceâˆ’Îµ1 kT k

Îµ2 kT k
}.
for all T âˆˆ aM0 ,F âˆ© a+
P0 with d(T ) â‰¥ Î´kT k, and all x, y âˆˆ {x âˆˆ G(F ) : kxk â‰¤ e

Proof. This is Arthur's main geometric lemma [5, Lemma 4.4].



Lemma 5.6. Suppose that Î´ > 0. Let c âŠ† m âˆ© s be an M -elliptic Cartan subspace. Then there exist
c, Îµ > 0 such that
Z
|K T (Î·, X, f, f â€² ) âˆ’ J T (Î·, X, f, f â€² )|dX â‰¤ ceâˆ’ÎµkT k
creg (F )

for all T âˆˆ aM0 ,F âˆ©

a+
P0

with sufficiently large kT k and d(T ) â‰¥ Î´kT k.
24

Proof. Fix Îµ2 > 0 to be the constant given by Lemma 5.5. Let x, y âˆˆ H(F ) and X âˆˆ creg (F ) âˆ’ c( Îµ22 , T ),
and assume that
f (Ad(xâˆ’1 )(X))f â€² (Ad(y âˆ’1 )(X)) 6= 0.

Let Ïƒ âŠ† s(F ) be a compact subset containing Supp(f ) âˆª Supp(f â€² ). From Lemma 3.5, there exists cÏƒ > 0
such that
inf kÏ„1 xk, inf kÏ„2 yk â‰¤ cÏƒ sup{1, |Ds (X)|âˆ’1
F }.
Ï„1 âˆˆTc (F )

Since X âˆˆ creg (F ) âˆ’

c( Îµ22 , T ),

Ï„2 âˆˆTc (F )

we have
sup{1, |Ds (X)|âˆ’1
F } â‰¤ sup{1, e

Îµ2 kT k
2

}=e

Îµ2 kT k
2

.

Then, multiplying x and y by elements in Tc (F ) if necessary, and taking kT k â‰¥
that
kxk, kyk â‰¤ eÎµ2 kT k .

2 log cÏƒ
,
Îµ2

we can assume

It follows from Lemma 5.5 that

|uM (x, y, T ) âˆ’ vM (x, y, T )| â‰¤ ceâˆ’Îµ1 kT k .
By the definitions (see (5.1.3) and (5.1.4)) of K T (Î·, X, f, f â€² ) and J T (Î·, X, f, f â€² ), we obtain that
Z
|K T (Î·, X, f, f â€² ) âˆ’ J T (Î·, X, f, f â€² )|dX â‰¤ c1 eâˆ’Îµ1 kT k ,
creg (F )âˆ’c(

where
c1 := c

Z

Îµ2
2

,T )

s

creg (F )

|D (X)|F

Z

(AM (F )\H(F ))2

|f (Ad(xâˆ’1 )(X))f â€² (Ad(y âˆ’1 )(X))|dxdydX

is finite by Proposition 3.16 and Lemma 3.4.
One can draw the conclusion by combining this with Lemma 5.4.
Define
J T (Î·, f, f â€² ) :=

X

MâˆˆL G,Ï‰ (M0 )

|W0Mn ||W0GLn |âˆ’1

X

câˆˆTell (mâˆ©s)

|W (MH , c)|âˆ’1


Z

J T (Î·, X, f, f â€² )dX,

creg (F )

where J T (Î·, X, f, f â€² ) is defined by (5.1.4).
Proposition 5.7. Suppose that Î´ > 0. Then there exist c, Îµ > 0 such that
|K T (Î·, f, f â€² ) âˆ’ J T (Î·, f, f â€² )| â‰¤ ceâˆ’ÎµkT k
for all T âˆˆ aM0 ,F âˆ© a+
P0 with sufficiently large kT k and d(T ) â‰¥ Î´kT k.
Proof. Apply Lemma 5.6.



It is proved in [5, (6.5) in p. 46] that vM (x, y, T ) is an exponential polynomial in T âˆˆ R0 âˆ© (a+
P0 /aG ).
Denote by á¹½M (x, y) the constant term of vM (x, y, T ) as in [5, (6.6) in p. 46]. Then for f, f â€² âˆˆ Ccâˆž (s(F ))
and X âˆˆ (m âˆ© srs )(F )ell , J T (Î·, X, f, f â€² ) is also an exponential polynomial in T âˆˆ R0 âˆ© (a+
P0 /aG ) whose
constant term is given by
(5.1.9)
Z
J ÌƒM (Î·, X, f, f â€² ) := |Ds (X)|F
f (Ad(xâˆ’1 )(X))f â€² (Ad(y âˆ’1 )(X))Î·(Nrd(xâˆ’1 y))á¹½M (x, y)dxdy.
(AM (F )\H(F ))2

Thus for f, f â€² âˆˆ Ccâˆž (s(F )), J T (Î·, f, f â€² ) is still an exponential polynomial in T âˆˆ R0 âˆ© (a+
P0 /aG ) whose
constant term is given by
Z
X
X
 Ìƒ f, f â€² ) :=
|W (MH , c)|âˆ’1
(5.1.10) J(Î·,
J ÌƒM (Î·, X, f, f â€² )dX.
|W0Mn ||W0GLn |âˆ’1
MâˆˆL G,Ï‰ (M0 )

câˆˆTell (mâˆ©s)

Corollary 5.8. For f, f â€² âˆˆ Ccâˆž (s(F )), we have the equality
 Ìƒ f, fË†â€² ) = J(Î·,
 Ìƒ fË†, f â€² ).
J(Î·,
25

creg (F )

Proof. By the Plancherel formula, for x âˆˆ H(F ), we have

k(x, f, fË†â€² ) = k(x, fË†, f â€² ).

Then for all T âˆˆ R0 âˆ© (a+
P0 /aG ),

K T (Î·, f, fË†â€² ) = K T (Î·, fË†, f â€² ).
Finally, apply Proposition 5.7 to conclude.
Lemma 5.9. For all Q âˆˆ F
have the equality
 Ìƒ f, f â€² ) =
J(Î·,

G,Ï‰

(M0 ), there exists a constant

X

MQn

QâˆˆF G,Ï‰ (M0 )

where J

MQ

Î·
Î·
(Î·, fQ
, f â€²Q)

|W0

câ€²Q


â€²

such that for all f, f âˆˆ

Ccâˆž (s(F )),

we

Î·

Î·
, f â€² Q )câ€²Q ,
||W0GLn |âˆ’1 (âˆ’1)dim(AQ /AG ) J MQ (Î·, fQ

is defined by (5.1.2).

Proof. Suppose that M âˆˆ L G,Ï‰ (M0 ). It is shown in [5, p. 92] that
X
Q
á¹½M (x, y) = (âˆ’1)dim(AM /AG )
vM
(x, y)câ€²Q ,
QâˆˆF G (M)

where câ€²Q is a constant for each Q âˆˆ F G,Ï‰ (M0 ).
Now substitude this in the definition (5.1.9) of J ÌƒM (Î·, X, f, f â€² ). Note that
M

Q
vM
(m1 n1 k1 , m2 n2 k2 ) = vM Q (m1 , m2 )

for m1 âˆˆ MQH (F ), n1 âˆˆ NQH (F ), m2 âˆˆ MQH (F ), n2 âˆˆ NQH (F ), k1 , k2 âˆˆ KH . By the same argument as
the proof of Proposition 4.1.4), one shows that
Z
Î·
M
Î·
Q
|Ds (X)|F
f (Ad(xâˆ’1 )(X))f â€² (Ad(y âˆ’1 )(X))Î·(Nrd(xâˆ’1 y))vM
(x, y)dxdy = JM Q (Î·, X, fQ
, f â€² Q ),
(AM (F )\H(F ))2

where

M
Î·
Î·
JM Q (Î·, X, fQ
, f â€²Q )

is defined by (5.1.1). Therefore, we have
X
Î·
M
Î·
, f â€² Q )câ€²Q .
J ÌƒM (Î·, X, f, f â€² ) = (âˆ’1)dim(AM /AG )
JM Q (Î·, X, fQ
QâˆˆF G (M)

 Ìƒ f, f â€² ).
Then the lemma follows from the definition (5.1.10) of J(Î·,



Proof of Theorem 5.3. Using Lemma 5.9 and Corollary 5.8, we can prove the theorem by induction on
the dimension of G.

â€²

5.2. The case of (Gâ€² , H â€² ). Suppose that M â€² âˆˆ L H (M0â€² ). For x, y âˆˆ H â€² (F ), we define an (H â€² , M â€² )family (vP â€² (x, y))P â€² âˆˆP H â€² (M â€² ) by
â€²

â€²

vP â€² (Î», x, y) := eâˆ’Î»(HP â€² (y)âˆ’HP â€² (x)) , âˆ€Î» âˆˆ iaâˆ—M â€² , P â€² âˆˆ P H (M â€² ),

where P â€² âˆˆ P H (M â€² ) is the parabolic subgroup opposite to P â€² . For f, f â€² âˆˆ Ccâˆž (sâ€² (F )) and Y âˆˆ
fâ€² âˆ© sâ€²rs )(F )ell , we define
(m
Z
Hâ€²
â€²
sâ€²
(5.2.1)
JM â€² (Y, f, f ) := |D (Y )|F
f (Ad(xâˆ’1 )(Y ))f â€² (Ad(y âˆ’1 )(Y ))vM â€² (x, y)dxdy.
(AM â€² (F )\H â€² (F ))2
â€²

Proposition 5.10. Suppose that M â€² âˆˆ L H (M0â€² ) and that f, f â€² âˆˆ Ccâˆž (sâ€² (F )).
1) The integral (5.2.1) is absolutely convergent.
Hâ€²
â€²
â€²
fâ€²
2) The function JM
â€² (*, f, f ) is locally constant on (m âˆ© srs )(F )ell .
â€²
â€²
â€²
â€²
f âˆ© s is an M -elliptic Cartan subspace, the restriction of J H â€²â€² (*, f, f â€² ) to câ€²reg (F ) vanishes
3) If c âŠ† m
M
outside a compact subset of câ€² (F ).
4) If w âˆˆ NormH â€² (F ) (M0â€² ), x âˆˆ M â€² (F ) and k, k â€² âˆˆ KH â€² , we have the equality
â€²

â€²

â€²
â€²
H
â€²
H
JAd(w)(M
â€² ) (Ad(wx)(Y ), Ad(k)(f ), Ad(k )(f )) = JM â€² (Y, f, f )

fâ€² âˆ© sâ€²rs )(F )ell .
for all Y âˆˆ (m
fâ€² âˆ© sâ€²rs )(F )ell , we have
5) There exist constants c > 0 and N âˆˆ N such that for all Y âˆˆ (m
â€²

â€²

H
â€²
s
N
|JM
.
â€² (Y, f, f )| â‰¤ c sup{1, âˆ’ log |D (Y )|F }
26

fâ€² âˆ© sâ€² )(F )ell , we have
6) For all Y âˆˆ (m
rs
X
Hâ€²
JM â€² (Y, f, f â€² ) =

Lâ€²

â€²

Lâ€²

â€²
â€²
â€²
1
2
dH
M â€² (L1 , L2 )JM â€² (Y, fQâ€² )JM â€² (Y, fQâ€²2 ),
1

Lâ€²1 ,Lâ€²2 âˆˆL H â€² (M â€² )

where (Qâ€²1 , Qâ€²2 ) := s(Lâ€²1 , Lâ€²2 ) (see Section 2.7).
Proof. It is almost the same as the proof of Proposition 5.1, except that one needs to use Proposition
4.4.4) and Corollary 4.6 to show 6) and 5).

For f, f â€² âˆˆ Ccâˆž (sâ€² (F )), we define
Z
X
X
â€² â€² âˆ’1
Hâ€²
â€²
Hâ€²
M â€² âˆ’1
dim(AM â€² /AH â€² )
|W (M , c )|
J (f, f ) :=
|W0 ||W0 | (âˆ’1)
câ€²reg (F )
fâ€² âˆ©sâ€² )
(5.2.2)
M â€² âˆˆL H â€² (M0â€² )
câ€² âˆˆTell (m
â€²

H
â€²
JM
â€² (Y, f, f )dY.

This expression is absolutely convergent by Proposition 5.10.5) and Corollary 3.7. One may extend in
the obvious way the definitions (5.2.1) and (5.2.2) to the symmetric pair (Leâ€² , Lâ€² , Ad(Î±)), where Lâ€² âˆˆ
â€²
L H (M0â€² ).
Remark 5.11. We have the equality
â€²

â€²

J H (f, f â€² ) = J H (f â€² , f ).
â€²

It results from the fact that for all M â€² âˆˆ L H (M0â€² ) and all x, y âˆˆ H â€² (F ), we have vM â€² (x, y) = vM â€² (y, x).

Theorem 5.12 (Noninvariant trace formula). For all f, f â€² âˆˆ Ccâˆž (sâ€² (F )), we have the equality
â€²
â€²
J H (f, fË†â€² ) = J H (fË†, f â€² ).

Proof. We may simply copy the proof of Theorem 5.3 here with obvious modifications. Especially, one
needs to use Proposition 3.23 to show analogues of Lemmas 5.4 and 5.6 for the case of (Gâ€² , H â€² ).

6. Howe's finiteness for weighted orbital integrals
6.1. The case of (G, H). For an open compact subgroup r of s(F ), denote by Ccâˆž (s(F )/r) the subspace
of Ccâˆž (s(F )) consisting of the functions invariant by translation of r. Let isr âˆ— : Ccâˆž (s(F ))âˆ— â†’ Ccâˆž (s(F )/r)âˆ—
be the dual map of the natural injection Ccâˆž (s(F )/r) Ö’â†’ Ccâˆž (s(F )).
For any set Ïƒ, denote by C[Ïƒ] the C-linear space of maps from Ïƒ to C with finite support. For
M âˆˆ L G,Ï‰ (M0 ) and Ïƒ âŠ† (m âˆ© srs )(F ), we define the linear map
G
Î´M
: C[Ïƒ] â†’ Ccâˆž (s(F ))âˆ— ,
X
G
(zX )XâˆˆÏƒ 7â†’
z X JM
(Î·, X, *),
XâˆˆÏƒ

where zX âˆˆ C is the coordinate at X âˆˆ Ïƒ.
âˆ—
L
and Î´M
in the
For L âˆˆ L G,Ï‰ (M0 ) and rL âŠ† (l âˆ© s)(F ) an open compact subgroup, we define ilâˆ©s
rL
same way by using (L, LH , Ad(Ç«)) in place of (G, H, Ad(Ç«)).
Proposition 6.1 (Howe's finiteness). Let r be an open compact subgroup of s(F ), M âˆˆ L G,Ï‰ (M0 )
and Ïƒ âŠ† (m âˆ© srs )(F ). Suppose that there exists a compact subset Ïƒ0 âŠ† (m âˆ© s)(F ) such that Ïƒ âŠ†
Ad(MH (F ))(Ïƒ0 ). Then the image of the linear map
is of finite dimension.

G
isr âˆ— â—¦ Î´M
: C[Ïƒ] â†’ Ccâˆž (s(F )/r)âˆ—

Remark 6.2. For M = G, Proposition 6.1 is essentially included in a more general result [29, Theorem
6.1] in the context of Î¸-groups (in the sense of [30, p. 467]).
The rest of this section is devoted to the proof of Proposition 6.1. We shall follow the main steps in
G
[33, Â§IV.2-6]. Since the function Îº(*)JM
(Î·, *, f ) is constant on Ad(MH (F ))(X) for f âˆˆ Ccâˆž (s(F )) and
X âˆˆ (m âˆ© srs )(F ), and T (m âˆ© s) is a finite set, by Lemma 3.4, we may and shall suppose that Ïƒ is
relatively compact in (m âˆ© s)(F ). The proposition will be proved by induction on the dimension of G.
Recall that we have chosen the standard maximal compact subgroup K = GL2n (OD ) of G(F ) =
GL2n (D). Let k = g(OF ) := gl2n (OD ), which is an OF -lattice in g(F ) = gl2n (D) and is stable under
the adjoint action of K. Since H âˆˆ L G (M0 ), we have set KH = K âˆ© H(F ) = GLn (OD ) Ã— GLn (OD ).
27

Let h(OF ) := k âˆ© h(F ) and s(OF ) := k âˆ© s(F ). Then we see that k = h(OF ) âŠ• s(OF ) and that
s(OF ) is stable under the adjoint action of KH . For all P âˆˆ F G (M0 ), we fix aP âˆˆ AP (F ) such that
|Î±(aP )|F < 1, âˆ€Î± âˆˆ âˆ†G
P.
Recall that we denote by N s the set of nilpotent elements in s(F ) and fix a uniformiser ÌŸ of OF . Let
X âˆˆ N s âˆ© (k âˆ’ ÌŸk). By the Jacobson-Morozov theorem for symmetric spaces (Lemma 3.8), there exists
a group homomorphism Ï† : SL2 (F ) â†’ G(F ) such that




0 1
ÌŸ
dÏ†
= X and aÏ† := Ï†
âˆˆ H(F ).
0 0
ÌŸâˆ’1
We define the parabolic subgroup P X of G as in [33, Â§IV.3]. More concretely, set
g[i] := {Y âˆˆ g : Ad(aÏ† )(Y ) = ÌŸi Y, âˆ€i âˆˆ Z}
and
pX :=

M

g[i];

iâ‰¥0

then let
P X := {x âˆˆ G : Ad(x)(pX ) = pX }.

(6.1.1)

Note that P X is independent of the choice of Ï† by [7, Proposition 5.7.1]. Since aÏ† commutes with Ç«, one
has Ç« âˆˆ P X . By Lemma 3.12, P X âˆ©H is a parabolic subgroup of H. Then there exists an element x âˆˆ KH
such that P â€² := Ad(x)(P X ) âˆˆ F G (M0 ). We shall fix such an x. Let aX := Ad(xâˆ’1 )(aP â€² ) âˆˆ H(F ). Note
that aX depends on the choice of x, but this is unimportant. It is proved in [33, (3) in Â§IV.3] that
Ad(aX )(X) âˆˆ ÌŸk.
But Ad(aX )(X) âˆˆ s(F ). Thus we have
Ad(aX )(X) âˆˆ ÌŸs(OF ).

(6.1.2)

Lemma 6.3. There exists an integer h âˆˆ N such that for all Y âˆˆ ÌŸh s(OF ), all integers l â‰¥ h and all
Z âˆˆ Ad(aX )âˆ’1 (ÌŸl s(OF )), there exists Î³ âˆˆ KH with Î·(Nrd(Î³)) = 1 such that
Ad(Î³)(X + Y + Z) âˆˆ X + Y + ÌŸl s(OF ).
Proof. It is analogous to the proof of [33, Lemme IV.3]. The point is that we require Î³ âˆˆ H(F ) and
Î·(Nrd(Î³)) = 1 here.
Set
M
nX :=
g[i].
iâ‰¥1

Ï†

Since a commutes with Ç«, one has g[i] = (g[i] âˆ© h) âŠ• (g[i] âˆ© s).
It is proved in [33, (4) in Â§IV.3] that
Ad(aX )âˆ’1 (k) âŠ† k + Ad(aX )âˆ’1 (k) âˆ© nX .
By the intersection of s(F ) with both sides in the last expression, we have
(6.1.3)

Ad(aX )âˆ’1 (s(OF )) âŠ† s(OF ) + Ad(aX )âˆ’1 (s(OF )) âˆ© nX .

It is shown in [33, (2) in Â§IV.3] and the proof of [33, Lemme IV.3] that there exists c âˆˆ N such that
nX âˆ© Ad(aX )âˆ’1 (k) âŠ† ad(X)(ÌŸâˆ’c k).
By the intersection of s(F ) with both sides in the last expression, we have
(6.1.4)

nX âˆ© Ad(aX )âˆ’1 (s(OF )) âŠ† ad(X)(ÌŸâˆ’c h(OF )).

Fix such an integer c. There exists câ€² âˆˆ N such that for all l â‰¥ câ€² , we have
â€¢ ÌŸl k âŠ† Vg ;
â€¢ exp(ÌŸl k) âŠ† {x âˆˆ K : Î·(Nrd(x)) = 1};
â€¢ Ad(exp(Y â€² ))(Y ) â‰¡ Y + ad(Y â€² )(Y ) mod ÌŸl+c k, âˆ€Y âˆˆ k, Y â€² âˆˆ ÌŸl k.
28

â€²â€²

Fix such an integer câ€² . There exists câ€²â€² âˆˆ N such that Ad(aX )âˆ’1 (ÌŸc k) âŠ† k. Fix such an integer câ€²â€² .
Let h âˆˆ N be such that h â‰¥ max{c + câ€² , c + câ€²â€² }. Let Y, l and Z be as in the statement. Thanks to
(6.1.3), we can write Z = Z1 + Z2 , where Z1 âˆˆ ÌŸl s(OF ) and Z2 âˆˆ Ad(aX )âˆ’1 (ÌŸl s(OF )) âˆ© nX . Because
â€²
of (6.1.4), we can choose Z â€² âˆˆ ÌŸlâˆ’c h(OF ) such that Z2 = ad(X)(Z â€² ). Since Z â€² âˆˆ ÌŸc h(OF ) from the
â€²
â€²
hypothesis l â‰¥ h â‰¥ c + c , we can define Î³ := exp(Z ). Then we have Î³ âˆˆ KH and Î·(Nrd(Î³)) = 1. It is
shown in the proof of [33, Lemme IV.3] that Î³ verifies
Ad(Î³)(X + Y + Z) âˆˆ X + Y + ÌŸl k.

But both of Ad(Î³)(X + Y + Z) and X + Y belong to s(F ). Hence, we deduce that
Ad(Î³)(X + Y + Z) âˆˆ X + Y + ÌŸl s(OF ).



X

s

For X âˆˆ N âˆ© (k âˆ’ ÌŸk), we shall fix an integer h such that
(1) hX verifies the condition of Lemma 6.3;
(2) hX â‰¥ 1;
X
(3) Ad(aX )(ÌŸh s(OF )) âŠ† ÌŸs(OF ).
Denote by N G the set of nilpotent elements in g(F ). Let Pg(F ) (resp. Ps(F )) be the projective space
associated to g(F ) (resp. s(F )) and Ï€ : g(F ) âˆ’ {0} â†’ Pg(F ) the natural projection. Since Ï€(N G âˆ’ {0})
is compact and N s âˆ’ {0} is a closed subset of N G âˆ’ {0}, we know that Ï€(N s âˆ’ {0}) is compact. One
also sees that
Ï€(N s âˆ© (k âˆ’ ÌŸk)) = Ï€(N s âˆ’ {0}).
We can and shall choose a finite set N0 âŠ† N s âˆ© (k âˆ’ ÌŸk) such that
[
X
Ï€(X + ÌŸh s(OF ))
XâˆˆN0

is an open neighbourhood of Ï€(N s âˆ’ {0}) âŠ† Ps(F ).

G
Lemma 6.4. There exists an integer c âˆˆ N such that for all d âˆˆ Î´M
(C[Ïƒ]) and all f âˆˆ Ccâˆž (s(F ))
satisfying d(f ) 6= 0, we have
[
X
F Ã— (X + ÌŸh s(OF ))] 6= âˆ….
Supp(f ) âˆ© [ÌŸâˆ’c s(OF ) âˆª
XâˆˆN0

Proof. Recall that Ïƒ is assumed to be relatively compact in (m âˆ© s)(F ). Fix an open compact neighbourhood Ïƒ â€² of Ïƒ in s(F ). Fix P0 âˆˆ P H (M0 ) and set
H
A+
P0 := {a âˆˆ AM0 (F ) : |Î±(a)|F â‰¥ 1, âˆ€Î± âˆˆ âˆ†P0 }.

Similarly, for all B âˆˆ P G (M0 ), set

G
A+
B := {a âˆˆ AM0 (F ) : |Î±(a)|F â‰¥ 1, âˆ€Î± âˆˆ âˆ†B }.

We see from the argument of [25, Lemma 4.11] that
[
A+
P0 âŠ†

A+
B.

{BâˆˆP G (M0 ):P0 âŠ†B}

By the Cartan decomposition, there exists a compact subset Î“ âŠ† H(F ) such that H(F ) = KH A+
P0 Î“.
Fix such a Î“. Then
[
H(F ) âŠ†
KH A+
B Î“.
âˆ’câ€²

{BâˆˆP G (M0 ):P0 âŠ†B}

Fix c âˆˆ N such that Ad(Î“)(Ïƒ ) âŠ† ÌŸ s(OF ). Since Ad(A+
B )(s(OF )) âŠ† s(OF ) + (nB âˆ© s)(F ) and
(nB âˆ© s)(F ) âŠ† N s , we obtain
â€²
Ad(H(F ))(Ïƒ â€² ) âŠ† ÌŸâˆ’c s(OF ) + N s .
Choose an integer c such that
c â‰¥ câ€² + sup hX .
â€²

â€²

XâˆˆN0

Let d and f be as in the statement. It is evident that
â€²

Supp(f ) âˆ© Ad(H(F ))(Ïƒ â€² ) 6= âˆ….

Suppose that X1 âˆˆ ÌŸâˆ’c s(OF ), X2 âˆˆ N s satisfy X1 + X2 âˆˆ Supp(f ). If X2 âˆˆ ÌŸâˆ’c s(OF ), we are done.
X
If not, let X âˆˆ N0 be such that Ï€(X2 ) âˆˆ Ï€(X + ÌŸh s(OF )). Then there exists Î» âˆˆ F Ã— such that
29

X

X2 âˆˆ Î»(X + ÌŸh s(OF )). Since X2 âˆˆ
/ ÌŸâˆ’c s(OF ), we have vF (Î») < âˆ’c and thus vF (Î») + hX < âˆ’câ€² .
X
X
X
Therefore, X1 âˆˆ Î»ÌŸh s(OF ) and then X1 + X2 âˆˆ Î»(X + ÌŸh s(OF )) âŠ† F Ã— (X + ÌŸh s(OF )). This is
exactly what we want to prove.

We shall fix an integer c verifying the condition in Lemma 6.4. We shall also fix another integer h
such that
h â‰¥ sup hX .

(6.1.5)

XâˆˆN0

Denote
C := {f âˆˆ Ccâˆž (s(F )/ÌŸh s(OF )) : Supp(f ) âŠ† ÌŸâˆ’c s(OF )},

which is a C-linear space of finite dimension. For all L âˆˆ L G (M ), L 6= G, let r(L) := ÌŸh (l âˆ© s)(OF ).
Lemma 6.5. Let z = (zX )XâˆˆÏƒ âˆˆ C[Ïƒ]. Suppose that
âˆ—
L
G
1) ilâˆ©s
r(L) â—¦ Î´M (z) = 0 for all L âˆˆ L (M ), L 6= G;
G
2) Î´M
(z)(C) = 0.
G
Then isÌŸh s(OF ) âˆ— â—¦ Î´M
(z) = 0.
G
Proof. Write d := Î´M
(z). It suffices to prove by induction on the integer e â‰¥ c the assertion
(A)e : for all f âˆˆ Ccâˆž (s(F )/ÌŸh s(OF )) with Supp(f ) âŠ† ÌŸâˆ’e s(OF ), we have d(f ) = 0.
If e = c, this is true by the hypothesis 2). Fix an e > c and suppose that (A)eâˆ’1 is true. For any
open compact subset s âŠ† g(F ), denote by 1s its characteristic function. It suffices to prove that for all
Y âˆˆ ÌŸâˆ’e s(OF ) âˆ’ ÌŸâˆ’e+1 s(OF ), we have d(1Y +ÌŸh s(OF ) ) = 0.
Suppose that Y âˆˆ ÌŸâˆ’e s(OF ) âˆ’ ÌŸâˆ’e+1 s(OF ). The hypothesis e > c implies ÌŸâˆ’c s(OF ) âŠ† ÌŸâˆ’e+1 s(OF )
and thus Y âˆˆ
/ ÌŸâˆ’c s(OF ). Suppose on the contary that d(1Y +ÌŸh s(OF ) ) 6= 0. By Lemma 6.4, there exists
X
X âˆˆ N0 and Î» âˆˆ F Ã— such that (Y + ÌŸh s(OF )) âˆ© Î»(X + ÌŸh s(OF )) 6= âˆ…. Fix such X and Î». Since
vF (Y ) = âˆ’e and vF (X) = 0, we have vF (Î») = âˆ’e. As h â‰¥ hX â‰¥ hX âˆ’ e (see (6.1.5)), we obtain
X
X
X
ÌŸh s(OF ) âŠ† Î»ÌŸh s(OF ) and then Y âˆˆ Î»(X +ÌŸh s(OF )). Let Y â€² âˆˆ ÌŸh s(OF ) such that Y = Î»(X +Y â€² ).
Let Z âˆˆ Ad(aX )âˆ’1 (ÌŸh s(OF )). Since h + e â‰¥ hX , we can apply Lemma 6.3 to X, Y â€² , Î»âˆ’1 Z and
l := h + e. Then there exists Î³ âˆˆ KH with Î·(Nrd(Î³)) = 1 such that

Ad(Î³)(X + Y â€² + Î»âˆ’1 Z) âˆˆ X + Y â€² + ÌŸh+e s(OF ).

From vF (Î») = âˆ’e, we deduce that

Ad(Î³)(Î»(X + Y â€² ) + Z) âˆˆ Î»(X + Y â€² ) + ÌŸh s(OF ),

i.e.,
Since Î³ âˆˆ KH , this is equivalent to

Ad(Î³)(Y + Z) âˆˆ Y + ÌŸh s(OF ).

Ad(Î³)(Y + Z + ÌŸh s(OF )) = Y + ÌŸh s(OF )

or
Ad(Î³)(1Y +Z+ÌŸh s(OF ) ) = 1Y +ÌŸh s(OF ) .
By Proposition 4.1.3), we obtain
d(1Y +Z+ÌŸh s(OF ) ) = Î·(Nrd(Î³))d(1Y +ÌŸh s(OF ) ).
Because Î·(Nrd(Î³)) = 1, we have
d(1Y +Z+ÌŸh s(OF ) ) = d(1Y +ÌŸh s(OF ) ).

Now, by the sum over Z âˆˆ Ad(aX )âˆ’1 (ÌŸh s(OF )) + ÌŸh s(OF ) /ÌŸh s(OF ) (a finite set), we get

(6.1.6)

d(1Y +ÌŸh s(OF ) ) = [k â€² : s(OF )]âˆ’1 d(1Y +ÌŸh kâ€² ),

where
(6.1.7)

k â€² := Ad(aX )âˆ’1 (s(OF )) + s(OF ).

By Proposition 4.1.6), we have the equality

d Ad(aX )(1Y +ÌŸh kâ€² ) âˆ’ Î·(Nrd(aX ))1Y +ÌŸh kâ€² = Î·(Nrd(aX ))
30

X

QâˆˆF G (M),Q6=G



M
Î´M Q (z) (1Y +ÌŸh kâ€² )Î·Q,(aX )âˆ’1 .

From (4.1.3), it is clear that (1Y +ÌŸh kâ€² )Î·Q,(aX )âˆ’1 is invariant by translation of r(MQ ). By the hypothesis


M
1), we have Î´M Q (z) (1Y +ÌŸh kâ€² )Î·Q,(aX )âˆ’1 = 0 for all Q âˆˆ F G (M ), Q 6= G, so

(6.1.8)
Î·(Nrd(aX ))d(1Y +ÌŸh kâ€² ) = d Ad(aX )(1Y +ÌŸh kâ€² ) .
We see easily that

Ad(aX )(1Y +ÌŸh kâ€² ) = 1s ,
where
s := Ad(aX )(Y ) + ÌŸh Ad(aX )(k â€² ).

(6.1.9)

Recall Y = Î»(X + Y â€² ) above. As X âˆˆ N0 , by (6.1.2), we have Ad(aX )(X) âˆˆ ÌŸs(OF ). Since
X
Y âˆˆ ÌŸh s(OF ), by the hypothesis (3) on hX , we have Ad(aX )(Y â€² ) âˆˆ ÌŸs(OF ). For vF (Î») = âˆ’e, we
obtain
â€²

Ad(aX )(Y ) âˆˆ ÌŸâˆ’e+1 s(OF ).

(6.1.10)
We see from (6.1.7) that

Ad(aX )(k â€² ) = s(OF ) + Ad(aX )(s(OF )).
X

By (6.1.5) and the hypothesis (3) on hX , we have ÌŸh Ad(aX )(s(OF )) âŠ† ÌŸh Ad(aX )(s(OF )) âŠ† ÌŸs(OF ).
Then by (6.1.5) and the hypothesis (2) on hX , we have
(6.1.11)

X

ÌŸh Ad(aX )(k â€² ) = ÌŸh s(OF ) + ÌŸh Ad(aX )(s(OF )) âŠ† ÌŸh s(OF ) + ÌŸs(OF ) = ÌŸs(OF ).

From (6.1.9), (6.1.10) and (6.1.11), we see that

Supp(1s ) âŠ† ÌŸâˆ’e+1 s(OF ).

Since s(OF ) âŠ† Ad(aX )(k â€² ), we know that 1s is invariant by translation of ÌŸh s(OF ). Using the induction
hypothesis (A)eâˆ’1 , we have
d(1s ) = 0.
Thanks to (6.1.6) and (6.1.8), we obtain
d(1Y +ÌŸh s(OF ) ) = 0.
This proves (A)e and thus the lemma.



Proof of Proposition 6.1. We use induction on the dimension of G. Suppose that for all L âˆˆ L G (M ), L 6=
G, and all open compact subgroups rL of (l âˆ© s)(F ), the image of the linear map
âˆ—

L
âˆž
âˆ—
ilâˆ©s
rL â—¦ Î´M : C[Ïƒ] â†’ Cc ((l âˆ© s)(F )/rL )

is of finite dimension. This is actually a product form of the proposition in lower dimensions. Now we
would like to prove the proposition. The argument below is also valid for the case G = M .
Enlarge h in (6.1.5) if necessary such that r âŠ‡ ÌŸh s(OF ). We shall prove that the image of isÌŸh s(OF ) âˆ— â—¦
G
Î´M
is of finite dimension. Admit this for the moment. Since isr âˆ— factorises by isÌŸh s(OF ) âˆ— , the image of
sâˆ—
G
i r â—¦ Î´M
is also of finite dimension. Then we finish the proof.
Let K1 be the kernel of the linear map
M
M
âˆ—
L
ilâˆ©s
Ccâˆž ((l âˆ© s)(F )/r(L))âˆ— ,
r(L) â—¦ Î´M : C[Ïƒ] â†’
LâˆˆL G (M),L6=G

LâˆˆL G (M),L6=G

whose image is of finite dimension by our induction hypothesis applied to rL := r(L) for all L âˆˆ
G
L G (M ), L 6= G. Hence, to prove that isÌŸh s(OF ) âˆ— â—¦ Î´M
(C[Ïƒ]) is of finite dimension, it suffices to prove
âˆ—
G
that isÌŸh s(OF ) â—¦ Î´M
(K1 ) is of finite dimension.
Consider the composition of the linear maps
âˆ—

G
d1 := isÌŸh s(OF ) â—¦ Î´M

and

K1

: K1 â†’ Ccâˆž (s(F )/ÌŸh s(OF ))âˆ—

Res : Ccâˆž (s(F )/ÌŸh s(OF ))âˆ— â†’ C âˆ— .
The latter map is the natural restriction. Lemma 6.5 says that
which is denoted by K2 . Then

ker(Res â—¦ d1 ) = ker(d1 ),
d1 (K1 ) â‰ƒ K1 /K2 â‰ƒ Res â—¦ d1 (K1 ) âŠ† C âˆ— .
31

Since C is of finite dimension, we see that d1 (K1 ) is of finite dimension.



Corollary 6.6. Let r be an open compact subgroup of s(F ), M âˆˆ L G,Ï‰ (M0 ) and Ïƒ âŠ† (m âˆ© srs )(F ).
Suppose that there exists a compact subset Ïƒ0 âŠ† (m âˆ© s)(F ) such that Ïƒ âŠ† Ad(MH (F ))(Ïƒ0 ). Then there
exists a finite subset {Xi : i âˆˆ I} âŠ† Ïƒ and a finite subset {fi : i âˆˆ I} âŠ† Ccâˆž (s(F )/r) such that for all
X âˆˆ Ïƒ and all f âˆˆ Ccâˆž (s(F )/r), we have the equality
X
G
G
G
JM
(Î·, X, f ) =
JM
(Î·, Xi , f )JM
(Î·, X, fi ).
iâˆˆI

G
Proof. By Proposition 6.1, there exists a finite subset {Xi : i âˆˆ I} âŠ† Ïƒ such that {isr âˆ— â—¦ Î´M
(Xi ) : i âˆˆ I}
sâˆ—
G
is a basis of ir â—¦ Î´M (C[Ïƒ]). By linear algebra, there exists a finite subset {fi : i âˆˆ I} âŠ† Ccâˆž (s(F )/r)
G
such that isr âˆ— â—¦ Î´M
(Xi )(fj ) = Î´ij , âˆ€i, j âˆˆ I, where Î´ij denotes the Kronecker delta function. Choose such
{Xi : i âˆˆ I} and {fi : i âˆˆ I}.
Then, for all X âˆˆ Ïƒ, there exists Î»i , âˆ€i âˆˆ I such that
X
G
G
JM
(Î·, X, *) =
Î»i JM
(Î·, Xi , *) âˆˆ Ccâˆž (s(F )/r)âˆ— .
iâˆˆI

Hence, for all i âˆˆ I,

G
JM
(Î·, X, fi ) =

X

G
Î»j JM
(Î·, Xj , fi ) =

jâˆˆI

X

Î»j Î´ji = Î»i .

jâˆˆI

We have finished the proof.
â€²



â€²

â€²

â€²

6.2. The case of (G , H ). For an open compact subgroup r of s (F ), denote by Ccâˆž (sâ€² (F )/râ€² ) the
â€²âˆ—
subspace of Ccâˆž (sâ€² (F )) consisting of the functions invariant by translation of râ€² . Let irsâ€² : Ccâˆž (sâ€² (F ))âˆ— â†’
Ccâˆž (sâ€² (F )/râ€² )âˆ— be the dual map of the natural injection Ccâˆž (sâ€² (F )/râ€² ) Ö’â†’ Ccâˆž (sâ€² (F )).
â€²
For any set Ïƒ â€² , denote by C[Ïƒ â€² ] the C-linear space with a basis Ïƒ â€² . For M â€² âˆˆ L H (M0â€² ) and Ïƒ â€² âŠ†
fâ€² âˆ© sâ€²rs )(F ), we define the linear map
(m
â€²

H
â€²
âˆž â€²
âˆ—
Î´M
â€² : C[Ïƒ ] â†’ Cc (s (F )) ,
X
Hâ€²
(zY )Y âˆˆÏƒâ€² 7â†’
z Y JM
â€² (Y, *),
Y âˆˆÏƒâ€²

â€²

where zY âˆˆ C is the coordinate at Y âˆˆ Ïƒ .
âˆ—
â€²
Lâ€²
â€²
â€²
leâ€² âˆ©sâ€²
eâ€²
and Î´M
For Lâ€² âˆˆ L H (M0â€² ) and rL
â€² in the
â€² âŠ† (l âˆ© s )(F ) an open compact subgroup, we define ir â€²
â€²
L
same way by using (Leâ€² , Lâ€² , Ad(Î±)) in place of (Gâ€² , H â€² , Ad(Î±)).
â€²

Proposition 6.7 (Howe's finiteness). Let râ€² be an open compact subgroup of sâ€² (F ), M â€² âˆˆ L H (M0â€² )
fâ€² âˆ© sâ€²rs )(F ). Suppose that there exists a compact subset Ïƒ0â€² âŠ† (m
fâ€² âˆ© sâ€² )(F ) such that Ïƒ â€² âŠ†
and Ïƒ â€² âŠ† (m
â€²
â€²
Ad(M (F ))(Ïƒ0 ). Then the image of the linear map
â€²âˆ—

is of finite dimension.

â€²

H
â€²
âˆž â€²
â€² âˆ—
isrâ€² â—¦ Î´M
â€² : C[Ïƒ ] â†’ Cc (s (F )/r )

The rest of this section is devoted to the proof of Proposition 6.7. It is similar to the proof of Proposition 6.1 and we only point out some additional argument. Recall that we have chosen the standard maximal compact subgroup KH â€² = GLn (ODâ€² ) of H â€² (F ) = GLn (Dâ€² ) in Case I (resp. KH â€² = GL n2 (ODâŠ—F E ) of
H â€² (F ) = GL n2 (D âŠ—F E) in Case II). Since Ad(Ï„ )(Dâ€² ) = Dâ€² in Case I (resp. Ad(Ï„ )(D âŠ—F E) = D âŠ—F E
in Case II), we deduce that Ad(Ï„ )(ODâ€² ) = ODâ€² in Case I (resp. Ad(Ï„ )(ODâŠ—F E ) = ODâŠ—F E in Case
II). Thus Ad(Ï„ )(KH â€² ) = KH â€² . Let hâ€² (OF ) := gln (ODâ€² ) in Case I (resp. hâ€² (OF ) := gl n2 (ODâŠ—F E ) in
Case II). Let sâ€² (OF ) := hâ€² (OF )Ï„ = Ï„ hâ€² (OF ) be an OF -lattice in sâ€² (F ) (see Section 3.3 for the choice of
Ï„ ). Let k â€² := hâ€² (OF ) âŠ• sâ€² (OF ), whose decomposition is stable under the adjoint action of KH â€² because
â€²
â€²
Ad(Ï„ )(KH â€² ) = KH â€² . For all P â€² âˆˆ F H (M0â€² ), we fix aP â€² âˆˆ AP â€² (F ) such that |Î±(aP â€² )|F < 1, âˆ€Î± âˆˆ âˆ†H
Pâ€² .
â€²
â€²
Starting from X âˆˆ N s âˆ© (sâ€² (OF ) âˆ’ ÌŸsâ€² (OF )), we obtain a group homomorphism Ï† : SL
(F )
2 (F ) â†’ G 
ÌŸ
by the Jacobson-Morozov theorem for symmetric spaces (Lemma 3.8). Denote aÏ† := Ï†
âˆˆ
ÌŸâˆ’1
H â€² (F ). Define P X as in (6.1.1), which contains the centraliser CentGâ€² (aÏ† ) of aÏ† in Gâ€² as a Levi factor.
Since aÏ† commutes with Î±, by Lemma 3.19, P X âˆ© H â€² is a parabolic subgroup of H â€² , which contains the
centraliser CentH â€² (aÏ† ) of aÏ† in H â€² as a Levi factor. We want to show that there exists x âˆˆ KH â€² such
â€²
â€²
that Ad(x)(P X âˆ© H â€² ) âˆˆ F H (M0â€² ) and that Ad(x)(P X ) âˆˆ F G (Me0â€² ).
32

â€²

Lemma 6.8. For Y âˆˆ N s , there exists x âˆˆ H â€² (F ) such that Ad(x)(Y ) is in the Jordan normal form,
i.e., diagonal block matrices with entries in Dâ€² Ï„ in Case I (resp. (D âŠ—F E)Ï„ in Case II) whose blocks
are of the form
ï£¶
ï£«
0 Ï„
ï£·
ï£¬
..
..
ï£·
ï£¬
.
.
ï£·.
ï£¬
ï£·
ï£¬
..
ï£­
. Ï„ ï£¸
0
Proof. It can be proved in the same way as [16, Lemmas 2.2 and 2.3] by linear algebra over a division
ring.

Thanks to Lemma 6.8, we can construct explicitly the above morphism Ï† (see [13, p. 184]). If X
â€²
is in the Jordan normal form, by loc. cit., we may choose aÏ† âˆˆ ALâ€² (F ) for some Lâ€² âˆˆ L H (M0â€² ) such
that CentH â€² (aÏ† ) = Lâ€² and that CentGâ€² (aÏ† ) = Leâ€² . For a general X as above, by Lemma 6.8, there exists
â€²
y âˆˆ H â€² (F ) such that Ad(y)(aÏ† ) âˆˆ ALâ€² (F ) for some Lâ€² âˆˆ L H (M0â€² ) satisfying CentH â€² (Ad(y)(aÏ† )) = Lâ€²
and CentGâ€² (Ad(y)(aÏ† )) = Leâ€² . Let x âˆˆ KH â€² be such that xâˆ’1 y âˆˆ (P X âˆ© H â€² )(F ). Then Ad(x)(P X âˆ© H â€² ) =
Ad(y)(P X âˆ© H â€² ) contains Lâ€² as a Levi factor and Ad(x)(P X ) = Ad(y)(P X ) contains Leâ€² as a Levi factor.
Furthermore, since Ad(x)(P X ) âˆ© H â€² = Ad(x)(P X âˆ© H â€² ), we see that Ad(x)(P X âˆ© H â€² ) and Ad(x)(P X )
fâ€² between F H â€² (M â€² ) and F Gâ€² (M â€² ).
are associated under the bijection P â€² 7â†’ P
0
e
0
â€²
fâ€² = Ad(x)(P X ). Put
Fix x âˆˆ KH â€² as above and denote P â€² := Ad(x)(P X âˆ© H â€² ) âˆˆ F H (M0â€² ). Then P
â€²
X
âˆ’1
a := Ad(x )(aP â€² ) âˆˆ H (F ). By the argument of [33, (3) in Â§IV.3], we show that
(6.2.1)

Ad(aX )(X) âˆˆ ÌŸsâ€² (OF ).

Proof of Proposition 6.7. We may apply the argument of Proposition 6.1 with obvious modifications.
Especially, one needs to use Proposition 4.4 and (6.2.1) to show an analogue of Lemma 6.5 for the case of
(Gâ€² , H â€² ). Additionally, to prove an analogue of Lemma 6.3 for this case, one may resort to the argument
rather than the consequence of some steps in the proof of [33, Lemme IV.3] since our definition of k â€² is
different from gâ€² (OF ) := gln (OD ). However, there is no essential difficulty with our preparation above
and we omit details here.

â€²

Corollary 6.9 (cf. Corollary 6.6). Let râ€² be an open compact subgroup of sâ€² (F ), M â€² âˆˆ L H (M0â€² ) and Ïƒ â€² âŠ†
fâ€² âˆ©sâ€²rs )(F ). Suppose that there exists a compact subset Ïƒ0â€² âŠ† (m
fâ€² âˆ©sâ€² )(F ) such that Ïƒ â€² âŠ† Ad(M â€² (F ))(Ïƒ0â€² ).
(m
â€²
Then there exists a finite subset {Yi : i âˆˆ I} âŠ† Ïƒ and a finite subset {fi : i âˆˆ I} âŠ† Ccâˆž (sâ€² (F )/râ€² ) such
that for all Y âˆˆ Ïƒ â€² and all f â€² âˆˆ Ccâˆž (sâ€² (F )/râ€² ), we have the equality
X
Hâ€²
â€²
Hâ€²
â€²
Hâ€²
â€²
JM
JM
â€² (Y, f ) =
â€² (Yi , f )JM â€² (Y, fi ).
iâˆˆI

7. Representability of the Fourier transform of weighted orbital integrals
7.1. The case of (G, H). Following [33, Â§V.6], we denote by E s the space of functions e : srs (F ) â†’ C
such that
(1) e is locally constant;
(2) for any open compact subset r of s(F ), there exist constants c > 0 and N âˆˆ N such that for all
X âˆˆ r âˆ© srs (F ), one has the inequality
|e(X)| â‰¤ c sup{1, âˆ’ log |Ds (X)|F }N .
âˆ’1/2

If e âˆˆ E s , the function X 7â†’ |Ds (X)|F
It defines then a distribution on s(F ):
(7.1.1)

e(X) is locally integrable on s(F ) thanks to Corollary 3.18.

âˆ€f âˆˆ Ccâˆž (s(F )), f 7â†’

Z

âˆ’1/2

s(F )

f (X)e(X)|Ds (X)|F

dX.

Denote by D s the space of distributions obtained in this way. The map E s â†’ D s defined above is an
isomorphism. For d âˆˆ D s , we shall always denote by ed its preimage in E s .
Notice that the notion E s can be defined for any symmetric pair, and that the definition D s can at
least be extended to the symmetric pair (M, MH , Ad(Ç«)), where M âˆˆ L G,Ï‰ (M0 ), since it appears as the
product of some copies of the form (G, H, Ad(Ç«)) in lower dimensions.
33

If d âˆˆ D s is Î·(Nrd(*))-invariant with respect to the adjoint action of H(F ), then so is ed âˆˆ E s and by
the Weyl integration formula (Proposition 3.14), we have the equality
Z
X
X
Mn
GLn âˆ’1
âˆ’1
G
|W (MH , c)|
JG
(Î·, X, f )ed (X)dX
(7.1.2)
d(f ) =
|W0 ||W0 |
MâˆˆL G,Ï‰ (M0 )

creg (F )

câˆˆTell (mâˆ©s)

G
for all f âˆˆ Ccâˆž (s(F )), where JG
(Î·, X, f ) is defined by (4.1.1).

Remark 7.1S (Glueing). Let d âˆˆ Ccâˆž (s(F ))âˆ— and (ri )iâˆˆI be a family of open compact subsets of s(F )
ri = s(F ). Suppose that for all i âˆˆ I, there exists di âˆˆ D s such that d(f ) = di (f ) for all
such that
iâˆˆI

f âˆˆ Ccâˆž (s(F )) with Supp(f ) âŠ† ri . Then d âˆˆ D s . Refer to [33, Remarque V.6] for the details.

G
Let M âˆˆ L G,Ï‰ (M0 ) and X âˆˆ (m âˆ© srs )(F ). Denote by JË†M
(Î·, X, *) the distribution on s(F ) defined by
G
G
JË†M
(Î·, X, f ) := JM
(Î·, X, fË†)

for all f âˆˆ Ccâˆž (s(F )), where the right hand side is defined by (4.1.1). We also have a similar definition
for the symmetric pair (M, MH , Ad(Ç«)), where M âˆˆ L G,Ï‰ (M0 ). The main result of this section is the
following.
Proposition 7.2 (Representability). Let M âˆˆ L G,Ï‰ (M0 ) and X âˆˆ (m âˆ© srs )(F ). Then the distribution
G
JË†M
(Î·, X, *) âˆˆ D s .
Remark 7.3. For M = G, Proposition 7.2 is essentially [37, Theorem 6.1.(i)] (see also [36, Theorem 6.2]).
The rest of this section is devoted to the proof of Proposition 7.2. We shall follow the main steps in
[33, Â§V.7-10].
Let c be a Cartan subspace of s. Recall that Tc denotes the centraliser of c in H. Suppose that
e0 : (Tc (F )\H(F )) Ã— creg (F ) â†’ C is a function such that
(1) e0 is locally constant;
(2) for any open compact subset r of s(F ), there exist constants c > 0 and N âˆˆ N such that for all
x âˆˆ Tc (F )\H(F ) and X âˆˆ creg (F ) satisfying Ad(xâˆ’1 )(X) âˆˆ r, one has the inequality
e0 (x, X) â‰¤ c sup{1, âˆ’ log |Ds (X)|F }N .

Following [33, Â§V.7], for f âˆˆ Ccâˆž (s(F )), we define
Z
Z
1/2
|Ds (X)|F
(7.1.3)
d0 (f ) :=

f (Ad(xâˆ’1 )(X))e0 (x, X)dxdX.

Tc (F )\H(F )

creg (F )

Lemma 7.4. Let c be a Cartan subspace of s. Suppose that e0 satisfies the above hypotheses. Then the
integral (7.1.3) is absolutely convergent. Moreover, the distribution d0 âˆˆ D s .
Proof. We define a function eâ€² : srs (F ) â†’ C by
X
(7.1.4)
eâ€² (X) :=

e0 (x, Ad(x)(X))

{xâˆˆTc (F )\H(F ):Ad(x)(X)âˆˆc(F )}

for all X âˆˆ srs (F ). If X âˆˆ
/ Ad(H(F ))(creg (F )), then eâ€² (X) = 0. If X âˆˆ Ad(H(F ))(creg (F )), then
the sum in (7.1.4) is actually over the finite set W (H, c)y, where y âˆˆ H(F ) is any element such that
Ad(y)(X) âˆˆ c(F ). Hence, eâ€² is well-defined.
Additionally, one may check that eâ€² âˆˆ E s from the hypotheses on e0 . Let dâ€² âˆˆ D s be the distribution
associated to eâ€² by (7.1.1). For all f âˆˆ Ccâˆž (s(F )), by the Weyl integration formula (3.1.2), we have
Z
Z
1/2
â€²
âˆ’1
s
f (Ad(xâˆ’1 )(X))eâ€² (Ad(xâˆ’1 )(X))dxdX.
(7.1.5)
d (f ) = |W (H, c)|
|D (X)|F
creg (F )

Since
eâ€² (Ad(xâˆ’1 )(X)) =

Tc (F )\H(F )

X

e0 (wx, Ad(w)(X))

wâˆˆW (H,c)

for all x âˆˆ Tc (F )\H(F ) and all X âˆˆ creg (F ), we deduce that
Z
X Z
1/2
dâ€² (f ) = |W (H, c)|âˆ’1
f (Ad(xâˆ’1 )(X))e0 (wx, Ad(w)(X))dxdX.
|Ds (X)|F
wâˆˆW (H,c)

creg (F )

Tc (F )\H(F )

34

Applying the change of variables X 7â†’ Ad(wâˆ’1 )(X) and x 7â†’ wâˆ’1 x, which does not modify the Haar
measures, we obtain
dâ€² (f ) = d0 (f )
for all f âˆˆ Ccâˆž (s(F )). That is to say, d0 = dâ€² âˆˆ D s .
Note that in the argument above, we have used the convergence of an analogue of (7.1.5) with e0 and
f replaced by their absolute values. It also results in the absolute convergence of (7.1.3).

Corollary 7.5 (Parabolic induction). Let M âˆˆ L G,Ï‰ (M0 ), P âˆˆ P G (M ) and d âˆˆ D mâˆ©s . Then the
distribution on s(F ) defined by âˆ€f âˆˆ Ccâˆž (s(F )), f 7â†’ d(fPÎ· ) belongs to D s , where fPÎ· is defined by (3.2.2).

Proof. Applying the Weyl integration formula (3.1.2) to d(fPÎ· ), we see that it suffices to fix a Cartan
subspace c âŠ† m âˆ© s and prove that the distribution on s(F ) defined by
(7.1.6)
Z
Z
1/2
|Dmâˆ©s (X)|F
âˆ€f âˆˆ Ccâˆž (s(F )), f 7â†’
fPÎ· (Ad(xâˆ’1 )(X))ed (Ad(xâˆ’1 )(X))dxdX
creg (F )

Tc (F )\MH (F )

belongs to D s . Recall that ed âˆˆ E mâˆ©s is associated to d by (7.1.1).
Define a function e1 : H(F ) Ã— creg (F ) â†’ C by
Z
(7.1.7)
e1 (x, X) := Î·(Nrd(x))
ed (Ad(mP (x)k)âˆ’1 (X))Î·(Nrd(mP (x)k))dk
MH (F )âˆ©K

for all x âˆˆ H(F ) and all X âˆˆ creg (F ), where mP (x) âˆˆ MH (F ) is any element such that mP (x)âˆ’1 x âˆˆ
NPH (F )KH . Since KH is a special subgroup of H(F ), such mP (x) is well-defined modulo MH (F ) âˆ© K.
Hence, the integral (7.1.7) is independent of the choice of mP (x). The function e1 is left Tc (F )-invariant
on the first variable, so it induces a function (still denoted by e1 ) : Tc (F )\H(F ) Ã— creg (F ) â†’ C.
We shall check that e1 verifies the hypotheses of Lemma 7.4. Firstly, e1 is locally constant because
ed is locally constant and e1 is right KH -invariant on the first variable. Secondly, suppose that r is
an open compact subset of s(F ). We fix an open compact subset rM âŠ† (m âˆ© s)(F ) such that if X âˆˆ
(mâˆ©s)(F ), U âˆˆ (nP âˆ©s)(F ), k âˆˆ KH satisfy Ad(k)(X +U ) âˆˆ r, then X âˆˆ rM ; this is possible for it suffices
to let rM contain the projection of Ad(KH )(r) to (m âˆ© s)(F ). Replacing rM with Ad(MH (F ) âˆ© K)(rM )
if necessary, we may additionally assume that
(7.1.8)

Ad(MH (F ) âˆ© K)(rM ) = rM .

Since ed âˆˆ E mâˆ©s , there exist constants c > 0 and N âˆˆ N such that

|ed (X)| â‰¤ c sup{1, âˆ’ log |Dmâˆ©s (X)|F }N

for all X âˆˆ rM âˆ© (m âˆ© s)rs (F ). One sees from (3.1.1) that for all X âˆˆ (m âˆ© s)rs (F ),
1/2

|Ds (X)|F |Dmâˆ©s (X)|âˆ’1
F = | det(ad(X)|g/m )|F .
Hence, |Ds (X)|F |Dmâˆ©s (X)|âˆ’1
F is bounded for X âˆˆ rM âˆ© (m âˆ© s)rs (F ). Recall that m âˆ© srs âŠ† (m âˆ© s)rs (see
Section 3.2) and that |Ds (X)|F 6= 0 for X âˆˆ srs (F ) (see Section 3.1). We deduce that there exists câ€² > 0
such that
(7.1.9)

|ed (X)| â‰¤ câ€² sup{1, âˆ’ log |Ds (X)|F }N

for all X âˆˆ rM âˆ© srs (F ). Now, suppose that x âˆˆ Tc (F )\H(F ) and X âˆˆ creg (F ) satisfy Ad(xâˆ’1 )(X) âˆˆ r.
Write x = mnk with m âˆˆ MH (F ), n âˆˆ NPH (F ) and k âˆˆ KH . Then
Ad(xâˆ’1 )(X) = Ad(k âˆ’1 )(Ad(mâˆ’1 )(X) + U ),

where U := Ad(nâˆ’1 mâˆ’1 )(X) âˆ’ Ad(mâˆ’1 )(X) âˆˆ (nP âˆ© s)(F ). Thus Ad(mâˆ’1 )(X) âˆˆ rM by our assumption
on rM . Thanks to (7.1.8) and (7.1.9), we obtain
|e1 (x, X)| â‰¤ câ€² sup{1, âˆ’ log |Ds (X)|F }N .
To sum up, e1 verifies the hypotheses of Lemma 7.4.
Applying Lemma 7.4 to c and e1 , we know that the distribution d1 on s(F ) defined by
Z
Z
1/2
f (Ad(xâˆ’1 )(X))e1 (x, X)dxdX
|Ds (X)|F
âˆ€f âˆˆ Ccâˆž (s(F )), d1 (f ) :=
Tc (F )\H(F )

creg (F )

35

belongs to D s . Note that e1 (mnk, X) = Î·(Nrd(k))e1 (m, X) for m âˆˆ MH (F ), n âˆˆ NPH (F ), k âˆˆ KH . By
the same argument as the proof of Proposition 4.1.4), one shows that
Z
Z
1/2
d1 (f ) =
|Dmâˆ©s (X)|F
fPÎ· (Ad(mâˆ’1 )(X))e1 (m, X)dmdX
creg (F )

=

Z

creg (F )

Tc (F )\MH (F )

|D

mâˆ©s

1/2
(X)|F

Z

Tc (F )\MH (F )

fPÎ· (Ad(mâˆ’1 )(X))

Z

ed (Ad(mk)âˆ’1 (X))Î·(Nrd(k))
MH (F )âˆ©K

dkdmdX.
Note that for k âˆˆ MH (F ) âˆ© K, we have Ad(k âˆ’1 )fPÎ· = Î·(Nrd(k))fPÎ· . By the change of variables mk 7â†’ m,

one can eliminate the integral over MH (F ) âˆ© K and see that d1 is the same as (7.1.6).

Let M âˆˆ L G,Ï‰ (M0 ) and d âˆˆ D mâˆ©s . Suppose that d is Î·(Nrd(*))-invariant with respect to the adjoint
action of MH (F ). Following [33, Â§V.9], we define a distribution IndG,w
M (d) on s(F ) by
(7.1.10)
Z
X
X
Ln
Mn âˆ’1
âˆ’1
G
|W
(L
,
c)|
JM
(Î·, X, f )ed (X)dX
IndG,w
(d)(f
)
:=
|W
||W
|
H
0
0
M
{LâˆˆL G,Ï‰ (M0 ):LâŠ†M}

câˆˆTell (lâˆ©s)

creg (F )

G
for all f âˆˆ Ccâˆž (s(F )), where JM
(Î·, X, f ) is defined by (4.1.1). In particular, if M = G and d âˆˆ D s is
Î·(Nrd(*))-invariant with respect to the adjoint action of H(F ), we have IndG,w
G (d) = d by (7.1.2).

Corollary 7.6. Let M âˆˆ L G,Ï‰ (M0 ) and d âˆˆ D mâˆ©s . Suppose that d is Î·(Nrd(*))-invariant with respect
to the adjoint action of MH (F ). Then the integral (7.1.10) is absolutely convergent. Moreover, the
s
distribution IndG,w
M (d) âˆˆ D .
Remark 7.7. This corollary is unnecessary for the proof of Proposition 7.2 but useful in Section 8.1.
Proof of Corollary 7.6. It suffices to fix a Cartan subspace c âŠ† m âˆ© s and prove the same assertion for
the distribution on s(F ) defined by
Z
G
âˆž
JM
(Î·, X, f )ed (X)dX.
(7.1.11)
âˆ€f âˆˆ Cc (s(F )), f 7â†’
creg (F )

Define a function e2 : (Tc (F )\H(F )) Ã— creg (F ) â†’ C by

(7.1.12)

G
e2 (x, X) := Î·(Nrd(x))vM
(x)ed (X)

for all x âˆˆ Tc (F )\H(F ) and all X âˆˆ creg (F ). It is locally constant. Note that ed (Ad(mâˆ’1 )(X)) =
Î·(Nrd(m))ed (X) for x âˆˆ MH (F ) and X âˆˆ (m âˆ© srs )(F ) by our assumption on d. Thus we may use the
same argument as in the proof of Corollary 7.5 to show the inequality
|ed (X)| = |ed (Ad(mâˆ’1 )(X))| â‰¤ câ€² sup{1, âˆ’ log |Ds (X)|F }N .

G
(x). In sum, e2 verifies the hypotheses of Lemma
Thanks to Lemma 4.2, one has a similar bound for vM
7.4.
Applying Lemma 7.4 to c and e2 , we know that the integral
Z
Z
1/2
|Ds (X)|F
âˆ€f âˆˆ Ccâˆž (s(F )), f 7â†’
f (Ad(xâˆ’1 )(X))e2 (x, X)dxdX
creg (F )

Tc (F )\H(F )

is absolutely convergent and defines a distribution in D s . This distribution is the same as (7.1.11).



mâˆ©s

Remark 7.8. Instead of the hypothesis ed âˆˆ E
, an analogue of Corollary 7.6 holds if one assumes
that d is defined via (7.1.1) by a function ed : (m âˆ© srs )(F ) â†’ C locally constant, Î·(Nrd(*))-invariant
with respect to the adjoint action of MH (F ), and such that for any open compact subset r of (m âˆ© s)(F ),
there exist constants c > 0 and N âˆˆ N such that for all X âˆˆ r âˆ© srs (F ), one has the inequality
|ed (X)| â‰¤ c sup{1, âˆ’ log |Ds (X)|F }N .

The proof is the same, except that we need not use the boundedness of |Ds (X)|F |Dmâˆ©s (X)|âˆ’1
F for
X âˆˆ rM âˆ© srs (F ) (see the proof of Corollary 7.5).

Lemma 7.9. Let M âˆˆ L G,Ï‰ (M0 ) and c âŠ† m âˆ© s be an M -elliptic Cartan subspace.
1) Let M â€² âˆˆ L G,Ï‰ (M0 ), câ€² âˆˆ Tell (mâ€² âˆ© s) and x âˆˆ H(F ) be such that Ad(x)(c) = câ€² . Then there exist
â€²
elements mâ€² âˆˆ MH
(F ) and w âˆˆ NormH(F ) (M0 ) such that x = mâ€² w.
2) The cardinality of
{(M â€² , câ€² ) : M â€² âˆˆ L G,Ï‰ (M0 ), câ€² âˆˆ Tell (mâ€² âˆ© s), câ€² is H(F )-conjugate to c}
36

is
|W0GLn ||W0Mn |âˆ’1 |W (MH , c)||W (H, c)|âˆ’1 .
Proof. 1) Since c âŠ† m âˆ© s (resp. câ€² âŠ† mâ€² âˆ© s) is M -elliptic (resp. M â€² -elliptic), we have ATc = AM
(resp. ATcâ€² = AM â€² ). From Ad(x)(c) = câ€² , we obtain Ad(x)(ATc ) = ATcâ€² , Ad(x)(AM ) = AM â€² and
â€²
Ad(x)(M ) = M â€² , which implies that Ad(x)(MH ) = MH
. Then 1) can be shown by the same argument
as in the proof of Lemma 3.13.1).
2) We can and shall identify an M -elliptic (resp. M â€² -elliptic) Cartan subspace in m âˆ© s (resp. mâ€² âˆ© s)
â€²
â€²
with its MH (F )(resp. MH
(F ))-conjugacy class. Then Tell (mâ€² âˆ© s) is identified to the set of MH
(F )â€²
â€²
3.13.1),
we
also
conjugacy classes of M -elliptic
Cantan
subspaces
in
m
âˆ©
s.
As
in
the
proof
of
Lemma



w
GL
n
: wn âˆˆ W0 n,D acts transitively on the set of pairs in 2).
see that the group W0H,Ï‰ :=
wn
Firstly, let us count M â€² appearing in the pairs (cf. [22, p.426]). 
wn
Since M âˆˆ L G,Ï‰ (M0 ), for w âˆˆ W0H,Ï‰ , we see that w =
âˆˆ NormW H,Ï‰ (M ) if and only if
0
wn
wn âˆˆ Norm GLn,D (Mn,D ), where NormW H,Ï‰ (M ) (resp. Norm GLn,D (Mn,D )) denotes the normaliser of
W0

W0

0

M (resp. Mn,D ) in

W0H,Ï‰

(resp.

GL
W0 n,D ).

GLn,D

|W0

Hence, the number of M â€² is

||Norm

GLn,D

W0

(Mn,D )|âˆ’1 .

Secondly, for such an M â€² fixed, we count câ€² such that (M â€² , câ€² ) belongs to the set of pairs in 2) (cf. [22,
Lemma 7.1]).
For x âˆˆ H(F ), we claim that Ad(x)(câ€² ) âŠ† mâ€² âˆ© s if and only if x âˆˆ NormH(F ) (M â€² ), which denotes the
normaliser of M â€² in H(F ). On the one hand, suppose that Ad(x)(câ€² ) âŠ† mâ€² âˆ© s. Then AM â€² âŠ† CentH (mâ€² âˆ©
s) âŠ† Ad(x)(Tcâ€² ), where CentH (mâ€² âˆ© s) denotes the centraliser of mâ€² âˆ© s in H. Since Ad(x)(AM â€² ) =
Ad(x)(ATcâ€² ) is the maximal F -split torus in Ad(x)(Tcâ€² ), we have AM â€² âŠ† Ad(x)(AM â€² ). By comparison
of dimensions, we deduce that Ad(x)(AM â€² ) = AM â€² , so x âˆˆ NormH(F ) (M â€² ). On the other hand, suppose
that x âˆˆ NormH(F ) (M â€² ). Since x âˆˆ H(F ), we have Ad(x)(mâ€² âˆ© s) = (mâ€² âˆ© s). But câ€² âŠ† mâ€² âˆ© s, so we
obtain Ad(x)(câ€² ) âŠ† mâ€² âˆ© s. In sum, we have proved our claim.
From this claim, the number of câ€² is
â€²
|MH
(F )\NormH(F ) (M â€² )/NormH(F ) (câ€² )|.

â€²
Since MH
(F ) is a normal subgroup of NormH(F ) (M â€² ), we know that the number of the double cosets is
equal to
â€²
â€²
(F )||NormH(F ) (câ€² )/(NormH(F ) (câ€² ) âˆ© MH
(F ))|âˆ’1
|NormH(F ) (M â€² )/MH

â€²
=|NormH(F ) (M â€² )/MH
(F )||NormH(F ) (câ€² )/NormMHâ€² (F ) (câ€² )|âˆ’1 .

For x âˆˆ NormH(F ) (M â€² ), we have Ad(x)(AM â€² ) = AM â€² . Because M â€² âˆˆ L G,Ï‰ (M0 ), there exists w âˆˆ W0H,Ï‰
â€²
(F ), where CentH(F ) (AM â€² ) denotes the centraliser of AM â€² in
such that wâˆ’1 x âˆˆ CentH(F ) (AM â€² ) = MH
â€²
H(F ). Since x âˆˆ NormH(F ) (M ), we have w âˆˆ NormW H,Ï‰ (M â€² ). That is to say,
0

â€²

â€²
NormH(F ) (M ) = NormW H,Ï‰ (M â€² )MH
(F ).
0

Therefore,
â€²
â€²
|NormH(F ) (M â€² )/MH
(F )| =|NormW H,Ï‰ (M â€² )||(NormW H,Ï‰ (M â€² ) âˆ© MH
(F ))|âˆ’1
0

0

=|Norm

â€²
â€²
(Mn,D
)||(W0H,Ï‰ âˆ© MH
(F ))|âˆ’1

=|Norm

â€²
(Mn,D
)||W0

GL
W0 n,D

GL
W0 n,D

â€²
Mn,D
âˆ’1

GLn,D

â€²
and Mn,D are W0
Since M â€² and M are W0H,Ï‰ -conjugate, Mn,D
â€²
|NormH(F ) (M â€² )/MH
(F )| = |Norm

GLn,D

W0

|

.

-conjugate. Hence,
Mn,D âˆ’1

(Mn,D )||W0

|

.

We also have
|NormH(F ) (câ€² )/NormMHâ€² (F ) (câ€² )| =|NormH(F ) (câ€² )/Tcâ€² (F )||NormMHâ€² (F ) (câ€² )/Tcâ€² (F )|âˆ’1
â€²
=|W (H, câ€² )||W (MH
, câ€² )|âˆ’1 .
37

Since (M â€² , câ€² ) and (M, c) are W0H,Ï‰ -conjugate, we obtain
|NormH(F ) (câ€² )/NormMHâ€² (F ) (câ€² )| = |W (H, c)||W (MH , c)|âˆ’1 .

To sum up, the number of câ€² is
|Norm

GLn,D

W0

Mn,D âˆ’1

|

(Mn,D )||W0

|W (MH , c)||W (H, c)|âˆ’1 .

Finally, combining the numbers of M â€² and câ€² , we obtain the number of pairs (M â€² , câ€² ) in 2).



Proof of Proposition 7.2. First of all, suppose that X âˆˆ (m âˆ© srs )(F )ell . Then c := sX âŠ† m âˆ© s is
an M -elliptic Cartan subspace and X âˆˆ creg (F ). Fix an open compact subgroup r âŠ† s(F ) and set
râˆ— := {Y âˆˆ s(F ) : âˆ€Z âˆˆ r, Î¨(hY, Zi) = 1}, which is also an open compact subgroup of s(F ). For all
L âˆˆ L G (M ), fix an open compact subgroup rL âŠ† (lâˆ©s)(F ) such that if Q âˆˆ P G (L) and if f âˆˆ Ccâˆž (s(F ))
Î·
Î·
âˆ—
in the same way
satisfies Supp(f ) âŠ† r, then Supp(fQ
) âŠ† rL , where fQ
is defined by (3.2.2). Define rL
âˆ—
as r .
There exists a neighbourhood Ïƒ of X in creg (F ) such that for all L âˆˆ L G (M ) and all f âˆˆ Ccâˆž ((l âˆ©
âˆ—
L
s)(F )/rL
), the function JM
(Î·, *, f ) is constant on Ïƒ. In fact, for L and f fixed, this results from Proposition 4.1.2) (actually its product form is needed). It suffices to apply Howe's finiteness (the product form
of Corollary 6.6) to each symmetric pair (L, LH , Ad(Ç«)) and an arbitrary compact neighbourhood of X
in creg (F ), and then take the intersection of a finite number of neighbourhoods involved.
We shall fix a Ïƒ satisfying the above condition and such that if two elements of Ïƒ are H(F )-conjugate
(or equivalently W (H, c)-conjugate), then they are the same. The latter condition is achievable since
the W (H, c)-conjugates of an element in creg (F ) form a finite subset, which is discrete. Consider the
local isomorphism Î² : (Tc (F )\H(F )) Ã— creg (F ) â†’ srs (F ) of F -analytic manifolds induced by the adjoint
action. Its restriction to (Tc (F )\H(F )) Ã— Ïƒ is injective. Choose a neighbourhood Îµ of 1 in Tc (F )\H(F )
such that Î·(Nrd(Îµ)) = 1. The set Î²(Îµ, Ïƒ) is a neighbourhood of X in s(F ). Fix a function f â€² âˆˆ Ccâˆž (s(F ))
such that Supp(f â€² ) âŠ† Î²(Îµ, Ïƒ), f â€² â‰¥ 0 and f â€² (X) 6= 0.
Let f âˆˆ Ccâˆž (s(F )) with Supp(f ) âŠ† r. We shall calculate J G (Î·, fË†, f â€² ), which is defined by (5.1.2).
Consider M â€² âˆˆ L G,Ï‰ (M0 ) and câ€² âˆˆ Tell (mâ€² âˆ© s). If câ€² and c are not H(F )-conjugate, by our choice
G
â€²
â€²
Ë† â€²
of f â€² , the function JM
â€² (Î·, *, f , f ) vanishes on creg (F ). Now suppose that c and c are H(F )-conjugate.
â€²
â€²
Let x âˆˆ H(F ) be such that Ad(x)(c) = c . By Lemma 7.9.1), there exist elements mâ€² âˆˆ MH
(F ) and
â€²
â€²
â€²
w âˆˆ NormH(F ) (M0 ) such that x = m w. By Proposition 5.1.4), for X âˆˆ creg (F ), we have
G
â€² Ë† â€²
G
â€² âˆ’1
JM
)(X â€² ), fË†, f â€² )
â€² (Î·, X , f , f ) = JM â€² (Î·, Ad(m

G
= JAd(w)(M)
(Î·, Ad(wxâˆ’1 )(X â€² ), fË†, f â€² )
G
= JM
(Î·, Ad(xâˆ’1 )(X â€² ), fË†, f â€² ).

From our choices of Haar measures, we obtain
Z
Z
G
â€² Ë† â€²
JM â€² (Î·, X , f , f ) =
câ€²reg (F )

creg (F )

G
JM
(Î·, Y, fË†, f â€² )dY.

By Lemma 7.9.2), the number of pairs (M â€² , câ€² ) with câ€² being H(F )-conjugate to c is
|W0GLn ||W0Mn |âˆ’1 |W (MH , c)||W (H, c)|âˆ’1 .
We deduce that
J (Î·, fË†, f â€² ) = (âˆ’1)dim(AM /AG ) |W (H, c)|âˆ’1
G

Z

creg (F )

G
JM
(Î·, Y, fË†, f â€² )dY.

G
It follows from our `
choice of f â€² that the support of the restriction to creg (F ) of the function JM
(Î·, *, fË†, f â€² )
is contained in
Ad(w)(Ïƒ). Then
wâˆˆW (H,c)

Z

creg (F )

G
(Î·, Y, fË†, f â€² )dY =
JM

X

wâˆˆW (H,c)

Z

creg (F )

G
JM
(Î·, Y, fË†, f â€² )1Ad(w)(Ïƒ) (Y )dY,

where 1Ad(w)(Ïƒ) denotes the characteristic function of Ad(w)(Ïƒ). By the change of variables Y 7â†’
Ad(w)(Y ), which does not modify the Haar measure, we have
Z
Z
G
G
JM
(Î·, Ad(w)(Y ), fË†, f â€² )dY.
JM
(Î·, Y, fË†, f â€² )1Ad(w)(Ïƒ) (Y )dY =
Ïƒ

creg (F )

38

Since w âˆˆ W (H, c), we have shown above that

G
G
JM
(Î·, Ad(w)(Y ), fË†, f â€² ) = JM
(Î·, Y, fË†, f â€² ),

which is independent of w. Therefore,
J (Î·, fË†, f â€² ) = (âˆ’1)dim(AM /AG )
G

Z

Ïƒ

G
JM
(Î·, Y, fË†, f â€² )dY.

G
Let Y âˆˆ Ïƒ. Applying the splitting formula for JM
(Î·, Y, fË†, f â€² ) (Proposition 5.1.6)), we have
X
L2
L1
â€²Î·
G
Ë†Î·
JM
(Î·, Y, fË†, f â€² ) =
dG
M (L1 , L2 )JM (Î·, Y, fQ )JM (Î·, Y, f Q2 ).
1

L1 ,L2 âˆˆL G (M)

Î·
Î·
Î·
âˆ—
is invariant by translation of rM
For all Q âˆˆ F G (M ), since Supp(fQ
) âŠ† rMQ , fË†Q
. In particular, fË†Q
Q
1
L1
âˆ—
Ë†Î· ) is constant on Ïƒ and thus equal to
is invariant by rL
.
Then
by
our
assumption
on
Ïƒ,
J
(Î·,
*,
f
M
1
Q1
J L1 (Î·, X, fË†Î· ). Therefore,
M

Q1

J G (Î·, fË†, f â€² ) =

X

Î·
L1
),
c(L1 , L2 )JM
(Î·, X, fË†Q
1

L1 ,L2 âˆˆL G (M)

where
dim(AM /AG )
c(L1 , L2 ) := dG
M (L1 , L2 )(âˆ’1)

Z

Î·

Ïƒ

L2
JM
(Î·, Y, f â€² Q2 )dY.

We claim that c(G, M ) 6= 0. In fact, from (1) and (4) in Section 2.7, we have
Z
Î·
M
c(G, M ) = (âˆ’1)dim(AM /AG ) JM
(Î·, Y, f â€² Q2 )dY,
Ïƒ

where MQ2 = M . By Proposition 4.1.4), we have
Î·

Q2
M
(Î·, Y, f â€² ).
JM
(Î·, Y, f â€² Q2 ) = JM
Q2
= 1, we obtain
Since vM
Q2
G
(Î·, Y, f â€² ) = JG
(Î·, Y, f â€² ).
JM

Hence,
c(G, M ) = (âˆ’1)dim(AM /AG )

Z

1/2

Ïƒ

|Ds (Y )|F

Z

f â€² (Ad(xâˆ’1 )(Y ))Î·(Nrd(x))dxdY.

HY (F )\H(F )

If Ad(xâˆ’1 )(Y ) âˆˆ Supp(f â€² ) âŠ† Î²(Îµ, Ïƒ), since the restriction of Î² to (HY (F )\H(F )) Ã— Ïƒ is injective, we
have x âˆˆ Îµ and then Î·(Nrd(x)) = 1. Since f â€² â‰¥ 0 and f â€² (X) 6= 0, we deduce our claim. Now, because of
(3) in Section 2.7, we have
X
Î·
L1
G
)
(7.1.13)
JË†M
(Î·, X, f ) = J G (Î·, fË†, f â€² ) âˆ’
c(L1 , L2 )c(G, M )âˆ’1 JË†M
(Î·, X, fQ
1

L1 ,L2 âˆˆL G (M),L1 6=G

for all f âˆˆ Ccâˆž (s(F )) with Supp(f ) âŠ† r.
By induction on the dimension of G and parabolic induction (Corollary 7.5), one can suppose that
Î·
L1
)
for all L1 âˆˆ L G (M ), L1 6= G, the distribution on s(F ) defined by âˆ€f âˆˆ Ccâˆž (s(F )), f 7â†’ JË†M
(Î·, X, fQ
1
belongs to D s . This is actually a product form of the induction hypothesis in lower dimensions.
We claim that the distribution on s(F ) defined by âˆ€f âˆˆ Ccâˆž (s(F )), f 7â†’ J G (Î·, fË†, f â€² ) belongs to D s
(cf. [33, (3) in Â§V.10]). In fact, thanks to the noninvariant trace formula (Theorem 5.3), one can replace
J G (Î·, fË†, f â€² ) with J G (Î·, f, fË†â€² ). By its definition (5.1.2), it suffices to fix M â€² âˆˆ L G,Ï‰ (M0 ), câ€² âˆˆ Tell (mâ€² âˆ© s)
and prove that the distribution on s(F ) defined by
Z
âˆž
G
Ë†â€²
âˆ€f âˆˆ Cc (s(F )), f 7â†’
JM
â€² (Î·, Y, f, f )dY
câ€²reg (F )

belongs to D s . By the splitting formula (Proposition 5.1.6)), it suffices to fix Lâ€²1 , Lâ€²2 âˆˆ L G (M â€² ) and
prove that the distribution on s(F ) defined by
Z
Î·
Lâ€²
Lâ€²
JM1â€² (Î·, Y, f Î· â€² )JM2â€² (Î·, Y, fË†â€² Qâ€²2 )dY,
âˆ€f âˆˆ Ccâˆž (s(F )), f 7â†’
Q1

câ€²reg (F )

39

where (Qâ€²1 , Qâ€²2 ) := s(Lâ€²1 , Lâ€²2 ), belongs to D s . By Proposition 4.1.4) and the definition (4.1.1), we have
Z
Qâ€²1
Qâ€²
Lâ€²1
1/2
Î·
s
JM â€² (Î·, Y, fQâ€² ) = JM â€² (Î·, Y, f ) = |D (Y )|F
f (Ad(xâˆ’1 )(Y ))Î·(Nrd(x))vM1â€² (x)dx.
1

Then

Z

Î·
L
L
JM1â€² (Î·, Y, f Î· â€² )JM2â€² (Î·, Y, fË†â€² Qâ€²2 )dY
â€²

â€²

câ€²reg (F )

=

HY (F )\H(F )

Z

Q1

1/2

câ€²reg (F )

|Ds (Y )|F

Z

Î·
Q
L
f (Ad(xâˆ’1 )(Y ))Î·(Nrd(x))vM1â€² (x)JM2â€² (Î·, Y, fË†â€² Qâ€²2 )dxdY.
â€²

â€²

Tcâ€² (F )\H(F )

Define a function e3 : (Tcâ€² (F )\H(F )) Ã— câ€²reg (F ) â†’ C by
Î·
Q
L
e3 (x, Y ) := Î·(Nrd(x))vM1â€² (x)JM2â€² (Î·, Y, fË†â€² Qâ€²2 ).
â€²

â€²

Qâ€²

It is locally constant by the product form of Proposition 4.1.2). Using Lemma 4.2 to dominate vM1â€² (x)
Î·
Lâ€²
and Corollary 4.3 to dominate JM2â€² (Î·, Y, fË†â€² Qâ€²2 ), we check that e3 verifies the hypotheses of Lemma 7.4,
which implies our claim.
G
(Î·, X, *) conincides with some element in D s for all
Now (7.1.13) shows that the distribution JË†M
âˆž
G
f âˆˆ Cc (s(F )) with Supp(f ) âŠ† r. By glueing (Remark 7.1), the distribution JË†M
(Î·, X, *) âˆˆ D s .
Finally, consider a general X âˆˆ (m âˆ© srs )(F ). There exists x âˆˆ MH (F ) such that Y := Ad(xâˆ’1 )(X) âˆˆ
G
G
(l âˆ© s)(F )ell for some L âˆˆ L G,Ï‰ (M0 ), L âŠ† M . Then JË†M
(Î·, X, *) = Î·(Nrd(x))JË†M
(Î·, Y, *). Applying
the descent formula (Proposition 4.1.5)), the product form of the elliptic case that we have just proved
(applied to Y âˆˆ (l âˆ© s)(F )ell ) and parabolic induction (Corollary 7.5), we deduce that the distribution
G
G
JË†M
(Î·, Y, *) âˆˆ D s . Thus the distribution JË†M
(Î·, X, *) âˆˆ D s .

â€²

â€²

7.2. The case of (Gâ€² , H â€² ). We define E s in the same way as the previous case. For e âˆˆ E s , thanks to
Corollary 3.24, it defines a distribution on sâ€² (F ):
Z
â€²
âˆ’1/2
f â€² (Y )e(Y )|Ds (Y )|F dY.
(7.2.1)
âˆ€f â€² âˆˆ Ccâˆž (sâ€² (F )), f â€² 7â†’
sâ€² (F )

â€²

â€²

Denote by D s the space of distributions obtained in this way. For d âˆˆ D s , we shall always denote by
â€²
â€²
â€²
ed âˆˆ E s its preimage under the isomorphism E s â†’ D s defined above. One may extend these definitions
fâ€² , M â€² , Ad(Î±)), where M â€² âˆˆ L H â€² (M â€² ). If d âˆˆ D sâ€² is invariant with respect to
to the symmetric pair (M
0
â€²
the adjoint action of H â€² (F ), then so is ed âˆˆ E s and by the Weyl integration formula (Proposition 3.21),
we have the equality
Z
X
X
â€²
â€²
Hâ€²
â€²
|W (M â€² , câ€² )|âˆ’1
(7.2.2)
d(f â€² ) =
JH
|W0M ||W0H |âˆ’1
â€² (Y, f )ed (Y )dY
M â€² âˆˆL H â€² (M0â€² )

câ€²reg (F )

fâ€² âˆ©sâ€² )
câ€² âˆˆTell (m

â€²

H
â€²
for all f â€² âˆˆ Ccâˆž (sâ€² (F )), where JH
â€² (Y, f ) is defined by (4.2.1).
â€²
fâ€² âˆ© sâ€²rs )(F ). Denote by JË†H â€²â€² (Y, *) the distribution on sâ€² (F ) defined by
Let M â€² âˆˆ L H (M0â€² ) and Y âˆˆ (m
M
Hâ€²
â€²
Hâ€²
Ë†â€²
JË†M
â€² (Y, f ) := JM â€² (Y, f )

for all f â€² âˆˆ Ccâˆž (sâ€² (F )), where the right hand side is defined by (4.2.1). One also has a similar definition
fâ€² , M â€² , Ad(Î±)), where M â€² âˆˆ L H â€² (M0â€² ).
for the symmetric pair (M
â€²
fâ€² âˆ© sâ€²rs )(F ). Then the distribution
Proposition 7.10 (Representability). Let M â€² âˆˆ L H (M0â€² ) and Y âˆˆ (m
â€²
â€²
H
s
JË†M â€² (Y, *) âˆˆ D .

The rest of this section is devoted to the proof of Proposition 7.10. Although it is similar to the proof
of Proposition 7.2, we shall sketch some steps for later use.
Let câ€² be a Cartan subspace of sâ€² . Recall that Tcâ€² denotes the centraliser of câ€² in H â€² . Suppose that
e0 : (Tcâ€² (F )\H â€² (F )) Ã— câ€²reg (F ) â†’ C is a function such that
(1) e0 is locally constant;
(2) for any open compact subset râ€² of sâ€² (F ), there exist constants c > 0 and N âˆˆ N such that for all
x âˆˆ Tcâ€² (F )\H â€² (F ) and Y âˆˆ câ€²reg (F ) satisfying Ad(xâˆ’1 )(Y ) âˆˆ râ€² , one has the inequality
â€²

e0 (x, Y ) â‰¤ c sup{1, âˆ’ log |Ds (Y )|F }N .
40

For f â€² âˆˆ Ccâˆž (sâ€² (F )), we define
Z
â€²
(7.2.3)
d0 (f ) :=

sâ€²

câ€²reg (F )

|D (Y

1/2
)|F

Z

f â€² (Ad(xâˆ’1 )(Y ))e0 (x, Y )dxdY.

Tcâ€² (F )\H â€² (F )

Lemma 7.11 (cf. Lemma 7.4). Let câ€² be a Cartan subspace of sâ€² . Suppose that e0 satisfies the above
â€²
hypotheses. Then the integral (7.2.3) is absolutely convergent. Moreover, the distribution d0 âˆˆ D s .
â€²

fâ€²

â€²

â€²

Corollary 7.12 (Parabolic induction). Let M â€² âˆˆ L H (M0â€² ), P â€² âˆˆ P H (M â€² ) and d âˆˆ D m âˆ©s . Then the
â€²
distribution on sâ€² (F ) defined by âˆ€f â€² âˆˆ Ccâˆž (sâ€² (F )), f â€² 7â†’ d(fPâ€² â€² ) belongs to D s , where fPâ€² â€² is defined by
(3.3.2).
Proof. We may apply the argument of Corollary 7.5 with the aid of Lemma 3.22.
fâ€²

â€²



â€²

Let M â€² âˆˆ L H (M0â€² ) and d âˆˆ D m âˆ©s . Suppose that d is invariant with respect to the adjoint action of
â€²
,w
â€²
â€²
M (F ). We define a distribution IndH
M â€² (d) on s (F ) by
(7.2.4)
Z
X
X
â€²
,w
â€²
Lâ€²
M â€² âˆ’1
â€² â€² âˆ’1
Hâ€²
â€²
IndH
(d)(f
)
:=
||W
|
|W
|W
(L
,
c
)|
JM
â€² (Y, f )ed (Y )dY
0
0
Mâ€²
{Lâ€² âˆˆL H â€² (M0â€² ):Lâ€² âŠ†M â€² }

câ€² âˆˆTell (leâ€² âˆ©sâ€² )

câ€²reg (F )

â€²

â€²

H
â€²
â€²
â€²
s
for all f â€² âˆˆ Ccâˆž (sâ€² (F )), where JM
is
â€² (Y, f ) is defined by (4.2.1). In particular, if M = H and d âˆˆ D
H â€² ,w
â€²
invariant with respect to the adjoint action of H (F ), we have IndH â€² (d) = d by (7.2.2).
fâ€²

â€²

â€²

Corollary 7.13. Let M â€² âˆˆ L H (M0â€² ) and d âˆˆ D m âˆ©s . Suppose that d is invariant with respect to the
adjoint action of M â€² (F ). Then the integral (7.2.4) is absolutely convergent. Moreover, the distribution
â€²
,w
sâ€²
IndH
M â€² (d) âˆˆ D .
Remark 7.14. This corollary is unnecessary for the proof of Proposition 7.10 but useful in Section 8.2.
Proof of Corollary 7.13. We may apply the argument of Corollary 7.6 thanks to Lemmas 4.5 and 7.11.

â€²
fâ€² âˆ© sâ€² be an M â€² -elliptic Cartan subspace.
Lemma 7.15 (cf. Lemma 7.9). Let M â€² âˆˆ L H (M0â€² ) and câ€² âŠ† m
â€²
H
â€²
â€²
â€²
e âˆ© s ) and x âˆˆ H (F ) be such that Ad(x)(câ€² ) = c. Then there exist
1) Let M âˆˆ L (M0 ), c âˆˆ Tell (m
elements m âˆˆ M (F ) and w âˆˆ NormH â€² (F ) (M0â€² ) such that x = mw.
2) The cardinality of
â€²

is

e âˆ© sâ€² ), c is H â€² (F )-conjugate to câ€² }
{(M, c) : M âˆˆ L H (M0â€² ), c âˆˆ Tell (m
â€²

â€²

|W0H ||W0M |âˆ’1 |W (M â€² , câ€² )||W (H â€² , câ€² )|âˆ’1 .

Proof of Proposition 7.10. We may apply the argument of Proposition 7.2 with obvious modifications.
One needs almost all results that we have prepared in this and previous sections, notably Howe's finiteness

(Corollary 6.9) and the noninvariant trace formula (Theorem 5.12).
8. Invariant weighted orbital integrals
8.1. The case of (G, H). Let M âˆˆ L G,Ï‰ (M0 ) and X âˆˆ (m âˆ© srs )(F ). We shall define a distribution
G
IË†M
(Î·, X, *) âˆˆ D s which is Î·(Nrd(*))-invariant with respect to the adjoint action of H(F ) by induction
L
on dim(G). Suppose that for all L âˆˆ L G (M ), L 6= G, we have defined a distribution IË†M
(Î·, X, *)
by an analogue of (8.1.1) where G is replaced by L such that the following properties are verified:
L
IË†M
(Î·, X, *) âˆˆ D lâˆ©s and is Î·(Nrd(*))-invariant with respect to the adjoint action of LH (F ). This is
L,G,w
actually a product form of the induction hypothesis in lower dimensions. Denote by IË†M
(Î·, X, *) its
G,w
âˆž
image under IndL (see (7.1.10)). As in [33, (1) in Â§VI.1], for f âˆˆ Cc (s(F )), we set
X
L,G,w
G
G
(8.1.1)
IË†M
(Î·, X, f ) := JË†M
(Î·, X, f ) âˆ’
IË†M
(Î·, X, f ).
LâˆˆL G (M),L6=G

G
Proposition 8.1. The distribution IË†M
(Î·, X, *) âˆˆ D s and is Î·(Nrd(*))-invariant with respect to the
adjoint action of H(F ).
41

G
Proof. The first statement results from the representability of JË†M
(Î·, X, *) (Proposition 7.2), the induction
hypothesis and Corollary 7.6. Now let us consider the second one.
Let f âˆˆ Ccâˆž (s(F )) and y âˆˆ H(F ). By the H(F )-invariance of h*, *i, we see that (Ad(y âˆ’1 )(f ))Ë† =
Ad(y âˆ’1 )(fË†). Applying Proposition 4.1.6), we have
X
M
G
G
JË†M
(Î·, X, Ad(y âˆ’1 )(f )) = JM
(Î·, X, Ad(y âˆ’1 )(fË†)) = Î·(Nrd(y))
JM Q (Î·, X, (fË†)Î·Q,y ).
QâˆˆF G (M)

For all Q âˆˆ F G (M ), we show that

Î·
(fË†)Î·Q,y = (fQ,y
)Ë†

by the same argument of an analogous property of (3.2.2). Then
X
M
Î·
G
(8.1.2)
JË†M
(Î·, X, Ad(y âˆ’1 )(f )) = Î·(Nrd(y))
).
JË†M Q (Î·, X, fQ,y
QâˆˆF G (M)

Let L âˆˆ L G (M ), L 6= G. Applying Proposition 4.1.6) again to JLG (Î·, Y, Ad(y âˆ’1 )(f )) in the integrand
of the definition (7.1.10) of IndG,w
L , we obtain
X
L,M ,w
L,G,w
Î·
(8.1.3)
IË†M
(Î·, X, Ad(y âˆ’1 )(f )) = Î·(Nrd(y))
IË†M Q (Î·, X, fQ,y
),
QâˆˆF G (L)

L,M ,w
IË†M Q (Î·, X, *)

M ,w
L
where
âˆˆ D mQ âˆ©s denotes the image of IË†M
(Î·, X, *) under IndL Q , which is defined by a
product form of (7.1.10).
From (8.1.1), (8.1.2) and (8.1.3), we deduce that
X
G
G
IË†M (Î·, X, Ad(y âˆ’1 )(f )) =JË†M
(Î·, X, Ad(y âˆ’1 )(f )) âˆ’
IË†L,G,w (Î·, X, Ad(y âˆ’1 )(f ))
M

=Î·(Nrd(y))

ï£«

X

QâˆˆF G (M)

LâˆˆL G (M),L6=G

ï£­JË†MQ (Î·, X, f Î· ) âˆ’
M
Q,y

ï£¶

X

LâˆˆL MQ (M),L6=G

L,M ,w
Î·
IË†M Q (Î·, X, fQ,y
)ï£¸ .

M

Consider Q 6= G first. By the induction hypothesis, IË†M Q (Î·, X, *) âˆˆ D mQ âˆ©s is Î·(Nrd(*))-invariant with
M ,M ,w
M
respect to the adjoint action of MQH (F ), so IË†M Q Q (Î·, X, *) = IË†M Q (Î·, X, *). By the definition of
M
IË†M Q (Î·, X, *) (a product form of (8.1.1)), the term in brackets is zero. Thus it remains the term for
Î·
Î·
Q = G. Note that fG,y
= fG
. By Proposition 4.1.4) applied to Q = G, we see that the term in brackets
G
Ë†
is exactly IM (Î·, X, f ) defined by (8.1.1). Therefore, we show that
G
G
IË†M
(Î·, X, Ad(y âˆ’1 )(f )) = Î·(Nrd(y))IË†M
(Î·, X, f ),

which is the second statement.



G,Ï‰

Ã®G
M (Î·, X, *)

G
ÄµM
(Î·, X, *))

Let M âˆˆ L
(M0 ) and X âˆˆ (m âˆ© srs )(F ). Denote by
(resp.
the element of
G
G
E s associated to IË†M
(Î·, X, *) (resp. JË†M
(Î·, X, *)) âˆˆ D s by (7.1.1). That is to say, for all f âˆˆ Ccâˆž (s(F )),
Z
âˆ’1/2
G
s
Ë†
dY
IM (Î·, X, f ) =
f (Y )Ã®G
M (Î·, X, Y )|D (Y )|F
s(F )

and
G
JË†M
(Î·, X, f ) =

Z

s(F )

âˆ’1/2

G
f (Y )ÄµM
(Î·, X, Y )|Ds (Y )|F

dY.

We also have a similar definition for the symmetric pair (M, MH , Ad(Ç«)), where M âˆˆ L G,Ï‰ (M0 ).

Lemma 8.2. Let M âˆˆ L G,Ï‰ (M0 ) and X âˆˆ (m âˆ© srs )(F ). Let L âˆˆ L G,Ï‰ (M0 ) and Y âˆˆ (l âˆ© srs )(F )ell .
G
Then Ã®G
M (Î·, X, Y ) = ÄµM (Î·, X, Y ).
Proof. Let L2 âˆˆ L G (M ), L2 6= G, L1 âˆˆ L G,Ï‰ (M0 ), L1 âŠ† L2 and c âˆˆ Tell (l1 âˆ©s). We define a distribution
dG,w
L1 ,L2 ,c (Î·, X, *) on s(F ) by
Z
2
(8.1.4)
dG,w
(Î·,
X,
f
)
:=
JLG2 (Î·, Z, f )Ã®L
L1 ,L2 ,c
M (Î·, X, Z)dZ
creg (F )

L2
for all f âˆˆ Ccâˆž (s(F )). By a product form of Proposition 8.1, the distribution IË†M
(Î·, X, *) âˆˆ D l2 âˆ©s
and is Î·(Nrd(*))-invariant with respect to the adjoint action of (L2 âˆ© H)(F ). We see from the proof of
s
Corollary 7.6 that the integral (8.1.4) is absolutely convergent and the distribution dG,w
L1 ,L2 ,c (Î·, X, *) âˆˆ D .
42

s
We denote by eG,w
L1 ,L2 ,c (Î·, X, *) its associated element in E by (7.1.1). From the definitions (8.1.1) and
(7.1.10), we have
X
X
X
L
L
G
Ã®G
|W0 1,n ||W0 2,n |âˆ’1
M (Î·, X, *) =ÄµM (Î·, X, *) âˆ’
L2 âˆˆL G (M),L2 6=G {L1 âˆˆL G,Ï‰ (M0 ):L1 âŠ†L2 }

|W (L1 âˆ©

H, c)|âˆ’1 eG,w
L1 ,L2 ,c (Î·, X, *).

câˆˆTell (l1 âˆ©s)

To prove the lemma, it suffices to fix such a triple (L2 , L1 , c) and prove that eG,w
L1 ,L2 ,c (Î·, X, Y ) = 0. But
(7.1.12) and (7.1.4) in the proofs of Corollary 7.6 and Lemma 7.4 respectively allow us to calculate
eG,w
L1 ,L2 ,c (Î·, X, Y ); explicitly, we have
X
G
2
(x)Ã®L
Î·(Nrd(x))vL
(8.1.5)
eG,w
M (Î·, X, Ad(x)(Y )).
L1 ,L2 ,c (Î·, X, Y ) =
2
{xâˆˆTc (F )\H(F ):Ad(x)(Y )âˆˆc(F )}

Let x âˆˆ Tc (F )\H(F ) such that Ad(x)(Y ) âˆˆ c(F ). As Y âˆˆ (l âˆ© srs )(F )ell and c âˆˆ Tell (l1 âˆ© s), from
the proof of Lemma 3.13.1), there exist elements l1 âˆˆ (L1 âˆ© H)(F ) and w âˆˆ NormH(F ) (M0 ) such that
x = l1 w. Since any element in W0H admits a representative in KH , we can suppose that w âˆˆ KH . Then
G
G
G

vL
(x) = vL
(1) since L1 âŠ† L2 . But vL
(1) = 0 for L2 6= G. Thus eG,w
L1 ,L2 ,c (Î·, X, Y ) = 0 by (8.1.5).
2
2
2
Lemma 8.3. Let M âˆˆ L G,Ï‰ (M0 ).
1) The function (X, Y ) 7â†’ Ã®G
M (Î·, X, Y ) is locally constant on (m âˆ© srs )(F ) Ã— srs (F ).
2) If w âˆˆ NormH(F ) (M0 ), x âˆˆ MH (F ) and y âˆˆ H(F ), we have the equality
G
Ã®G
Ad(w)(M) (Î·, Ad(wx)(X), Ad(y)(Y )) = Î·(Nrd(wxy))Ã®M (Î·, X, Y )

for all (X, Y ) âˆˆ (m âˆ© srs )(F ) Ã— srs (F ).
3) If Î» âˆˆ F Ã— , we have the equality

G
Ã®G
M (Î·, Î»X, Y ) = Ã®M (Î·, X, Î»Y )

for all (X, Y ) âˆˆ (m âˆ© srs )(F ) Ã— srs (F ).
4) Let rM âŠ† (m âˆ© s)(F ) and r âŠ† s(F ) be two compact subsets. Then there exist constants c > 0 and
N âˆˆ N such that
s
N
s
N
|Ã®G
M (Î·, X, Y )| â‰¤ c sup{1, âˆ’ log |D (X)|F } sup{1, âˆ’ log |D (Y )|F }

for all X âˆˆ rM âˆ© srs and Y âˆˆ r âˆ© srs .
5) Let f âˆˆ Ccâˆž (s(F )) and rM âŠ† (m âˆ© s)(F ) be a compact subset. Then there exist constants c > 0 and
N âˆˆ N such that
G
(Î·, X, f )| â‰¤ c sup{1, âˆ’ log |Ds (X)|F }N
|IË†M
for all X âˆˆ rM âˆ© srs .

Proof. Let rM âŠ† (m âˆ© s)(F ) and r âŠ† s(F ) be two open compact subgroups. Set râˆ— := {Y âˆˆ s(F ) : âˆ€Z âˆˆ
r, Î¨(hY, Zi) = 1}, which is an open compact subgroup of s(F ). Notice that if f âˆˆ Ccâˆž (s(F )) satisfies
Supp(f ) âŠ† r, then fË† âˆˆ Ccâˆž (s(F )/râˆ— ). Applying Howe's finiteness (Corollary 6.6) to râˆ— and rM âˆ© srs , we
know that there exists a finite subset {Xi : i âˆˆ I} âŠ† rM âˆ©srs and a finite subset {fi : i âˆˆ I} âŠ† Ccâˆž (s(F )/râˆ— )
such that for all X âˆˆ rM âˆ© srs and all f âˆˆ Ccâˆž (s(F )) with Supp(f ) âŠ† r, we have
X
G
G
G
JM
(Î·, X, fË†) =
JM
(Î·, Xi , fË†)JM
(Î·, X, fi ).
iâˆˆI

We deduce that
(8.1.6)

G
ÄµM
(Î·, X, Y ) =

X

G
G
ÄµM
(Î·, Xi , Y )JM
(Î·, X, fi )

iâˆˆI

for all X âˆˆ rM âˆ© srs and Y âˆˆ r âˆ© srs .
G
1) The local constancy of (X, Y ) 7â†’ ÄµM
(Î·, X, Y ) on (m âˆ© srs )(F ) Ã— srs (F ) results from (8.1.6), PropoG
s
sition 4.1.2) and ÄµM (Î·, Xi , *) âˆˆ E for i âˆˆ I. For L âˆˆ L G,Ï‰ (M0 ), we deduce from Lemma 8.2 the local
constancy of (X, Y ) 7â†’ Ã®G
M (Î·, X, Y ) on (m âˆ© srs )(F ) Ã— (l âˆ© srs )(F )ell . Let (X, Y ) âˆˆ (m âˆ© srs )(F ) Ã— srs (F ).
Choose L âˆˆ L G,Ï‰ (M0 ) and Y â€² âˆˆ (l âˆ© srs )(F )ell such that Y â€² is H(F )-conjugate to Y . Fix a neighbourhood V1 Ã— V2 of (X, Y â€² ) in (m âˆ© srs )(F ) Ã— (l âˆ© srs )(F )ell such that (X, Y ) 7â†’ Îº(Y )Ã®G
M (Î·, X, Y ) is constant
on V1 Ã— V2 . Thanks to the Î·(Nrd(*))-invariance of Ã®G
M (Î·, X, *) with respect to the adjoint action of H(F )
(Proposition 8.1), we know that (X, Y ) 7â†’ Îº(Y )Ã®G
M (Î·, X, Y ) is constant on V1 Ã— Ad(H(F ))(V2 ) which is
43

a neighbourhood of (X, Y ) in (m âˆ© srs )(F ) Ã— srs (F ). Since Îº(*) is locally constant on srs (F ), we show
that (X, Y ) 7â†’ Ã®G
M (Î·, X, Y ) is constant on a neighbourhood of (X, Y ) in (m âˆ© srs )(F ) Ã— srs (F ).
2) The effect of Ad(y) comes from Propostion 8.1. Then when considering the effects of Ad(w)
and Ad(x), up to H(F )-conjugation, we may and shall suppose that Y âˆˆ (l âˆ© srs )(F )ell for some L âˆˆ
L G,Ï‰ (M0 ). That is to say, it suffices to prove the equality
G
Ã®G
Ad(w)(M) (Î·, Ad(wx)(X), Y ) = Î·(Nrd(wx))Ã®M (Î·, X, Y )
G
for all (X, Y ) âˆˆ (m âˆ© srs )(F ) Ã— (l âˆ© srs )(F )ell . By Lemma 8.2, we may replace Ã®G
Ad(w)(M) and Ã®M by

G
G
ÄµAd(w)(M)
and ÄµM
respectively in the equality to be proved. Now the equality results from Proposition
4.1.3).
3) Let Î» âˆˆ F Ã— , X âˆˆ (m âˆ© sreg )(F ) and f âˆˆ Ccâˆž (s(F )). From (3.1.1), we have
(dim(g)âˆ’rank(g))/2

|Ds (Î»X)|F = |Î»|F

|Ds (X)|F ,

where dim(g) and rank(g) denote the dimension and rank (over an algebraic closure of F ) of g respectively.
Then we have
Z
âˆ’1/2
G
G
G
f (Y )ÄµM
(Î·, Î»X, Y )|Ds (Y )|F dY = JË†M
(Î·, Î»X, f ) = JM
(Î·, Î»X, fË†)
s(F )
Z
1/2
Q
=|Ds (Î»X)|F
fË†(Ad(xâˆ’1 )(Î»X))Î·(Nrd(x))vM
(x)dx
HÎ»X (F )\H(F )

(dim(g)âˆ’rank(g))/4 G
=|Î»|F
JM (Î·, X, fË†(Î»*)).

But
fË†(Î»*) =cÎ¨ (s(F ))

Z

f (Z)Î¨(hÎ»*, Zi)dZ = cÎ¨ (s(F ))
s(F )
Z
âˆ’ dim(s)
f (Î»âˆ’1 Z)Î¨(h*, Zi)dZ
=|Î»|F
cÎ¨ (s(F ))

Z

f (Z)Î¨(h*, Î»Zi)dZ
s(F )

s(F )

âˆ’ dim(g)/2
=|Î»|F
(f (Î»âˆ’1 *))Ë† .

Thus we have
G
JM
(Î·, X, fË†(Î»*))

âˆ’ dim(g)/2 Ë†G
=|Î»|F
JM (Î·, X, f (Î»âˆ’1 *))

Z

=

âˆ’ dim(g)/2
|Î»|F

Z

s(F )

âˆ’1/2

G
f (Î»âˆ’1 Y )ÄµM
(Î·, X, Y )|Ds (Y )|F

dY

âˆ’1/2

G
f (Y )ÄµM
(Î·, X, Î»Y )|Ds (Î»Y )|F dY
s(F )
Z
âˆ’1/2
(rank(g)âˆ’dim(g))/4
G
f (Y )ÄµM
(Î·, X, Î»Y )|Ds (Y )|F dY.
=|Î»|F

=

s(F )

Therefore, we deduce the equality
G
G
ÄµM
(Î·, Î»X, Y ) = ÄµM
(Î·, X, Î»Y )

for all Î» âˆˆ F Ã— and all (X, Y ) âˆˆ (m âˆ© srs )(F ) Ã— srs (F ). We obtain a similar equality for Ã®G
M thanks
to Lemma 8.2 and the Î·(Nrd(*))-invariance of Ã®G
(Î·,
X,
*)
with
respect
to
the
adjoint
action
of H(F )
M
(Proposition 8.1).
G
4) A similar bound for (X, Y ) 7â†’ ÄµM
(Î·, X, Y ) on (rM âˆ© srs ) Ã— (r âˆ© srs ) results from (8.1.6), Corollary
G
4.3 (together with Proposition 4.1.4)) and ÄµM
(Î·, Xi , *) âˆˆ E s for i âˆˆ I. For L âˆˆ L G,Ï‰ (M0 ), we deduce
from Lemma 8.2 a similar bound of (X, Y ) 7â†’ Ã®G
M (Î·, X, Y ) on (rM âˆ© srs ) Ã— (r âˆ© (l âˆ© srs )(F )ell ). Let
(X, Y ) âˆˆ (rM âˆ© srs ) Ã— (r âˆ© srs ). Thanks to the Î·(Nrd(*))-invariance of Ã®G
M (Î·, X, *) with respect to the
adjoint action of H(F ) (Proposition 8.1), if we replace Y by Ad(y)(Y ), where y âˆˆ H(F ), the two sides
in the inequality to be proved remain unchanged. Since any Cartan subspace in s is H(F )-conjugate
to an element in Tell (l âˆ© s) for some L âˆˆ L G,Ï‰ (M0 ), with the help of Lemma 3.4, it suffices to fix
L âˆˆ L G,Ï‰ (M0 ), c âˆˆ Tell (l âˆ© s) and rc âŠ† c(F ) a compact subset, prove a similar bound for (X, Y ) âˆˆ
(rM âˆ© srs ) Ã— (rc âˆ© creg ), and then obtain a uniform bound for (X, Y ) âˆˆ (rM âˆ© srs ) Ã— (r âˆ© srs ) by the
finiteness of Tell (l âˆ© s). But this is what we have established.

5) It is a consequence of 4) applied to r := Supp(f ) and Corollary 3.18.
44

G
For M âˆˆ L G,Ï‰ (M0 ) and X âˆˆ (m âˆ© srs )(F ), we define a distribution IM
(Î·, X, *) on s(F ) by
G
G
IM
(Î·, X, fË†) := IË†M
(Î·, X, f )

(8.1.7)
for all f âˆˆ Ccâˆž (s(F )).

G
G
Remark 8.4. For M = G, it is evident that IG
(Î·, X, f ) = JG
(Î·, X, f ) for all X âˆˆ srs (F ) and f âˆˆ
âˆž
Cc (s(F )).

One may easily extend the definitions (8.1.1) and (8.1.7) to the symmetric pair (L, LH , Ad(Ç«)), where
L âˆˆ L G,Ï‰ (M0 ), since it appears as the product of some copies of the form (G, H, Ad(Ç«)) in lower
dimensions.
G
Lemma 8.5. Let M âˆˆ L G,Ï‰ (M0 ) and X âˆˆ (m âˆ© srs )(F ). The distribution IM
(Î·, X, *) on s(F ) is
independent of the choice of the H(F )-invariant non-degenerate symmetric bilinear form h*, *i on s(F )
or the continuous nontrivial unitary character Î¨ of F .

Proof. Suppose that h*, *iâ€² is another bilinear form and that Î¨â€² is another character. Denote by f 7â†’ f Ìƒ the
G
G
G
associated Fourier transform and by I ÌƒM
(Î·, X, *) (resp. J ÌƒM
(Î·, X, *)) the associated analogue of IË†M
(Î·, X, *)
G
âˆž
âˆž
(resp. JË†M (Î·, X, *)). For f âˆˆ Cc (s(F )), define fâˆ’ âˆˆ Cc (s(F )) by fâˆ’ (Y ) := f (âˆ’Y ) for all Y âˆˆ s(F ).
 Ìƒ Ë†
Since f Ìƒ = fË† = fâˆ’ for all f âˆˆ C âˆž (s(F )), it suffices to prove the equality
c

G
G
(Î·, X, fË†)
I ÌƒM
(Î·, X, f Ìƒ) = IË†M

for all f âˆˆ Ccâˆž (s(F )).
Let Ï„ â€² be the linear automorphism of s(F ) such that
âˆ€Y, Z âˆˆ s(F ), hY, Ziâ€² = hÏ„ â€² (Y ), Zi.

Let a âˆˆ F Ã— such that Î¨â€² (*) = Î¨(a*). Set Ï„ := aÏ„ â€² . Then

cÎ¨â€² (s(F )) Ë†
f (Ï„ (*))
f Ìƒ(*) =
cÎ¨ (s(F ))

for all f âˆˆ Ccâˆž (s(F )). One may check that Ï„ is an H(F )-equivariant linear automorphism of s(F ) thanks
to H(F )-invariance of two bilinear forms. One also deduces that
âˆ€Y, Z âˆˆ s(F ), hÏ„ (Y ), Zi = hY, Ï„ (Z)i

from the symmetry of two bilinear forms. Now for all f âˆˆ Ccâˆž (s(F )) and all Y âˆˆ s(F ), we have
Z
Z
cÎ¨â€² (s(F )) Ë†
 Ìƒ
f (âˆ’Y ) = f Ìƒ(Y ) = cÎ¨â€² (s(F ))
f Ìƒ(Z)Î¨â€² (hY, Ziâ€² )dZ = cÎ¨â€² (s(F ))
f (Ï„ (Z))Î¨(hÏ„ (Y ), Zi)dZ
s(F )
s(F ) cÎ¨ (s(F ))
Z
Z
cÎ¨â€² (s(F ))2
cÎ¨â€² (s(F ))2
Ë†
=
f (Ï„ (Z))Î¨(hY, Ï„ (Z)i)dZ =
fË†(Z â€² )Î¨(hY, Z â€² i)dZ â€²
cÎ¨ (s(F )) s(F )
cÎ¨ (s(F ))| dets(F ) (Ï„ )|F s(F )
=

cÎ¨â€² (s(F ))2
cÎ¨â€² (s(F ))2
Ë†
fË†(Y ) =
f (âˆ’Y ).
2
cÎ¨ (s(F )) | dets(F ) (Ï„ )|F
cÎ¨ (s(F ))2 | dets(F ) (Ï„ )|F

Therefore, we obtain

cÎ¨â€² (s(F ))
cÎ¨ (s(F ))

1/2

= | dets(F ) (Ï„ )|F . Then for all f âˆˆ Ccâˆž (s(F )), we have
1/2
f Ìƒ(*) = | dets(F ) (Ï„ )|F fË†(Ï„ (*)).

G
s
 ÌƒG
 ÌƒG
Denote by Ä©G
M (Î·, X, *) (resp. jÌƒM (Î·, X, *)) the element of E associated to IM (Î·, X, *) (resp. JM (Î·, X, *))
s
âˆž
âˆˆ D by (7.1.1). For f âˆˆ Cc (s(F )), we have
Z
âˆ’1/2
s
G
f Ìƒ(Y )Ä©G
dY
I ÌƒM
(Î·, X, f Ìƒ) =
M (Î·, X, Y )|D (Y )|F
s(F )
Z
1/2
âˆ’1/2
s
= | dets(F ) (Ï„ )|F
dY
fË†(Ï„ (Y ))Ä©G
M (Î·, X, Y )|D (Y )|F
s(F )
Z
âˆ’1/2
âˆ’1/2
âˆ’1
= | dets(F ) (Ï„ )|F
fË†(Y )Ä©G
(Y ))|Ds (Ï„ âˆ’1 (Y ))|F dY.
M (Î·, X, Ï„
s(F )

We reduce ourselves to proving the equality
(8.1.8)

âˆ’1/2 G
Ä©M (Î·, X, Ï„ âˆ’1 (Y

| dets(F ) (Ï„ )|F

âˆ’1/2

))|Ds (Ï„ âˆ’1 (Y ))|F
45

âˆ’1/2

s
= Ã®G
M (Î·, X, Y )|D (Y )|F

for all Y âˆˆ srs (F ). But we have the equality
G
G
J ÌƒM
(Î·, X, f Ìƒ) = JË†M
(Î·, X, fË†)
G
since both sides equal JM
(Î·, X, fâˆ’ (*)), which is defined by (4.1.1). The same computation as above
G
G
G
shows that the equality (8.1.8) is true when one replaces Ä©G
M and Ã®M with jÌƒM and ÄµM respectively. Recall
that Ï„ is H(F )-equivariant, so HY = HÏ„ âˆ’1 (Y ) for Y âˆˆ srs (F ). As a consequence, for L âˆˆ L G,Ï‰ (M0 ),
Y âˆˆ (l âˆ© srs )(F )ell if and only if Ï„ âˆ’1 (Y ) âˆˆ (l âˆ© srs )(F )ell . One may conclude by Lemma 8.2 together with
the Î·(Nrd(*))-invariance of Ã®G
M (Î·, X, *) with respect to the adjoint action of H(F ) (Proposition 8.1). 
â€²
fâ€² âˆ© sâ€²rs )(F ). We shall define a distribution
8.2. The case of (Gâ€² , H â€² ). Let M â€² âˆˆ L H (M0â€² ) and Y âˆˆ (m
â€²
â€²
H
s
Ë†
IM â€² (Y, *) âˆˆ D which is invariant with respect to the adjoint action of H â€² (F ) by induction on dim(H â€² ).
Lâ€²
leâ€² âˆ©sâ€²
Suppose that we have defined a distribution IË†M
which is invariant with respect to the
â€² (Y, *) âˆˆ D
â€²
adjoint action of Lâ€² (F ) for all Lâ€² âˆˆ L H (M â€² ), Lâ€² 6= H â€² . This is actually a product form of the induction
â€²
Lâ€² ,H â€² ,w
,w
hypothesis in lower dimensions. Denote by IË†M
(Y, *) its image under IndH
(see (7.2.4)). For
â€²
Lâ€²
f â€² âˆˆ Ccâˆž (sâ€² (F )), we set
X
Lâ€² ,H â€² ,w
Hâ€²
â€²
â€²
Ë†H â€²
(8.2.1)
IË†M
IË†M
(Y, f â€² ).
â€² (Y, f ) := JM â€² (Y, f ) âˆ’
â€²

Lâ€² âˆˆL H â€² (M â€² ),Lâ€² 6=H â€²

Hâ€²
sâ€²
Proposition 8.6. The distribution IË†M
and is invariant with respect to the adjoint action of
â€² (Y, *) âˆˆ D
H â€² (F ).
â€²

H
Proof. We may apply the argument of Proposition 8.1 thanks to the representability of JË†M
â€² (Y, *) (Propo
sition 7.10), Corollary 7.13 and Proposition 4.4.6).
â€²
fâ€² âˆ© sâ€²rs )(F ). Denote by Ã®H â€²â€² (Y, *) (resp. Äµ H â€²â€² (Y, *)) the element of E sâ€²
Let M â€² âˆˆ L H (M0â€² ) and Y âˆˆ (m
M
M
â€²
â€²
H
sâ€²
Ë†H
associated to IË†M
by (7.2.1). That is to say, for all f â€² âˆˆ Ccâˆž (sâ€² (F )),
â€² (Y, *) (resp. JM â€² (Y, *)) âˆˆ D
Z
â€²
âˆ’1/2
sâ€²
Hâ€²
â€²
Ë†
f â€² (X)Ã®H
dX
IM â€² (Y, f ) =
M â€² (Y, X)|D (X)|F

sâ€² (F )

and
Hâ€²
â€²
JË†M
â€² (Y, f ) =

Z

â€²

sâ€² (F )

â€²

âˆ’1/2

H
s
f â€² (X)ÄµM
â€² (Y, X)|D (X)|
F

dX.
â€²

fâ€² , M â€² , Ad(Î±)), where M â€² âˆˆ L H (M0â€² ).
One has a similar definition for the symmetric pair (M

â€²
fâ€² âˆ© sâ€²rs )(F ). Let Lâ€² âˆˆ L H â€² (M0â€² ) and X âˆˆ (e
Lemma 8.7. Let M â€² âˆˆ L H (M0â€² ) and Y âˆˆ (m
lâ€² âˆ© sâ€²rs )(F )ell .
â€²
â€²
H
H
Then Ã®M â€² (Y, X) = ÄµM â€² (Y, X).

Proof. We may apply the argument of Lemma 8.2 by using Proposition 8.6 and consulting the proofs of
Corollary 7.13, Lemmas 7.11 and 3.20.1).

â€²

Lemma 8.8. Let M â€² âˆˆ L H (M0â€² ).
â€²
â€²
â€²
fâ€²
1) The function (Y, X) 7â†’ Ã®H
M â€² (Y, X) is locally constant on (m âˆ© srs )(F ) Ã— srs (F ).
â€²
â€²
â€²
2) If w âˆˆ NormH â€² (F ) (M0 ), x âˆˆ M (F ) and y âˆˆ H (F ), we have the equality
â€²

â€²

H
Ã®H
Ad(w)(M â€² ) (Ad(wx)(Y ), Ad(y)(X)) = Ã®M â€² (Y, X)

fâ€² âˆ© sâ€²rs )(F ) Ã— sâ€²rs (F ).
for all (Y, X) âˆˆ (m
Ã—
3) If Î» âˆˆ F , we have the equality

â€²

â€²

H
Ã®H
M â€² (Î»Y, X) = Ã®M â€² (Y, Î»X)

fâ€² âˆ© sâ€²rs )(F ) Ã— sâ€²rs (F ).
for all (Y, X) âˆˆ (m
â€²
fâ€² âˆ© sâ€² )(F ) and râ€² âŠ† sâ€² (F ) be two compact subsets. Then there exist constants c > 0
4) Let rM â€² âŠ† (m
and N âˆˆ N such that
â€²

â€²

â€²

s
N
s
N
|Ã®H
M â€² (Y, X)| â‰¤ c sup{1, âˆ’ log |D (Y )|F } sup{1, âˆ’ log |D (X)|F }

â€²
â€²
â€²
â€²
for all Y âˆˆ rM
â€² âˆ© srs and X âˆˆ r âˆ© srs .
â€²
â€²
fâ€²
5) Let f â€² âˆˆ Ccâˆž (sâ€² (F )) and rM
â€² âŠ† (m âˆ© s )(F ) be a compact subset. Then there exist constants c > 0
and N âˆˆ N such that
â€²
â€²
|IË†H â€² (Y, f â€² )| â‰¤ c sup{1, âˆ’ log |Ds (Y )|F }N
M

â€²
â€²
for all Y âˆˆ rM
â€² âˆ© srs .

46

Proof. It is almost the same as the proof of Lemma 8.3, except that one needs to use Howe's finiteness
(Corollary 6.9), Proposition 8.6 and Lemma 8.7. We also need Proposition 4.4.2) for 1), Proposition
4.4.3) for 2), Corollary 4.6 for 4) and Corollary 3.24 for 5).

â€²

â€²

fâ€² âˆ© sâ€²rs )(F ), we define a distribution I H â€² (Y, *) on sâ€² (F ) by
For M â€² âˆˆ L H (M0â€² ) and Y âˆˆ (m
M
Hâ€²
â€²
Ë†â€²
Ë†H â€²
IM
â€² (Y, f ) := IM â€² (Y, f )

(8.2.2)

for all f â€² âˆˆ Ccâˆž (sâ€² (F )). One may easily extend the definitions (8.2.1) and (8.2.2) to the symmetric pair
â€²
(Leâ€² , Lâ€² , Ad(Î±)), where Lâ€² âˆˆ L H (M0â€² ).
â€²

â€²

H
â€²
H
â€²
â€²
â€²
Remark 8.9. For M â€² = H â€² , it is evident that IH
âˆˆ
â€² (Y, f ) = JH â€² (Y, f ) for all Y âˆˆ srs (F ) and f
âˆž â€²
Cc (s (F )).
â€²
fâ€² âˆ© sâ€²rs )(F ). The distribution I H â€²â€² (Y, *) on sâ€² (F ) is
Lemma 8.10. Let M â€² âˆˆ L H (M0â€² ) and Y âˆˆ (m
M
independent of the choice of the H â€² (F )-invariant non-degenerate symmetric bilinear form h*, *i on sâ€² (F )
or the continuous nontrivial unitary character Î¨ of F .

Proof. We may apply the argument of Lemma 8.5 thanks to Proposition 8.6 and Lemma 8.7.



9. The invariant trace formula
9.1. The case of (G, H). For f, f â€² âˆˆ Ccâˆž (s(F )), we define
Z
X
X
|W (MH , c)|âˆ’1
I G (Î·, f, f â€² ) :=
|W0Mn ||W0GLn |âˆ’1 (âˆ’1)dim(AM /AG )
creg (F )
(9.1.1)
câˆˆTell (mâˆ©s)
MâˆˆL G,Ï‰ (M0 )
G
G
IË†M
(Î·, X, f )IG
(Î·, X, f â€² )dX.
G
(Î·, *, f â€² ) vanishes outside a compact subset of c(F ),
From Proposition 4.1.2), for any c âˆˆ Tell (m âˆ© s), IG
so one may apply Lemma 8.3.5) to show that this expression is absolutely convergent with the help of
Proposition 3.16 and Corollary 3.7.

Theorem 9.1 (Invariant trace formula). For all f, f â€² âˆˆ Ccâˆž (s(F )), we have the equality
I G (Î·, f, f â€² ) = I G (Î·, f â€² , f ).

The rest of this section is devoted to the proof of Theorem 9.1. We shall follow the main steps in [33,
Â§VII.2-3]. The theorem will be proved by induction on the dimension of G.
G
Let f âˆˆ Ccâˆž (srs (F )) and M âˆˆ L G,Ï‰ (M0 ). By Proposition 4.1.2) and 3), the function Îº(*)JM
(Î·, *, f ) :
(m âˆ© srs )(F ) â†’ C is locally constant and invariant by the adjoint action of MH (F ), where Îº is defined
by (4.1.2). Moreover, the support of its restriction to c(F ) for any c âˆˆ T (m âˆ© s) is included in the
G
compact subset creg (F ) âˆ© Ad(H(F ))(Supp(f )). Then Îº(*)JM
(Î·, *, f ) defines a locally constant function
on (m âˆ© s)rs (F ) (see Section 3.2 for the notation) via the extension by zero on the complement. From
Harish-Chandra's submersion principle (Lemma 3.9), there exists f â€² âˆˆ Ccâˆž ((m âˆ© s)rs (F )) such that
Z
1/2
G
mâˆ©s
Îº(X)JM (Î·, X, f ) = |D
(X)|F
f â€² (Ad(xâˆ’1 )(X))dx
MH,X (F )\MH (F )

â€²â€²

â€²

for all X âˆˆ (m âˆ© srs )(F ). Let f := Îºf âˆˆ
product form. Then we have
(9.1.2)

Ccâˆž ((m

âˆ© s)rs (F )), where we extend the definition of Îº to the

G
M
JM
(Î·, X, f ) = JM
(Î·, X, f â€²â€² ), âˆ€X âˆˆ (m âˆ© srs )(F ).

We have shown that for f âˆˆ Ccâˆž (srs (F )) and M âˆˆ L G,Ï‰ (M0 ), there exists a function f â€²â€² âˆˆ Ccâˆž ((m âˆ©
s)rs (F )) such that (9.1.2) holds. We shall fix such an f â€²â€² and denote it by Ï†G
M (f ).
As before, one may extend in the obvious way the definition (9.1.1) and the notation Ï†G
M (f ) to the
symmetric pair (M, MH , Ad(Ç«)), where M âˆˆ L G,Ï‰ (M0 ), since it appears as the product of some copies
of the form (G, H, Ad(Ç«)) in lower dimensions.
Lemma 9.2. Let M âˆˆ L G,Ï‰ (M0 ), X âˆˆ (mâˆ©srs )(F )ell and f, f â€² âˆˆ Ccâˆž (srs (F )). Then we have the equality
X
X
Î·
L2
L1
L
â€²Î·
G
Ë†L
(9.1.3)
JM
(Î·, X, fË†, f â€² ) =
dG
L (L1 , L2 )IM (Î·, X, Ï†L (fQ ))IL (Î·, X, Ï†L (f Q2 )),
1

LâˆˆL G (M) L1 ,L2 âˆˆL G (L)

G
where JM
(Î·, X, fË†, f â€² ) is defined by (5.1.1), and (Q1 , Q2 ) := s(L1 , L2 ) (see Section 2.7).
47

Proof. By definition,
G
JM
(Î·, X, fË†, f â€² )

= |D

s

where
Ï†1 (y) := |D

s

Z

1/2
(X)|F

1/2
(X)|F

f â€² (Ad(y âˆ’1 )(X))Î·(Nrd(y))Ï†1 (y)dy,

AM (F )\H(F )

Z

fË†(Ad(xâˆ’1 )(X))Î·(Nrd(xâˆ’1 ))vM (x, y)dx.

AM (F )\H(F )

For L âˆˆ L G (M ) and L2 âˆˆ L G (L), since Q2 âˆˆ P G (L2 ), by Proposition 4.1.4), we have
Î·

Î·

Q2
L2
â€²
â€²
â€²
2
ILL (Î·, X, Ï†L
L (f Q2 )) = JL (Î·, X, f Q2 ) = JL (Î·, X, f ).

(9.1.4)

Since X âˆˆ (m âˆ© srs )(F )ell , the right hand side of (9.1.3) is
Z
1/2
s
f â€² (Ad(y âˆ’1 )(X))Î·(Nrd(y))Ï†2 (y)dy,
|D (X)|F
AM (F )\H(F )

where

X

Ï†2 (y) :=

X

Q2
Î·
L1
Ë†L
dG
L (L1 , L2 )IM (Î·, X, Ï†L (fQ ))vL (y).
1

LâˆˆL G (M) L1 ,L2 âˆˆL G (L)

It suffices to fix y âˆˆ H(F ) and prove that Ï†1 (y) = Ï†2 (y).
Let L âˆˆ L G (M ) and
X
Î·
Q2
L1
hL :=
dG
L (L1 , L2 )Ï†L (fQ )vL (y).
1

L1 ,L2 âˆˆL G (L)

Then

X

Ï†2 (y) =

L
IË†M
(Î·, X, hL ).

LâˆˆL G (M)

For Y âˆˆ (l âˆ© srs )(F ), we have

X

JLL (Î·, Y, hL ) =

Q2
Î·
L1
L
dG
L (L1 , L2 )JL (Î·, Y, Ï†L (fQ ))vL (y).
1

L1 ,L2 âˆˆL G (L)

For L1 âˆˆ L G (L), as in (9.1.4), we have
Î·
Î·
Q1
L1
1
JLL (Î·, Y, Ï†L
L (fQ )) = JL (Î·, Y, fQ ) = JL (Î·, Y, f ).
1

Then
1/2

JLL (Î·, Y, hL ) = |Ds (Y )|F

1

Z

f (Ad(xâˆ’1 )(Y ))Î·(Nrd(x))h(x, y)dx,

HY (F )\H(F )

where

X

h(x, y) :=

Q2
Q1
dG
L (L1 , L2 )vL (x)vL (y).

L1 ,L2 âˆˆL G (L)

It is shown in the proof of [33, Lemme VII.2] that
X

h(x, y) = vL (x, y) =

Q
â€²
vQ
(y)vL
(x).

QâˆˆF G (L)

Thus
JLL (Î·, Y, hL ) =

X

â€²
vQ
(y)JLQ (Î·, Y, f ).

QâˆˆF G (L)

As in (9.1.4), we have
M

M

Î·
Î·
) = JLL (Î·, Y, Ï†L Q (fQ
)).
JLQ (Î·, Y, f ) = JL Q (Î·, Y, fQ

Let
hâ€²L :=

X

M

Î·
â€²
vQ
(y)Ï†L Q (fQ
).

QâˆˆF G (L)

Then we obtain
(9.1.5)
for all Y âˆˆ (l âˆ© srs )(F ).

JLL (Î·, Y, hL ) = JLL (Î·, Y, hâ€²L )
48

L
By a product form of Proposition 8.1, the distribution d := IË†M
(Î·, X, *) âˆˆ D lâˆ©s and is Î·(Nrd(*))invariant with respect to the adjoint action of LH (F ). By a product form of (7.1.2), we deduce from
(9.1.5) that
L
L
IË†M
(Î·, X, hL ) = IË†M
(Î·, X, hâ€²L ).

Therefore,
X

Ï†2 (y) =

L
IË†M
(Î·, X, hL ) =

LâˆˆL G (M)

X

=

â€²
vQ
(y)

X

X

L
IË†M
(Î·, X, hâ€²L )

LâˆˆL G (M)
M
Î·
L
)).
IË†M
(Î·, X, Ï†L Q (fQ

LâˆˆL MQ (M)

QâˆˆF G (M)

By (7.1.10) and (7.1.2) (actually their product forms are needed), we have
L,M ,w
M ,w
Î·
Î·
IË†M Q (Î·, X, fQ
) = IndL Q (d)(fQ
)
X
X
Lâ€²
=
|W0 n ||W0Ln |âˆ’1

câˆˆTell (lâ€² âˆ©s)

{Lâ€² âˆˆL G,Ï‰ (M0 ):Lâ€² âŠ†L}

X

|W0 ||W0Ln |âˆ’1

M
Î·
=d(Ï†L Q (fQ
))

M
Î·
L
IË†M
(Î·, X, Ï†L Q (fQ
)).

=

X

Lâ€²n

{Lâ€² âˆˆL G,Ï‰ (M0 ):Lâ€² âŠ†L}

=

câˆˆTell (lâ€² âˆ©s)

|W (Lâ€²H , c)|âˆ’1

Z

|W (Lâ€²H , c)|âˆ’1

Z

M

creg (F )

Î·
JL Q (Î·, Z, fQ
)ed (Z)dZ
M

creg (F )

Î·
))ed (Z)dZ
JLL (Î·, Z, Ï†L Q (fQ

Then by (8.1.1), we get
X

M
Î·
L
)) =
IË†M
(Î·, X, Ï†L Q (fQ

X

L,M ,w
Î·
)
IË†M Q (Î·, X, fQ

LâˆˆL MQ (M)

LâˆˆL MQ (M)

M
M
Î·
Î·
Q
=JË†M Q (Î·, X, fQ
) = JM Q (Î·, X, fË†Q
) = JM
(Î·, X, fË†).

Hence,
Ï†2 (y) =

X

Q
â€²
(Î·, X, fË†)
vQ
(y)JM

QâˆˆF G (M)
1/2

=|Ds (X)|F

Z

fË†(Ad(xâˆ’1 )(X))Î·(Nrd(x))

AM (F )\H(F )

But

X

X

Q
â€²
vQ
(y)vM
(x)dx.

QâˆˆF G (M)

Q
â€²
vQ
(y)vM
(x) = vM (x, y),

QâˆˆF G (M)

which implies that Ï†1 (y) = Ï†2 (y).



Proof of Theorem 9.1. We use induction on the dimension of G. Suppose that the equality is true for
L âˆˆ L G,Ï‰ (M0 ), L 6= G, which is actually a product form in lower dimensions. Now we would like to
prove the equality for G. The argument below is also valid for the case L G,Ï‰ (M0 ) = {G}, i.e., n = 1.
First of all, suppose that f, f â€² âˆˆ Ccâˆž (srs (F )). Applying Lemma 9.2 to the definition (5.1.2) of
G
J (Î·, fË†, f â€² ), we obtain
Z
X
X
Mn
GLn âˆ’1
âˆ’1
G
â€²
dim(AM /AG )
Ë†
|W (MH , c)|
J (Î·, f , f ) =
|W0 ||W0 | (âˆ’1)
MâˆˆL G,Ï‰ (M0 )

G
JM
(Î·, X, fË†, f â€² )dX
X
=
|W0Mn ||W0GLn |âˆ’1 (âˆ’1)dim(AM /AG )
MâˆˆL G,Ï‰ (M0 )

X

X

X

câˆˆTell (mâˆ©s)

X

LâˆˆL G,Ï‰ (M0 )

|W (MH , c)|âˆ’1

Z

creg (F )

Î·
L1
L2
L
â€²Î·
Ë†L
dG
L (L1 , L2 )IM (Î·, X, Ï†L (fQ1 ))IL (Î·, X, Ï†L (f Q2 ))dX

LâˆˆL G (M) L1 ,L2 âˆˆL G (L)

=

creg (F )

câˆˆTell (mâˆ©s)

|W0Ln ||W0GLn |âˆ’1 (âˆ’1)dim(AL /AG ) BL (Î·, f, f â€² ),
49

where

X

BL (Î·, f, f â€² ) :=

dG
L (L1 , L2 )

L1 ,L2 âˆˆL G (L)

|W (MH , c)|âˆ’1
X

=

Z

X

{MâˆˆL G,Ï‰ (M0 ):MâŠ†L}

creg (F )

|W0Mn ||W0Ln |âˆ’1 (âˆ’1)dim(AM /AL )

X

câˆˆTell (mâˆ©s)

Î·
L2
L
L
â€²Î·
1
IË†M
(Î·, X, Ï†L
L (fQ ))IL (Î·, X, Ï†L (f Q2 ))dX
1

Î·

Î·
L2
L1
â€²
L
dG
L (L1 , L2 )I (Î·, Ï†L (fQ ), Ï†L (f Q2 )).
1

L1 ,L2 âˆˆL G (L)

Here we have used the absolute convergence of the expressions above to exchange the order of sums, and
Î·
L2
â€²Î·
1
I L (Î·, Ï†L
L (fQ1 ), Ï†L (f Q2 )) is defined by a product form of (9.1.1).
By the noninvariant trace formula (Theorem 5.3) and Remark 5.2, we have the equality J G (Î·, fË†, f â€² ) =
J G (Î·, fË†â€² , f ). Therefore,
X
(9.1.6)
|W0Ln ||W0GLn |âˆ’1 (âˆ’1)dim(AL /AG ) (BL (Î·, f, f â€² ) âˆ’ BL (Î·, f â€² , f )) = 0.
LâˆˆL G,Ï‰ (M0 )

Let L âˆˆ L G,Ï‰ (M0 ), L 6= G. Applying the induction hypothesis, we have
X
Î·
L2
L1
L
â€²Î·
BL (Î·, f, f â€² ) =
dG
L (L1 , L2 )I (Î·, Ï†L (f Q2 ), Ï†L (fQ )).
1

L1 ,L2 âˆˆL G (L)

By exchanging L1 and L2 and by using (2) and (5) in Section 2.7, we obtain BL (Î·, f, f â€² ) = BL (Î·, f â€² , f ).
We deduce from (9.1.6) that BG (Î·, f, f â€² ) = BG (Î·, f â€² , f ). But
BG (Î·, f, f â€² ) = I G (Î·, f, f â€² ),
which implies I G (Î·, f, f â€² ) = I G (Î·, f â€² , f ).
Now consider f, f â€² âˆˆ Ccâˆž (s(F )) in general. Let {Î©i }iâ‰¥1 be a sequence of increasing open compact
âˆž
S
Î©i = srs (F ). Such a consequence exists. For example, one may take
subsets of srs (F ) such that
iâ‰¥1

Î©i := {X âˆˆ srs (F ) : kXk â‰¤ i} for all i â‰¥ 1, where k * k denotes the abstract norm on srs (F ) defined by
[22, (18.2.1) in Â§18.2]. From [22, Proposition 18.1.(3)], since k * k is continuous, we deduce that Î©i is
âˆž
S
Î©i = srs (F ). For all i â‰¥ 1,
compact for all i â‰¥ 1. It is obvious that Î©i is open for all i â‰¥ 1 and that
iâ‰¥1

denote by 1Î©i the characteristic function of Î©i . Let fi := f 1Î©i and fiâ€² := f â€² 1Î©i .
Let M âˆˆ L G,Ï‰ (M0 ) and c âˆˆ Lell(m âˆ© s). For all X âˆˆ creg (F ), by Lebesgue's dorminated convergence
G
G
G
theorem, we have lim IG
(Î·, X, fiâ€² ) = IG
(Î·, X, f â€² ). For X âˆˆ (m âˆ© srs )(F ), because IË†M
(Î·, X, *) âˆˆ D s
iâ†’âˆž

G
(see Proposition 8.1), again by Lebesgue's dorminated convergence theorem, we have lim IË†M
(Î·, X, fi ) =
iâ†’âˆž

G
IË†M
(Î·, X, f ). Because of Lemma 3.4 applied to Supp(f â€² ), there exists a compact subset r âŠ† c(F ) such
G
that for all X âˆˆ creg (F ) âˆ’ r, IG
(Î·, X, fiâ€² ) = 0 for all i â‰¥ 1. By Lemma 8.3.4) applied to r and Supp(f â€² ),
there exist constants c > 0 and N âˆˆ N such that
Z
âˆ’1/2
G
s
Ë†
dY
|IM (Î·, X, fi )| =
|fi (Y )Ã®G
M (Î·, X, Y )||D (Y )|F
s(F )
Z
âˆ’1/2
â‰¤ c sup{1, âˆ’ log |Ds (X)|F }N
|f (Y )| sup{1, âˆ’ log |Ds (Y )|F }N |Ds (Y )|F dY
s(F )

G
for all i â‰¥ 1 and X âˆˆ r âˆ© creg . For all X âˆˆ srs (F ), we also have |IG
(Î·, X, fiâ€² )| â‰¤ IX (|f â€² |), where
IX is defined by (3.1.3). Combining Corollary 3.18, Corollary 3.7 and Proposition 3.16, we deduce
G
G
that {IË†M
(Î·, X, fi )IG
(Î·, X, fiâ€² )}iâ‰¥1 is bounded by an integrable function on creg (F ). Using Lebesgue's
dorminated convergence theorem once again, we obtain
Z
Z
G
G
â€²
G
G
Ë†
IM (Î·, X, f )IG (Î·, X, f )dX = lim
IË†M
(Î·, X, fi )IG
(Î·, X, fiâ€² )dX.
creg (F )

iâ†’âˆž

creg (F )

Therefore,
I G (Î·, f, f â€² ) = lim I G (Î·, fi , fiâ€² ).
iâ†’âˆž

By exchanging f and f â€² and using the regular semi-simple support case that we have proved, we draw
the conclusion.

50

Corollary 9.3. Let M, L âˆˆ L G,Ï‰ (M0 ), X âˆˆ (m âˆ© srs )(F )ell and Y âˆˆ (l âˆ© srs )(F )ell . Then we have the
equality
dim(AL /AG ) G
(âˆ’1)dim(AM /AG ) Ã®G
Ã®L (Î·, Y, X).
M (Î·, X, Y ) = (âˆ’1)
Proof. By Lemma 8.3.2), up to MH (F )-conjugation on X and LH (F )-conjugation on Y , we may and
shall suppose that there exist Cartan subspaces c1 âˆˆ Tell (mâˆ©s) and c2 âˆˆ Tell (lâˆ©s) such that X âˆˆ c1,reg (F )
and Y âˆˆ c2,reg (F ). As in the proof of Proposition 7.2, we can choose an open compact neighbourhood V1
of X in c1,reg (resp. V2 of Y in c2,reg ) such that if two elements in V1 (resp. V2 ) are H(F )-conjugate, then
they are the same. Let f, f â€² âˆˆ Ccâˆž (s(F )) with Supp(f ) âŠ† Ad(H(F ))(V2 ) and Supp(f â€² ) âŠ† Ad(H(F ))(V1 ).
By an analogous calculation to that of J G (Î·, fË†, f â€² ) in the proof of Proposition 7.2, with the help of
Lemma 8.3.2) and Proposition 4.1.3), we show the equalities
Z
G
â€²
dim(AM /AG )
G
G
I (Î·, f, f ) = (âˆ’1)
IË†M
(Î·, X1 , f )IG
(Î·, X1 , f â€² )dX1
V1

and
G
IË†M
(Î·, X1 , f ) =

for all X1 âˆˆ V1 by (7.1.2). Then
â€²

G

dim(AM /AG )

I (Î·, f, f ) = (âˆ’1)

Z

V2

Z

V1 Ã—V2

Similarly, we have
G

â€²

dim(AL /AG )

I (Î·, f , f ) = (âˆ’1)

Z

V2 Ã—V1

G
Ã®G
M (Î·, X1 , Y2 )IG (Î·, Y2 , f )dY2

G
G
â€²
Ã®G
M (Î·, X1 , Y2 )IG (Î·, Y2 , f )IG (Î·, X1 , f )dY2 dX1 .

G
â€² G
Ã®G
L (Î·, Y2 , X1 )IG (Î·, X1 , f )IG (Î·, Y2 , f )dX1 dY2 .

By Harish-Chandra's submersion principle (Lemma 3.9), when f â€² varies, the function X1 7â†’ IX1 (f â€² ) =
G
G
Îº(X1 )IG
(Î·, X1 , Îºf â€² ) on V1 runs over all Ccâˆž (V1 ), so the function IG
(Î·, *, f â€² ) on V1 also runs over all
âˆž
G
Cc (V1 ). Similarly, when f varies, the function IG (Î·, *, f ) on V2 runs over all Ccâˆž (V2 ). Then from the
invariant trace formula (Theorem 9.1), we deduce that
dim(AL /AG ) G
(âˆ’1)dim(AM /AG ) Ã®G
Ã®L (Î·, Y2 , X1 )
M (Î·, X1 , Y2 ) = (âˆ’1)

for all (X1 , Y2 ) âˆˆ V1 Ã— V2 . We conclude by (X, Y ) âˆˆ V1 Ã— V2 .



9.2. The case of (Gâ€² , H â€² ). For f, f â€² âˆˆ Ccâˆž (sâ€² (F )), we define
Z
X
X
â€² â€² âˆ’1
Hâ€²
â€²
Hâ€²
M â€² âˆ’1
dim(AM â€² /AH â€² )
|W (M , c )|
I (f, f ) :=
|W0 ||W0 | (âˆ’1)
câ€²reg (F )
fâ€² âˆ©sâ€² )
(9.2.1)
M â€² âˆˆL H â€² (M0â€² )
câ€² âˆˆTell (m
Hâ€²
Hâ€²
â€²
IË†M
â€² (Y, f )IH â€² (Y, f )dY.

fâ€² âˆ© sâ€² ), I Hâ€²â€² (*, f â€² ) vanishes outside a compact subset of câ€² (F ),
From Proposition 4.4.2), for any câ€² âˆˆ Tell (m
H
so one may apply Lemma 8.8.5) to show that this expression is absolutely convergent with the help of
Proposition 3.23 and Corollary 3.7. One may extend in the obious way the definition (9.2.1) to the
fâ€² , M â€² , Ad(Î±)), where M â€² âˆˆ L H â€² (M â€² ).
symmetric pair (M
0
Theorem 9.4 (Invariant trace formula). For all f, f â€² âˆˆ Ccâˆž (sâ€² (F )), we have the equality
â€²

â€²

I H (f, f â€² ) = I H (f â€² , f ).
Proof. We may apply the argument of Theorem 9.1 with obvious modifications. It is deduced from
the noninvariant trace formula (Theorem 5.12) and other results that we have prepared in previous
sections.

â€²

fâ€² âˆ© sâ€²rs )(F )ell and X âˆˆ (e
Corollary 9.5. Let M â€² , Lâ€² âˆˆ L H (M0â€² ), Y âˆˆ (m
lâ€² âˆ© sâ€²rs )(F )ell . Then we have the
equality
â€²

â€²

dim(ALâ€² /AH â€² ) H
(âˆ’1)dim(AM â€² /AH â€² ) Ã®H
Ã®Lâ€² (Y, X).
M â€² (Y, X) = (âˆ’1)

Proof. We may apply the argument of Corollary 9.3 by using the invariant trace formula (Theorem 9.4)
and consulting the proof of Proposition 7.10.

51

10. A vanishing property at infinity
10.1. The case of (G, H). The following proposition is an analogue of [9, Proposition 2.2].
Proposition 10.1. Let M âˆˆ L G,Ï‰ (M0 ), M 6= G. Let X âˆˆ (m âˆ© srs )(F ) and Y âˆˆ srs (F ). Then there
exists N âˆˆ N such that if Î» âˆˆ F Ã— satisfies vF (Î») < âˆ’N , we have
Ã®G
M (Î·, Î»X, Y ) = 0.
Remark 10.2. A limit formula at infinity for Ã®G
G (Î·, Î»X, Y ) in the spirit of Laplace transform is given in
[37, Proposition 7.1] (see also [36, Proposition 6.4]), which is an analogue of [33, Proposition VIII.1].
Proof of Proposition 10.1. We shall imitate the proof of [9, Proposition 2.2].
By Lemma 8.3.2), up to H(F )-conjugation on Y , we may and shall suppose that there exists L âˆˆ
L G,Ï‰ (M0 ) and an L-elliptic Cartan subspace c âŠ† l âˆ© s such that Y âˆˆ creg (F ). By Lemma 8.2, we have
the equality
G
Ã®G
M (Î·, Î»X, Y ) = ÄµM (Î·, Î»X, Y ).
Thus it suffices to prove that there exists N âˆˆ N such that if Î» âˆˆ F Ã— satisfies vF (Î») < âˆ’N , we have
G
ÄµM
(Î·, Î»X, Y ) = 0.

Fix an OF -lattice kh (resp. ks ) of h(F ) (resp. s(F )). Denote by kes the dual OF -lattice of ks in s(F ),
i.e.,
kes := {Z âˆˆ s(F ) : âˆ€Z â€² âˆˆ ks , Î¨(hZ, Z â€² i) = 1}.

Set

c(X) := {X â€² âˆˆ c(F ) : âˆƒx âˆˆ H(F ), Ad(x)(X â€² ) = X},

which is a finite (perhaps empty) set. For Î» âˆˆ F Ã— , choose hÎ» âˆˆ N such that both of the functions
G
ÄµM
(Î·, Î»X, *) and |Ds (*)|F are constant on Y + ÌŸhÎ» ks .
Let f (resp. f â€² ) âˆˆ Ccâˆž (s(F )) be the characteristic function of Y + ÌŸhÎ» ks (resp. ÌŸâˆ’hÎ» kes ). Then for
Z âˆˆ s(F ), we see that
Z
Z
â€²
â€²
Ë†
Î¨(hZ, Z â€² i)dZ â€²
Î¨(hZ, Z i)dZ = cÎ¨ (s(F ))Î¨(hZ, Y i)
f (Z) =cÎ¨ (s(F ))
Y +ÌŸ hÎ» ks
=cÎ¨ (s(F ))vol(ÌŸhÎ» ks )Î¨(hZ, Y

ÌŸ hÎ» ks

â€²

i)f (Z).

G
Now there are two expressions for JM
(Î·, Î»X, fË†). One the one hand,
(10.1.1)
Z
âˆ’1/2
âˆ’1/2
f (Z)Äµ G (Î·, Î»X, Z)|Ds (Z)|
dZ = vol(ÌŸhÎ» ks )Äµ G (Î·, Î»X, Y )|Ds (Y )|
.
J G (Î·, Î»X, fË†) =
M

M

s(F )

F

M

F

On the other hand,
(10.1.2)
1/2
G
JM
(Î·, Î»X, fË†) = |Ds (Î»X)|F

Z

HÎ»X (F )\H(F )

1/2

=cÎ¨ (s(F ))vol(ÌŸhÎ» ks )|Ds (Î»X)|F

Z

G
fË†(Ad(xâˆ’1 )(Î»X))Î·(Nrd(x))vM
(x)dx

HX (F )\H(F )

G
Î¨(hAd(xâˆ’1 )(Î»X), Y i)f â€² (Ad(xâˆ’1 )(Î»X))Î·(Nrd(x))vM
(x)dx.

Fix an open neighbourhood Vh of 0 in h(F ) which is invariant by the adjoint action of H(F ) such that
a homeomorphic exponential map is defined on Vh . Choose a âˆˆ N verifying the following conditions:
(1) ÌŸa kh âŠ† Vh ;
(2) Ka := exp(ÌŸa kh ) is a subgroup of KH ;
(3) Î·(Nrd(Ka )) = 1;
(4) the adjoint action of Ka stabilises ks (and thus kes ).
Fix a set Î“ of representatives in H(F ) of double cosets HX (F )\H(F )/Ka . We may and shall suppose
that if x âˆˆ Î“ and y âˆˆ HX (F )xKa verify Ad(y âˆ’1 )(X) âˆˆ c(F ), then Ad(xâˆ’1 )(X) âˆˆ c(F ).
The integral in (10.1.2) can be decomposed as
XZ
G
Î¨(hAd(y âˆ’1 )(Î»X), Y i)f â€² (Ad(y âˆ’1 )(Î»X))Î·(Nrd(y))vM
(y)dy.
xâˆˆÎ“

HX (F )\HX (F )xKa

52

G
By the conditions (2), (3) and (4) on a respectively, the factors vM
, Î· and f â€² can be extracted from
the integral. By comparing (10.1.1) and (10.1.2), since h*, *i is invariant by the adjoint action of Ka , we
obtain
(10.1.3)
Z
X
1/2
â€²
âˆ’1
G
G
s
s
f (Ad(x )(Î»X))Î·(Nrd(x))vM (x)
ÄµM (Î·, Î»X, Y ) =cÎ¨ (s(F ))|D (Î»X)D (Y )|F
HX (F )\HX (F )xKa

xâˆˆÎ“

Î¨(hAd(y

âˆ’1

)(Î»X), Y i)dy

1/2

=cÎ¨ (s(F ))|Ds (Î»X)Ds (Y )|F vol(Ka )âˆ’1

X

vol(HX (F )\HX (F )xKa )f â€² (Ad(xâˆ’1 )(Î»X))

xâˆˆÎ“
G
Î·(Nrd(x))vM
(x)i(x),

where
i(x) :=

Z

Î¨(hAd(xâˆ’1 )(Î»X), Ad(y)(Y )i)dy.

Ka

For x âˆˆ Î“, consider the map Ka â†’ F defined by

âˆ€y âˆˆ Ka , y 7â†’ hAd(xâˆ’1 )(X), Ad(y)(Y )i.

(10.1.4)

Its differential at the point y0 âˆˆ Ka is the map h(F ) â†’ F defined by

âˆ€Z âˆˆ h(F ), Z 7â†’ hAd(xâˆ’1 )(X), Ad(y0 )([Z, Y ])i.

(10.1.5)

Since h*, *i is invariant by the adjoint action of G(F ), we see that

hAd(xâˆ’1 )(X), Ad(y0 )([Z, Y ])i = h[Y, Ad(xy0 )âˆ’1 (X)], Zi.

Because the restriction of h*, *i to h(F ) is non-degenerate, the map (10.1.5) is not surjective if and only if
[Y, Ad(xy0 )âˆ’1 (X)] = 0.

Since Y âˆˆ creg (F ), this condition is equivalent to

Ad(xy0 )âˆ’1 (X) âˆˆ c(F ).

From our choice of Î“, as y0 âˆˆ Ka , it implies that
Let

Ad(xâˆ’1 )(X) âˆˆ c(F ).

Î“â€² := {x âˆˆ Î“ : Ad(xâˆ’1 )(X) âˆˆ c(F )},
which is a finite (perhaps empty) subset of Î“. Then for x âˆˆ Î“ âˆ’ Î“â€² , the map (10.1.4) is a submersion.
Define
[
Î© :=
HX (F )xKa ,
xâˆˆÎ“âˆ’Î“â€²

which is an open and closed subset of H(F ). Fix a basis of the F -linear space s(F ). For Z âˆˆ s(F ), define
its norm kZk âˆˆ Râ‰¥0 as the maximum of normalised absolute values of coefficients of Z with respect to
the fixed basis. For Z âˆˆ s(F ) âˆ’ {0}, define Î½(Z) âˆˆ Z by kZk = |ÌŸÎ½(Z) |F . Let SX be the closure of
0
SX
:= {ÌŸâˆ’Î½(Ad(y

âˆ’1

)(X))

Ad(y âˆ’1 )(X) : y âˆˆ Î©}

in the unit sphere Ss := {Z âˆˆ s(F ) : kZk = 1}. Then SX is compact. Recall that we denote by N s the
set of nilpotent elements in s(F ).
Lemma 10.3. We have
0
SX âˆ’ SX
âŠ† N s âˆ’ {0}.

/ SX . Let Z âˆˆ SX . There exists a sequence
Proof of Lemma 10.3. Since SX âŠ† Ss , it is obvious that {0} âˆˆ
{yi } in Î© such that when i â†’ âˆž,
âˆ’1

ÌŸâˆ’Î½(Ad(yi

)(X))

Ad(yiâˆ’1 )(X) â†’ Z.

We distinguish two cases.
i) Suppose that the sequence {kAd(yiâˆ’1 )(X)k} remains bounded. By Harish-Chandra's compactness
lemma for symmetric spaces (Lemma 3.2), the projection of the sequence {yi } to HX (F )\H(F ) is contained in a compact subset. By taking a subsequence, since the projection of Î© to HX (F )\H(F ) is
0
closed, we may assume that when i â†’ âˆž, Ad(yiâˆ’1 )(X) â†’ Ad(y âˆ’1 )(X) with y âˆˆ Î©. Thus Z âˆˆ SX
in this
case.
53

ii) Suppose that the sequence {kAd(yiâˆ’1 )(X)k} is unbounded. By taking a subsequence, we may
assume that when i â†’ âˆž, kAd(yiâˆ’1 )(X)k â†’ +âˆž. The eigenvalues of ad(Ad(yiâˆ’1 )(X)) are the same as
those of ad(X); here ad(Ad(yiâˆ’1 )(X)) and ad(X) are viewed as linear endomorphisms of g. Thus the
âˆ’1
eigenvalues of ad(ÌŸâˆ’Î½(Ad(yi )(X)) Ad(yiâˆ’1 )(X)) tend to zero when i â†’ âˆž. Hence ad(Z) is nilpotent. We
shall prove that Z âˆˆ N s in this case.
Since g is reductive, one has g = z âŠ• gder , where z denotes the centre of g and gder denotes the derived
algebra of g, and gder is semisimple. Let Z = Z1 + Z2 with Z1 âˆˆ z(F ) and Z2 âˆˆ gder (F ). Since ad(Z) is
nilpotent as a linear endomorphism of g, we deduce that ad(Z2 ) is nilpotent as a linear endomorphism
of gder . As gder is semisimple, we obtain that Z2 is a nilpotent element in g. Let X = X1 + X2
âˆ’1
with X1 âˆˆ z(F ) and X2 âˆˆ gder (F ). The projection of ÌŸâˆ’Î½(Ad(yi )(X)) Ad(yiâˆ’1 )(X) to z(F ) is equal to
âˆ’1
ÌŸâˆ’Î½(Ad(yi )(X)) X1 , which tends to zero when i â†’ âˆž. Thus Z1 = 0, and Z = Z2 is a nilpotent element
in g. Hence Z âˆˆ N s .

For U âˆˆ N s âˆ’ {0}, consider the map Ka â†’ F defined by

âˆ€y âˆˆ Ka , y 7â†’ hU, Ad(y)(Y )i.

(10.1.6)

Its differential at the point y0 âˆˆ Ka is the map h(F ) â†’ F defined by

âˆ€Z âˆˆ h(F ), Z 7â†’ hU, Ad(y0 )([Z, Y ])i = h[Y, Ad(y0âˆ’1 )(U )], Zi

by the G(F )-invariance of h*, *i. Since Y âˆˆ creg (F ) and Ad(y0âˆ’1 )(U ) âˆˆ N s âˆ’ {0}, we have
[Y, Ad(y0âˆ’1 )(U )] 6= 0.

Then the map (10.1.6) is a submersion by the non-degeneration of h*, *i on h(F ).
Using Lemma 10.3 and combining our discussion on the maps (10.1.4) and (10.1.6), we deduce that
f
f
there exists an open compact neighbourhood Sf
X of SX in Ss such that the map Ï† : Ka Ã— SX â†’ F Ã— SX
defined by
âˆ€(y, Z) âˆˆ Ka Ã— Sf
X , (y, Z) 7â†’ (hZ, Ad(y)(Y )i, Z)
is a submersion. Since any submersion is open, the image of Ï† (denoted by Im(Ï†)) is an open compact
â€²
f
subset of F Ã— Sf
X . Then the map Ï† induces a surjective submersion Ï† : Ka Ã— SX â†’ Im(Ï†). Applying
Harish-Chandra's submersion principle [17, Theorem 11] to Ï†â€² , there exists a function Ï† âˆˆ Ccâˆž (Im(Ï†))
such that for all Î¦â€² âˆˆ Ccâˆž (Im(Ï†)),
Z
Z
â€²
Ï†(t, Z)Î¦â€² (t, Z)dZdt.
Î¦ (hZ, Ad(y)(Y )i, Z)dZdy =
Ka Ã—Sf
X

Im(Ï†)

Fix such a Ï†. Denote by C (F Ã— Sf
X ) the space of locally constant, complexed-valued functions on
âˆž
f
f
F Ã— SX . For Î¦ âˆˆ C (F Ã— SX ), the restriction of Î¦ to Im(Ï†) belongs to Ccâˆž (Im(Ï†)), so we obtain
Z
Z
Ï†(t, Z)Î¦(t, Z)dZdt.
Î¦(hZ, Ad(y)(Y )i, Z)dZdy =
âˆž

F Ã—Sf
X

Ka Ã—Sf
X

f
By taking Î¦(t, Z) := Î¨(Î¼t)Î²(Z) with Î¼ âˆˆ F and Î² âˆˆ Ccâˆž (Sf
X ), we deduce that for all Z âˆˆ SX ,
Z
Z
Ï†(t, Z)Î¨(Î¼t)dt.
Î¨(Î¼hZ, Ad(y)(Y )i)dy =
F

Ka

âˆž
âˆž
f
Since Im(Ï†) is an open compact subset of F Ã— Sf
X , we see that Ï† âˆˆ Cc (Im(Ï†)) âŠ† Cc (F Ã— SX ) =
P
âˆž
âˆž f
âˆž
âˆž f
cj * Î¾j âŠ— Ï‡j with cj âˆˆ C, Î¾j âˆˆ Cc (F ) and Ï‡j âˆˆ Cc (SX ). Then
Cc (F ) âŠ— Cc (SX ). Suppose that Ï† =

Z

1â‰¤jâ‰¤m

Ï†(t, Z)Î¨(Î¼t)dt =

F

X

cj Î¾Ë†j (Î¼)Ï‡j (Z),

1â‰¤jâ‰¤m

where Î¾Ë†j âˆˆ
is the Fourier transform of Î¾j . We see that there exists N0 âˆˆ N such that for all
Î¼ âˆˆ F Ã— satisfying vF (Î¼) < âˆ’N0 and all Z âˆˆ SX , we have
Z
Î¨(Î¼hZ, Ad(y)(Y )i)dy = 0.
Ccâˆž (F )

Ka

Fix such an N0 .
Recall that for x âˆˆ Î“,

i(x) =

Z

Î¨(Î¼hZ, Ad(y)(Y )i)dy,

Ka
54

where Î¼ := Î»ÌŸÎ½(Ad(x
i(x) = 0 if

âˆ’1

)(X))

and Z := ÌŸâˆ’Î½(Ad(x

Set

âˆ’1

)(X))

Ad(xâˆ’1 )(X). For x âˆˆ Î“ âˆ’ Î“â€² , we have Z âˆˆ SX , so

vF (Î») + Î½(Ad(xâˆ’1 )(X)) < âˆ’N0 .
Î½0 := sup Î½(Ad(xâˆ’1 )(X)),
xâˆˆÎ“

which is finite thanks to Harish-Chandra's compactness lemma for symmetric spaces (Lemma 3.2). Now
let
N := N0 + Î½0 .
G
G
(Î·, Î»X, Y ) = 0, it suffices to prove vM
(x) = 0 for
Suppose that vF (Î») < âˆ’N . From (10.1.3), to show ÄµM
â€²
all x âˆˆ Î“ .
For x âˆˆ Î“â€² , we have Ad(xâˆ’1 )(X) âˆˆ creg (F ). Then Ad(xâˆ’1 )(HX ) = Tc . Since X âˆˆ (m âˆ© srs )(F ),
we see that Ad(xâˆ’1 )(AM ) is an F -split torus in Tc . As c âŠ† l âˆ© s is L-elliptic, AL is the maximal
F -split torus in Tc . Thus Ad(xâˆ’1 )(AM ) âŠ† AL . Then AM âŠ† Ad(x)(AL ) âŠ† Ad(x)(AM0 ). We deduce
that Ad(x)(AM0 ) is a maximal F -split torus in MH , so it is MH (F )-conjugate to AM0 . Therefore,
G
x âˆˆ MH (F )NormH(F ) (M0 ) âŠ† MH (F )KH . Consequently, we have vM
(x) = 0 and conclude.


10.2. The case of (Gâ€² , H â€² ).
â€²
fâ€² âˆ© sâ€²rs )(F ) and X âˆˆ sâ€²rs (F ). Then there
Proposition 10.4. Let M â€² âˆˆ L H (M0â€² ), M â€² 6= H â€² . Let Y âˆˆ (m
Ã—
exists N âˆˆ N such that if Î» âˆˆ F satisfies vF (Î») < âˆ’N , we have
â€²

Ã®H
M â€² (Î»Y, X) = 0.

Proof. It is almost the same as the proof of Proposition 10.1, except that one needs to use Lemma 8.8.2)
and Lemma 8.7.

References
[1] Avraham Aizenbud and Dmitry Gourevitch. Generalized Harish-Chandra descent, Gelfand pairs, and an Archimedean
analog of Jacquet-Rallis's theorem. Duke Math. J., 149(3):509â€“567, 2009. With an appendix by the authors and Eitan
Sayag.
[2] James Arthur. A trace formula for reductive groups. I. Terms associated to classes in G(Q). Duke Math. J., 45(4):911â€“
952, 1978.
[3] James Arthur. The trace formula in invariant form. Ann. of Math. (2), 114(1):1â€“74, 1981.
[4] James Arthur. The invariant trace formula. I. Local theory. J. Amer. Math. Soc., 1(2):323â€“383, 1988.
[5] James Arthur. A local trace formula. Inst. Hautes Ã‰tudes Sci. Publ. Math., (73):5â€“96, 1991.
[6] James Arthur. An introduction to the trace formula. In Harmonic analysis, the trace formula, and Shimura varieties,
volume 4 of Clay Math. Proc., pages 1â€“263. Amer. Math. Soc., Providence, RI, 2005.
[7] Roger W. Carter. Finite groups of Lie type. Pure and Applied Mathematics (New York). John Wiley & Sons, Inc.,
New York, 1985. Conjugacy classes and complex characters, A Wiley-Interscience Publication.
[8] Pierre-Henri Chaudouard. La formule des traces pour les algÃ¨bres de Lie. Math. Ann., 322(2):347â€“382, 2002.
[9] Pierre-Henri Chaudouard. Sur certaines identitÃ©s endoscopiques entre transformÃ©es de Fourier. J. Reine Angew. Math.,
585:1â€“59, 2005.
[10] Pierre-Henri Chaudouard. Sur le changement de base stable des intÃ©grals orbitales pondÃ©rÃ©es. Ann. Sci. Ã‰cole Norm.
Sup. (4), 40(1):51â€“112, 2007.
[11] Pierre-Henri Chaudouard. Le transfert lisse des intÃ©grales orbitales d'aprÃ¨s Waldspurger. In On the stabilization of
the trace formula, volume 1 of Stab. Trace Formula Shimura Var. Arith. Appl., pages 145â€“180. Int. Press, Somerville,
MA, 2011.
[12] Marion Chommaux. Distinction of the Steinberg representation and a conjecture of Prasad and Takloo-Bighash. J.
Number Theory, 202:200â€“219, 2019.
[13] Neil Chriss and Victor Ginzburg. Representation theory and complex geometry. Modern BirkhÃ¤user Classics.
BirkhÃ¤user Boston, Ltd., Boston, MA, 2010. Reprint of the 1997 edition.
[14] Brooke Feigon, Kimball Martin, and David Whitehouse. Periods and nonvanishing of central L-values for GL(2n).
Israel J. Math., 225(1):223â€“266, 2018.
[15] Jiandong Guo. On a generalization of a result of Waldspurger. Canad. J. Math., 48(1):105â€“142, 1996.
[16] Jiandong Guo. Uniqueness of generalized Waldspurger model for GL(2n). Pacific J. Math., 180(2):273â€“289, 1997.
[17] Harish-Chandra. Harmonic analysis on reductive p-adic groups. Lecture Notes in Mathematics, Vol. 162. SpringerVerlag, Berlin-New York, 1970. Notes by G. van Dijk.
[18] Roger Howe. The Fourier transform and germs of characters (case of Gln over a p-adic field). Math. Ann., 208:305â€“322,
1974.
[19] HervÃ© Jacquet. Sur un rÃ©sultat de Waldspurger. Ann. Sci. Ã‰cole Norm. Sup. (4), 19(2):185â€“229, 1986.
[20] HervÃ© Jacquet and Stephen Rallis. Uniqueness of linear periods. Compositio Math., 102(1):65â€“123, 1996.
[21] B. Kostant and S. Rallis. Orbits and representations associated with symmetric spaces. Amer. J. Math., 93:753â€“809,
1971.
55

[22] Robert E. Kottwitz. Harmonic analysis on reductive p-adic groups and Lie algebras. In Harmonic analysis, the trace
formula, and Shimura varieties, volume 4 of Clay Math. Proc., pages 393â€“522. Amer. Math. Soc., Providence, RI,
2005.
[23] Jean-Pierre Labesse. Noninvariant base change identities. MÃ©m. Soc. Math. France (N.S.), (61):iv+113, 1995.
[24] J. Lepowsky and G. W. McCollum. Cartan subspaces of symmetric Lie algebras. Trans. Amer. Math. Soc., 216:217â€“
228, 1976.
[25] Huajie Li. An infinitesimal variant of Guo-Jacquet trace formula I: the case of (GL2n,D , GLn,D Ã— GLn,D ). arXiv
e-prints, page arXiv:1904.07102, Apr 2019.
[26] Huajie Li. An infinitesimal variant of Guo-Jacquet trace formula II. arXiv e-prints, page arXiv:2001.07083, January
2020.
[27] J.S. Milne. Class field theory (v4.03), 2020. Available at www.jmilne.org/math/.
[28] Dipendra Prasad and Ramin Takloo-Bighash. Bessel models for GSp(4). J. Reine Angew. Math., 655:189â€“243, 2011.
[29] Cary Rader and Steve Rallis. Spherical characters on p-adic symmetric spaces. Amer. J. Math., 118(1):91â€“178, 1996.
[30] Ãˆ. B. Vinberg. The Weyl group of a graded Lie algebra. Math. USSR, Izv., 10:463â€“495, 1977.
[31] Thierry Vust. OpÃ©ration de groupes rÃ©ductifs dans un type de cÃ´nes presque homogÃ¨nes. Bull. Soc. Math. France,
102:317â€“333, 1974.
[32] J.-L. Waldspurger. Sur les valeurs de certaines fonctions L automorphes en leur centre de symÃ©trie. Compositio Math.,
54(2):173â€“242, 1985.
[33] J.-L. Waldspurger. Une formule des traces locale pour les algÃ¨bres de Lie p-adiques. J. Reine Angew. Math., 465:41â€“99,
1995.
[34] J.-L. Waldspurger. Le lemme fondamental implique le transfert. Compositio Math., 105(2):153â€“236, 1997.
[35] AndrÃ© Weil. Basic number theory. Classics in Mathematics. Springer-Verlag, Berlin, 1995. Reprint of the second (1973)
edition.
[36] Chong Zhang. On linear periods. Math. Z., 279(1-2):61â€“84, 2015.
[37] Chong Zhang. On the smooth transfer for Guo-Jacquet relative trace formulae. Compos. Math., 151(10):1821â€“1877,
2015.
[38] Wei Zhang. Fourier transform and the global Gan-Gross-Prasad conjecture for unitary groups. Ann. of Math. (2),
180(3):971â€“1049, 2014.

Aix Marseille Univ, CNRS, Centrale Marseille, I2M, Marseille, France
E-mail: huajie.LI@univ-amu.fr

56

