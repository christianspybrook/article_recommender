iftuamcsic2146 tensor renormalization group for interacting quantum fields manuel campos germn sierra and esperanza lpez instituto de fsica terica uamcsic c nicols cabrera 1315 cantoblanco 28049 madrid spain arxiv210500010v1 quantph 30 apr 2021 we present a new tensor network algorithm for calculating the partition function of interacting quantum field theories in 2 dimensions it is based on the tensor renormalization group trg protocol adapted to operate entirely at the level of fields this strategy was applied in ref1 to the much simpler case of a free boson obtaining an excellent performance here we include an arbitrary selfinteraction and treat it in the context of perturbation theory a real space analogue of the wilsonian effective action and its expansion in feynman graphs is proposed using a 4 theory for benchmark we evaluate the order correction to the free energy the results show a fast convergence with the bond dimension implying that our algorithm captures well the effect of interaction on entanglement tensor network techniques have been crucial to study strongly coupled spin systems relevant to condensed matter and statistical physics243 the application of these techniques to quantum fields presents the challenge of dealing with infinite dimensional systems several strategies have been pursued to this aim the most obvious is to introduce a truncation that brings back to the simpler framework of finite dimensional hilbert spaces an opposite philosophy has lead to the development of continuous versions of tensor networks4451 tensor networks have also provided simple versions of the holographic principle within the adscft correspondence5259 inspired on standard field theory techniques a different strategy was explored in1 the main idea was to keep the continuous character of fields treating them as the basic element for the implementation of an adapted tensor renormalization group trg protocol17 the viability of this approach was tested by evaluating the partition function of a free massive boson on a 2dimensional square lattice the results exhibited a very good numerical precision with moderate bond dimension which in this case counts the number of fields per lattice link remarkably the massless limit could be addressed without an increase in the bond dimension the strength of the method relies on the combination of semianalytic expressions and numerics that only involves finite dimensional matrices this however is heavily based on the gaussian nature of free fields therefore it was an open question whether the same ideas are applicable to interacting field theories we show that the answer is affirmative moreover the semianalytical character of the method exhibits important aspects of the interplay between interaction and entanglement the paper is organized as follows we set the basis of our proposal in section 1 section 2 reviews the application to free fields section 3 contains a brief summary of the wilsonian approach to quantum fields theories interaction is introduced in section 4 in the context of perturbation theory the structure of the trg for interacting quantum fields is analized in section 5 we explore the numerical performance of the protocol in section 6 section 7 presents a summary of results and discusses further lines of research technical details are consigned to appendices an implementation in mathematica of this adapted trg newtwork can be found in the github repository60 a tensor network for quantum fields the aim of this paper is to present a new framework for a real space renormalization group rg analysis of quantum field theories it will combine the main guidelines of a conventional particle physics approach to quantum field theory6162 with the introduction of a classification of degrees of freedom based on entanglement the main focus of study will be the partition function whose rg analysis will be formulated in terms of fields x r in the spirit of lattice field theory the spacetime will be discretized we will work in two dimensions and consider a scalar field theory with lagrangian l x2 m2 x2 vx where m is the boson mass and a coupling constant for concrete numerical evaluations we will choose vx x4 but otherwise we keep the potential generic we will study a discretized version of this theory living on a square lattice with unit spatial and temporal steps the field variables are assigned to the lattice links while the statistical or boltzmann weights are carried by the vertices the weights w0 xi are given by  e 2 i1 xi xi1 2 m2 xi2 vxi the partition function of the so defined vertex model is ilinks dxi w0 j xi jvertices the evaluation of the partition function will be done by means of an adapted tensor renormalization group protocol trg that reduces iteratively the size of the lattice the trg for finite dimensional systems is based on the singular value decomposition svd of the boltzmann weights17 w ul dur where ulr are unitary matrices with ur denoting the adjoint of ur and d is a diagonal matrix containing the singular values of w this decomposition has the following graphical representation the tensor w can be analogously decomposed along the opposite diagonal the variables in the new tilted links have a one to one correspondence with the singular values of w therefore they have a natural hierarchy based on entanglement this allows to discard those with the weakest contribution after the splitting 6 the old variables are summed over eliminating degrees of freedom associated with short range entanglement the number of lattice links is reduced in this process by a factor of two our proposal of a tensor network for quantum field theories can be summarized in a simple idea apply the svd splitting not to the boltzmann weights but to their exponent this allows to treat fields as the basic elements and to deal with finite tensors instead of functions while preserving the continuous character of the boltzmann weights trg for free fields let wn denote the boltzmann weights of the discretized boson model at a given coarse graining level  wn xi where xi xi1 xin is the set of fields carried by each lattice link we will refer to n as the bond dimension of the tensor network in analogy with 6 we are searching for a factorization of the form wn xi dp vn x1 x2 pvn p x4 x3 the variables p p1 pn1 necessary for the splitting of wn are associated with the internal tilted link in 6 we require that p j r in order to interpret them as fields thus n1 will be the bond dimension of the new links in this simple implementation of the trg xfields on straight links and pfields on tilted links alternate along the coarse graining iterations the symmetries of the model allow to make a choice of basis for the fields such that all cubic weights independently of their orientation share the same expression this choice has been assumed in 9 gaussian svd we consider first the implementation of this approach on the initial weights w0 3 the mass and interaction terms in the lagrangian 1 do not contribute to the coupling of fields across lattice links the only obstruction to a trivial splitting of w0 is the factor e 2 x2 x3 x1 x4 remarkably a simple fourier transform is enough to realise the scheme proposed in 9 e 2 x1 x4 1 2 d p1 e ip1 x1 x4 2 p1 an analogous expression holds for the mixing between x23 after introducing a second splitting field p2 hence the bond dimension is doubled in this process while a single field lives at the links of the original lattice 0 1 the new tilted links carry two 1 2 this simple mechanism is enough for the real space rg analysis of free field theories1 in the absence of interaction the weights 3 are gaussian the splitting 11 respects this property we can thus write the boltzmann weights at any coarse graining level n as wn x fn e 2 x mn x with mn a 4n 4n matrix and fn a numerical factor from now on boldface symbols without indices will denote collectively all fields involved in the expression under consideration the argument of the boltzmann weights are xtype fields for n even and ptype fields for n odd for convenience and without loss of generality we have chosen the former to write down the general expression 12 a basis can be chosen1 where mn has the form an 0 bn bn mn 0 an bn bn where an and bn are real nonnegative symmetric matrices and mn acts on x x1 x2 x4 x3 for the initial weights w0 the previous matrices are given by 1 1 a0 12 b0 12 1 1 the 2 2 block structure of 13 reflects the lr factorization that we need to implement in order to move to the next coarse graining level with respect to the splitting 6 we have x xl xr with xl x1 x2 and xr x4 x3 generalizing 10 the piece of the boltzmann weights responsible for lr mixing is e 2 xl xr bn xl xr because of the mentioned properties of bn its svd reduces to bn un dnunt with un an orthogonal matrix using this decomposition we can apply again a fourier transformation to rewrite 15 as 2 n1 det dn 1 p dp e ixl xr un p 2 p dn numerical results the free energy per site of the discretized free boson model which implements the desired factorization the splitting fields p are in one to one correspondence with the singular values of bn in this way the trg machinery is moved from the boltzmann weights to their exponent where fields are treated as the basic elements we add for completeness the expression of vn 1 p fn e 2 x an x ixun p 4 p dn it holds for cubic weights with any of the four possible orientations the normalization constant fn is defined by the relation fn n fn2 n 2n1 det dn this factorization mechanism was named gaussian svd1 in appendix a we analyze the relation between the gaussian and the standard svd which for the boltzmann weights 12 can be carried out explicitly we show that the latter is also governed by the singular values of the matrix bn therefore the gaussian svd is not a different way of evaluating the lr mixing which the standard svd has been proved to do in an optimal way instead it provides a method to organize the infinite set of singular values obtained when working with continuous functions grouping them into a finite number of subsets associated with fields we include a summary of the first two steps of the trg log z where n is the number of lattice sites and z is the partition function 4 was used to test the numerical performance of this adapted trg protocol1 the coarse graining process trades space time degrees of freedom by link variables the exponential increase in the bond dimension that 20 describes is not numerically sustainable truncation was implemented by discarding small singular values of the lr mixing matrix bn together with their associated splitting fields fig1 shows the results obtained with different maximal number of fields per link an average precision of 108 was achieved with max 64 across a wide range of boson masses remarkably no increase in the bond dimension was necessary to access small masses this allowed to evaluate the central charge of the cft emerging in the massless limit the value c 1 was reproduced to within a 105 error 001 106 108 104 103 001 figure 1 relative error in the free energy per site f ft rgfex fex as a function of the boson mass for different maximal bond dimensions a lattice with n 240 sites has been considered such that the exact free energy fex can be replaced by its n limit it was also proven that the coarse graining process attains an infrared fixed point at the right length scale set by the boson mass even for small bond dimension recall that each field encodes an infinite subset of the singular values resulting from a standard svd described in a16 this subset contains arbitrarily small entries which might explain why working in terms of fields retains relevant long distance information for any bond dimension the singular value matrices d2n1 turn out to have half of their diagonal entries equal to zero the would be splitting fields associated with them can be readily discarded as a consequence the bond dimension doubles when evolving from xfields to pfields but keeps constant from p to xfields1 therefore 2n 2n iii the effective action the treatment of interaction will be inspired in the standard approach to quantum field theories searching for numerical efficiency is not our only motivation we aim at obtaining new insights based on entanglement and for that it is convenient to make a natural connection with the commonly used techniques and concepts we will start reviewing some basic facts about effective field theories6162 let us consider a theory defined at a ultraviolet uv momentum scale by the lagrangian 1 the partition function of the theory is given by d es s d l is the real space analogue of the wilsonian effective action with n playing the role of the uv cutoff 0 preserving the structure of 12 we define where the variables i denote spacetime directions let 0 be a smaller scale the field contains slow modes with a momentum smaller than 0 and fast modes with momentum in the interval 0 we denote them as and respectively the action s can be divided into a quadratic part s0 and s1 which collects the interaction terms s s0 s0 s1 quadratic cross terms between and have been disregarded because these fields are orthogonal upon integration replacing 23 into 22 and integrating the fast modes yields d eseff wn x e 2 x mn x fn x the matrix mn encodes all independent quadratic terms being the counterpart of l0 the function fn contains the effects of interaction and therefore relates to sint real space feynman diagrams we analyze in this section the new features introduced by interaction focussing in the first trg iteration the initial weights w0 of the discretized interacting model were given in 3 the matrix m0 is constructed from a0 and b0 in 14 and the function f0 is where seff s0 sint is the wilsonian effective action at the scale 0 the term sint is derived from the expectation value of s1 taken with the quadratic action of the fast fields esint d es0 s1 f0 x e 2 i1 vxi with x x1 x4 the dependence of f0 on xi trivially factorizes anticipating the lr splitting needed to move to the next coarse graining level we define when is small the average 25 can be evaluated by means of a perturbative expansion its contribution to the effective action at each order in is described by a sum of connected feynman diagrams whose internal lines are propagators we use double lines for propagators and solid lines for external legs feynman diagrams will be depicted in red for avoiding confusion with the tensor network structure of the discretized model taking as example a 4 theory some diagrams at second order in perturbation theory are f0 x 0 f0 xl f0 xr where xl labels the fields at two contiguous links entering w0 and xr those at the other two complementary links a constant 0 has been introduced for convenience as in 18 it is the normalization factor of the fourier transform 16 which in this case equals 2 following section iib for the factorization of the gaussian cross terms in w0 the resulting cubic weights are 1 2  e 2 x a0 xixp 4 p f0 x the integration of high momentum modes gives rise to terms with any number of external legs the exponential prefactor reproduces 17 after taking into account that since b0 12 its svd data u0 and d0 are also the identity sewing together four cubic weights as shown in 19 and integrating out the original x fields we obtain trg for interacting quantum fields guided by the previous formulation we search for a real space rg protocol that can be implemented by local operations namely we want the partition function to be given at each coarse graining level n by dxi ilinks wn j x dx e 2 x q0 xixc0 p wn j x  f0 for concreteness we have chosen xtype fields to write down this general expression the boltzmann weights wn should depend only on the fields living at contiguous links as in 12 the product w1 p e 4 p jvertices jvertices which stands for 1 2 the matrices q0 and c0 of dimensions 4 4 and 4 8 respectively are readily constructed from a0 and u0 their concrete expressions can be found in appendix b the gaussian kernel of 34 can be further simplified by the change of variables x x iq1 0 c0 p it leads to the structure 29 for w1 with m1 18 c0t q1 0 c0 the first term on the rhs reproduces the gaussian factor in front of the integral 34 and the second is generated by the previous shift of variables the function f1 encoding the effects of interaction is given by f1 p dx e 2 x q0 x  f0 x iq1 0 c0 p this expression can be considered a local analogue of 25 with x and p identified with the fields and respectively we can therefore evaluate f1 with the same tools used for the effective action in particular we might use a perturbative expansion when the coupling constant is small order by order in the integral 37 is gaussian and can be easily performed this is done by considering all possible pairings of the xi variables and replacing xi x j 0 i j under the exchange of x and y but otherwise arbitrary this is consistent with the symmetries of the lattice model although f does not satisfy in general 31 it can be rewritten as fx y f x z f y z for some appropriate but not unique function f a possible although not necessarily convenient choice of f is f x z 1 fx x z recall the main guidelines of the trg protocol that we wish to design first obtaining an svdlike protocol that classifies fields according to an entanglement criterium second keeping the coarse graining process local this requires that no residual coupling between x and y linked to the function f remains after splitting we will start by analyzing how the transformation 11 fails to meet the latter condition upgrading z in 41 into an independent field the general expression 40 can be restated as which is equivalent to the well known wicks theorem the matrix q1 0 plays the role of the high momentum mode propagator using this a set of feynman rules can be defined in terms of which to construct the real space analogue of feynman diagrams this is presented in appendix c the logarithm of f1 is given by a sum of so defined connected feynman diagrams for a 4 theory schematically we will have z xy b 2 dzd p e ipxyz 2 z f x z f y z integrating p produces a delta function that imposes z x y and equality immediately follows let us invert the order of integration and evaluate first the integral in z b 2 dz eipz 2 z f x z f y z the functions f are brought out of the integral by promoting them into a the differential operator fx p f x zzi p log f1 1 we have followed the same graphical notation as in 26 a double line for the original fields x living at the four inner links on the lhs of 33 and a single line for the first level fields p carried by the four tilted links interacting svd the effects of interaction on the trg protocol appear after the first coarse graining integration contrary to f0 the function f1 does not satisfy the trivial factorization 31 this is an immediate consequence of the matrix q0 not being diagonal the nonfactorization of f1 is to be expected since the contrary will imply that interaction has no effect on entaglement as a consequence of this the lr splitting protocol has to be revisited to that aim we consider the following function of two variables which serves as a simplified version of the general weights 29 e 2 xy fx y the gaussian integral can then be explicitly evaluated we set  2b such that numerical factors cancel and obtain 1 2 fx p fy p e 2b p the parameter b represents a singular value of the lr mixing matrix b 15 the function f is assumed to be symmetric when f is independent of z as in 31 the standard fourier transform is recovered in the general case the fact that both differential operators act on the same gaussian factor hinders factorization this problem has a simple solution we may double the splitting fields such that each differential operator acts on a different gaussian factor this is achieved by considering fx y f x z1 f y z2 z12 x y with 2 2 we upgrade again z12 into independent variables with the help of two fourier fields p12 using this trick 40 can be factorized as follows dp1dp2 v x p1 p2 v y p2 p1 with v x p1 p2 e ixp p fx p1 e p1 2 notice that v depends on both splitting fields albeit in an asymmetrical manner process the resulting cubic weight v1 p x1 x2 is feynman diagrams and svd we have seen that the function f1 encoding the interaction effects of the level one boltzmann weights admits a diagrammatic expansion we analyze here how this feature behaves under the factorization protocol recall that the first trg iteration exchanges the roles of the x and p variables following 47 we define f1 pl pr 1 f1 pl z1 f1 pr z2 with 1 an appropriate constant and z1 z2 pl pr in order to understand the structure of f1 we focus on a simple example let us consider a contribution to f1 of the form e pl pr the argument of the exponential represents a connected feynman diagram with four legs contributing at first order in perturbation theory it has the same structure as the last graph in 39 the splitting of the previous term according to 50 is 1 2 e 2 pl pl z 2 2 e 2 pr pr z we observe that the four leg diagram is inherited by both factors the coefficient weighting the diagram has been modified such that the original term is recovered when substituting 51 the undesired dependence on the fields plr has been replaced with the help of the auxiliary variables z12 the previous example illustrates a general conclusion connected feynman diagrams in the expansion of f1 reappear in f1 with their topological structure unchanged therefore since the former has a diagrammatic expansion so it does the latter as shown in 39 the logarithm of f1 only contains connected feynman diagrams expression 53 makes clear that this property is also inherited by f1 by induction these statements hold at all coarse graining levels interaction and entanglement the semianalytical character of the coarse graining protocol that we have designed allows to obtain interesting results on the interplay between interaction and entanglement already before addressing its numerical implementation that will be the subject of this section  e 2 p a1 pi pu1 x 1 x2  1 1 1 f1 p x1 ex d1 x generalizing 45 the differential operator f1 is given by f1 p x1 f1 p zziu1 1 the matrices a1 u1 and d1 governing the gaussian terms are those already present in the free case 17 the arrows in the magnified link stress the different roles that the fields x12 play in the cubic weight this is better understood by considering the linear combinations x x1 x2 x x1 x2 a tale of two fields we are ready to factorize the level one boltzmann weights as explained above two sets of splitting fields x12 are necessary upper indices will always make reference to the splitting we will refer to them as even and odd variables respectively the independent coupling of p with the splitting fields only involves the even variables x in the absence of interaction the odd variables x completely decouple since multiplying contributions from the l and r cubic weights we have 1 1 x1 x2 d1 x2 ex d1  e 2 x d1 x 12 x d1 1 x therefore x is the counterpart of the splitting fields already present in the gaussian svd while x allows to treat locally the new entanglement ties created by interaction without interaction the latter become trivial sewing four cubic weights 54 and following the steps presented in section iva for the elimination of p we obtain the second level boltzmann weights w2 x e 2 x m2 x f2 x here x stands for both splitting fields x x recall that the gaussian prefactor only contains leading terms in the pertubative expansion namely o 0 its exponent is given by x m2 x x s1 c1t q1 1 c1 x x s1 x with s1 14 d1 1 diagonal and q1 and c1 constructed out of a1 and u1 respectively as explained in appendix b the expression in parenthesis is the same combination governing the level one boltzmann weights in the absence of interaction this shows the direct connection between x and the fields already present in the free network we have disregarded quadratic terms between even and odd variables indeed relation 57 implies that they trivially cancel in the product of boltzmann weights 28 building up the partition function the effect of interaction is encoded in the function f2 x e u s1 u f2 x u eu s1 u ux1 a variable u has been introduced in order to unambiguously define the action of the derivatives inherited from f1 the differential operator f2 x u is given by dp e 2 p q1 p f1 p iq1 1 c1 x u this integral is the level one equivalent of 37 the expression 60 may seem unconventional it is however reminiscent of the hermite polynomials hn x 1n e x d n x2 dxn each monomial xk in hn is to be related with a feynman diagram with k external legs of type u this introduces an additional structure in the set of feynman diagrams whose relevance we discuss below general structure the main feature of our protocol is the introduction of new fields representing the effect of interaction on entanglement they first appear at the second coarse graining level corresponding to the odd combination of the splitting fields we recall schematically the leading order structure of the even and odd fields x and x respectively using the decomposition 13 of m2 a2x 0 b2x 0 a2 b2 0 a2x 0 0 the decoupling between even and odd variables together with the vanishing of the odd mixing matrix b2x shows the trivial nature of x at leading order o 0 namely these fields just represent decoupled degrees of freedom living at each link however they contribute in general to lr mixing through the function f2 and require an own set of splitting fields to continue the coarse graining process in the simplified splitting problem 40 the vanishing of b2x is equivalent to setting b 0 it is thus a question whether the factorization technique of section iiib applies in this limiting situation which moreover will be recurrent in subsequent iterations in order to clarify this point we send b to zero in 49 after renaming the splitting fields as q12 the product of the gaussian exponential and its associated normalization factor results then in a delta function 1 1 2 lim e b q q1 namely the consequence of a vanishing b is the collapse into a delta function of the probability distribution of q1 in the free case a delta function implies that the associated field can be trivially removed from the coarse graining process in the presence of interaction this does not hold anymore we come back to the factorization of w2 x the splitting fields for the even and odd variables x and x will be denoted by p and q respectively as just explained the probability distribution of fields q collapses into a delta function the level two cubic weights are then  e 2 x a2 x i xu2 p i x q  1 1 1 f2 x p1 q1 ep d2 p q1 with u2 and d2 the svd data of b2x the differential operator f2 induces derivatives of q1 the delta derivatives can not be evaluated right away this has to be postponed to the coarse graining integral that eliminates q it will be done using integration by parts which is equivalent to work at the level of the hermite polynomials 62 instead of dealing with individual feynman diagrams in this way the fields q in spite of their singular distribution function provide a regular and well defined contribution to the propagation of entanglement due to the need of doubling the splitting fields the bond dimension of the trg network with interaction increases twice as fast an in the free case however the different roles of the even and odd combinations in perturbation theory induce a clear distinction between fields a reduced set of them will be in direct correspondence with the fields already present in the free network inheriting from them their leading order structure this set is given by where the index in parenthesis labels the coarse graining level hence x2 refers to the corresponding fields in 59 and p3 to those in 65 the dots stand for the even combination of splitting fields associated with the previous term in the chain the largest set of fields represents entanglement ties created by interaction at each coarse graining level a new family of them is seeded by the odd counterpart of the variables 66 in order to stress the structure organizing this set of fields we have renamed q in 65 as p23 all these fields have a trivial leading order structure as x2 in 59 many of them will have a singular distribution function as it is the case of p23 but this does not represent a harm for the trg protocol a perturbative bound on in the previous section we have not made reference to the order at which we want the perturbative expansion to stop this is however an important information for the trg protocol which sets a limit to the propagation of entanglement mediated by odd variables and results in a reduction of the large set of extra fields 67 for n 2 it is best to analize the effects of the interaction in terms of a differential operator fn x u generalizing f2 in 60 and defined by an integral as in 61 fn x u recall that u is an auxiliary variable which after the evaluation of the derivatives should be replaced by x1 introducing therefore a dependence on the odd variables the operator fn admits an expansion in feynman graphs where the graphss external legs can carry components of the vector x or the derivative u let us assume that in order to move to the next coarse graining level we factorize 68 along the axis i 1 2l 3 4r a generic connected diagram in the expansion of fn has the structure within one iteration at second order in it is straightforward to generalize this reasoning to order n with the result that at larger n more ramifications in 67 become relevant equivalently high orders in perturbation theory require a growing number of extra fields to represent locally the effects of interaction we consider this property a consistency check of our proposal we shall end with a comment on the fields 66 it was mentioned in section iia that before truncation kicks in the singular values matrices d2n1 have half of their diagonal entries equal to zero the probability distribution of the associated fields is thus a delta function although in the free case these fields are trivially discarded in the presence of interaction some of them become relevant and need to be kept we show in appendix e that this only happens when conditions 70 are met since these extra fields behave with respect to the perturbative order as the odd variables do we will not discuss them further the subgraph on the left originates from fn1 and contributes ml powers of the coupling constant a corresponding statement holds for the subgraph on the right after introducing the necessary splitting fields the previous graph will be inherited by the cubic weights resulting from the factorization of 68 as described in section ivc appendix d proves that splitting fields associated with the odd variables x such as q12 in 66 are only required in diagrams satisfying ml mr 1 ml mr n in the previous sections we have extended the trg protocol based on local operations formulated in terms of fields to include interactions we will start here the analysis of its numerical performance using as benchmark a 4 theory this theory has been studied with tensor networks techniques which imply the discretization of the field variables in2635404358 truncation with n the order at which to cut the perturbative expansion clearly these conditions cannot be met at first order in perturbation theory although doubling the splitting fields is necessary at first order in the odd combinations represent short range entanglement and their effect extinguishes within one iteration the upper row contains the fields 66 with a counterpart in the free network from the set 67 only the first item in each tree is relevant this drastic simplification is consistent with the rather trivial nature of quantum corrections at order at second order in perturbation theory 70 implies ml mr 1 numerical results thus if a feynman diagram contributes to odd variable mixing in the nth iteration it will not do it at any subsequent one indeed as an individual diagram it fails to satisfy the first condition 70 while as part of a larger diagram it will be the second which fails the fields involved at second order include 71 plus secondary chains with that same structure stemming from each element of the second row namely the second level odd fields such as p23 in 67 get extinguished the last question that needs to be addressed before implementing the trg is truncation in the free case truncation consists in discarding small singular values of the matrix bn as 64 shows this is equivalent to approximate the probability distribution of the splitting fields related with small singular values by a delta function perturbation theory treats in an asymmetrical way quadratic terms and interaction giving rise to a potential problem truncation is only justified for fields with small lr cross terms from both the leading order gaussian prefactor and the feynman diagrams this only represents a problem for fields contributing non trivially at leading and higher order in namely the set 66 these two conditions are a priori not related since fields with a delta function distribution can yet have a relevant contribution to feynman diagrams via delta derivatives checking their compatibility is the first issue in the numerical study of the trg we will work below at first order in perturbation theory to simplify the analysis by focussing as much as possible on the set 66 when the trg protocol is applied at first order in there is onetoone correspondence between the leading order gaussian structure of the even fields and their counterpart in the free network see appendix e for details since the odd fields do not contribute to the propagation of entanglement they play a secondary role motivated by this we will apply the term bond dimension to the number of fields in 66 which without truncation is given by 20 as for the criterium of truncation we will adopt the simplest choice and base it again on the singular values of bn partition function we present the results on the numerical evaluation of the free energy per site of a 4 theory log z f0 f1 o 2 fig2 shows the relative error in the first order correction f1 for several maximal bond dimensions and masses the relative error of the leading term f0 is also included for comparison a remarkable feature of the trg protocol is the capacity to correctly estimate f0 in the massless limit without varying the bond dimension this property however does not extend to f1 which requires a sustained increase in the bond dimension to keep the precision as the mass lowers on the other hand the convergence with max appears to be faster for f1 than for f0 notice that the precision in f1 improves on that of f0 down to m 006 with just max 20 001 001 001 104 001  f1 figure 2 relative errors f0 dotted lines and f1 crosses in the free energy per site as a function of the mass and the bond dimension in a lattice of size n 240 it is important to quantify the convergence of the trg with the bond dimension the error in the leading term of the free energy at fixed mass follows a power law max this is observed in fig3a where choosing as example m 01 and setting 37 we have obtained a very good fit of f0 the behaviour of f1 is plotted in fig3b at the same mass the error for small bond dimension although larger than that of the leading term decreases exponentially fast as the precision improves the dependence on max turns into a power law with exponent 73 this confirms the faster convergence of f1 across all bond dimensions a similar pattern holds at other values of the mass the smaller the mass the bigger the error at fixed bond dimension and the larger the range of max were convergence is exponential in the same way that the singular values of bn describe the entanglement hierarchy at leading order new quantities are needed to characterize how interaction modifies it to this aim we will use the cubic weights vn after the maximal bond dimension is reached they result from the factorization of the max we will be interested in the cubic weights before implementing the truncation represented in second step at first order in the coupling constant vn can be written as an 21 12 d1 n1 x i xun p 1 1 1 n p1 x u eu12 dn1 u p dn p ux1 max boltzmann weights plus a truncation guided by the matrix bn  e 2 x 104 figure 3 relative errors a f0 and b f1 as a function of the bond dimension at m 01 the blue lines represent a power law fit max the max max matrix dn1 and the 2max 2max matrices an un and dn are precisely the same as in the free case upon evaluating the derivatives u the differential operator n will transform into the level n generalisation of 55 for a 4 theory the operator n can be represented in the terms of the quartic polynomial cn 1 tn tni j zi z j tni jkl zi z j zl zl  76 i j i jkl where the vector z stands for p1 x u the leading order constant cn has been factored out in the definition of the orderk tensors tn k using these tensors we define ni max  tni j ni max  tni jkl jkl with i 1 2max running over the components of p1 these quantities provide an estimate of the relevance of p1i in transmitting the effect of interaction the larger the bond dimension the smaller are some of the singular values in the diagonal matrices dn if the derivatives u and p1 in 75 were evaluated small singular values would induce artificially large entries in the previous tensors such large contributions just mean that the probability distribution of the associated fields is close to a delta function and as discussed above the trg protocol can deal with these objects the singular values of bn and the above defined s are plotted in fig4a for m 01 at the coarse graining level n 8 we observe that the singular values follow a marked descending pattern on the contrary the s start slightly increasing and reach then a plateau extending up to i 10 this implies that interaction strengthens the first set of entanglement ties tending to make them equally relevant however although the entanglement hierarchy is modified it is not incompatible with the leading order truncation criterium based on bn indeed the entries ni with i 14 present a clear decreasing trend the associated splitting fields can thus be discarded with a small error both at the level of the leading and first order terms this is in agreement with the good performance of max 16 for m 01 seen in fig2 it is interesting to notice the similarity between the s related to the two and four leg tensors    bni    ni  1016 ni 1016 figure 4 singular values of bn and sum of tensor elements 77 for a m 01 and b m 001 at the coarse graining level n 8 the number of bs and s at that level is 2n 32 the behaviour shown in fig4a is general moreover the smaller the mass the more s should be taken into account to obtain a good precision this is observed in fig4b which suggests that including up to i 20 is necessary to reasonably describe the first order effects when m 001 the pattern of the s also explains the two regimes seen in fig3b exponential and power law for the dependence of the relative error  f1 on the bond dimension only when max is large enough to include all fields associated with similarly relevant values of the convergence changes from exponential to power law on the other hand the singular values of bn for m 01 and 001 practically coincide this agrees with the almost equal leading order error f0 seen in fig2 for both masses indeed the rg flow of the gaussian weights 12 can be described by the evolution mn mcdl where the only nonzero entries of the matrix mcdl are those described by the cdl vertex when the degrees of freedom running in each plaquette decouple from the others it is simple to integrate them out in this sense the cdl is nothing but a redundant way to represent a trivial ir fixed point this is confirmed by the ability of the trg to transform the free boson lattice into a cdl network as the coarse graining process surpasses the scale set by the boson mass1 having into account that the lattice spacing doubles every two trg iterations this happens when n 2 log2 m1 we show in fig5a the rg evolution of the singular values of bn for max 16 and m 001 at n 18 half of the singular values start to strongly decay this signals the emergence of a cdl structure since contributions from fields at opposite corners trivially factorize at the same time the cdl matrix 79 freezes out which is also observed in that figure the value n 18 is in good agreement with the theoretical estimation 80 whose rhs for m 001 gives 133 notice that the quotient between the correlation length m1 and the lattice spacing at n 18 is 02 we are ready now to analyze the rg flow associated with the first order correction to the free energy the tensors defined in 76 encode the structure at first order in the perturbative expansion of the 4 theory they should reach an ir fixed point at the same scale as the singular values bni a modification of the ir scale 80 can only arise from an all order resumation of perturbative effects as that implied by the usual rg equations we are not addressing this issue here consistently we found that the two and four leg tensors freeze out right after the leading gaussian structure reaches the cdl fixed point cdl structure the standard trg has the drawback of not being fully able to eliminate short range entanglement22 the infrared ir fixed point of gapped systems treated with this protocol is given by a socalled corner double line structure cdl correlations in the cdl network are confined inside each plaquette a svd based coarse graining fails however to detect this structure and promotes half of the cdl loops to the next level this problem is replicated by the free boson trg1 figure 5 rg flow of a the singular values of bn and b the sum of tn 4 elements 77 for max 16 and m 001 the pink line signals n 8 the iteration where truncation begins with max 16 and the red line marks n 18 these plots refer n even horizontal lattices analogous results describe n odd tilted lattices the rg flow of the order terms can be portrayed with the help of 77 we have plotted in fig5b the evolution of the s associated with tn 4 for max 16 and m 001 not only these quantities stabilise at the same time as bni but together with them the corresponding half becomes zero the same result holds for tn 2 this implies that the associated p in 75 are irrelevant to the factorization of both gaussian and interacting cross terms hence the truncation in the second step of 74 is automatic which is a distinct characteristic of the cdl structure finally we have checked that the two and four leg tensors reproduce the cdl pattern of network connections to that aim we define the matrix i j tni j max  tni jkl recall that its indices refer to p1 x u contrary to 77 we assume that the truncation in the second step of 74 has been already implemented and the bond dimension in all links is max a nonzero entry i j reflects that the feynman diagrams connect components i and j a graphical representation of this matrix is given in fig6 for max 16 m 001 and n 24 when the cdl regime is clearly stablished for the leading gaussian terms the boxes defined by the thin black lines have dimension max max while the numbers on their side label the links of the cdl cubic weight included in that figure the colour code describes the magnitude of the entries making clear the cdl structure we obtain thus a unified picture of the rg flow at leading and first order in the coupling constant figure 6 colour plot of the matrix 81 for max 16 m 001 and n 24 vii conclusions we have explored the formulation of a real space coarse graining protocol for interacting qfts based on local manipulations on continuous variables together with an entanglement rooted organisation of degrees of freedom we have used the standard wilsonian approach as guideline this led to move the svd analysis characteristic of real space rg algorithms from the boltzmann weights which describe the discretized qft partition function to their exponent or in other words to the free energy our motivation was to operate directly at the level of fields each field is a proxy for an infinite subset of the singular values that would result from a standard svd the strong structure that this automatically implies aims to be an efficient theoretical tool able to obtain insights that are difficult for more numerical oriented algorithms we have developed a framework based on the trg network17 which realises this program in the context of perturbation theory describing the effect of interaction in terms of local manipulations requires the introduction of extra fields with distinct properties they have a trivial leading order structure and their number increases with the order in perturbation theory at which we want to work due to the simple nature of the associated quantum corrections the role of these additional fields at first order in the coupling constant is secondary it would be therefore important to extend the detailed numerical analysis we have performed here beyond first order the adapted trg network evaluates the partition function of a free boson with excellent precision and a numerical cost independent of the boson mass1 we have chosen a 4 theory to benchmark the performance at first order in perturbation theory in this case the numerical cost increases at small masses but the results exhibit a fast convergence with the bond dimension using the direct correspondence between the field content of the free and first order networks we have analyzed how the interaction modifies the leading order entanglement hierarchy the quantum corrections work towards levelling off the pattern of marked decreasing relevance that organizes the fields in the absence of interaction this effect involves a larger subset of fields the lower the mass is explaining a dependence of the numerical cost on the mass which was not present in the free network besides we obtained a consistent picture of the rg flow at leading and first order as it is characteristic of standard trg algorithms a fixed point with cdl structure was attained in the ir tensor networks are designed to deal with any value of the coupling constant the perturbative approach we have followed here might seem thus limited we believe however that it is an important step towards a goal that is extremely difficult for qft although beyond the scope of this paper a venue to include nonperturbative effects could be adding finite corrections to the gaussian structure that underlies the algorithm a modification of the leading order gaussian structure can also be relevant for improving the performance in the limit of small masses on the other hand we would like to stress that the perturbative framework is not essential for the svd protocol presented in section ivb finally there are other interesting and simpler generalizations of the adapted trg protocol in particular the calculation of correlation functions and its application to field theories with fermions we plan to address some of these issues in the near future acknowledgments we thank pasquale calabrese jos melgarejo javier molinavillaplana giuseppe mussardo antoine tilloy and erik tonni for conversations the work of mc is supported by a contract bes2017080586 we acknowledge financial support from the grants pgc2018095862bc21 quitemad s2013ice2801 and sev20160597 of the centro de excelencia severo ochoa programme m campos g sierra and e lopez tensor renormalization group in bosonic field theory phys rev b 100 195106 2019 i affleck t kennedy e h lieb and h tasaki valence bond ground states in isotropic quantum antiferromagnets commun math phys 115 477 1988 s r white density matrix formulation for quantum renormalization groups phys rev lett 69 2863 1992 m fannes b nachtergaele and r f werner finitely correlated states on quantum spin chains commun math phys 144 443 1992 a klmper a schadschneider and j zittartz matrixproductgroundstates for onedimensional spin1 quantum antiferromagnets europhys lett 24 293 1993 s stlund and s rommer thermodynamic limit of density matrix renormalization phys rev lett 75 3537 1995 t nishino density matrix renormalization group method for 2d classical models j phys soc jpn 64 3598 1995 t nishino and k okunishi corner transfer matrix algorithm for classical renormalization group j phys soc jpn 66 3040 1997 j dukelsky ma martindelgado t nishino g sierra equivalence of the variational matrix product method and the density matrix renormalization group applied to spin chains europhys lett 43 457 1998 g sierra and ma martindelgado the density matrix renormalization group quantum groups and conformal field theory proceed workshop on the exact renormalization group faro portugal 1998 arxivcondmat9811170 g vidal efficient classical simulation of slightly entangled quantum computations phys rev lett 91 147902 2003 f verstraete d porras and j i cirac dmrg and periodic boundary conditions a quantum information perspective phys rev lett 93 227205 2004 f verstraete and j i cirac renormalization algorithms for quantummany body systems in two and higher dimensions arxivcondmat0407066v1 2004 u schollwck the densitymatrix renormalization group rev mod phys 77 259 2005 v murg f verstraete and j i cirac efficient evaluation of partition functions of frustrated and inhomogeneous spin systems phys rev lett 95 057206 2005 d prezgarca f verstraete m m wolf j i cirac matrix product state representations quantum inf comput 7 401 2007 m levin and c p nave tensor renormalization group approach to twodimensional classical lattice models phys rev lett 99 120601 2007 g vidal entanglement renormalization phys rev lett 99 220405 2007 v giovannetti s montangero r fazio quantum mera channels phys rev lett 101 180503 2008 f verstraete ji cirac v murg matrix product states projected entangled pair states and variational renormalization group methods for quantum spin systems adv phys 57143 2008 r n c pfeifer g evenbly and g vidal entanglement renormalization scale invariance and quantum criticality phys rev a 79 040301 2009 zc gu and xg wen tensorentanglementfiltering renormalization approach and symmetryprotected topological order phys rev b 80 155131 2009 f pollmann a m turner e berg and m oshikawa entanglement spectrum of a topological phase in one dimension phys rev b 81 064439 2010 x chen zc gu and xg wen classification of gapped symmetric phases in onedimensional spin systems phys rev b 83 035107 2011 n schuch d prezgarca and j i cirac classifying quantum phases using matrix product states and projected entangled pair states phys rev b 84 165139 2011 y shimizu tensor renormalization group approach to a lattice boson model mod phys lett a 27 1250035 2012 r ors a practical introduction to tensor networks matrix product states and projected entangled pair states ann phys 349 117 2014 g evenbly and g vidal tensor network renormalization phys rev lett 115 180405 2015 g evenbly and g vidal tensor network renormalization yields the multiscale entanglement renormalization ansatz phys rev lett 115 200401 2015 sj ran c peng w li m lewenstein g su criticality in twodimensional quantum systems tensor network approach phys rev b 95 155114 2017 m bal m marin j haegeman f verstraete renormalization group flows of hamiltonians using tensor networks phys rev lett 118 250602 2017 h he y zheng b andrei bernevig n regnault entanglement entropy from tensor network states for stabilizer codes phys rev b 97 125102 2018 s singha roy h shekhar dhar a sen de u sen tensornetwork approach to compute genuine multisite entanglement in infinite quantum spin chains phys rev a 99 062305 2019 m c banuls k cichy ht hung yj kao cj d lin yp lin d tl tan phase structure and realtime dynamics of the massive thirring model in 11 dimensions using the tensornetwork method pos lattice2019 022 d kadoh y kuramashi y nakamura r sakai s takeda and y yoshimura tensor network analysis of critical coupling in two dimensional 4 theory jhep 05 2019 184 b vanhecke j haegeman k van acoleyen l vanderstraeten f verstraete a scaling hypothesis for matrix product states phys rev lett 123 250604 2019 j garrerubio symmetries in topological tensor network states classification construction and detection arxiv191208597 m c banuls m p heller k jansen j knaute v svensson from spin chains to realtime thermal field theory using tensor networks phys rev research 2 033301 2020 huike jin honghao tu yi zhou efficient tensor network representation for gutzwiller projected states of paired fermions phys rev b 101 165135 2020 c delcamp a tilloy computing the renormalization group flow of twodimensional 4 theory with tensor networks phys rev research 2 033278 2020 q mortier nschuch f verstraete j haegeman resolving fermi surfaces with tensor networks arxiv200811176 d poilblanc m mambrini f alet finitetemperature symmetric tensor network for spin12 heisenberg antiferromagnets on the square lattice scipost phys 10 019 2021 b vanhecke f verstraete k van acoleyen entanglement scaling for 24 arxiv210410564 f verstraete and j i cirac continuous matrix product states for quantum fields phys rev lett 104 190405 2010 j haegeman t j osborne h verschelde and f verstraete entanglement renormalization for quantum fields in real space phys rev lett 110 100402 2013 d jennings c brockt j haegeman t j osborne and f verstraete continuum tensor network field states path integral representations and spatial symmetries new j phys 17 063039 2015 a tilloy j i cirac continuous tensor network states for quantum fields phys rev x 9 021040 2019 j cotlera m r m mozaffar a mollabashi a naseh renormalization group circuits for weakly interacting continuum field theories fortschr phys 67 1900038 2019 q hu a francorubio g vidal continuous tensor network renormalization for quantum fields arxiv180905176 t d karanikolaou p emonts a tilloy gaussian continuous tensor network states for simple bosonic field theories phys rev research 3 023059 2021 arxiv200613143 ae b nielsen b herwerth j i cirac and g sierra field tensor network states phys rev b 103 155130 2021 b swingle entanglement renormalization and holography phys rev d 86 065007 2012 j i latorre and g sierra holographic codes arxiv150206618 f pastawski b yoshida d harlow and john preskill holographic quantum errorcorrecting codes toy models for the bulkboundary correspondence j high energy phys 2015 149 2015 j molinavilaplana information geometry of entanglement renormalization for free quantum fields j high energ phys 2015 2 2015 m miyaji t numasawa n shiba t takayanagi k watanabe cmera as surfacestate correspondence in adscft phys rev lett 115 171602 2015 p caputa n kundu m miyaji t takayanagi and k watanabe liouville action as pathintegral complexity from continuous tensor networks to adscft j high energy phys 2017 97 2017 r vasseur a c potter yz you a w w ludwig entanglement transitions from holographic random tensor networks phys rev b 100 134203 2019 a jahn j eisert holographic tensor network models and quantum error correction a topical review arxiv210202619 httpsgithubcommcamposinteractingtrg kg wilson group and critical phenomena i renormalization group and the kadanoff scaling picture phys rev b 4 3174 1971 r shankar renormalization group approach to interacting fermions rev mod phys 66 129 1994 m abramowitz i a stegun handbook of mathematical functions with formulas graphs and mathematical tables applied mathematics series 55 new york dover publications 1970 appendix a svd vs gaussian svd in this appendix we compare the standard svd with the gaussian svd employed throughout the paper as the basic mathematical tool to implement the gtrg the svd is equivalent to the schmidt decomposition of a quantum state we shall use this correspondence in what follows the fourier transform as a continuous svd let us start with eq11 e 2 x1 x2 1 2  eipx1 x2 2 p and define the state dx1 dx2 e 2 x1 x2 x1 i x2 i where xi is a orthonormal basis in the dirac sense that is hxx0 i x x0 eqa2 represents a pair of particles in a bound state that using a1 can be written as 1 2 i 2 d p e 2 p pi pi where the states pi  eipx xi satisfy hpp0 i p p0 eqa3 is the schmidt decomposition of the state a2 in the orthonormal basis pi eq a1 is a continuous svd that is 1 2 nothing but the fourier transform of e 2 p notice that the norm of a3 is hi 2 32 0 that reflects the translational invariance of the two body wave function e 2 x1 x2 svd of a normalized gaussian state let us next consider the function w x1 x2 e 2 x1 x2 bx1 x2 that has the same form as eq12 we define the state w i dx1 dx2 w x1 x2 x1 i x2 i that is normalized provided a b with the normalization factor 12 a2 b2 14 the state a2 corresponds to a b 1 that as explained above is normalized in the dirac sense to find the schmidt decomposition of a7 we use the identity63 exp 1 u2 1 u2 n0 2 n where hn x are the hermite polynomials that give the eigenfunctions of the hamiltonian of the harmonic oscillator h 2 x x n x hn xex 2  2 n using a9 one can write a8 as x y2 2uxy  u n xn y p1 u2 exp 21 u2 a10 comparing a6 and a10 we find ax12 1 u2 ax22 1 u2 bx1 x2 uxy 1 u2 a11 so that a12 let us write a6 using the variables x and y x y2 2uxy w x y exp 21 u2 u 1 where we took into account the jacobian of the transformation the state a7 becomes w i 1 u2 un ni ni a13 a14 where ni dx n xxi a15 equation a14 is the schmidt decomposition of w i in terms of the discrete schmidt coefficients wn 1 u2 un u 0 1 a16 talking the trace over the left or right hilbert space of the pure density matrix of a14 gives  trl w ihw 1 u2 u2n nihn a17 whose von neumann entropy is s1 log1 u2 that diverges in the limit u2 1 u2 log u2 1 u2 a18 gaussian svd of a normalized gaussian state let us consider again the state a7 and write a6 as w x1 x2 e 2 abx1 x2 2 x1 x2 using a1 with x12 a19 bx12 this equation reads w x1 x2 e 2 abx1 x2 d p ipx1 x2 1 p2 a20 that allow us to write a7 as w i d p e 2b p p a bi p a bi a21 where p a bi dx e 2 abx 2 ipx xi a22 these states are not orthogonal since hp a bp a bi 0 2  pp e 4ab a23 equation a21 looks like a continuous schmidt decomposition similar to a3 but it is not because the basis p a bi is not orthogonal when a b on the other hand we saw above that the schmidt decomposition of w i involves an infinite number of terms but is discrete see a14 the gaussian svd is an example of a look alike schmidt decomposition that is forced upon us by the condition of working with the exponent of the boltzmann weights or the effective action in quantum field theory appendix b loop matrices we will construct the matrices qn and cn that govern the gaussian kernel of the trg coarse graining integrals the leading gaussian terms do not couple the fields with a counterpart in the free model the set 66 with the new fields 67 introduced by interaction for the n 2 matrices this was made explicit in 63 based on it we will focus on the matrix blocks associated with the set 66 they are given by the same expressions that apply to the free network in order to simplify notation we refer to the free case in the following presentation in an appropriate basis and up to a propotionality constant the boltzmann weights of the free model are described by  12 x mn x an 0 bn bn mn 0 an bn bn the 2 2 block structure of mn corresponds to the choice x xl xr with xl x1 x2 and xr x4 x3 motivated by a subsequent splitting of wn along the axis 12 34 the factorization of the boltzmann weights is based on the svd of bn which rewrites this matrix as un dnunt in general un is a 2n n1 isometry we have n1 2n since some singular values in dn might be truncated because their number is larger than max or discarded because they vanish the matrices an and un have a further interesting structure1 an an an 12 dn1 an an 1 un vn un 2 un vn the matrix an is real symmetric and positive both an and dn1 have dimension n n the isometries un and vn have real entries and dimension n 12 n1 satisfying u n un vn vn 1 after splitting wn into two cubic weights according to the 2 2 block structure in b1 four cubic weights are sewed together in order to obtain wn1 the kernel of the coarse graining integral that eliminates the fields x in favour of the next level p is e 2 x qn xixcn p where we have ignored again a multiplicative constant the 4n 4n matrix q is readily built out of d1 n1 and an qn 14 d1  an it is convenient to decompose the matrix cn into two components such that cn p cnl pl cnr pr the 4n 2n1 matrices cnlr are constructed in terms of the isometries un and vn un vn 1 0 cr un vn un vn 1 u vn un vn cl n 2 0 0 un vn 0 0 0 0 0 0 un vn un vn the zeroes in the last row of cnl reflect that x4 does not couple to pl and correspondigly for the second row of zeroes in cnr generalizing 59 and 63 we obtain an1 t 1 12 d1 n cnl cnr qn cnl cnr bn1 cnl n cnr where from b1 we have used cnl n cnl cnr qn cnr cnl n cnr cnr qn cnl appendix c feynman rules we present the feynman rules for building the diagrammatic expansion of f1 37 f1 p dx e 2 x q0 x  f0 x iq1 0 c0 p in analogy with the wilsonian effective action reviewed in section 3 double lines are used to represent the fields integrated over x fast fields and single lines for the next level fields p slow fields the propagator of the fast fields is given by with i 1 4 the kinetic terms and spatial derivatives in the original lagrangian 1 render the matrix q0 nondiagonal as a consequence q1 0 propagates linear combinations involving all four xfields in the integral c1 on the contrary interaction in the initial lattice only couples fields living on the same link using a 4 theory as example the interaction vertex for the x fields is the interaction vertices between fast and slow fields are obtained by dressing some double lines of the vertex c3 with q1 0 c0 and analogously for all other possible replacements of double by single lines in order to avoid confusion we use the letters a b 1 8 to label the p fields of the level one tilted lattice due to the dressing q1 0 c0 interaction couples p fields from different lattice links the interaction vertex of the level one boltzmann weight w1 is the feynman rules for constructing fn with n 1 are more involved due to the doubling of the splitting fields explained in section 4b and the different roles of the fields in the sets 66 and 67 a sketch of the feynman rules necessary for working at first order in perturbation theory can be found in the readme document of the github link60 appendix d a bound on odd fields odd variables can contribute to lr mixing via the functions fn which contain the effect of interaction on the boltzmann weights wn these functions are given by hermitelike expressions with the associated differential operator fn obtained from an integral generalizing 61 fn x u the arguments of function fn1 live at the links intersected by the dotted circle the shifted fields pii1 and the derivatives ui the latter generate a dependence of fn on xi after evaluating the corresponding expression 60 we assume that wn will be subsequently factorized along the axis i 1 2l 3 4r a generic connected feynman diagram in the expansion of fn has the form the subgraph on the left combines diagrams from fn1 with i 1 2 and contributes ml powers of the coupling constant it has kl single line external legs which can carry any field x j but only uderivatives with indices i 1 2 the same applies to the subgraph on the right with i 3 4 mr and kr when ml or mr vanish all derivatives belong to the same l or r side a symmetric definition of the cubic weights emerging from wn namely vnl vnr as in 9 is compatible with assigning a diagram with mr or ml 0 to vnl or vnr respectively with this choice factorization is achieved by just introducing splitting fields for even variables hence odd fields only require their own set of splitting fields in diagrams satisfying ml mr 1 ml mr n with n the order at which we want the perturbative expansion to stop appendix e a bound on even fields without truncation the bond dimension in the free network doubles when progressing from the coarse graining level 2n to the level 2n 1 but remains the same from 2n 1 to 2n 2 namely 2n1 22n 2n2 2n1 the reason behind this behaviour is the vanishing of half of the b2n1 singular values1 which leads to discard automatically the associated splitting fields this property is lost once max is reached and actives the truncation preventing the bond dimension to further grow in the presence of interaction a field can only be discarded when its contribution to entanglement is small both at the level of the leading gaussian structure and the feynman graphs related to that in the section vc we raised the question about the fate of the fields inherited from the free network and related to vanishing singular values of b2n1 we will now prove that they do not participate in the lr factorization of graphs with ml or mr equal to zero in the notation of d2 since we are interested in odd coarse graining levels the corresponding lattice fields will be of type p analogously to d1 the differential operator f2n1 is schematically given by f2n1 p u for definiteness we consider a feynman graph in the expansion of f2n1 with mr 0 such diagram only traces back to the two cubic weights on the left side of the integrand its external legs carry the expressions the subindices 1 2 of the uderivatives refer to the tilted lattice links in e2 while the subindices 1 2 3 in the linear combinations of the p fields allude to the corresponding internal links contrary to the uderivatives these linear combinations involve fields from the l and r sides and are the only source of lr cross terms in e3 the leading gaussian structure does not mix the fields which have a counterpart in the free network the set 66 with the fields 67 required to keep the trg manipulations local therefore although both appear in the previous linear combinations we can treat them separately using this in the following we focus on the former and disregard the latter it is natural to assign the graph e3 to the cubic vertex v2n1l the dependence on pr should be thus eliminated as explained in section ivb it results in the substitution 2n c2n p q2n c2nl pl c2nr pr q2n c2nl c2nr pl ic2nr u2n1 x1 all the matrices here are given by the expressions in appendix b in particular c2nl and c2nr are constructed in terms the matrices u2n and v2n obtained from the svd of b2n relations e1 imply that in the absence of truncation b2n has maximal rank and thus u2n and v2n are orthogonal matrices instead of just isometries in that case we have c2nl c2nl  12n the 4 4 matrix in the rhs refers to the four internal links in the integrand of e2 it has rank three because c2nl does not couple the fields on the left external links with those on the fourth internal link let v be a singular vector of b2n1 with zero singular value multiplying b6 by c2nl we obtain 2n c2nr v 123 the rows of the matrix u2n1 on the rhs of e4 contain the singular vectors of b2n1 let y1 denote the component of x1 related to v the previous equality implies that y1 decouples from the contribution of the graph e3 to the cubic vertex v2n1l at first order in perturbation theory ml mr 1 and thus ml or mr must be zero we chose again to assign the associated feynman diagram to the l or r cubic weights respectively the splitting fields related to vanishing singular values of b2n1 can then be safely ignored therefore at first order in the fields 66 and their leading order gaussian structure coincides precisely with those of the free network let us finally consider a generic feynman diagram in the expansion of f2n1 its external legs can carry if this diagram contributes to v2n1l the following term will appear in some of its external legs q2n c2nr v4 y1 the zero singular value of v does not impose the vanishing of the combination in brackets hence although y1 is irrelevant for e3 it can be important to transmit the entanglement created by the general graph e7 in that case the field y1 should not be truncated analogous reasoning holds for y2 the component of x2 related to v when a general graph contributes to v21r the even combination y1 y2 will enlarge then the set of fields 66 beyond those present in the free model 