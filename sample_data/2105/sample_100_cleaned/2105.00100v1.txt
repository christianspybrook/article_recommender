datadriven fullwaveform inversion surrogateconditional generative adversarial networksmarcus saraivaac avelino forechib jorcy oliveira netoc antnio delreyc thomas rauberaarxiv210500100v1 cslg 30 apr 2021departamento informtica centro tecnolgicouniversidade federal esprito santovitria esprito santo brazilthomasrauberufesbrcoordenadoria engenharia mecnicainstituto federal esprito santoaracruz esprito santo brazilavelinoforechiifesedubrexplorao e produopetrleo brasileiro savitria esprito santo brazilmvsaraiva jorcyneto delreypetrobrascombrabstractin oil gas industry estimating subsurface velocity field essential step seismic processingreservoir characterization hydrocarbon volume calculationfullwaveform inversion fwi velocity modeling iterativeadvanced technique provides accurate detailedvelocity field model high computational costphysicsbased numerical simulations requiredfwi iteration study propose method generatingvelocity field models detailed obtained fwiconditional generative adversarial network cganmultiple inputs primary motivation approachcircumvent extremely high cost fullwaveform inversionvelocity modeling realworld data train testproposed network architecture evaluation metricspercent error structural similarity index measure visualanalysis adopted quality criteria based metricsresults evaluated test set suggest ganable accurately match real fwi generated outputs enablingextract input data main geological structureslateral velocity variations experimental results indicateproposed method deployed potential increasespeed geophysical reservoir characterization processessaving time computational resourcesindex termsconditional generative adversarial networkcgan fullwaveform inversion fwi seismic velocity modelingntroductionoil industry applications utilize seismic reflectionprimary indirect method investigating properties subsurface strata method uses controlled source acoustic waves receiver arrays geophones hydrophonesrecord transit time amplitude acoustic wavesreflected contrasting rock type interfaces fig 1seismic acquisition subsurface regionsampled multiple times different offsets resultingdata redundancy vertical projection regionsurface called common midpoint cmp sortingthank petrobras sa providing computational resourcesdata publicationfig 1 schematic representation marine seismic acquisitiondata cmp obtain socalled cmp gathersfig 2obtain image subsurface area necessary process recorded data transit time amplitudereflected acoustic waves estimation accuratevelocity model essential step seismic processingmodel steps seismic processing including seismic migration normal moveout nmo correctiontimetodepth conversionseismic migration procedure aims migrateseismic events correct position collapse reflectionsdiffractions creating seismic image subsurface 1nmo correction adjusts cmp seismic traces theoreticalzero offset source receiver position 2procedure enables use data redundancy increasesignaltonoise ratio cmpcorrected gather stackingfig 2 velocity model important timetodepthconversion necessary step reservoir characterizationoil volume estimation 3fig 2 schematic representation normal moveout correction b processstacking synthetic cmp gather normal moveout correctionimprove signaltonoise ratio adapted 4complex geological settings salt domes foldedfaulted regions require detailed velocity models orderform satisfactory seismic image currently velocity modeling fullwaveform inversion fwi advanced technique providing accurate detailed velocity model 5paper present method imagetoimagetranslator pix2pix 6 based conditional generativeadversarial network cgan translate input poststackseismic image average tomographic velocity twowaytime grid interval velocity model detailed fwiseismic data velocity modelprimary outcome 3d seismic processing seismic image volume seismic volume slices acquisitiondirection conventionally referred inlines slices perpendicular acquisition direction crosslines slicesperpendicular vertical axis time slices verticalsample vector seismic trace fig 3fig 3 3d representation seismic image main slicing directions inlineparallel seismic acquisition direction crossline perpendicular seismicacquisition direction time slice perpendicular vertical axis redline shows seismic trace vertical sample vectorseismic volume important inputs characterizing hydrocarbon reservoirs datas correlationlogs possible map main seismic horizonsdelimit hydrocarbon reservoirstypical workflow seismic velocity estimation consistssteps follows1 normal moveout nmo velocity estimation performed manually picking velocities best horizontalize hyperbola reflections cmp gathers fig 4process returns smooth average nmo velocity model approximated root meansquare velocity small offsets2 raybased grid tomography iterative techniqueseismic reflections travel time measurementsassociated amplitudes calculate seismic velocity 7seismic tomography delivers lowfrequency seismicacoustic velocity model typically 23 hzcommonly takes nmo velocity input3 fullwaveform inversion fwi seismic inversiontechnique initially proposed 8 9 prestack seismic data raw data seismic acquisitionoutput detailed interval velocity modelfwi takes initial lowresolution velocity model inputgenerate synthetic prestack seismic data wave equationnumerical modeling synthetic model comparedreal data seismic acquisition fwi iteratively updates velocity model order minimize differencereal synthetic data fig 5fwi performed prestack seismic dataorders magnitude greater traditional seismicvolume computationally expensive timeconsuming use technique industrially feasible recent years increase processingpower theory established 1980s 8fig 4 normal moveout velocity picking line passing red spotscentral image manually selected define velocity besthorizontalize reflections cmp gather adapted 10fig 5 fwi modeling real seismogram compared synthetic seismogram generated initial velocity model b real seismogram comparedsynthetic seismogram generated final velocity model 11building fwi velocity model requiremonths year construction depending seismic acquisition size geological subsurface complexitytheoretically fwi estimate highresolution velocitymodel initial input smooth velocity modelpractice support convergence reduce numberiterations conventional tomographic velocitymodel inputfwi velocity model fills gap lowfrequency tomographic velocity model seismic reflection image volume fig 6 increasing useful databandwidthb generative adversarial networks ganconvolutional neural networks cnn gettingpopular geophysical applications typicallyclassification segmentation tasks 12 13 14 1516 recent studies demonstratedfeasibility geophysical modeling cnns 17 1819cnn architectures generative adversarial networksgan traditional classification segmentationtasks gans stand ability learn mimicdata provided capturing statistical spatialdistributions 21gans generative models learn generalize ruletransform random noise vector z output image yg z y 21 pix2pix gan architecture proposed6 adopted paper conditional gan cganinput sum random noise vector zimage x rule translate inputimage y g x z yaccomplish task pix2pix uses networks competing network generates synthesized images generator network judgesimages valid discriminator generator g trainedproduce output images indistinguishableactual images discriminator d turn trainedimprove performance detecting generators fakeimagescgan generator output y connected directlydiscriminator input image xbackpropagation process discriminator classification realfake images provides signal generator updateweights bias improving performance objectivefunction cgan expressed 1lcgan g d exy log dx yexz log1 dx gx zgenerator g tries minimize objectivefunction adversarial discriminator d triesmaximize 2fig 6 simplified representation information gap tomographicvelocity model seismic reflection image volume fwi velocity model fillsgap adapted 20g arg min max lcgan g dprevious work 22 shows l1 regularization beneficial process helping generator g create sharperimages 3ll1 g exyzy gx zfinal objective function pix2pix conditionalgan work 4g arg min max lcgan g d ll1 gimage processing problems involve transformingimage problems addressedalgorithms specific situation conditional gansgeneral solution good performance varietyproblems 6 fig 7 shows generic examplespix2pix cganii m aterials m ethodsdatamarine seismic acquisition approximately680 km2 campos basin brazil seismicvolumespost stack seismic imageaverage tomographic velocitytwoway time twt gridfwi interval velocityloaded data originally segy format 3dmatrix python environment segyio library 23shape matrix 1451 3001 751x y samples spaced 125 m apart z samplesspaced 0004 spreprocessing involved limiting data variabilitystandard deviations eliminate outliers partially croppingregions reflections sea water thickness laterdata normalization global maximum minimumparameters 5xnormx xminxmax xmindivided data training test sets ratio70 30 respectively fig 8 training setrandomly sampled 2000 patches 512 512 test setrandomly sampled 800 patches 512 512 xdirection direction acquisitionpoststack seismic image average tomographic velocity twt grid combined form threechannelimage training pair composed imagefwi interval velocity fig 9b networkpix2pix conditional gan implementedpytorch unet 24 generator patchgan6 discriminator counterpartunet encoderdecoder architecture skip connections patchgan special type classifier networksubdividing image 70 70 patches classifyingreal fake fig 10 gan lossaverage loss patches strategy focuseshigh frequency image data lowfrequencycontent captured l1 lossc experimentsexperiments performed hp z8 workstation 24 gb memory quadro p6000 gpu beganexperiment seismic images associated fwivelocity training pair generator produced artificialhigh frequency structure images artifacts fig 11conclude seismic images provideinformation network convergeobtain better results added additional channelsaverage tomographic velocity twt grid resultingthreechannel input image fig 9tomographic interval velocity inaccurateprovided reliable average velocity average velocity interval velocity twt informationsupported network better estimating spatial positionsextracted patches randomly directrelation velocity overburden thicknessfig 7 examples pix2pix gan aerial photos maps edges photosday night gray scale color adapted 6fig 8 seismic volume showing spatial distributions training testsetspercent error common metric quality controlseismic processing defined 6pe1 x yi y 0100n i1ssim composite index 7 measuring similaritysignals based comparison mean8 variance 9 correlation coefficient 10ssimy y 0 f ly y 0 cy y 0 sy y 0ly y 02y y0 c12y 2y0 c1cy y 02y y0 c2y2 y20 c2yy0 c3y y0 c3sy y 0fig 9 channels combined input fwi velocity patches producingtraining pairassumption tomographic average velocitytwt grid function boundary conditionshelping network converge right interval velocitytraining time experiment approximatelyhoursgenerator discriminator trainedlearning rate lr 2 105 establishedempirically based visual quality training setresults stochastic gradient descent methodadam solver momentum parameters 1 052 0999 l1 multiplier set 100results evaluated based criteria visualanalysis percent error pe structural similarity indexmeasure ssim 25fig 10 schematic representation pix2pix network architecturec1 c2 c3 constants avoid divisionzero setting c3 c22 obtain ssim equation 11ssimy y 02y y0 c1 2yy0 c22y 2y0 c1 y2 y20 c2iii r esultspix2pix gan approach produced accurate velocitymodel channels poststack seismic image averagetomographic velocity twoway time input fig 12chosen metrics excellent results test setaverage percent error 15 average ssim0994 generated velocity visually identicalfwi velocity artifacts verifying geologicalstructures incorporated gan velocity modeldistributions close confirming metricresults fig 13criterion stop training set visual analysistraining set results later confirmed percenterror ssim results based test set metricsstabilized 60 80 epochs fig 14 fig 15fig 11 fwi velocity compared channel gan velocityfig 12 fwi velocity gan velocity percent error ssim map representative patches shallow intermediate deep regionsrespectivelyfig 13 fwi gan velocity distributions test setunexpectedly onechannel model experiment showedsatisfactory ssim pe results comparedthreechannel model visual analysis showedpoor resultsshallower regions presented better results deeper regions metrics fig 12iv d iscussionprevious works 26 demonstrated feasibilitycnns onedimensional 1d synthetic seismic inversion27 cnns perform seismic inversion synthetic prestack seismic data conditional unpaired cyclegans 28 employed perform forward inverseseismic modeling poststack seismic data velocitymodels synthetic data single inputchannel poststack seismic image achieved qualitatively moderate results gans generateprior models constrain solutions traditional fwialgorithm 29study apply conditional pix2pix gangenerate highly accurate velocity models real poststackseismic data multiple inputsneural networks understood perform better interpolation extrapolation tasks 30 31challenging cgan extrapolate lower frequenciespoststack seismic image inputeasier interpolate missing frequencies fig 6combine lower frequency data input caseaverage tomographic velocity twt grid explainsadding information helped improve resultsproviding twt grid average tomographic velocityenabled depth estimation sample usefulinformation estimating interval velocity increasesdepthordinary physicsbased fwi provides better results shallower regions acquisition cables sufficientlength capture diving waves 32 worse results3 channels input1 channel inputpercent errorv c onclusionsepochfig 14 percent error versus epochs test set10009940950992090ssimgans normally difficult train pronereduce output variability complete mode collapse 35different architectures variational autoencodersautoencoder perceptual loss need tested orderavoid problems0990098808509860800753 channels input1 channel input070epochfig 15 ssim versus epochs test setdeeper regions expected pix2pix gan capturedinaccuracy produced worse results deeper regionsfig 12l1 regularization loss acts global metric minimizing average loss pixels ganloss provided patchgan discriminator focuseshighfrequency structures suspect reasonexperiment channel presented good pe ssimvalues generator produced velocity fieldhonors low frequency associated average velocity goodpe high frequency variations good ssimproducing poorly accurate visual results result revealsdifficulty finding reliable metrics evaluating gansmajor threat method usage poorqualitytraining data despite robustness fwi velocity modeling examples fwi converge acceptablevelocity model seismic acquisition limitationslow signaltonoise ratio common 34 datatrain model pix2pix cgan producepoorquality velocity modelpresented method based pix2pix conditionalgan multiple input surrogate fwivelocity modeling inputs poststack seismic imageaverage tomographic velocity twt grid vitalexperiment channel poststack seismic imagefaileddevelopment new network architectures focusedseismic data particularities consideringspatial dimensions generate improvement qualityresultstest data presented excellent results based pessim visual analysis main geological structureslateral velocity changes captured resulting velocitymodeltrain gan fast generationfwi interval velocity model surrogate real timeproposed method replace fwi modelingproviding initial velocity model need feweriterations converge traditional fwi similar strategyadopted 36fair comparison fwi cgan surrogate model consider implementation fwialgorithm parallel gpu hardwarepapers proposed gpu implementations fwi algorithm 37 38 39 2d synthetic datamainly gpu memory constraints present fwialgorithm processing gpu hardwareindustrially feasibleproposed method deployed potentialspeed geophysical reservoir characterization processes saving time reducing computational resource requirementsr eferences1 j gazdag p sguazzero migration seismic data proceedingsieee vol 72 10 pp 13021315 19842 o yilmaz seismic data analysis processing inversioninterpretation seismic data society exploration geophysicists01 2001 online available httpsdoiorg101190197815608015803 p schultz seismic velocity model interpretation assetsociety exploration geophysicists 19984 g liu s fomel l jin x chen stacking seismic datalocal correlation geophysics vol 74 20095 s kapoor d vigh h li d derharoutian waveform inversion detailed velocity model building 74th eage conferenceexhibition incorporating europec 2012 european associationgeoscientists engineers 2012 pp cp2936 p isola jy zhu t zhou efros imagetoimage translationconditional adversarial networks 20187 jones tutorial velocity estimation raybased tomographybreak vol 28 20108 p lailly seismic inverse problem sequence stack inversions conference inverse scatteringtheory applicationvol 11 siam 1983 p 2069 tarantola inversion seismic reflection data acousticapproximation geophysics vol 49 pp 12591266 198410 madagascar development team madagascar software version 14httpwwwahayorg 201211 j virieux asnaashari r brossier l mtivier ribodettiw zhou introduction waveform inversion encyclopediaexploration geophysics society exploration geophysicists 2017pp r1112 z geng y wang automated design convolutional neuralnetwork multiscale filters costefficient seismic data classification nature communications vol 11 202013 w xiong x ji y ma y wang n m albinhassan m n aliy luo seismic fault detection convolutional neural networkgeophysics vol 83 201814 y shi x wu s fomel saltseg automatic 3d salt segmentationdeep convolutional neural network interpretation vol 7 201915 x wu l liang y shi s fomel faultseg3d syntheticdata sets train endtoend convolutional neural network 3dseismic fault segmentation geophysics vol 84 201916 b guazzelli m roisenberg b rodrigues efficient 3dsemantic segmentation seismic images orthogonal planes 2dconvolutional neural networks 2020 international joint conferenceneural networks ijcnn pp 18 202017 y ren x xu s yang l nie y chen physicsbased neuralnetwork way perform seismic waveform inversion ieee accessvol 8 pp 112 266112 277 202018 b moseley markham t nissenmeyer solving waveequation physicsinformed deep learning arxiv computationalphysics 202019 r zhang y liu h sun physicsguided convolutional neuralnetwork phycnn datadriven seismic response modeling arxivvol abs190908118 201920 j f claerbout imaging earths interiorblackwell scientificpublications oxford 1985 vol 121 j goodfellow j pougetabadie m mirza b xu d wardefarleys ozair c courville y bengio generative adversarial netsnips 201422 d pathak p krhenbhl j donahue t darrell efros context encoders feature learning inpainting 2016 ieee conferencevision pattern recognition cvpr pp 25362544201623 equinor segyio documentation online available httpssegyioreadthedocsioenlatestindexhtml24 o ronneberger p fischer t brox unet convolutional networksbiomedical image segmentation arxiv vol abs150504597 201525 z wang c bovik h r sheikh s member e p simoncellis member image quality assessment error visibility structuralsimilarity ieee transactions image processing vol 13 pp 600612 200426 v puzyrev egorov pirogova c elders c otto seismicinversion deep neural networks feasibility analysis 81steage conference exhibition 2019 vol 2019 1 europeanassociation geoscientists engineers 2019 pp 1527 y wu y lin z zhou inversionnet accurate efficient seismicwaveform inversion convolutional neural networks seg technicalprogram expanded abstracts 201828 l mosser w kimman j dramsch s purves d l fuenteg ganssle rapid seismic domain transfer seismic velocity inversionmodeling deep generative neural networks arxiv volabs180508826 201829 l mosser o dubrule m j blunt stochastic seismicwaveform inversion generative adversarial networksgeological prior mathematical geosciences vol 52 1 pp 5379 jan 2020 online available httparxivorgabs180603720httplinkspringercom101007s1100401909832630 e barnard l wessels extrapolation interpolation neuralnetwork classifiers ieee control systems vol 12 pp 5053 199231 k xu j li m zhang s du k kawarabayashi s jegelkaneural networks extrapolate feedforward graph neuralnetworks arxiv vol abs200911848 202032 w zhou r brossier s operto j virieux waveforminversion diving reflected waves velocity model buildingimpedance inversion based scale separation geophysical journalinternational vol 202 pp 15351554 201533 borji pros cons gan evaluation measures comput visimage underst vol 179 pp 4165 201934 g yao d wu sx wang review reflectionwaveforminversion petroleum science vol 17 2 pp 334351 202035 t salimans goodfellow w zaremba v cheung radfordx chen improved techniques training gans arxiv preprintarxiv160603498 201636 w senior r evans j jumper j kirkpatrick l sifre t greenc qin dek w nelson bridgland et al improved proteinstructure prediction potentials deep learning nature vol577 7792 pp 706710 202037 b li wang j gao h zhang w zhao cudabased accelerationwaveform inversion gpu seg technical program expandedabstracts 201138 j mao r shan wu b wang multiscale waveform inversiongpu seg technical program expanded abstracts 201239 j fang h chen h zhou y rao p sun j zhang elasticfullwaveform inversion based gpu accelerated temporal fourthorderfinitedifference approximation comput geosci vol 135 p 1043812020