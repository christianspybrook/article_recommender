long runs imply big separators vectoraddition systemswojciech czerwiskiuniversity warsawadam jdrychuniversity warsawarxiv210500052v1 csfl 30 apr 2021abstractdespite recent progress settled complexity reachability problem vectoraddition systems states vasses ackermanncomplete lack lot understandingproblem striking example reachability problem threedimensional vasses3vasses known pspacehard known elementary possibleapproach turned successful vass subclasses prove checkreachability suffices inspect runs bounded length approachlimitations usually hard design algorithm substantially faster possible sizefinite reachability sets vass subclass 2010 leroux proven nonreachabilityconfigurations implies separability source target semilinear setinductive invariant reasonable hope suffices look separatorsbounded size deliver efficient algorithm vass reachability papervasses fulfilling certain conditions existence long runsconfigurations implies existence big separators configurationsslightly modified vass additionally prove known examples hard vasses fulfilmentioned conditions improving complexity reachability problemsubclass separators approach meet obstacles2012 acm subject classification theory computation parallel computing modelskeywords phrases vector addition systems reachability problem separators semilinear setsdigital object identifier 104230lipicscvit201623funding wojciech czerwiski supported erc grant infsys agreement 950398introductioncomplexity reachability problem vector addition systems vaseschallenging natural problem decades research resultcomplexity expspacehardness lipton 1976 15 decidability shown mayr1981 16 later construction mayr simplified presented bitdifferent light kosaraju 9 lambert 10 currently knownklm decomposition main inventors complexity upper boundobtained leroux schmitz recent 2016 13 reachability problemshown solvable cubicackermann time years later authorsshown problem solved ackermann time actually primitive recursivetime dimension fixed 14 time lower bound towerhardnessestablished reachability problem 4 year recently independentpapers shown ackermannhardness reachability problem 12 6 settlingcomplexity problem ackermanncompletedespite recent huge progress lack lot understandingreachability problem vasses striking example problem dimensionbest known lower bound reachability problem 3vasses pspace wojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 2312316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanyhardness inherited hardness result 2vasses 1 best known upperbound bigger tower concretely speaking problem solved timef7 14 f hierarchy fastgrowing complexity classes 18 recalltower f3 similarly low dimensional vasses situation unclear currentlysmallest dimension d expspacehardness published dvassesd 14 4 d 3 13 problem pspace knownelementary dimensions expect expspacehardnessconjecture 3vasses 4vasses reachability problem actually elementarychallenge algorithm complexity gap witness lackunderstanding structure vasses hope future abledesign efficient algorithms reachability problem vasses high dimensionscondition belong subclass example avoid hardpatterns important practical point view understandingclasses efficient pspace algorithms possible future goalthink quest better understanding reachability problemvalid complexity reachability problem general vasses settledcommon successful approach reachability problems provingshort run property showing order decide reachability suffices inspectruns bounded length technique exploited lot area vassesrackoff proved expspace upper bound complexity coverability problem 17approach shown exist covering run existcovering run doublyexponential length recently lot researchlow dimensional vasses technique bounded run length1 authors established complexity reachability problem 2vassespspacecompleteness proving order decide reachability suffices inspectruns exponential length similarly paper line research 7shown 2vasses unary transition representation suffices consider runspolynomial length proves nlcompleteness reachability problemapproach meets subtle obstacle tries prove upper boundcomplexity reachability problem dvasses order boundedlength property natural try unpump long runs way unpumpingtricky run close axes small modificationrun cause counters negative common approach problemmodify run counters high local run modificationscause problem approach example 2vasses 1 klmdecomposition 9 10 16 runs configuration countervalues high convenient cycle increases counterssimultaneously observe existence cycle implies set reachableconfigurations infinite approach hard case reachabilityset finite finite set turn hard design algorithm substantially fastersize reachability set known dvasses finite reachability setslarge fd1 n n vass size f hierarchy fastgrowing functions 18 designing algorithm breaking fd1 n timereachability problem dvasses exist need approach breakingbarrier size finite reachability set possible general probably usuallychallenging best knowledge nontrivial algorithm breaking7 sophisticated analysis possible behaviours runs 2vassesmotivates search techniques suitable designing fastwojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 2322316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanyalgorithmsleroux work 11 provided algorithm reachability problem followscompletely different direction shown run configurations nd configuration t nd vas v exist semilinear set s calledseparator 1 contains s 2 contain t 3 inductive invariantv s v t s transition t v v t nd noticeexistence separator clearly implies nonreachability s t lerouxswork nonreachability existence separator equivalent following simplealgorithm decides t reachable s run semiprocedures lookspossible runs s t longer longer looks possible separatorss t bigger bigger clearly exist run exist separatorpoint algorithm terminate perspective viewruns separators dual objects bounding length run nontrivial maybebounding size separator promising approach notice providingexample fd n upper bound size separators provide algorithmsolving reachability problem working time fd ncontribution main contribution theorems stating vasses fulfillingcertain conditions long runs configurationssmall modification vass big separatorsconfigurations designed theorem 4 relatively simple statementsufficiently strong applications theorem 9 needs sophisticated notionsadvanced tools proven potentially broader spectrum applicationsadditionally shown nontrivial constructions hard vasses4vass 5 vass towerhardness construction 4 fulfilconditions proposed theorem 4 indicates vass subclass fexample 3vasses 1 order prove better upper complexity boundreachability problem f focus proving short run property smallseparator property 2 possibility finding vass f long shortestruns smaller separators case mentioned vassconstructed use different techniques currently known needsviolate conditions theorems 4 9considered vasses occurring recent papers proving ackermannhardness 12 6 techniques promisingrespect vasses occurring 6organisation paper section 2 introduce necessary notions recall standardfacts section 3 state prove main results theorems 4 9section 4 provide applications theorem 4 section 41 4vass described5 section 42 vasses occurring paper 4 proving towerhardnessreachability problempreliminariesbasic notions denote n set nonnegative integers n set positiveintegers b n b denote set 1 b 1 b set swrite s denote size number elements sets b defineb b b ab b b b contextwojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 2332316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanysimplify notation write x instead singleton set x example x ny denotesset x ny description size irreducible fraction pq maxp qr q description size description size irreducible formddimensional vector x x1 xd rd index 1 d write xixi s 1 d write projs x denote sdimensional vector obtainedx removing coordinates outside s norm vector x ndnormx maxi1d xi 1 d elementary vector ei unique vectorei j 0 j ei 1 0d nd denote ddimensional vectorcoordinates zerovector addition systems ddimensional vector addition states shortlydvass vass consists finite set states q finite set transitionst q zd q configuration dvass v q t pair q v q ndwrite qv instead q v configuration c qv write statec q setvectors s nd state q q write qs qv v s transition t p u qfired configuration r v qnd p r uv nd write pv quvtriple pu t qu v called anchored transition run sequence anchoredtransitions c1 t1 c2 cn tn cn1 run run configurationc1 configuration cn1 traverses configurations ci 2 nstatec1 statecn1 run configuration c configurationc c reachable c c reaches c write c cwrite cc configuration c source configuration c targetconfiguration c q nd denote postv c c c c setconfigurations reachable c prev c c c c setconfigurations reach c reachability problem vasses given vass vconfigurations s t asks s reaches t v vass v sizedenote total number bits needed represent states transitions vasssaid binary numbers transitions encoded binary effect transitionc t c q zd q vector t nd extend notion naturally anchoredtransitions runs effect run c1 t1 c2 cn tn cn1 equal t1 tnvector addition systems vases vasses stateignored known simple reachability problems vasesvasses polynomially interreducible work focus wlog reachabilityproblem vassessemilinear sets vectors b v1 vk nd set l b nv1 nvk calledlinear set vector b base l vectors p1 pk periods l setvectors semilinear finite union linear sets set vass configurationss q nd semilinear finite union sets form qi si q nd sisemilinear sets vectors size representation linear set sumnorms base periods size representation semilinear set lisum sizes representations sets li size semilinear set sizesmallest representationdvass v q t configurations s t q nd set s q ndconfigurations separator v s t fulfils following conditions 1 s s2 t s 3 s invariant transitions v c s c ct t c s work usually exploit condition 3use facts implied conditions 1 2 3wojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 2342316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanyposts s pret squasiorder runs order x wellquasi order wqoinfinite sequence x1 x2 elements x domination existj xi xjfix dvass v q t define useful order runs turnswqo weaker version originally introduced 8 configurationspu qv q nd write pu qv p q ui vi 1 danchored transitions c1 t c2 c1 t c2 write c1 t c2 c1 t c2 t tc1 c1 c2 c2 notice condition actually implied previousruns m1 mk m1 ml mi 1 k mi1 l anchored transitions write exists sequence indicesi1 i2 ik1 ik l j 1 k mj mij noticesetting ik l implies trg trg subsequent considerationsanalogously applied case i1 1 ik necessarily equal kenforces src src following claim folklore proof proposition19 3claim 1 order wqo runsorder nice property runs bigger fixed additivecertain sense following claim folklore proof lemma 23 2 arxivversion 3claim 2 let 1 2 runs vass v 1 2 trg1 trg 1trg2 trg 2 1 2 nd exist runtrg trg 1 2following corollary easily shown induction ncorollary 3 let runs vass v trg trg ndn n exists run n v trgn trg nnotions useful proof theorem 9separatorssection state prove main results simplerformulation proof sufficient applications section 4 aimsecond potentially general scope applications formulateassumptions bit canonical wayapplied theoremtheorem 4 let v dvass s t q nd configurations q q stateline n vectors nd1 1 2 0d2 nd2 run s t3 q postv s4 q n e2 prev tseparator v s t contains period r r qwojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 2352316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanyproof consider arbitrary separator s v s t let sq v qv s v nddevoted state q let sq ii li li linear sets linecontains infinitely points sq linear sets li containinfinitely points denote li l let l b np1 npk knowarbitrarily big n n b n1 p1 nk pk ni n wlogassume ni 0 write periods pi coefficient ni 0 noticecoordinate j 3 d nj norma pipi j 0 j 3 d ni norma let p0 set periods pipi j 0 j 3 d p0 set periods pibni pi npi p0ni pipi p0sum v b pi p0 ni pi norm bounded b norma normbk norma maxpi p0 normpi independent n restrict equationcoordinates considered vectorsv1 v2 n1 2ni pi 1 pi 2pi p0aim showing pi equal r r q recallj 3 d j pi j 0 pi 1 pi 2 r 1 2following claimclaim 5 period p p0 1 p2 2 p1proof intuitive meaning 1 p2 2 p1p2write fractionhappen p2 0 assume contradictionp p0 1 p2 2 p1 let 1 p2 2 p1 0recall b n l n n b n 1 p l p p0period l1 p 1 p1 p2 0d2 1 p1 1 p2 0d21 p1 2 p1 0d2 p1 e2 n n e2b n 1 p b n n e2 means qb n 1 p prev tknow qb n 1 p qsq s separator s nonemptyintersects set prev t contradiction definition separatororder p r p p0 sufficient 1 p22 p1 assume contradiction p p0 1 p2 2 p1claim 5 know actually p p0 1 p2 2 p1p1 0 equivalently write p p0 21 p1 let fmaximal valuep p0 clearlyf2 f 11 knowv n2v n1wojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 2362316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanyv n positive linear combination vectors p p0 p p0p1 f holdsv2 n2 f v1 n1equivalentlyn2 f 1 f v1 v22 2 f 1 0f v1 v22 f 1contradiction assumption n arbitrarily big finishesproofremark 6 theorem 4 instead separator v s t consider separatorv s t v obtained v adding loop state q effectdecreasing second counter easy observe points 14theorem statement remain true substitution v v version theorem 4bit convenient applicationsgeneralised theoremstart introducing notions needed theorem 9 motivate needgeneralisation theorem 4 formulation theorem 4 simple sufficientapplications bit arbitrary vassratio counters x y fraction big description sizetheorem 4 applicable intuitively speaking aims proving separators bigbig description size fraction xy easily imaginerelated vass value x kept counters 2x1 3x2value y kept sum counters y1 y2 y3 case like1 3x2reason description size fraction y2xderive lower bounds1 y2 y3size separators motivates introduction linear functions defineddeal counters easily speak linesnatural theorem 4 reason forced use abstract languageorder prepared mentioned simple applicationsgreatest common divisors state fact greatest common divisorshelpful sequel gcda1 ak denote greatest common divisornumbers a1 akclaim 7 natural numbers a1 ak m s m 2 mdivisible gcda1 ak exist nonnegative coefficients b1 bk ns a1 b1 ak bkproof folklore easily proved induction k existcoefficients b1 bk z gcda1 ak i1 ai bi let solutionminimises sum ibi 0 bi solution actually binonnegative assume let bi 0 1 k s m 2 mbj 1 k bj m substituting bj bj ai bi bi aj obtainsolution smaller ibi 0 bi contradictionwojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 2372316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanylinear functions let linear function lin nd n form linx1 xdi1 ni xi coefficients ni n linear function reduced gcdn1 nd1 let assume lin reduced notice linear function reduced linearfunction multiplied natural number let m maxi1d ni support linearfunction supplin 1 d set coordinates coefficient ni nonzero letset vectors zerolin zd contain vectors nj ei ni ej j supplin clearlyv zerolin u nd u v nd linu v linufollowing claim tells set zerolin way spans set vectorsvalue lin case bigclaim 8 u v nd linu linv d m 3 sequencevectors u x0 x1 xk v nd 1 k xi xi1 zerolinproof prove claim induction d d 1 clearly u vlet assume claim holds d 1 aim prove d addingvector y zerolin xi1 order obtain xi xi1 y nd step clearlysequence steps u v plan apply sequencesteps u u u vi 1 d inductionassumption sequence steps u v existssubset coordinates 1 d x nd lini x denote ii ni xilinv d m 3 exists j 1 d lin1dj v d 1m 3 assumewlog j dlin1d1 v d 1m 3aim reach u u d vd m 2 clearly dui m apply step ni ed nd ei u increase value udpd1continue reach u i1 u d 1m possiblepd1i1 u d 1m implies d u mlin1d1 u d 1m 2 m maxi1d ni nd u d dm 3 d 1m 2 3nd vd dm 3 d1m 3 m 3 nd u dvd d1m 3 m 2pd1u dvd d1m 2 m m 2 m claim 7 u dvd i1 ni xixi n order obtain u u d vd 1 d 1apply 1 d 1 exactly xi number times step nd ei ni ed u noticecoordinates dth increase steps leadvectors nonnegative coordinates lini1d1 u lini1d1 v d 1m 3apply induction assumption starting u reach vsequence steps finishes proofmodification vass linear functions lin1 lin2 nd n vass vstate q define vass vlinv additional transitions aim able1 lin2lin1increase ratio lin2 decrease let lin1 x1 xd i1 ni1 xi letlin2 x1 xd i1 ni2 xi set states vlininherited v similarly1 lin2set transitions v additionally add v transitions form q v qloops state q q following form1 coordinate supplin2 add loop decreases coordinate2 coordinate supplin1 supplin2 add loops increasesdecreases coordinate3 v zerolin1 v zerolin2 add loop effect vwojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 2382316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanynotice condition 2 means freely modify vlincoordinates1 lin2outside supplin1 supplin2 ready state theoremtheorem 9 let lin1 lin2 nd n reduced linear functions disjoint supportslet v q t dvass q q state s t q nd configurationsr q rational number assume1 v nd s qv lin1 v r lin2 v2 u v nd qv t u lin1 v u r lin2 v u3 run states statet traverses configuration c statec q4 set proji v s qv t infinite supplin1 supplin2supplin2 run s t ei v vlin1 lin2separator v s tei contains period p proji p 0 lin1 p rlin2 pproof condition 4 theorem statement exists infinite sequencevectors vi nd proji vi pairwise different s qvi t let 1icorresponding runs s qvi 2i corresponding runs qvi t recallwellquasi order modified version denoted comparisonsources instead targets wellquasi order exist j1i 1j 2i 2j let vj vi nd clearly proji 0 proji vi proji vjlet vi corollary 3 n n run v s nanalogous reasoning targets changed sources shows n n runv n t n n s qa n t conditions1 2 theorem statement lin1 n r lin2 nn n consequence lin1 r lin2 notice lin1 lin2 0proji 0st ei v assume contradiction s t eicondition 3 know s qv t ei v nd observeconditions 1 2 hold reachability relation defined v added loopsstate q invalidate notice condition 2 setting u eilin1 v lin1 v ei r lin2 v ei r lin2 vequation follows fact lin1 ei 0 hand s qvcondition 1 lin1 v r lin2 v contradictioninequality st eiseparator v s t ei contains appropriate period pproof similar proof theorem 4 need dealtechnicalities consider separator s qq qsq v s t ei clearly sq jj ljlj linear sets needs contain vectors n n let lfinitely linear sets lj contains infinitely vectors n n nlet l b np1 npk p set periods p1 pk aim showingl contains period p proji p 0 lin1 p r lin2 plin1 p lin2 lin2 p lin1 r linlin2prove claim analogous claim 5 challengingprove purpose defined v intricately additional loopsproof use nontrivial claim 8claim 10 period p p lin1 lin2 p lin2 lin1 pproof similarly claim 5 intuitively mean p plin1lin1 plin2 lin2 p formally correct statement lin2 p 0wojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 2392316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanyassume contradiction period p lin1 lin2 plin2 lin1 p clearly l mp l m n aimshowing mp n ei v m n n leadcontradiction know n t n ei t eimp l mp n ei t eicontradiction definition separatorlet lin2 x1 xd i1 ni2 xi let m maximal coefficient lin2m maxi1d ni2 set m dm 3 lin1 n dm 3 lin1 p observelin1 mp lin1 n eilin1 mp lin1 v m lin1 p lin1 v dm 3 lin1 lin1 plin1 v n lin1 lin1 n eisupplin1 lin1 ei 0 let p p1 p2 ptrash 1 2 trashp1 1 positive supplin1 p2 2 positive supplin2ptrash trash positive outside supplin1 supplin2 notice thankstransitions v freely modify coordinates outside supplin1 supplin2assume wlog ptrash trash 0 claim 8 lin1reduced run v mp mp1 mp2 n1 mp2lin1 mp1 lin1 n1 dm 3 supplin1 m 3 claimlin2 mp2 lin2 n2 ei vtrash dm 3 supplin2 m 3vtrash positive supplin2 finalise argumentn1 mp2 n1 n2 ei vtrash n1 n2 ei n eirelation follows claim 8 fact lin2 reduced secondfollows existence transitions v arbitrarily decrease coordinatesupplin2recall lin1 lin2 p lin2 lin1 plin1 lin2 p lin2 lin1 p 1set m dm 3 lin1 n dm 3 lin1 plin2 mp2 lin2 n2 dm 3 lin1 lin2 p dm 3 lin2 lin1 p dm 3lin2 mp2 lin2 n2 ei dm 3 m m 2 m claim 7 existb1 bd n j1 nj2 bj lin2 mp2 lin2 n2 ei lin2 mp2lin2 n2 ei j1 bj ej dm 3 set vtrash j1 bj ej satisfying 4finishing proof claimexactly follow lines proof claim 5 let p set periodsp proji p p p p recall want existenceperiod p p fulfilling lin1 p lin2 lin2 p lin1 assumecontradiction period claim 10 period p psatisfies lin1 lin2 p lin2 lin1 p particular period p plin1 p 0 equivalently write p p holdslin2 plin2lin1 plin1wojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 23102316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanylet f maximal valuelin2 plin1 pp p clearlylin2lin1flin2 f lin1recall arbitrary big n n b np1 npkb n np1 npk let v blin1 v n lin2 v nni lin1 p lin2 ppi pknowlin2 v nlin1 v nv n positive linear combination periods p p p2 plin1 p lin2 p 0 p p linlin1 p flin2 v nlin2 f lin1 v nlin1equivalentlynlin2 f lin1 f lin1 v lin2 v5 lin2 f lin1 0f lin1 v lin2 vlin2 f lin1contradiction fact n arbitrarily big finishes proofremark time theorem 9 needed applicationsmotivation stating proving theorem prepare possible future applications explore limits approach proof theorem 9 needs useadditional techniques needed prove theorem 4 quasiorder runsconstruction modified vass auxiliary transitions believestatement theorem 9 robust looks natural theorem 4applicationssection theorem 4 obtain lower bounds separatorsize section 41 prove construction 5 obtain 4vassseparators doublyexponential size section 42 existvasses separators arbitrary high elementary size special shape existenceseparators arbitrary high elementary size easy consequence towerhardnessvass reachability problem provide theorem 13 concrete instance separatorbig contribution aim proving theorem 13 illustratetechniques easily applied existing vass examplesdoublyexponential separator 4vassaim section following theoremwojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 23112316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanytheorem 11 exists family binary 4vasses vn nn size on3configurations sn tn vn normsn normtn 1 sn reachtn smallest separator vn sn tn doublyexponential size wrt nrest section devoted proof theorem 11 constructionbased construction family binary 4vasses nn shortest rundoublyexponential length described section 5 5 proof followsnatural line big challenge boils performing small modification4vasses 5 order assure conditions theorem 4 checkingconditions satisfied sketch idea constructionmentioned family 4vasses extend explain prooftheorem 11 details refer 5 construction based followinglemma lemma 12 5lemma 12 n 1 n rational numbers1 f1 fn 1description size bounded 4nf fn 2 f2 2 f1 2bounded 42ndescription size f definedvasses constructed follows valuation counters x1 x2 x3 x4distinguished initial state initially 04 run accepting finishesdistinguished final state valuation 04 run consists n 2 phasesinitial phase n phases corresponding fractions fn fn1 f2 f1 respectivelyfinal phase run initial phase counter valuation equal n n 0 0nondeterministically guessed value n n accepting run phasecorresponding fraction fi results multiplying second counter x2 valuefi2 accepting run counter valuation phases correspondingfractions fn fi followingx1 x2 x3 x4 n n fn2 fi2 0 0particular n phases corresponding fractions second counter equaln fn2 f12 n fequality follows lemma 12 let qi state initial phasen phases corresponding fractions fn fi1 phase correspondingfraction fi case 0 important claim 15 5reachable configuration form qi x1 x2 x3 x4 satisfies x2 fn2 fi2 x1particular reachable configuration q0 x1 x2 x3 x4 x2 f x1f fn2 f12 let f ab final phase transition effect b 0 0applied loop easily order reach counter values 04final phase need state q0 values satisfying equality x2 f x1 similarlyconfiguration qn1 x1 x2 x3 x4 accepting run needs satisfy x2 fn2 x1let fi abii 1 n accepting run x1 needs divisible b2ndoublyexponential number wrt n forces accepting rundoublyexponentialwojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 23122316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanyslightly modify 4vasses order obtain 4vasses vn fulfil conditionstheorem 4 vass vn obtained adding end instructions1 decrease x2 1 2 loop decreases x2 arbitrary nonnegativenumber vn satisfies conditions theorem 4 arguefinishes proof theorem 11 let qin initial state vass qoutfinal state qlast state final phase applyingmentioned decreases x2 set sn qin 04 tn qout 04 let n i1 bi2 setn n fn2 0 0 n4 fix state q qn1 claim vass vnconfigurations sn tn state q vector satisfies conditions theorem 4condition 1 satisfied trivially n n fn2 0 0 order 2satisfied recall vn reaches q0 x1 x2 x3 x4 x2 ab x1 finalphase subtract loop vector b 0 0 change inequality finallysubtracting 1 x2 implies reachable configuration qout x1 x2 x3 x4 satisfiesx2 1 ab x1 true x1 x2 0 shows condition 2satisfied observe k n configuration qn kn kn 0 0 initialphase reachable sn configuration qn1 kn kn fn2 0 0 reachablesn multiply second counter fn2 proves condition 3 observestarting configuration qn1 kn kn fn2 0 0 reach valuation qlast 04decreases x2 adding e2 0 1 0 0 sidesqn1 kn kn fn2 1 0 0 qlast 0 1 0 0 tn k n optiondecreasing x2 times qlast qn1 kn kn fn2 l 0 0 tnk l 1 equivalent condition 4theorem 4 separator vn sn tn contains period2nr n4 r q let r x1 x2 0 0 n4 know x2 x1 abnnorder x2 n need b2n x1 implies x1 doublyexponentialrespect n size period r size separatordoublyexponential respect ntower size separatorssection following resulttheorem 13 exists family vasses vn nn size polynomial wrt nconfigurations sn tn vn normsn normtn 0 following truesn tn shortest run nfold exponentialsntn e elementary vector e separator vn sn tn enfold exponential sizerest section dedicated prove theorem 13 construction vasses vnbased constructions 4 follow exactly 4 order avoidtechnicalities simplify construction construction 4 pretty involveddecided sketch intuition constructed vasses useproperties detailed explanation main goal section provideintuition theorem 4 applicable case details constructionrefer original paper 4 essentially speaking theorem 4 applicable vassesconfigurations accepting run distinguishedkeeping specific ratio counter values bigger description size ratiobigger separator vasses 4 description size nfold exponentialimplies lower bound size separatorswojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 23132316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanycounter bbounded value upper bounded brun 4 counters assured bbounded values b followingway order guarantee counter x initially equal 0 bbounded introducecounter x initialised b invariant b keptrun construction 4 strongly relies fact having triplex y z b c bc simulate c2 zerotests bbounded counter zerotestcounter realised follows decrease y 2 enter loopseffect 1 1 1 counters z second effect 1 1 1counters easy bbounded counter maximal possibledecrease z loops equal 2b realisedloops 0 blet 3n number 3 followed n applications factorial functionexample 31 3 32 6 33 720 roughly speaking vass 4 consistssequence n gadgets accepting run compute triples form3i ki 3i ki nondeterministically guessed values ki n gadget bcomputes triple 3 k1 3 k1 easy way increasing counters 3 0 0fires nondeterministically guessed number k1 times loop effect equal 0 1 3sequence n 1 gadgets f ith inputing triple 3i ki 3i kioutputting triple 3i1 ki1 3i1 ki1 set countersimportant mention correct value output triple requires run valuesinput triple zero triple 3n kn 3i kn 4 simulate3n bounded counters counter automaton modify constructionorder obtain vasses vn fulfil conditions theorem 13 triples usedifferent counters presented vass dimension 3n original construction4 counters actually reused order decrease dimensionallow wasteful use counters change idea constructionfamily vasses vn defined follows distinguish initial state qin vnfinal state qout vn 1 n let qi state ith gadgetdescription state qi valuation counters equal3i ki 3i ki let denote counters xi yi zi qn reach counter valuesxn yn zn 3n kn 3n kn kn 0 state qn define state qdecdecrease values yn zn applying nonzero number zerotests3n bounded counters operation seen loop decreasing counters xn yn zn0 1 3n course subtracting 0 1 3n realised single transitionsmaller subgadget vass state qout decreaseloop counter xn counter yn define sn qin 0d tn qout 0dappropriate dimension d set vector e zero coordinates ynset claim vn configurations sn tn elementaryvector e satisfy conditions theorem 13 easy assuming remarksconstruction 4 accepting runs need traverse configurationqn 3n k 3n k k 1 implies accepting runs nfoldexponential length remains second point theorem 13 applytheorem 4 purposecounters xn yn zn important let assume wlog correspondcoordinates notation respectively let 0 1 3n 0d3 nd0 yn zn yn 1 zn 3n properties vn summarisedfollowing claim derived 4claim 14 sn qdec x y z 0d3 x 3n y 3n z y nwojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 23142316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanysn qdec 3n y 3n y 0d3aim showing vass vn configurations sn tn e vectorstate qdec fulfils conditions theorem 4 immediate condition 1satisfied second coordinates nonzero allow reorderingcoordinates theorem 4 loss generality order 2 relyclaim 14 tn e qout 0 1 0 0d3 sn tn e needsn qdec x y 0 0d3 tn e y 0 contradictionclaim 14 y 3n 0 claim 14 immediately derive condition 3condition 4 notice loop qdec effect 0 1 3n countersxn yn znqdec 0 kl k3n 0d3 qdec 0 l 0d2 qout 0 l1 0d2 qout 0 1 0d2 tn ek l 1 shows theorem 4 applied vnseparator vn sn tn e contains period form r r 3n 0 0d3 n r nnumber r 3n nfold exponential size separator vn sn tn enfold exponential finishes proof theorem 13acknowledgementsthank sawomir lasota micha pilipczuk inspiring discussionsreferencesmichael blondin alain finkel stefan gller christoph haase pierre mckenzie reachability twodimensional vector addition systems states pspacecomplete proceedingslics 2015 pages 3243 2015lorenzo clemente wojciech czerwinski slawomir lasota charles paperman separabilityreachability sets vector addition systems corr 2016lorenzo clemente wojciech czerwinski slawomir lasota charles paperman separabilityreachability sets vector addition systems proceedings stacs 2017 pages 24124142017wojciech czerwinski slawomir lasota ranko lazic jrme leroux filip mazowieckireachability problem petri nets elementary proceedings stoc 2019 pages2433 2019wojciech czerwinski slawomir lasota ranko lazic jrme leroux filip mazowieckireachability fixed dimension vector addition systems states proceedings concur2020 pages 4814821 2020wojciech czerwiski ukasz orlikowski reachability vector addition systemsackermanncomplete corr abs210413866 2021matthias englert ranko lazic patrick totzke reachability twodimensional unaryvector addition systems states nlcomplete proceedings lics 16 pages 4774842016petr jancar decidability temporal logic problem petri nets theor comput sci7417193 1990s rao kosaraju decidability reachability vector addition systems preliminary versionproceedings stoc 82 pages 267281 1982jeanluc lambert structure decide reachability petri nets theor comput sci99179104 1992jrme leroux general vector addition reachability problem presburgerinductive invariants proceedings lics 09 pages 413 2009wojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 23152316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germanyjrme leroux reachability problem petri nets primitive recursive corrabs210412695 2021jrme leroux sylvain schmitz demystifying reachability vector addition systemsproceedings lics 2015 pages 5667 2015jrme leroux sylvain schmitz reachability vector addition systems primitiverecursive fixed dimension proceedings lics 2019 pages 113 2019richard j lipton reachability problem requires exponential space technical reportyale university 1976ernst w mayr algorithm general petri net reachability problem proceedingsstoc81 pages 238246 1981charles rackoff covering boundedness problems vector addition systems theorcomput sci 6223231 1978sylvain schmitz complexity hierarchies elementary acm trans comput theory8131336 2016wojciech czerwiski adam jdrychlicensed creative commons license ccby 4042nd conference important topics cvit 2016editors john q open joan r access article 23 pp 23162316leibniz international proceedings informaticsschloss dagstuhl leibnizzentrum fr informatik dagstuhl publishing germany