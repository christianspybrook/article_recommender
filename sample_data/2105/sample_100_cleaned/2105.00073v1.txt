numerical approximations fractionalnonlocal mean field gamesarxiv210500073v1 mathap 30 apr 2021indranil chowdhury olav ersland espen r jakobsenabstract construct numerical approximations mean field gamesfractional nonlocal diffusions schemes based semilagrangian approximations underlying control problemsgames dual approximationsdistributions agents methods monotone stable consistentprove convergence subsequences degenerate equationsspace dimension ii nondegenerate equations arbitrary dimensionsresults convergence convergence classical solutions numericaltests implemented range different nonlocal diffusions supportanalytical findingscontents1 introduction2 assumptions preliminaries3 discretisation mfg4 convergence mfg5 sl scheme hjb equation6 dual sl scheme fpk equation7 proof convergence theorem 41 438 numerical examplesappendix proof proposition 34appendix b proof lemma 56 ii iiiappendix c proof lemma 69acknowledgementsreferences1 introductionarticle study numerical approximations mean field games mfgsfractional general nonlocal diffusions consider mean field game0 t rdut lu hx du f x mtmt l m divmdp hx du 00 t rdut x gx mt m0 m0rdlxx z x 1z1 dx z dz2020 mathematics subject classification 35q89 47g20 35q84 49l12 45k05 35k61 65m1291a16 65m22 35r11 35r06key words phrases mean field games jump diffusion anomalous diffusion nonlocal operatorsfractional pdes nonlocal pdes degenerate pdes semilagrangian scheme convergence compactnessfokkerplanck equations hamiltonjacobibellman equations duality methodschowdhury o ersland e r jakobsennonlocal diffusion operator possibly degenerate lvy measure assumption 0 adjoint l defined l l2 ll2 cc rdequation 1 backward time hamiltonjacobibellman hjb equation terminal data g second equation forward time fokkerplanckkolmogorov fpk equation initial data m0 h hamiltoniancoupled cost functions f g different typescouplings local couplings f g depend point values m iinonlocal smoothing couplings depend distributional properties inducedm integration convolution work nonlocal couplingsmathematical theory mfgs introduced lasrylions 49 caineshuangmalhame 44 describes limiting behavior n player stochastic differential games number players n tends 18 recent yearssignificant progress mfg systems local diffusion including modeling wellposedness numerical approximations long time behavior convergence nash equilibria control game theoretic questions5 27 18 13 39 43 references study mfgs nonlocaldiffusion recent results exist far stationary problems fractional laplacians studied 30 parabolic problems including 1 3337 refer 48 references development probabilisticmethodsdifference problem 1 standard mfg formulations lies typenoise driving underlying controlled stochastic differential equations sdes usuallygaussian noise considered 49 51 20 26 5 noise order case17 19 underlying sdes driven pure jump lvy processesleads nonlocal operators 2 mfg real world applicationsjump processes model observed noise better gaussian processes 9 50 3454 prototypical examples symmetric stable processes generatorsfractional laplace operators 4 2 economy finance observed noisesymmetric stable nonsymmetric tempered typical examplegz m zonedimensional cgmy process 34 dc g mdz z z1y e0 y 0 2 models covered results article assumptionsnonlocal operators cf 1 general allowing degenerate operatorsrestrictions tail lvy measuredevelopment numerical approximations mfg systemslocal operators finite difference schemes nondegenerate second order equationsdesigned analyzed achdou et al 1 2 3 4 7 8 6 gueant40 42 41 semilagrangian sl schemes mfg developedcarlinisilva order equations 23 possibly degenerate second orderequations 24 numerical schemes mfgs include recent machine learningmethods 28 29 52 high dimensional problems refer survey article 6recent developments numerical methods mfg know prior schemesnumerical analysis mfgs fractional nonlocal diffusionspaper focus sl schemes monotone stable connectedunderlying control problem easily handles degenerate arbitrarily directeddiffusions large time steps allowed sl schemes hjb equationsstudied time 38 16 14 35 results fpkequations 25 coupled mfg nonlocal problemsknow results 15 hjb equationscontributionsderivation construct fully discrete monotone numerical schemesmfg 1 dual sl schemes closely related underlying controlapproximation nonlocal mfgsformulation mfg case based following controlled sdedxt t dt dltt control lt pure jump lvy process cf 6 note ltdecomposed small large jumps small jumps infiniteintensity derive approximation steps1 approximate small jumps small jumps approximated brownian motion7 following 10 15 36 avoid infinitely jumpstimeinterval singular integrals gives better approximation comparedsimply neglecting terms2 sl scheme hjb discretise resulting sde step 1 time approximate noise random walks approximate compound poisson processesspirit 15 section 31 corresponding discrete time optimal controlproblem dynamic programming interpolation construct sl schemehjb equation section 323 approximate control define approximate optimal feedback controlsl scheme step 2 continuous optimal feedback control 23 24dp h dud ud regularization interpolated solutionapproxstep 2 section 334 dual sl scheme fpk control step 3 scheme step 2 definecontrolled approximate sde corresponding discrete fpk equationdensities solutions explicitly derive fpk equation weak formobtain final dual sl scheme taking test functions linear interpolation basisfunctions section 3418 24 section 3 specific form discretizationsnumerical approximations mfg systems nonlocal fractionaldiffusion sl approximations nonlocal fpk equations dual slschemes extensions nonlocal case schemes 23 24 25 clearderivation type schemes new schemes come formnonlinear coupled systems 27 need resolved numerically prove existencesolutions fixed point arguments proposition 34b analysis establish range properties scheme including monotonicity consistency stability discrete regularity convergence individual equationsconvergence mfg1 hjb approximation approximation hjb equation prove pointwise consistency uniform discrete l lipschitz semiconcavity boundsconvergence viscosity solution obtained half relaxed limit method2 fkp approximation prove consistency sense distributions preservation mass positivity l1 stability tightness equicontinuity timedimension d 1 prove uniform lp estimates p 1 convergenceobtained compactness stability arguments3 mfg approximation prove convergence subsequences viscosityvery weak solutions mfg cases degenerate equationsdimension d 1 ii nondegenerate equation rd assumptionsolutions hjb equation c 1 space convergence follows mfgsunique solutions convergence classical solutions follows certainregularity weak uniqueness conditions applying results setting37 obtain convergence classical solutions casenonlocal smoothing couplings hjb approximation analysed independently fkp approximation analysis fkp schemechowdhury o ersland e r jakobsenhand strongly depends boundedness regularity properties solutions hjb scheme compactness measure nondegenerate casehjb equation c 1 solutions stronger weak compactness lpp 1 needed degenerate case 23 ableprove compactness dimension d 1 priori estimates convergencep 1 new local mfgspaper study general lvy jump processes nonlocal operatorsmeans underlying stochastic processes momentsinitial distribution like stable processes 1longer work commonly wasserstein1 space p1 d1 fkp equationsinstead work space p d0 probability measures weak convergencemetrizised rubinsteinkantorovich metric d0 section 2 surprisinglyresult 31 proposition 61 allow prove tightness compactnessspace moment assumptions refer section 43 detaileddiscussion convergence results traditional p1 d1 topologymoments availablep d0 setting adapted local problems resultsmoment assumptions finally note results degenerate problems coverorder equations improve 23 sense general initial distributionsm0 allowed p lp p 1 instead p1 l 0c testing provide numerical simulations example 1 2use similar setup 24 comparing effects range different diffusionoperators fractional laplacians different powers cgmydiffusions degeneratediffusion spectrally onesided diffusion classical local diffusion casediffusion example 3 solve mfg long time horizonobserve turnpike property nonlocal setting finally example 4 studyconvergence schemeoutline paper section 2 list assumptions state knownresults mfg 1 individual hjb fkp equations section3 construct discrete schemes hjb fkp mfg equationsunderlying stochastic control problemgame convergence results givensection 4 extensions discussion section sections 5 6 analyzediscretisations hjb fkp equations respectively including establishingpriori estimates stability consistency results results proveconvergence results section 4 section 7 section 8 provide discussnumerical simulations nonlocal mfg systems finally appendices proofs technical results2 assumptions preliminariesstart notation c k mean constants changeline line euclidean norm rd type space denotedsubset q rd q 0 t rd bounded possibly vector valuedfunction q consider lp spaces lp q spaces cb q bounded continuousfunctions use notation k k0 alternative notation normscb l space cbm q subset cb q m bounded continuousderivatives q 0 t rd cblk q subset cb q l boundedcontinuous derivatives time k space p rd denote set probabilitymeasure rd kantorovichrubinstein distance d0 1 2 space p rddefinedd0 1 2supf xd1 2 xf lip11 rdapproximation nonlocal mfgslip11 rd f f lipschitz continuous kf k0 kdf k0 1 definelegendre transform l hlx q sup p q hx pprduse following assumptions equation 10 lvy condition positive radon measure satisfies1 z2 dz1 growth near singularity exists constants 0 2 c 0density z 1 satisfiesd z 1l0 continuity local boundedness function l rd rd rcontinuous x q k 0 exists cl k 0sup lx q cl kx rdl1 convexity growth function lx q convex q satisfieslimlx qx rdl2 lipschitz regularity exists constant ll 0 independent qlx q ly q ll x yl3 semiconcavity exists constant cl 0 independent qlx y q 2lx q lx y q cl y2f1 uniform bounds exists constants cf cg 0f x cf gx cgx rd p rdf2 lipschitz assumption exists constants lf lg 0f x 1 f y 2 lf x y d0 1 2gx 1 gy 2 lg x y d0 1 2f3 semiconcavity exists constants cf cg 0f x y 2f x f x y cfgx y 2gx gx y cgm initial condition assume m0 p rdm dimension d 1 m0 p r lp r p 1l1 legendre transform h l welldefined optimal q qdp hx p study convergence numerical schemes assume localuniform bounds derivatives hamiltonianh1 function dp h crd rd r 0 constantcr 0 x rd p br dp hx p crchowdhury o ersland e r jakobsenh2 function dp h c 1 rd rd r 0 exists constantcr 0 x rd p brdpp hx p dpx hx p crremark 21 impose conditions l h l appearsoptimal control problem basis semilagrangian approximation assumptions l1 l2 l3 immediately carry forwardcorresponding hamiltonian h definition legendre transformrequire assume h1h2 h contrary assumptionsfollow condition l general lagrangian l behaveslike r q variable large q r 1 growth corresponding hamiltonianh r1 p variable large p cf 32 proposition 21 growthderivatives h large p computed similarly correspondsimilar condition h1h2paper solutions hjb equation 1 interpretedviscosity sense refer 46 references general definition wellposedness results solutions fpk equation 1 considered weaksense defined followsdefinition 22 u cb01 0 t rd measure m c0 t p rdweak solution fpk equation 1 cc rd t 0 tx dmtxx dm0 xz tzlx dp hx du dx dmsxdsb u l 0 t w 1 rd p 1 function m c0 t p rdlp 0 t rd weak solution fpk equation 1 3 holdscc rd t 0 tremark 23 inequality 3 holding cc rd t 0 t equivalentt x dmt x0 x dm0 xt s x ls x dp hx du ds x dmsxdsholding cb12 0 t rd cf 31 lemma 61definition 24 pair u m viscosityvery weak solution mfg 1u viscosity solution hjb equation m weak solutionfpk equation definition 22proposition 25 fix c0 t p rd let 0 l2 f1 holdcomparison principle u viscosity subsolution v viscosity supersolution hjb equation 1 ut vt u vb exists unique bounded viscosity solution u cb 0 t rd hjbequation 1 t 0 t kutk0 cf t cgc l2 f2 hold viscosity solution u lipschitz continuous spacevariable t 0 t x y rdut x ut x y t ll lf lg yapproximation nonlocal mfgsaddition l3 f3 hold u semiconcave space variablet 0 t x y rdut x y ut x y 2ut x t cl cf cg y2proof results standard follows similar argument46 theorem 31 b follows perrons method c adapting comparison arguments 46 standard way omit details extraassumptions b c follows theorem 54 lemma 53proposition 26 assume 0 1 h1 mu c0 t cb1 rd exists weak solution m c0 t p rdfpk equation 1b d 1 u c0 t w 1 r u semiconcave m holds existsweak solution m c0 t p r lp 0 t r fpk equation 1kmtklp r ect km0 klp r constant c 0 t 0 tproof results follow convergence discrete scheme articleproof follows proof theorem 43 setting duh du proofb follows proof theorem 41 theorem 67 setting duh du notesemiconcavity u crucial lp bound theorem 67existence uniqueness results given 37 classical solutions mfgsnonlocal diffusions additional assumptions2 growth near singularity exists constants 1 2 c 0density z 1 satisfiesz 1f4 exists constants cf cg 0 kf mkcb2 cfmkcb3 cg m m p rdf5 f g satisfy monotonicity conditionsf x m1 f x m2 d m1 m2 x 0m1 m2 p rdg x m1 g x m2 d m1 m2 x 0m1 m2 p rdh3 hamiltonian h c 3 rd rd r 0 cr 0x rd p br nn0 3 d hx p crh4 r 0 cr 0 x y rd u r r prd h x u p h y u p cr p 1 x yh5 uniform convexity exists constant c 0dpph x p cidc idm probability measure m0 density denoted m0 m0 cb2theorem 27 assume 0 1 2 f2 f4 h3h4 mexists classical solution u m 1 u cb13 0 t rdm cb12 0 t rd c0 t p rdb addition f5 h5 hold classical solution uniquechowdhury o ersland e r jakobsenconsequence 37 theorem 25 theorem 26 refer 37general results particular assumptions 1 2 relaxedallow larger class nonlocal operators l nondegenerate caseindividual equations 1 uniqueness viscosityvery weak solutionsexistence classical solutions uniqueness hjb equations existence hjbfpk equations follows theorem 53 theorem 55 proposition 68 37prove uniqueness weak solutions fpk equationsproposition 28 uniqueness fpk equation assume 0 1 2dp hx dut cb02 0 t rd weak solutionfpk equation 1proof let m1 m2 weak solutions define m m1 m2cc rd 0 t terminal value problemt l d dp hx du 0rd 0x xrdunique classical solution cb12 0 rd essentially 37 theorem 55result follows proposition 58 k 2 observation prooftheorem 55 holds k 2 definition weak solutionremark 23z zt l d dp hx du dmtx dt 0x dm x0 t arbitrary follows m 0 p rd0 t uniqueness follows3 discretisation mfgdiscretise mfg 1 follow 15 derive semilagrangeapproximation hjb equation 1 approximation optimalcontrol original problem derive approximation fpk equation 1approximate duality approximation hjbequationderivation based following control interpretation hjb equationfixed given density m solution u hjb equation 1 valuefunction optimal stochastic control problemut x inf j x tt admissible control j total cost minimizedz tj x t elxs s f xs s ds gxt txsxsxtsolves controlled stochastic differential equation sdedxs s ds z1 z dz ds z1 zn dz ds s txt xn poisson random measure intensitylvy measure dzdsn dz ds dzds compensated poisson measure131 approximation underlying controlled sde1the n integral difficult way writing compound poisson jumpprocessintegral centered jump process infinite number small jumps time intervalapproximation nonlocal mfgsapproximate small jumps brownian motion approximate small jumps6 vanishing brownian motion2 cf 10 r 0 1 let xs xsxt solvedxs bs ds r dws zr zn dz ds s txt xws standard brownian motion bs s brbrz dzrz1zz dz2 zrintegral 7 compound poisson process cf 9 t 0z tzzn dz dtnumber jumps time t nt poissontr jumps jj j iidrvs rd distribution r j0 0 r 0 1r 1zrr dzinfinitesimal generators l l sdes 6 7 cf 9l x t l1 x l1 xl x bt x tr rt d2 x r lr xcb2 rdlx lr x lr xx z x 1z1 dx z dzoperator l approximation llemma 31 47 1 holds cb3 rd lr r defined 129 respectivelylr x tr rt d2 x r cr3 kd3 k0addition cb4 rd lvy measure symmetriclr x tr rt d2 x r cr4 kd4 k0b time discretization approximate sde fix time step h n0 1n n discrete times tk kh k 0 1 n following 15 proposefollowing eulermaruyama discretization sde 7 let xntl x xttnl xxn xntl x solvesxl xxn xn1 hbn1 hrm n1n l ni 1 l ni1 1lni1lni1 1avoid singular integrals infinite number jumps time intervalchowdhury o ersland e r jakobsencontrol n constant time interval rm mthcolumn rn n1 nd random walk rdp ni 1processes jk nk defines approximation compound poisson 7equation 10 nt replaced approximationt maxk t1 t2 tk texponentially distributed waiting times time jumps replacedapproximations tk kn 3 tk hnk hnk nk1 nk n 0n0 0 nk iid approximate hr exponential distribution givenpnk j ehr jj 0 1 2pj p nk j p0 0pj p nk j 1 ppnk jejhr ehr 1 j 0 j0 pj 1 enk j0 ejhrehrehr 1note time interval approximation 13 diffuses secondequation jumps equation ignored unlikely eventjump time interval scheme convergeneed send h 0 hr 0 case enk jumpsfrequent random walk dominates evolution xkexpected32 semilagrangian approximation hjb equationcontrol approximation hjb equation approximate control problem4 6 discrete time control problem define value functionh tl x inf jh x tl ncontrols n piecewise constant time cost function jh givennxjh x tl n elxn n f xn tn h gxn tncontrolled discrete time process xn xntl x solution 13discrete time dynamic programming principle followslptl xh tl x inf elxntl x n f xntl x tn h h tlp1 xlp1l p 1 n taking p 0 computing expectation conditionalprobabilities probability jump time interval p1 1 ehrdiscrete time hjb equationh ehr xh tl x inf hf x tl hlxh tl h x hb hdrm2d m1iff1 ehrh tl h x hb hdrmh tl h x zdz3in new model gives number jumps time tapproximation nonlocal mfgsb interpolation fully discrete scheme 0 fix grid g zdlinearmultilinear g interpolation functions f g rxf xi xx rdizdj s piecewise linearmultilinear basis functions satisfyingj 0 j xi jij x 1 ki k0 kd2 k0 2cb2 rd fully discrete scheme obtained 16 followsik shr k1 k k ngxi tnshr v k infhf xi tk hlxi1 ehrivxi zdzehr xivxi hb hdr ivxi hb hdr2d m1finally extend solution discrete scheme ik rd 0 tlinear interpolation x piecewise constant interpolation t20 h t x ht xx ht t x 0 t rdizd33 approximate optimal feedback controlhjb equation 1 satisfied value function 4 easily followsoptimal feedback controlt x dp hx dut xbased feedback law define approximate feedback control discretetime optimal control problem 1315 following way h 0 t xrd 0 tnum t x dp hx dh t xh given 20h t x h t xmollifier x 1d x 0 cc rd rd xdx 1 statestandard result mollificationlemma 32 u w 1 rd 0 u u u cb rdexists constant c 0 0ku uk0 kduk0kdp u k0 c kduk0 1p p nconstruction expect num approximation optimal feedbackcontrol approximate control problem value function 14 hsmall h close u34 dual sl discretization fpk equationchowdhury o ersland e r jakobsendual approximation fpk equation note xs xs0z0 solves6 t 0 x0 z0 rv distribution m0 fpk equationm lawxsmt l m divm 0m0 m0setting num equation approximation fpk equation 1choice approximate m density mk lawxkapproximate process xk xk0z0 solving 13 l 0 x0 z0derive fpk equation mk discretised form serveapproximation fpk equation 1 simplify consider dimension d 1definition mkexk1x dmk1 xcb rd k n 0 let ak event jump tk tk1ak nk1 nk 1 nk random jump time definedsection 31 b definition xk 13 fact nk jk kiid independent xk conditional expectationsx dmk1 x exk1exk1 ack p ack exk1 ak p akehr exk hbnum hr k 1 ehr exk jiehrx hbnum hr x hbnum hr mk dxz z1 ehrx zmk dxr zrlet ei xi 2 xi 2 mjk ej mk dx approximate expressionmidpoint quadrature approximation ej f xmk dx f xj mjkchoosing x j x linear interpolant j z j xi jifully discrete approximationmjk1mikh ehrj xi hbnum1 ehrhr j xi hbnumhrj xi zdzarbitrary dimension d denotehdrpjkp xj h hp xj dh tk xj brj zd k 0 n p 1 d redefining ei xi 2 1 1d reasoningd 1 following discrete fpk equationmik1mjk bhr hp dh j kzjzddm0 xmi0approximation nonlocal mfgsbhr hp dh j ker h xjkpjkp2d p11 er hxj zdzsolution probability distribution g hnh nh 0 nlemma 33 let mik bepthe solution 24 m0 p rd mik p zdmik 0 zd jzd mjk 1 k nhproof note mik 0 follows directlyp definition schememi0 0 changing order summation bhr hp dh j k 1mik1mjk bhr hp dh j kmjkresult follows iterationmj0 1extend mik rd piecewise constant interpolation x 0 tlinear interpolation t t tk tk1 k nhtk1 tt tkmh tk1 xmh tk xmh t xmh tk x 1d izd mik 1ei x note mh c0 t p rdduality linear xconstant t interpolation h 2035 discretisation coupled mfgdiscretisation mfg obtained coupling discretisationssetting mh choice u m mfollowing discretisation 1uik shr mh uk1 kuin gxi mh tnmik1 jzd mjk bhr hp duh j kmi0 ei dm0 xshr bhr uh mh definedindividual discretisations explicit forwardbackward naturecoupling total discretisation explicit yields nonlinearsolved method like fixed point iteration newton typemethodapproximation scheme 27 solutionproposition 34 existence discrete mfg assume 0 1 l1l2 f1f2 h1 m exist pair uh mh solving 27proof result nonconstructive given appendix4 convergence mfgsection main theoretical results paper convergenceresults h r 0 cflconditions proofs given section 7require results individual schemes given sections 5 6chowdhury o ersland e r jakobsen41 convergence viscosityvery weak solutions consider degeneratenondegenerate cases separately degenerate case convergence holdsdimension d 1theorem 41 degenerate case d 1 assume 0 1 l1l3 f1f3h1h2 m uh mh h0 solutions discrete mfg 27n hn n rn 0 cfl conditions2n hnhn rno1hn n precompact cb 0 t k compact set k rii mnn hn n sequentially precompact c0 t p r l1 weakp 1 m b l weak p miii u m limit point hn mnn hn n u m viscosityveryweak solution mfg 1note mh precompact c0 t p rd assuming minitial distribution degenerate case convergencemfg lower regularity solutions hjb equationlonger c 1 need assumption m stronger compactness giventheorem 41ii b result able d 1arbitrary dimensions assume regularity solutions hjb equation1u let um viscosity solution hjb equation 1 mc0 t p rd t 0 t umt c 1 rdremark 42 assumption u holds nondegenerate cases assumption2 theorem 27 discussionfollowing convergence result arbitrary dimensionstheorem 43 nondegenerate case assume 0 1 l1l3 f1f3 h1h2 u m uh mh h0 solutions discrete mfg 27n hn n rn 0 cfl conditions2n hnh n rno1hn n precompact cb 0 t k compact set k rdii mnn hn n precompact c0 t p rdiii u m limit point hn mnn hn n u m viscosityveryweak solution mfg 1results compactness approximations convergence subsequences precise ii convergent subsequencesiii corresponding limits solutions mfg 1immediately existence 1corollary 44 existence solutions 1 assumptions theorem41 43 exists viscosityvery weak solution u m mfg 1addition uniqueness mfg 1 convergence sequence approximationscorollary 45 assumption theorem 41 theorem 43mfg 1 viscosityvery weak solution sequencehn mnn hn n converges limit u m unique viscosityvery weaksolution mfg 142 convergence classical solutions case individual equationsregularising convergence classical solutions mfgprecise needapproximation nonlocal mfgs1 weak uniqueness individual pdes hjb equation unique viscosity solutions fpk equation unique weak solutions2 smoothness individual pdes equations classical solutionsmeans viscosityvery weak solutions mfg automaticallyuniqueness individual equations classical solutions addition3 classical uniqueness mfg classical solutions mfguniqueconvergence approximate solutions solution mfgprecise result setting 37 theorem 27 section 2existence uniqueness classical solutions 1corollary 46 assume 02 l1l3 f1f4 h3h4 m letuh mh solutions discrete mfg 27 n hn n rn 0cfl conditions2n hnhn rno1hn mnn hn nconvergent subsequence space cbloc 0 t rdc0 t p r limit point classicalclassical solution 1b addition f5 h5 hold sequence convergesunique classicalclassical solution u m 1proof 1 assumption u holds theorem 27 theorem 43convergent subsequence hn mnn hn n hn mnn hn u mu m viscosityvery weak solution 12 m c0 t p rd viscosity solution u unique proposition 25b 37 theorem 53 coincides classical cb13 0 t rdsolution given 37 theorem 553 dp hx dut cb2 rd 2 h3 proposition 28weak solution fpk equation coincidesclassical cb12 0 t rd solution given 37 proposition 684 addition f5 h5 hold classical solution u mtheorem 27 b5 shows compactness smoothness uniqueness convergent subsequences hn mnn hn n limit sequenceconverges u m unique classical solution 143 extension discussionextension general lvy operators results theorem 41 43hold general assumptions lvy operator l 37 use0 assumptions1 rz d rzd rd c r 0 1rz1rz12 1 2 k 0 heat kernels k kl l satisfy k k k k 0 kkt kl1 rd 1kd kt klp rd kt 1 p dt 0 tp 1 multiindex nd 0heat kernel operator l defined fundamental solution heatequation t ulu 0 assumptions cover lots new cases compared 0 12 new cases include sums operators satisfying 1 subspaces spanningchowdhury o ersland e r jakobsenrd having possibly different orders ii general nonabsolutely continuous lvymeasures iii lvy measures supported positive cones example cf372 d 22 1 21 d 1 2x21x2ddzisatisfies 10 mini dzi1 zi 1i j6i 0 dzjsum onedimensional fractional laplacians different orders exampleiii givenr spectrally positive fractional laplacian space dimensionlu c 0 ux z ux dux z 1z1 z 1 dzfollowing generalization wellposedness result classical solutionsgiven theorem 27theorem 47 37 theorem 27 holds replace 1 2 10 20follows u holds theorem 47 holds 1 implies 10integrals 10 appear different proofs easy checkestimates paper true lvy measures satisfying 10 instead 1means assumption 10 20 following extensionstheorems 41 43 corollary 46theorem 48 theorem 41 holds replace 1 10theorem 49 theorem 43 holds replace 1 2 10 20corollary 410 corollary 46 holds replace 1 2 10 20wasserstein metric d1 versus metric d0 typical settingfpk equations mfg literature metric space p1 rd d11wasserstein space w1 probability measures finite momentcase 25 convergence results given sl schemes localnondegenerate mfgs rd paper assume finite momentswant cover general nonlocal operators example fractional laplacian2 1 underlying stable process finite momentsorder instead consider weaker metric space p rd d0metrization weak weak cb convergence probability measurestopology consider processes probability measures solutions fpkequations finite moments restrictions tail behaviourcorresponding lvy measurescourse additional assumptions convergence d0 implies convergence d1lemma 411 mn converges m p rd d0 mn m uniformlybounded 1 moments 0 mn m p1 rd d1convergence p1 rd 53 definition 68 definition equivalent weak convergence plus convergence moments result follows proposition11 lemma 15 5following version theorem 41 theorem 43corollary 412 assume m0 p1 r rd b1 z1 dz 0assumptions theorem 41 theorem 43 statements theorem 41theorem 43 hold replace p d0 p1 d1 iinote number moments m determined number moments1z1 m0 discussion section 23 37 1z1finite moments lu welldefined u order growthinfinity nonlocal case duality moments mapproximation nonlocal mfgsgrowth ofr u note um integrable naturaleuxt t ux tmdx t finitecase assume moments work bounded solutions umoments weak compactness lp degenerate case previousresults semilagrangian schemes order degenerate second ordercase 23 24 cover case m0 p1 r l r means m0 finite firstmoments results assume m0 p r lp r p 1 momentbounds possibly unbounded m0 p weak compactness l1instead weak compactness lresults degenerate case allows l 0 immediatelyextension p lp setting convergence results order problems23 conditions arguments results easily holds localdiffusive case considered 245 sl scheme hjb equationprove results numerical approximation hjb equation includingmonotonicity consistency different uniform priori stability regularity estimates halfrelaxed limit method 12 convergenceform vn hn n tn xn vt x v viscosity solution continuous hjb equation let bg set bounded functions defined gtheorem 51 assume 0 l1 h r 0 c0 t p rd let shrdenote scheme defined 18bounded control liprd shr k minimal controlk k depends kdx k0 growth l xii monotonicity v w bg v wshr v k shr w k g k 0 n 1iii commutation constant c r w bgshr w c k shr w k c g k 0 n 1assume 1 f2iv consistency let n hn rn 0 cfl conditions hnn hrn o1grid points tkn xin t x n c0 t p rd ncc rd 0 ttkn 1 xin sn hn rn n kn 1 knlimn hnt t x inf lx d lx f x tproofehr xixi hb hrm ixi hb hrm2d m1lipschitz maximum linear growth infinity lx coercivelinear growth infinity l1 exists ball br r dependslipschitz constant growth l minimizing controlshr k belongs brii iii follows directly definition schemechowdhury o ersland e r jakobseniv ease notation write h r instead n hn rn n 4th order taylorexpansion givesx hb hdrm x dx hb hdrmhd m t 2r d xrm d h 2 bt d2 xrm bt d2 xbx d xx dhb hd rmhb hd rmrd b rz1 zdz 1 rz1 zdzor1x hb hdrm x hb hdrm 2x2hdx 2hdx zdz hdrm t d2 x rm o h2 r22rz1h2 bt d2 xb3 332 1order oh2 r22 3rd order terms orweder oh rh r4th order terms order hdr 4 oh2 r42error taylor expansion oh2 r22 lemma 31xi shr kehr xxi inf hf xi tk1 hlxi2xi 2hdxi2d m1m t 2hdr d xi r 2hdxi zdzrz11 ehrxi zdz o2 oh2 r2229 hf xi tk1 inf hlxi hehr dxi 1 ehr xihehr lr xi or3 hehrdxi zdzrz1xi zdz o2 h2 r22zr z2 dz kr2 1 small jump operator lr defined12lr xi ehr lr xi hr r2 kd2 k0rz1 zdz kr1 z1 dz k long jump operatorlr defined 121 ehrxi z xi dzl xi edxi zdzrz11 ehr 1k1 ehr r1 kdk0 k 1kdk0 kk0k hr rkdk0 hr kk0recalling lxi lr xi lr xi combining 29 30 31xi shr k hf xi tk1 h inf lxi dxi hlxiapproximation nonlocal mfgso h2 r hr3 h2 r r1 2 h2 r22r crtk xi tk1 xitk1 xi sh k1 kt tk xi ltk1 xi f xi tk1 inf lxi dtk1 xio h hr r3 hr12result follows taking limit n2n hnhn rnhr22o1theorem 52 comparison assume 1 2 c0 t p rd 0 l1 letuh 1 uh 2 defined scheme 20 1 2 respectivelykuh 1 uh 2 k0 t kf 1 f 2 k0 1 t g 2 t k0hdrm noteproof let cm hbiuk1 1 x iuk1 2 xp xupk1 1 upk1 2pzd18 definition inf 0 rdehr x hiuk1 2 xi cm2d m11 ehr ziuk1 2 xi cmiuk1 2 xi zdzuik 2 hf xi 2 tk hlxi18 32 33uik 1 uik 2 h f xi 1 tk f xi 2 tk hlxi lxix ehr xp cupik1 1 upik1 2p m2d m1pzd1 ehrp z upik1 1 upik1 2 dzhkf 1 f 2 k0 c sup uik1 ik1p 11 ehr zehr x xp cm p cip zdz 12d m1uin 1 uin 2 1 tn g 2 tn k0 symmetry iterationargument showsuik 1 uik 2 n khkf 1 f 2 k0 1 tn g 2 tn k0result follows interpolation t n hsl scheme stable sense uniform h boundednesslipschitz continuity semiconcavity solutions uiklemma 53 let c0 t p rd uik defined scheme 18chowdhury o ersland e r jakobsenlipschitz continuity assume 0 l2 f2uik ujklf ll t tk lgxi xjj zd k 0 1 nb semiconcavity assume 0 l3 f3uijk 2uik uijkcf cl t tk cg j zd k 0 1 nxj 2c uniformly bounded assume 0 l0l2 f1 f2j zd k 0 1 nuik cf cl kt tk cgk defined theorem 51proof note m xj x mj xp xupjk1 upik1iuk1 xj x iuk1 xi xpzdl2 f2 similar computations theorem 52ujk uik hlf ll xi xj sup uik1 ujk1uin 1 ujn 1 gxi mtn 1 gxj mtn 1 lg xi xj f2result follows iterationb similar 34iuk1 xij x 2iuk1 xi x iuk1 xij xp xi xupjk1 2upk1 upjk1pzdl3 f3 similar computations theorem 52uijk 2uik uijk cl cf hxj 2 supuijk1 2uik1 uijk1uijn 2uin uijn cg xj f3 result follows iterationc theorem 51 k direct calculation showssup hf l sup ujk1 uik sup hf l sup ujk1result follows l1 f1theorem 54 convergence hjb scheme assume 0 1 f1 f2 l2n hn rn 0 cfl conditions hnn hrn o1 n c0 t p rdhn n solution scheme 18 defined 20continuous bounded function u hn n u locally uniformly rd0 t u viscosity solution hjb equation 1 mproof result follows barlesperthamesouganidis relaxed limit method12 monotonicity consistency l stability properties scheme cftheorem 51 ii iii lemma 53 c strong comparison principlehjb equation proposition 25 refer proof 23 theorem 33standard detailed proof similar caserecall continuous extensions uh t x uh t x defined20 22 respectively results lemma 53 transfers uh t xlemma 55 let c0 t p rd uh given 22approximation nonlocal mfgslipschitz continuity assume 0 l2 f2uh t x uh t y ll lf t lg x yb approximate semiconcavity assume 0 l2l3 f2 f3exist constant c1 0 independent huh t x y 2uh t x uh t x y c1 y2 2hduh t y duh t x y xi c1 x y 2c assume d 1 0 l3 f3 exists constant c2 0independent h j zd k nhhduh tk xj duh tk xi xj xi c2 xj xi 2proof uik satisfies discrete lipschitz bound lemma 53 uhlipschitz lipschitz constant uik properties linear interpolationuh lipschitz constant uh properties mollifiers lemmab j zd lemma 53 b uij uij 2ui cxj 2 multiplyingsides x summing zduh x xj uh x xj 2uh x cxj 2letting x x z multiplying positive mollifier z integratinguh x xj uh x xj 2uh x cxj 2multiply sides j y sum zdiuh x y iuh x y 2iuh x ci 2 y cy2 2lemma 32 iuh uh kkd2 uh k0 2 klipschitz bound k depends constants l2 f2uh x y uh x y 2uh x cy2 2second b follows 3 remark 6c proof given 23 lemma 36assumptions continuous hjb equation viscosity solution utw 1 rd derivative exists 37 theorem 43following result duhtheorem 56 assume 0 1 l1l2 f1f2 n hn rn n 0cfl conditions hnn hrn o1 n c0 t p rd let unn hn ndefined 22 u viscosity solution hjb equation 1 munn hn n u locally uniformlyii assume l3 f3 nn o1 dunn hn n t x dut xdut x exists convergenceiii assume l3 f3 nn o1 u dunn hn n dulocally uniformlyproof follows convergence result theorem 54 lemma 32ii iii refer 23 theorem 35 25 proposition 51 estimateslemma 55 needed completeness proof appendix bchowdhury o ersland e r jakobsen6 dual sl scheme fpk equationsection establish properties discrete fpk equation 24 including tightness equicontinuity time l1 stability solutions respectlp bounds dimension d 1 prove tightness use result 31proposition 61 assume 0 m exists function 0 c 2 rdkdk0 kd2 k0 lim xx z z dzsupxrdx m0 dxproof use 31 lemma 49 familymeasures 1 m0 1 defined11 function x v0 1 x2 v0 0 0nondecreasing subadditive function kv00 k0 kv000 k0 lim v0 xx dx1 m0immediately result 35 estimate followssubadditivity 1 integrability v0 31 lemma 413 iizdz 1 rd x2 m0 dx 1 2 0remark 62 dp dzz log 1 z2 possible explicit choice function propositionb c 2 rd 35 equivalent klk0 31 lemma413 iilemma 63 assume p rrd exists function 0 crdlimx x sup rd x dx c tightresult classical proved similar way chebychev inequalitytheorem 64 tightness assume 0 1 l1l2 f2 h1 m cflcondition h hr12 o1 c0 t p rd mh defined 26proposition 61 exists c 0 independent hx dmh t ct 0 tproof essentially start multiplying scheme 24 integratingspace definition mh mh 26 241 xxdmh tk1 dmik1xdxx 1 zxdxmjk bhr hp duh j kdefinition bhr 25 interchanging order summation integrationd x zx mjk er h xxxd mh tk1jkp jkp dx2d p1 d eijzdr h zxi xj zdx dzapproximation nonlocal mfgsc 2 rd propertiesmidpoint approximationlinearmultilinearinterpolation 1d ei xdx xi x izd xxi o2r h xmjkxd mh tk1jkp jkpjzdr h zxj z dz o2estimate terms right hand letjkp xj ahjhrph kfundamental theorem calculusxjhj xj ahj 2xj ahj ahj dxj e1hj ahj 2h dp h xj duh tk xj brz 1he1hj dxj tahj dxj ahj dxj tahj dxj dtlemma 55 h1 kdp h duh k0 cr r lllf t lg 1p 2e1 kd2 k0hj ahj 4kd k0 h cr br hrestimate nonlocal term writexj z dzxj zdzxj z dxjrz1oz dxj tz dxj dt dzxj z xj dz r xj br dxjkd2 k0z2 dzrz1r xj br dxj e2e2 finite independent h proposition 61going 36 estimates leadsxd mh tk1z2 dzer h x2xj 2h dp h xj duh tk xj br dxj e12d p1jzd1 er hr xj br dxj e2 c2mjk xj c h2 r br h2 br 2 h 2mjkjzdr hh 1er23 r h21er hh inequalitychowdhury o ersland e r jakobsenak1 rd xd mh tk1 estimate ak1 ak ee cr h2 br h2 br 2 h 2 iteration br 2 r br cr120 1 k n chak1 a0 k 1e a0 c hr12 1assumption h hr12 o1 proposition 61 a0 rd xd m0xd mh tk ck 0 1 nconstant c 0 independent h 26 result followst 0 ttheorem 65 equicontinuity time assume 0 1 l1l2 f2 h1m c0 t p rd mh defined 26 let h rh o10 1 h hr12 o1 1 2 exists constant c0 0independent h t1 t2 0 td0 mh t1 mh t2 c0 t1 t2proof start case 1 0 let definedlemma 32 mh mh noted0 mh t1 mh t2 supxmh t1 mh t2 dxlip11 rdsupmh t1 mh t2 dxmh t1 mh t2 dxlip112kdk0suplip11mh t1 mh t2 dxlemma 32 estimate term mh dx 1 mhrd xmh t xdx affine interval tk tk1 rd x mh xdxw 1 0 tx mh xdx sup ikdt rdmh tk1 xmh tk xik rd xdx followsmh t1 x mh t2 xdx t1 t2 sup iklet estimate ik 26 24 25 midpoint quadrature approximation errorbound linearmultilinear interpolation error bound1x 1ikx dxmik1 mikh d ei1 xxdx mjk bhr hp duh j k mik ijh jimjkxi bhr hp duh j k xj ckd2 k0 2h japproximation nonlocal mfgsh er h xmjkjkpjkph j1 er hxj z xj dz ckd2 k0 2jkp xj ahj 37 2nd order taylors expansion givesmjk er h hdp h xj duh tk xj hbr d xjikh j1 er hkd2 k0 x 2br d xjahjkd2 k0z2 dz 2k k0dz ckd2 k0 2rz1hkdp h duh k0 h2 r br kd k0 c3 hk k0c1 hkdp h duh kbrhr hkd k0mjkr hinequality follows 1erhehr h2 r br d rterms rz1 z dz z1 dz c independently r 0 1lemma 55 h1 kdp h duh k0 cr r ll lf t lg 1mjk 1 lip11 kd2 k0 kdkbr 2 r br kr120 12 1conclude proof case 1 40 41 viewestimate ik assumption h hr12 o1d0 mh t1 mh t2 2 ct1 t2 1finally taking t1 t2 d0 mh t1 mh t2 c t1 t2ik c1 hr12 c 1 h hr121 br cik c1 hr c 1 h hrassumption hr2 1o1d0 mh t1 mh t2 2 ct1 t2 1concludeneed l1 stability result mh respect variationslemma 66 l1 stability assume 0 h1 mh defined 261 2 c0 t p rdsup kmh 1 t mh 2 t kl1 rdt0tckt hrdp h duh 1 dp h duh 2chowdhury o ersland e r jakobsenproof let dp h duh 1 dp h duh 2 mjk mjk 1 mjkmjk 2 25 lemma 33 bhr j k 0 mjk 0x xmik1 mik1mjk bhr j k mjk bhr j kmjk bhr j k bhr j k mjk mjk bhr j kbhr j k 1 follows 1 25mjk mjk bhr j kmjk mjkfinite numberkd s nonzero given pointlipschitz constant c j mjk 1 lemma 33 definitions bhr25jkp 23mjk bhr j k bhr j kehr x xmjkjkp 1 jkp 22d p1jkp 1 jkp 2 kdchehrk k0iteration showsckd t hrmik1 mik1mi0 mi0k k0mi0 mi0 ei m0 dx result follows interpolationend section uniform lp bound mh dimension d 1theorem 67 lp bounds assume d 1 0 1 l1 l3 f3 h2 mc0 t p rd mh defined 26 mh lp rexist constant k 0 independent hkmh tklp r ekt km0 klp rprove theorem need technical lemmaslemma 68 assume d 1 0 1 l1 l3 f3 h2 existsconstant c0 0 independent hdp h xj duh tk xj dp h xi duh tk xi xj xi c0 xj xi 2proof l1 h2 r lf ll t lg 1dp h xj duh tk xj dp h xi duh tk xi xj xiz 1xj xidp h xj t duh tk xj 1 tduh tk xi dt0 dtxj xi dp h xj duh tk xi dp h xi duh tk xiz 1xj xidpp h xj t duh tk xj1 tduh tk xi duh tk xj duh tk xi dtapproximation nonlocal mfgsxj xi dp h xj duh tk xi dp h xi duh tk xicr c2 xj xi 2 cr xj xi 2inequality follows convexity h l convex l1 semiconcavity uh lemma 55 c regularity h h2lemma 69 assume d 1 0 1 l1 l3 f3 h2 c0 t p rdletjk defined 23 exist constant k0 0 independent hz k nhmaxjkjk 1 k0 hproof result similar proof 23 lemma 38 slightly expandedproof given appendix c similar result holds integraltermlemma 610 assume d 11 xxj zdz 1proof 11 properties basis functions j1 xxj zdzij zdzdz 1r zrr zrproof theorem 67 definition mh 26 scheme 24z xmik1 1ei x dxmh x tk1 p dxr1 xxmik1 p p1mjk bhr j kp1bhr bhr hp duh defined 25 jensens inequalityp x xp1 xmjk bhr j kbhr p kmjk bhr j klemma 69 610bhr p k 1 k0 hk0 independent h bhr p k 1 follows1p xmik1 p 1 k0 hp1mjkbhr j kkmh tk kplp r 1k0 hp1iteration kmh t0 klp km0 klp kmh tk1 klp ek0 t 1 p km0 klpresult follows p 1proof p simpler view lemma 69 610 proof follows24 2nd order casechowdhury o ersland e r jakobsen7 proof convergence theorem 41 43main structure proofs similar present proofsproceed stepsstep 1 compactness mnn hn view theorem 64 65 mh precompactc0 t p rd prokhorov arzelascoli theorem existsubsequence mnn hn m c0 t p rdmnn hn mc0 t p rdproves theorem 43 ii theorem 41 iim holds p theorem 67 hellys weak compactness theoremimply mh weak precompact l 0 t r subsequencemnn hn function m mnn hn m l 0 t r m holdsp 1 mh equiintegrable 0 t r theorem 64 67la valle poussins theorem dunfordpettis theorem weakly precompactl1 0 t r exists subsequence mnn hn function mmnn hn m l1 0 t r second theorem 41 ii followsstep 2 compactness limit points hn limit points uviscosity solutions iii theorem 41 43 follow step 1theorem 56step 3 consistency mnn hn let u m limit point unn hn mnn hn nstep 2 u viscosity solution hjb equation 1m weak solution fpk equation 1 u input datam satisfies 3 t 0 t cc rd rest proof use h rinstead n hn rn n simplify let mb mnn hn w unn hn mbttn hn hn notexdmtb n x0dm0 xxdmtb k1 mtb kprove 3 estimate sum rightmidpoint approximation 26 scheme 24 25 combinedlinearmultilinear interpolation finally midpoint approximation1 xxdmtb k1 dmik1xdxmik1 xi o2izdximjk bhr hp dwi j k o2mjker h xx mjkjkp jkp1 er hxj zdz o2r h xkp x kp x1 er hx zdz dx o2 e ehdrpjkp defined 23 kp x x h hp x dwtk x bre e error midpoint approximation smooth uhapproximation nonlocal mfgsckduh 0assumption h2uniformly lipschitz lemma 55 kd2 wk0jkp dkp xdxejkdk0hkdk0dp hxj dwtk xj dp hx dwtk x dxk 1 hkhpp k0 kd2 wk0 khpx k0 k 1 kduh k0e o hsimilarly e oh r o restimatesz r h xb k1 mtb k xxd mtkp x kp x 2x2d p11 er hh h2x z x dz dmtb k x o 2similar argument 28 lemma 31kp x kp x 2x 2h dx dp hx dwtk x br dx2hlr x oh2 r22 hr330 31xdmtb k1 mtb k xdx dp hx dwtk x lr x lr x dmtb k xh h2h2 r22 hr3summing k 0 k n 1 approximating sums integrals obtainxdmtb n xxdmtb 0oh2 r h2 r12 h2 r22 o2dx dp hx dwtk x lx dmtb k xn o2h h2h2 r hr3dx dp hx dws x lx dmsx2 he riemann sum approximation error let ik x dxdp hx dwtk xlx use timecontinuity mb d0 metric theorem 65 w xckduh k0conclude sconstant tk tk1 h1 h2 kd2 wk0tk tk1z tk1 zs tkik xd mtb k msxds h kik k0 kdik k0 c0 supkh 1 kdwk0 kd2 wk0 h kh 1stk tk1chowdhury o ersland e r jakobsenpn1 r tk1 rsumming k eb k msxds o hxd mtk0 tkrd kmb converges m c0 t p rd cc rd implies l cb rdz z tz z tnlxdmsxlxdmsxremains convergence dp hterm pass limit 42m weak solution satisfying 3step 4 proof theorem 41 iii d 1 ii theorem 41implies mb m l 0 t r m0 l r mb m l1 0 t rm0 l r p 1 dwt x duh t x dut x0 t r theorem 56 ii d cc r dp h dwuniformly bounded triangle inequality dominated convergence theoremz z tndxdp hx dws x dmsxr 0z z tdx dp hx dus x dmsxpassing limit 42 limit 43 cfl conditions2 hh r o1 note h large n 3 holds mweak solution fpk equation completes proof theorem 41 iiiu holds dw duh du lor1cally uniformly theorem 56 iii d cc rd rd dmsxcontinuity uniform boundedness dp h dw followsz z tndx dp hx dws x dmsxrd 0z z tndx dp hx dus x dmsxrd 0t kdk0 kdpp hk0 kdw dukl suppdmsxstep 5proof theorem 43iiimb m c0 t p rd d dp h dut cb rd uz z tndxdp hx dus x dmsxrd 0z z tdx dp hx dus x dmsxpassinglimit 42 limit 44 43 cflconditions h rh h o1 3 holds m weak solutionfpk equation completes proof theorem 43iii8 numerical examplesnumerical experiments lookut lu 2 ux f t x k mt xmt l m divmux 0ut x gx mtmx 0 m0 x0 t b0 t bbapproximation nonlocal mfgsb real numbers l diffusion operator 12 e 22 k realnumber f bounded smooth function specify quantitiesexamplesartificial boundary conditions schemes 18 24 approximating 45posed r work bounded domain impose artificial exteriorconditionsu1 u ku0 k0 t kf kl 0t ab r b 0 tm1 m 0 r b 0 t m0 compactly supported bcondition u1 penalizebc ensuring optimal controls 18xi h hr b contributions nonlocal operators ubc small away boundary condition m1 ensures massm essentially contained b finite time mass leaknonlocal effects contribution bc computenonlocal operators m present numerical results regionfar away boundary b influence artificialexterior data expected negligibleevaluating integrals implement scheme need evaluate integralxi zdzf xi jijiji zdz17 addition need compute values r br r 9 811 compute weights ji use different methods fractionallaplacians use explicit weights 45 cgmy diffusions calculateweights numerically inbuilt integral function matlab testedfractional laplacian matlab integrator produced error 1015quantities r br r computed explicitly cgmy caseuse numerical integrationsolving coupled use fixed point iteration scheme let m0solve uh 1820 ii approximate optimal control duh 21solve mh 24 iii let new mh 2 repeat processnew continue converged fixed point machineaccuracyremark 81 instead new mh new mh 2 use fixedpoint iteration memory gives faster convergence examplesexample 1 problem 45 0 t b 0 2 0 1 g 0 f t x 5xx052051 sin2t2 m0 x ce 012 c m0 1 furthermoreaccordancecflconditions theorem 41 let h 0005 r h 2sh 00707 009 04 k 1diffusions consider l 2 s 05 15 19 l l 0figure 1 plot different solutions time t 05 t 15figure 2 plot solution s 15 time interval 0 2example 2 problem 45 cost functions example 1 differentdiffusions parameter s 15chowdhury o ersland e r jakobsent 05b t 15figure 1 solutions m example 1mt xb ut xfigure 2 solution m u example 1 diffusion parameters 15l 2 r 2ii l 2 cds r ux y ux dux y 1y1 10 ydy1siii l cds r ux y ux dux y 1y1 10505c ydy1s10y y dyiv l cds r ux y ux dux y 1y1 ey1scds normalizing constant fractional laplacian 45 casereference solution symmetric uniformly elliptic operator case ii nonsymmetric nondegenerate case iii symmetric degenerate case ivcgmydiffusion 34 plotted m t 05 t 15 figure 3example 3 long time behaviour certain conditions 22 21solution time dependent mfg systems quickly converge solutioncorresponding stationary ergodic mfg time horizon t increasescheck numerically case nonlocal diffusions 45l 2 s 15 0 t b 0 10 1 2 gx x 22 f t x x2m0 x 112 x expect cost functions f g solutionm approach line x 0 fast travel line goespoint x 2 end numerical simulations showscase nonlocal diffusions considered cases k 0approximation nonlocal mfgst 05b t 15figure 3 solutions m example 2coupling u equation k 04 coupling parameterssimulations h 001 h r h12s results shown figure 4fb f 04figure 4 solutions m example 3players want avoid case k 04 solutionspread space direction case k 0example 4 compute convergence rate f g m0 example 1s 15 02 04 domain 0 t b 0 05 0 1 hr h 2s simplicity 025calculate solutions different values h compare reference solutioncomputed h 210 calculate l l1 relative errors restricted xinterval 13 23 avoid boundary effects t 0 u t t merrukuh 0 uref 0 kl 31 32kuref 0 kl 13 32errmkmh t mref t kl1 31 23kmref t kl1 31 23results given tableerruerrm0315508055019510458300920 0044602886 01869002180102300097 0003500596 003000001300186halve h error halved observe error order ohchowdhury o ersland e r jakobsenappendix proof proposition 34proof adaptation schauder fixed point argument prove existence mfgs use direct consequence theorem 64 65corollary a1 assume 01 l1l2 h1 f2 m given proposition 61 mh defined 26 ch 0c0 t p rd t s 0 td0 mh t mh schx dmh tt spoint h fixed result letc c0 t p rd 0 m0d0 t ssupxdt x pcht sts0tch defined corollary a1 c let uh solution 18uh defined 22 mh s defined corresponding solution24 note fixed point s solution u m scheme 27conclude proof applying schauders fixed point theorem1 c convex closed compact set convex closed standard argumentscompact prokhorov arzelascoli theorems2 s selfmap c map s maps c corollary a1 tightnessequicontinuity lemma 33 positivity mass preservation3 s continuous let n c theorem 52 comparison f2kuh n uh k0t sup f x n t f x t sup gx n t gx tt lf sup d0 n t t lg d0 n t t 0u uu uijksupi ik n ijk n ikduh k0 0 finally lemma 66sup kmh n t mh t kl1 rdt0t0 uniformly ij 1 kduh nckt hrkduh n duh k0 0s continuousappendix b proof lemma 56 ii iiifix t x 0 t rd consider sequence tk xk t x y rdtaylor expansion showsunn hn n tk xk y unn hn n tk xk dunn hn n tk xk yz 1z 1dunn hn n tk xk sy dunn hn n tk xk y dsy dslemma 55 lemma 55 bz ny2ll lf t lgy ds 2kdunn hn n k0z 1z 1z 11 2ny ds c1sy2 2n ds c1 y2s y2 2napproximation nonlocal mfgsc1 y2n ys s2 ds c1 y2lemma 55 sequence dunn hn n tk xk precompactconvergent subsequence n k nn o1 p limit passinglimit 46 subsequenceux y ux p y c1 y2y rdp d ut x superdifferential ut x points x t udifferentiable d ut x dut x p dut xsubsequence arbitrary argument limit points p coincidelim suptk xk txndunn hn n tk xklim inftk xk txndunn hn n tk xkdut xconclude dunn hn n du t x ii follows ulipschitz space proposition 25 c xdifferentiable ae xprove iii note u c 1 u 47 holds t xview uniform lipschitz estimate lemma 55 local uniformconvergence follows 11 chapter v lemma 19 proof completeappendix c proof lemma 69strong separation characteristics lemmadp hxj duh tk xj brdp hxi duh tk xi brxj xi 2 2h dp h xj duh tk xj dp h xi duh tk xi xj xi1 c0 hxj xi 2o pmin1 c0 hj 1 c0 hresult holds following proof 23 lemma 38 proofcompletenessdiameter support hat basis functions 2 483 characteristics inside suppi small h result trivialcharacteristic suppi suppi contains 2 characteristicsj1 k j2 k 48 check different orderings xk j1 k j2 kj1 kj2 kxij1 kj1 kj2 kxij2 k1 c0 h 1 k0 hchowdhury o ersland e r jakobsenfinally assume supporti contains 3 characteristicsj1 k j2 k j3 k 48characteristics left right xi lossgenerality assumej1 k xi j2 k j3 kj1 k j2 k j3 k 1j2 kj1 kj3 kxij1 kj2 k xij3 k xij2 k3 2 1 c0 h 1 21 1 c0 h 1 k0 hcombining casesjk 1 k0 h zestimatejk similar completes proofacknowledgementsauthors supported toppforsk research excellence project wavesnonlinear phenomena wanp grant 250070 research council norwayic partially supported croatian science foundation project 4197authors like thank elisabetta carlini sharing code numericalmethods introduced 23references1 y achdou f camilli capuzzodolcetta mean field games numerical methodsplanning problem siam j control optim 50177109 20122 y achdou f camilli capuzzodolcetta mean field games convergence finitedifference method siam j numer anal 51525852612 20133 y achdou f camilli l corrias numerical approximation hamiltonjacobitransport arising high frequency approximations discrete contin dyn syst ser b193629650 20144 y achdou capuzzodolcetta mean field games numerical methods siam j numeranal 48311361162 20105 y achdou p cardaliaguet f delarue porretta f santambrogio mean field games lecturenotes mathematics cime vol 2281 springer 20206 y achdou m laurire mean field games applications numerical aspects arxivpreprint arxiv200304444 20207 y achdou v perez iterative strategies solving linearized discrete mean field gamessystems netw heterog media 72197 20128 y achdou porretta convergence finite difference scheme weak solutions partial differential equations arising mean field games siam j numer anal 541161186 20169 d applebaum lvy processes stochastic calculus cambridge university press 200910 s asmussen j rosiski approximations small jumps lvy processes viewsimulation j appl probab 382482493 200111 m bardi capuzzodolcetta optimal control viscosity solutions hamiltonjacobibellman equations birkhuser 199712 g barles p e souganidis convergence approximation schemes fully nonlinear secondorder equations asymptotic anal 43271283 199113 bensoussan j frehse p yam mean field games mean field type control theory springerbriefs mathematics springer 201314 f camilli m falcone approximation scheme optimal control diffusion processesrairo modl math anal numr 29197122 199515 f camilli e r jakobsen finite element like scheme integropartial differential hamiltonjacobibellman equations siam j numer anal 47424072431 200916 capuzzo dolcetta discrete approximation hamiltonjacobi equation dynamicprogramming appl math optim 104 367377 1983approximation nonlocal mfgs17 p cardaliaguet weak solutions order mean field games local coupling analysisgeometry control theory applications volume 11 springer indam ser pages111158 springer cham 201518 p cardaliaguet f delarue jm lasry pl lions master equation convergence problem mean field games annals mathematics studies vol 201 princeton university press 201919 p cardaliaguet p j graber mean field games systems order esaim control optimcalc var 213690722 201520 p cardaliaguet p j graber porretta d tonon second order mean field games degenerate diffusion local coupling nodea nonlinear differential equations appl 22512871317 201521 p cardaliaguet jm lasry pl lions porretta long time average mean field gamesnonlocal coupling siam j control optim 51535583591 201322 p cardaliaguet jm lasry pl lions porretta long time average mean field gamesnetw heterog media 72279 201223 e carlini f j silva fully discrete semilagrangian scheme order mean fieldgame problem siam j numer anal 5214567 201424 e carlini f j silva semilagrangian scheme degenerate second order mean fieldgame discrete contin dyn syst 3594269 201525 e carlini f j silva discretization nonlinear fokkerplanckkolmogorovequations applications siam j numer anal 56421482177 201826 r carmona f delarue probabilistic analysis meanfield games siam j control optim51427052734 201327 r carmona f delarue probabilistic theory mean field games applications iii probability theory stochastic modelling 84 springer 201828 r carmona m laurire convergence analysis machine learning algorithms numerical solution mean field control games iithe finite horizon case arxiv preprintarxiv190801613 201929 r carmona m laurire z tan linearquadratic meanfield reinforcement learning convergence policy gradient methods arxiv preprint arxiv191004295 201930 cesaroni m cirant s dipierro m novaga e valdinoci stationary fractional meanfield games j math pures appl 1229122 201731 chowdhury e r jakobsen m krupski fully nonlinear parabolic mean field gamesexamples nonlocal local diffusions arxiv preprint arxiv210406985 202132 m cirant solvability ergodic control problems rd siam j control optim52640014026 201433 m cirant goffi existence uniqueness solutions timedependent fractionalmfg siam j math anal 512913954 201934 r cont p tankov financial modelling jump processes crc press 200335 k debrabant e r jakobsen semilagrangian schemes linear fully nonlinear diffusionequations math comp 8228314331462 201336 s elghanjaoui k h karlsen markov chain approximation scheme singular investmentconsumption problem lvy driven stock prices online available urlhttpsciteseerxistpsueduviewdocdownloaddoi1011152182reprep1typepdf 200237 o ersland e r jakobsen fractional nonlocal parabolic mean field gamesspace arxiv preprint arxiv200312302 202038 m falcone r ferretti semilagrangian approximation schemes linear hamiltonjacobi equations society industrial applied mathematics siam 201439 d gomes e pimentel v voskanyan regularity theory meanfield game systemsspringerbriefs mathematics springer 201640 o guant mean field games equations quadratic hamiltonian specific approach mathmodels methods appl sci 2209 201241 o guant new numerical methods mean field games quadratic costs netw heterogmedia 72315336 201242 o guant mean field games quadratic hamiltonian constructive scheme advancesdynamic games pages 229241 springer 201343 o guant jm lasry pl lions mean field games applications parisprincetonlectures mathematical finance 2010 lecture notes mathematics 2003 205266 springer201144 m huang r p malham p e caines large population stochastic dynamic games closedloop mckeanvlasov systems nash certainty equivalence principle commun inf syst63221251 2006chowdhury o ersland e r jakobsen45 y huang oberman numerical methods fractional laplacian finite differencequadrature approach siam j numer anal 52630563084 201446 e r jakobsen k h karlsen continuous dependence estimates viscosity solutionsintegropdes j differential equations 2122278318 200547 e r jakobsen k h karlsen c la chioma error estimates approximate solutionsbellman equations associated controlled jumpdiffusions numer math 1102221255200848 v n kolokoltsov m s troeva w yang mean field games based stablelike processesautom remote control 771120442064 201649 jm lasry pl lions mean field games jpn j math 21229260 200750 r metzler j klafter random walks guide anomalous diffusion fractional dynamicsapproach phys rep 3391177 200051 porretta weak solutions fokkerplanck equations mean field games arch rationmech anal 2161162 201552 l ruthotto s j osher w li l nurbekyan s w fung machine learning frameworksolving highdimensional mean field game mean field control problems proc natl acadsci usa 1171791839193 202053 c villani optimal transport old new springer science business media 200854 w woyczyski lvy processes physical sciences lvy processes pages 241266 springer2001chowdhury department mathematics faculty science university zagrebcroatiaemail address indranilchowdhuryntnuno indranill2011gmailcomo ersland norwegian university science technology norwayemail address olaverslandntnunoe r jakobsen norwegian university science technology norwayemail address espenjakobsenntnuno