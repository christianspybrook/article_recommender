draft version may 4 2021
typeset using latex twocolumn style in aastex63

transport of protostellar cosmic rays in turbulent dense cores
1

margot fitz axen stella s s offner1 2 brandt a l gaches3 2 chris l fryer4 aimee hungerford4 and
kedron silsbee5
1 department

of astronomy the university of texas at austin 2515 speedway stop c1400 austin texas 787121205 usa
of planetary systems habitability the university of texas at austin austin tx 78712 usa
3 i physikalisches institut universitt zu kln zlpicher strasse 77 50937 kln germany
4 center for theoretical astrophysics los alamos national laboratory los alamos nm 87544 usa
5 maxplanckinstitut fr extraterrestrische physik giessenbachstrasse 85748 garching germany

arxiv210500028v1 astrophga 30 apr 2021

2 center

received date revised date accepted may 4 2021

abstract
recent studies have suggested that lowenergy cosmic rays crs may be accelerated inside molecular
clouds by the shocks associated with star formation we use a monte carlo transport code to model
the propagation of crs accelerated by protostellar accretion shocks through protostellar cores we
calculate the cr attenuation and energy losses and compute the resulting flux and ionization rate as
a function of both radial distance from the protostar and angular position we show that protostellar
cores have nonuniform cr fluxes that produce a broad range of cr ionization rates with the maximum
value being up to two orders of magnitude higher then the radial average at a given distance in
particular the cr flux is focused in the direction of the outflow cavity creating a flashlight effect and
allowing crs to leak out of the core the radially averaged ionization rates are less than the measured
value for the milky way of   1016 s1  however within r  003 pc from the protostar the maximum
ionization rates exceed this value we show that variation in the protostellar parameters particularly
in the accretion rate may produce ionization rates that are a couple of orders of magnitude higher
or lower than our fiducial values finally we use a statistical method to model unresolved subgrid
magnetic turbulence in the core we show that turbulence modifies the cr spectrum and increases
the uniformity of the cr distribution but does not significantly affect the resulting ionization rates
1 introduction
accretion and the ability of the disk to form planetesimals dutrey et al 2014
cosmic rays crs are the primary drivers of ionthe level of cosmic ray ionization is usually exization inside the densest regions of molecular clouds
pressed
quantitatively as the cosmic ray ionization
where uv radiation cannot penetrate dalgarno 2006
rate
crir
which is the rate of cr ionizations per
padovani et al 2020 the degree of ionization in starhydrogen
molecule
the mean galactic ionization rate
forming regions is critical to setting the atomic and
16 1
is


10
s
indriolo
 mccall 2012 however obmolecular abundances wakelam et al 2012 ionizaservations
along
different
sightlines suggest higher rates
tion also impacts the gas dynamics inside the cloud as
towards
the
galactic
center
indriolo et al 2015 cr
ionized species couple to the magnetic field and resist
ionizations
produce
molecules
such as oh  h2 o  and
collapse while neutral molecules decouple from the field

h3 o in diffuse interstellar clouds so observations of
through ambipolar diffusion fiedler  mouschovias
these molecules indicate the abundance of crs and can
1993 ionization is especially crucial to the evolution of
be used to derive the crir indriolo et al 2015
circumstellar disks as the level of ionization determines
while high energy crs e  100 gev are primarwhether the magnetorotational instability mri is acily
accelerated to relativistic energies by supernovae and
tive balbus  hawley 1991 gammie 1996 the mri
active
galactic nuclei morlino 2017 berezhko 2008 reimpacts the dynamics of angular momentum transport
cent studies suggest that the shocks associated with star
formation also have the right conditions to accelerate
corresponding author margot fitz axen
crs with lower energies of e  100 gev for example
fitza003utexasedu
observations of hco and n2 h along sightlines to

2

fitz axen et al

wards the protostars omc2 fir 4 and l1157b1 indicate values higher than the mean crir ceccarelli et al
2014 fontani et al 2017 podio et al 2014 favre et al
2018 measured a value of   1014 s1 towards omc2 fir 4 two orders of magnitude higher than the milky
way value in general differences in the ionization rate
in certain regions may be explained by the magnetic
field morphology in those regions measurements of the
magnetic fields in young protostellar systems have found
that they trace an hourglasslike shape girart et al
2006 though this is not necessarily ubiquitous to leading order this field geometry does not significantly impact the cr flux fatuzzo  adams 2014 however the
environments surrounding young stellar objects are expected to be turbulent theoretical studies have found
that in the presence of magnetic pockets  regions with
a locally reduced magnetic field strength that naturally
occur in magnetized turbulence  the crir may be significantly lower fatuzzo  adams 2014 silsbee et al
2018 consequently the elevated observed ionization
rates suggest a local mechanism is acting to accelerate
crs inside molecular clouds
another signature of cr acceleration is nonthermal
synchrotron emission which is caused by relativistic
electrons gyrating around a magnetic field evidence of
nonthermal emission has been linked to shocks in protostellar jets anglada et al 2018 synchrotron emission has been observed from the hh 8081 jet and a
jet in the star forming region g03502035 which are
both associated with young massive stars rodrguezkamenetzky et al 2017 sanna et al 2019 synchrotron
emission has also been detected from the jet of the lower
mass young sunlike star dg tau ainsworth et al 2014
these results further support the evidence that the formation of young stars generates lowenergy crs
theoretical studies have modeled the acceleration of
crs associated with protostellar shocks padovani et al
2015 2016 padovani et al 2016 developed a model
of protostellar cr proton and electron acceleration at
three potential sites accretion flow shocks in collapsing envelopes jet shocks and surface accretion shocks
gaches  offner 2018 extended the surface accretion
shock predictions to include more detailed models of
the shocks focusing on connecting the properties of the
shock and the resulting cr spectrum to the properties
of the forming star these authors also investigated the
attenuation of the cr spectrum in clouds dense cores
and disks padovani et al 2016 2018 gaches  offner
2018 offner et al 2019 however they used analytic
models that made simplifications assuming isotropic diffusion for the protostellar core properties

protostellar cores exhibit a number of asymmetries
that likely influence cr propagation both the magnetic
field and the density of the gas influence cr propagation the magnetic field determines the direction of their
travel and the gas density determines how much energy
they lose cores are often prolate and elongated along
the direction of filaments myers et al 1991 nutter
 wardthompson 2007 cores particularly those in
higher mass star forming regions like orion are also turbulent kirk et al 2017 in the star formation process
high momentum outflowing material coupled to magnetic field lines sweeps up and removes the dense gas in
the core creating an outflow cavity bally 2016 significant deviations in the symmetry of the gas density
and magnetic field around the star will produce different
cr flux spectra and ionization rates in different regions
therefore having a fully consistent treatment of the geometry of the gas density and magnetic field is crucial to
accurately modeling cr propagation within protostellar
disks cores and molecular clouds
in this work we explore the propagation of cr protons accelerated by a protostellar accretion shock from
the stars surface to the edge of the protostellar core
we model the propagation of the crs numerically using previous simulations of forming protostars as inputs
for the magnetic field and gas density in the core we
use these results to compute the attenuation of the cr
energy spectrum and ionization rate as a function of radius from the protostar and solid angle going beyond
the symmetric limitations of past theoretical studies
we explore the impacts of different protostellar ages and
amount of magnetic turbulence in the core on the propagation of the crs in section 2 we describe the model we
use and our numerical methods in section 3 we discuss
the results of the cr propagation and ionization rates
in the core finally in section 4 we compare our results
to observations and discuss the further implications of
our work
2 methods

21 model for cr acceleration in protostellar
accretion shocks
we consider cr acceleration through diffusive shock
acceleration dsa or first order fermi acceleration in
which a charged particle encounters a shock and scatters
back and forth across the shock width due to magnetic
fluctuations gaining energy as it does so drury 1983
the shock must have the right conditions for the particle to be accelerated efficiently without losing too much
energy or leaving the shock specifically the shock must
be supersonic us  cs  and superalfvnic us  va 
where us  cs  and va are the shock velocity sound speed

3

protostellar crs
and alfvn speed respectively the sound speed in the
shock is given by padovani et al 2019

the shock density is given by
s 



05
ts
cs  91 ad 1  x
km s1 
104 k

1

where ad  53 is the adiabatic index ts is the preshock temperature and x is the ionization fraction x 
1 at the surface of the star the alfvn velocity is given
by
va  

bs
4s
2

 22  10



05
ns
106 cm3



bs
10g



km s1 
2

where bs is the shock magnetic field s is the shock
mass density and ns  ims h is the shock number density here i is the mean molecular weight and mh is
the atomic hydrogen mass we assume a fully ionized
gas and use a value of i  06
to compute the initial cr spectrum at the protostellar surface we follow the analytical calculation done by
gaches  offner 2018 which builds on the model from
padovani et al 2016 the properties of the spectrum
are determined by a model for the protostellar accretion
shock which accelerates particles to relativistic energies gaches  offner 2018 developed a semianalytic
model for protostellar accretion and the corresponding
cr spectrum as a function of protostellar mass m  protostellar radius r  and accretion rate  which we describe further in section 232 their protostellar accretion shock model is parameterized by the shock velocity temperature of the gas and density of the gas
hartmann et al 2016
we assume the shock velocity us  is approximately
the freefall velocity at the protostellar surface r 
r

2gm
r

05 
05
m
r
 309
km s1 
05m
2r

us 


1
f

 8387  10
105 m yr1
01
1
2 

us
r
g cm3 
5

2r
309km s1
10



where a  4f r2 is the area of the accretion columns
and f is the filling fraction of the accretion columns on
the surface of the protostar
the energy spectrum of cosmic rays produced by dsa
forms a powerlaw distribution in momentum space


p
f p  f0

6
pinj
where f0 is a normalization factor pinj is the injection
momentum of thermal cr particles and  is the powerlaw index which is related to the shock compression
s
ratio rs by   r3r
 the flux spectrum of the crs is
s 1
given by
ven e
je 

7
4
where ve  c is the velocity as a function of energy
e and the energy number density distribution is given
by
dp
n e  4p2 f p

8
de
the energy spectrum is defined over a range einj 
e  emax  where einj is the injection energy of thermal crs and emax is the maximum energy for which
crs can be efficiently accelerated by dsa the injection energy einj  depends on the strength of the shock
and the hydrodynamic properties while the maximum
energy emax is determined by the magnetic field ionization fraction and shock acceleration efficiency gaches
 offner 2018 the details describing the calculation of
these energy parameters are outlined in gaches  offner
2018 and padovani et al 2016
22 cr propagation

3

in the strong shock regime the postshock temperature
is given by hartmann et al 2016
3 i mh 2
us
16 k
2
  
us
i
 1302  106
k
06
309km s1


aus

ts 

4

221 numerical method
our aim is to model the attenuation of the cr spectrum in the protostellar core after the crs are accelerated at the surface by the accretion shock past studies
have calculated the attenuation of the spectrum analytically by making assumptions about the properties of the
core here we instead follow the propagation of each individual cr particle through a realistic magnetic field
and density configuration this method has the advantage that it accounts for spatial variations in the core

4

fitz axen et al

properties and allows us to calculate attenuated spectra
and ionization rates in different regions of the core
to compute the cr propagation we use a threedimensional timeindependent monte carlo radiation
transport code designed for the propagation of cr protons fitz axen et al 2021 a cr source can be placed
at any location in the grid and emits particles in random
initial directions the code propagates particles through
a three dimensional grid of cubic cells with physical
properties density bulk magnetic field that are constant within each cell the particles travel through the
grid from their starting location until they exit one of
the grid boundaries
the code determines the propagation of particles by
approximating the lorentz equation of motion the
lorentz equation describes the motion of particles spiraling around a magnetic field line with a gyroradius
of motion rg  for a charged particle moving with velocity vt through a magnetic field bx the lorentz
equation is
dut


vt  bx
dt
rg

9

where ut  vtc c is the speed of light and  and 
are the lorentz factors which
p are related to the velocity
of the particle by   1 1  v 2 c2 and   vc the
gyroradius for a particle with charge e is given by
pc
rg 
 22  103 
eb



etot
gev



b
100g

1
au 10

where p  mv is the momentum of the particle m is
the mass of the particle and etot  e  m2c  for a
proton with a kinetic energy of 1 gev in a magnetic
field of strength 100 g typical of our problem rg is
much smaller than the grid cells we model
solving equation 9 is computationally expensive because of the number of directional changes the particle
makes therefore the code makes the common approximation that the particle simply follows the magnetic
field line that it experiences harding et al 2016 fitz
axen et al 2021 this is a valid approximation as long
as rg changes on a much smaller scale than the magnetic
field because of the assumption that solving equation 9
would be unlikely to move the particle into a region with
a different magnetic field under this approximation
the particle does not change direction until the direction of the local magnetic field changes for a particle
traveling for a timestep t the particles position at
time t  t can be calculated as
xt  t  xt 

vt  b
bt
b

11

where x and v are the particles position and velocity at
time t the particle travels either parallel or antiparallel
to the direction of the magnetic field line
the distance the particle travels in a single step
x  vt is sampled using the scattering path length
sc  which is the expected distance the particle travels
before the local magnetic field changes for the scattering length we adopt the expression from equation 3 in
fryer et al 2007
2q

sc  c

8
f a 
q  1 2 ckmin



ckmin


2q


12
here the quantity f a  is a function of the alfvn velocity a in the plasma q is the index of the power
spectrum for the turbulence and  2  bb0 2 is the
power of the turbulent fluctuation b relative to the
bulk magnetic field b0  the bulk magnetic field b0 is
the mean magnetic field over some distance in our case
a grid cell the minimum wavenumber of the magnetic
field kmin is related to the maximum scale length of the
magnetic field by kmin  2max  where max  lc 
the correlation length of the magnetic field
particles with a scattering length sc follow an exponential probability distribution for their motion
p x  exsc  solving this equation for the cumulative distribution function cdf gives   1 
exsc  where  is a random value sampled between
0 and 1 this can be rearranged to sample a distance
traveled for that step as
x  lnsc 

13

if b  0 there is no magnetic turbulence and sc is
infinite in this case x is limited by the size of the
grid cell as the particle will change direction only when
it encounters a new value of b0 
for each particle step through the grid ie each recalculation of x the code samples the magnetic field
and computes the path length for the next step the
method checks whether traveling this distance would
take the particle into a different grid cell where there
is a different bulk magnetic field if it does the particle
travels only to the edge of the cell even if this distance is
less than x when it enters a new cell its path length
and travel distance are resampled and its motion continues along the previously determined direction harding
et al 2016 fitz axen et al 2021
the code also calculates the energy losses the cr particles experience after every step as crs propagate
through the gas they undergo interactions that cause
them to lose energy and change the shape of the flux
spectrum these energy losses can be represented as a

5

protostellar crs
loss function le which is defined as
le 

1 de
1
de


nh2  dx
nh2 v dt

14

where nh2   28mh is the local number density of
molecular hydrogen
222 magnetic field treatment
the coupling between crs and the mean magnetic
field is determined by the amount of magnetic turbulence rodgerslee et al 2017 thomas  pfrommer
2019 bai et al 2019 dense protostellar cores are
expected to be at least subsonically turbulent while
outflows and disk winds can drive additional turbulence bai 2016 offner  chaban 2017 additionally
mhd turbulence can be driven by streaming instabilities
caused by anisotropies in the cr distribution function
morlino  gabici 2015 padovani et al 2020 the
amount of turbulence is relatively unknown however
and depends on parameters such as the core formation
process infall from the envelope and gas properties such
as magnetic field strength and ionization
particles in a turbulent magnetic field approximate
a random walk this means that for many particles
the positions will be isotropically distributed in angle
around their source at distances much further away than
a scattering length for this reason many commonly
used cr propagation codes such as galprop assume
that crs propagate entirely due to spatial and momentum diffusion strong  moskalenko 1998 in the absence of energy losses the attenuation of the cr flux
in a turbulent magnetic field can be solved for analytically je r  jin er1  where jin e is the flux at
the stellar surface r  the opposite extreme is the free
streaming solution in which particles are in a completely
isotropic magnetic field and do not change direction at
all in the free streaming limit without energy losses
the flux attenuates as je r  jin er2 
in fraschetti et al 2018 the authors perform testparticle numerical simulations of protons propagating in
a ttauri stellar wind they include a two component
treatment for their magnetic field structure a large scale
component b0 x that is generated by mhd simulations and is constant within each grid cell and a smallscale turbulent component bx which changes on
scales smaller than a grid cell following giacalone 
jokipii 1999 they explicitly calculate the direction of
the turbulent component for every particle step as a sum
over plane waves with randomly sampled polarizations
and phases using a kolmogorov power spectrum they
then use this to calculate the total magnitude and direction of the magnetic field as bx  b0 x  bx
and follow particle propagation along this field line

while this method for modeling turbulence is widely
used recomputing the turbulent field at every particle
step is computationally expensive if the path length is
much smaller than the grid we follow fraschetti et al
2018 by modeling the magnetic field as having both
a bulk component b0 x and a turbulent component
bx unlike fraschetti et al 2018 however we treat
the turbulent component bx statistically which allows us to examine a range of behaviors between strong
turbulence and no turbulence by choosing to use an
alternative method for cr transport we ensure that we
can run many particles through the full extent of our
grid
to determine the particle travel direction we use a
numerical method in which the particles either follow
the bulk magnetic field direction or approximate random
walk motion fitz axen et al 2021 for every step
we sample a random number  between 0 and 1 and
compare that to the regular field amplitude ratio b 
b0 xbx where bx  b0 x  bx is the sum of
the magnitudes of the two components and b is related
to the turbulent power by  2   1b  12  if   b
then the particle travel direction is sampled randomly
to approximate random walk motion if   b then
the particle follows the bulk magnetic field with one of
two directions either parallel or antiparallel to it based
on the velocity of its previous step for example if the
amplitudes of the global and turbulent field are the same
 2  1 then b  05 and a particle will have a 50 
probability of following the direction of b0 and a 50 
probability of sampling a random direction
we do not have a simple method for testing our two
component magnetic field treatment however we did
test the behavior of our code in the free streaming and
diffusion limits first we tested the behavior of the code
in these limits without energy losses and verified that we
reproduced the analytical solutions for the flux attenuation we also tested both of these limits with energy
losses and compared the results to a model developed by
silsbee  ivlev 2019 these tests are described further
in appendix c2
23 initial conditions
231 gas distribution
we take the magnetic field and density grid inputs and the initial conditions for the protostar from
the magnetohydrodynamic simulations performed by
offner  chaban 2017 this study modeled the collapse of a dense core and the subsequent formation of
a protostar for different initial magnetic field strengths
and core masses the simulations use the orion2 adaptive mesh refinement code li et al 2012 orion2 is a

6

fitz axen et al

code which includes ideal magnetohydrodynamics selfgravity gray radiative transfer radiative feedback and
star particles with a model for protostellar evolution
protostars form in the simulations when the density in a
cell becomes high enough to violate the jeans condition
krumholz et al 2004 the protostar interacts with
its surroundings by accreting radiating and launching
gas outflows offner et al 2009 krumholz et al 2004
cunningham et al 2011 the accretion shock onto the
protostar is our cr source as described in gaches 
offner 2018
the domain extent of the mhd simulations is l 
026 pc twice the initial diameter of the core and the
basegrid has 2563 cells five amr levels are used to
reach a maximum resolution of xamr  26 au we
use the density and magnetic field outputs at two different times to compute the cr propagation the mhd
code also includes a tracer fluid which tracks the density
of the gas launched in the outflow following offner 
chaban 2017 we define the tracer fraction ft  t 
which is the ratio of outflow gas density to total gas
density in a grid cell this ratio indicates the amount of
material launched in the outflow and reflects the amount
of mixing and entrainment of core material with the outflow while most grid cells have values of ft  001 we
define the outflow as those cells with ft  01 we
examine cutoff values of ft  001 ft  005 and
ftout  01 to study regions of progressively wider collimation around the outflow cavity while this quantity is
not relevant to cr propagation we use it to investigate
how the outflow geometry influences the cr distribution
we use the outputs of the fiducial run from offner 
chaban 2017 and summarize the physical parameters
in table 1 we use the simulation outputs at two different times t  03 myr and t  05 myr in order
to study the effect of protostellar age and changes to
the core properties on cr propagation the masses of
the protostar at the two times are 083 m and 107
m  at t  03 myr and t  05 myr respectively figure 1 shows volume renderings of the gas energy density
at these two times figure 2 shows slice plots of the
grid density and magnetic field through the center of
the star at the two times the shape of the outflow cavity and the magnetic field configuration shown in these
plots are mostly dependant on the initial magnetic field
used in the offner  chaban 2017 simulations figure
2 demonstrates that in these grids the direction of the
magnetic field is asymmetric and correlated with the
direction of the outflow cavity decreasing the initial
magnetic field strength in the mhd simulations by a

factor of a few would cause more asymmetry in the gas
density and magnetic field direction lee et al 2017
we discuss how the protostellar accretion rate and
radius impact the cr spectrum in more detail in section
232
232 input cr spectrum properties
for the initial cr energy spectrum at each time we
use the accretion shock model outlined in section 21
which was developed by gaches  offner 2018 in
their model the initial spectrum of accelerated crs depends on the mass radius and accretion rate of the protostar which evolve during the offner  chaban 2017
simulations as the star forms it also depends on the
filling fraction f  stellar magnetic field b  and shock
efficiency 
the mass radius and accretion rate of the protostar
are determined by a model for protostellar evolution
the radius is a somewhat uncertain parameter and may
not be single valued with mass due to the potential influence of underlying factors on the evolution such as
initial conditions and the accretion details additionally there is uncertainty in the protostellar evolution
model which depends on the accretion history assumed
initial radius and accretion efficiency hosokawa et al
2011the protostellar radius adopted by the star particles in orion2 depends on the accretion history and
is calculated as described in offner et al 2009 given
uncertainties in premain sequence models protostellar
radii are uncertain to factors of  2
the accretion rate is known to be variable and often fluctuates over small timescales during the offner
 chaban 2017 simulations varying up to an order
of magnitude this is consistent with the expectation
that young stars undergo accretion bursts audard et al
2014 the area of the accretion columns is a  4f r2 
where f is the accretion flow filling fraction gaches
 offner 2018 the value of  typically scales with
f  as faster accreting protostars have larger accretion
columns additionally for a star with a fixed mass the
stellar radius is higher for higher internal entropy therefore we expect the value of r to scale with  as well
hosokawa et al 2011
the three most uncertain parameters in the model
are the filling fraction f  protostellar magnetic field b 
and shock efficiency parameter  studies of t tauri
stars infer a magnetic field of a few g to a few kg
johnskrull 2007 donati et al 2011 johnstone et al
2014 this is a later stage of evolution than we consider for our simulations but these studies suggest reasonable values to assume for protostellar magnetic field
strengths the spirou spectrograph artigau et al

7

protostellar crs
model
mp45

mcore m 
40

lmax
5

xamr au
26

bz g
206

m m 
080


5

mcreff m 
127

eff
315

vi kms1 
052

table 1 shows the inputs used in the offner  chaban 2017 simulations that we use columns are the model name gas mass
maximum amr level cell size on the maximum level magnitude of the initial magnetic field in the z direction the magnetic
mass masstoflux ratio effective magnetic critical mass effective masstoflux ratio and initial rms turbulent velocity the
molecular core has an initial radius of rc  0065pc a uniform density an initial temperature tc  10k and an initial virial
parameter of vir  20 for a detailed description of these paramaters see offner  chaban 2017

figure 1 volume renderings of the gas energy density at t  03 myr and t  05 myr

figure 2 a slice plot through the center of the star at t  03 myr and t  05 myr colorscale indicates the gas density
contours outline the location of the outflow with ft  001 in yellow ft  005 in brown and ft  01 in red vectors show
the magnitude and direction of the magnetic field which varies between  10 g and  1 mg in our grid the white star
indicates the location of the protostar which is located slightly off center of the grid and is discussed in section 34

2014 aims to study stellar magnetism at earlier stages

and should provide better values of b for future studies

8

fitz axen et al

the shock efficiency parameter represents the fraction of
particles accelerated by the shock and is constrained by
the temperatures associated with protostellar shocks to
be  106  104 padovani et al 2016 a filling fraction of f  01 represents a moderately accreting protostar but this value may be higher for younger sources
and lower for older sources hartmann et al 2016 finally for the shock compression ratio we use a value
of rs  2 which is appropriate for the high temperatures near a protostar padovani et al 2016 further
discussion of these parameters can be found in gaches
 offner 2018 and padovani et al 2016
for our fiducial runs we use the values of the radius
and accretion rate at t  03 myr and t  05 myr given
by the output of the offner  chaban 2017 simulations we adopt values of f  01 b  10 g and
  105 following gaches  offner 2018 then for
each time we study the impact of varying r   f  and
 within the limits discussed to produce both a high input cr spectrum and a low input cr spectrum the
accretion rate is the dominant parameter in each model
as varying the accretion rate has the largest impact on
the spectrum therefore these variations can be thought
of as high accretion and low accretion models we do
not vary the stellar magnetic field b because it has
a negligible impact on the magnitude of the spectrum
the parameter values for all of the runs are given in
table 2
the values of the stellar parameters also impact the
maximum energy of the crs emax  in the initial spectrum as shown in gaches  offner 2018 the maximum energy is determined by the outcomes of three different processes upstream escape wave damping and
collisions which of these effects dominates is highly
parameter dependant here we choose to set it at
emax  3 gev for all of the initial spectra this is
roughly the median of the range of values that emax can
take about 110 gev gaches  offner 2018 moreover the ionization by crs with energies above 100
mev is insignificant due to their low ionization cross
section see padovani et al 2009 figure 1 so this
choice does not significantly impact our results similarly particles with energies below 100 kev also have
a low cross section padovani et al 2009 and lose energy too rapidly to contribute significantly to ionization
thus we set emin  100 kev
figure 3 shows the initial spectra calculated for protons at the two evolution times at lower energies the
spectra have a powerlaw behavior with index 19 the
index in equation 6 is   6 so jp  p2
f p 
p4 amato 2014 at lower energies p  e so
je  e 2  above 938 mev the proton rest mass

p  e so the spectrum turns over and eventually limits
to je  e 4 

figure 3 cr proton spectra at the accretion shock at times
t  03 myr and t  05 myr solid lines show the input
spectrum using fiducial values of f   r  and  while the
dashed and dashdot lines show the high input cr spectra
and low cr input spectra the slopes follow a power law
with index 19 at lower energies

we inject the crs at the location of the protostar
which is located at xyz000396 000488 000191
pc for the t  03 myr grid and at xyz001584 001579 001428 pc for the t  05 myr grid shown by
the white stars in figure 2 to calculate the energy of
each particle we divide the input energy spectrum into
ne  50 logarithmically spaced energy bins between
emin and emax  and sample the same number of initial
particles np e  1000 from each bin the total number
of particles is n  50np e  running a higher number of
particles produces less statistical error but is more expensive we discuss our choice of np e in further detail
and provide convergence tests in appendix a2
we compute the proton propagation in two stages
first we use the highest resolution amr grid and propagate the particles from r  0 pc out to rstart  0001
pc which is approximately the size of one grid cell in
the lowest resolution grid this gives us a modified spectrum jstart at rstart  we include this step to capture the
higher resolution magnetic field and density information
close to the star where the gas densities are higher and
may cause significant cr energy losses we then use
the lower resolution amr grid to propagate the particles from rstart out to the edge of the protostellar core
at rcore  01 pc we switch to using only this grid
for most of the cr propagation to reduce the compu

9

protostellar crs
name
mp45 03
mp45 05
mp45 03 high
mp45 03 high
mp45 03 low
mp45 03 low

time myr
03
05
03
05
03
05

mcore104 m 
176
079
176
079
176
079

m m 
083
107
083
107
083
107

r r 
715
683
715
683
358
342

m yr
255  106
439  107
255  105
439  106
255  107
439  108

l l 
927
215
9268
2153
185
043

f
01
01
09
09
005
005


105
105
104
104
106
106

table 2 properties of the protostar that we use to construct the initial cr spectra first three columns are the simulation
name time and core mass remaining columns are protostellar mass radius accretion rate and accretion luminosity and the
stellar filling fraction and shock efficiency all runs assume a stellar magnetic field of b  10 g the input cr spectrum for
each setup is shown in figure 3


tational expense of the simulations and ensure that we
run particles all the way to the edge of the core
for the first and second stages of the propagation
the magnitudes of j and jstart respectively are captured
in the weight function of each particle each particle
begins with an energy eiinit  the weight of each particle
is given by
wi 

2
jinit eiinit 4rinit
deeiinit  particles

np e
s

15

where rinit  r and jinit  j for stage 1 and
rinit  rstart and jinit  jstart for stage 2 adopting
this weight function allows us to use the same number of
particles np e in each bin and thereby reduce statistical
uncertainties while preserving the initial flux information at each energy for the second stage runs particles
do not change direction or experience energy losses below rstart  thereby preserving the information encoded
in their weight function from jstart  we note that this
is not a perfect approximation since it does not allow
particles to propagate back inside rstart and lose energy
233 cr propagation parameters
the two problemspecific parameters that are not
specified by the outputs of the offner  chaban 2017
simulations are the scattering length 12 particularly
its dependance on the turbulence bx and the particle energy loss function 14 the scattering length
is calculated using equation 12 the function f a 
scales weakly with a  going as loga  so we follow
fryer et al 2007 and set it to a constant f a   5
we assume the turbulence power spectrum to be scaleinvariant and kolmogorov which is described by a
powerlaw index of q  53 using these values the
expression for the path length can be rewritten in terms
of the gyroradius as fraschetti et al 2018
13
2
sc  56l23
c rg  

16
13

equation 16 shows that the path length is only  rg 
and so it is not a strong function of the coherent mag

netic field strength or particle energy however it is
a stronger function of the correlation length lc and
the power of the turbulence  2  the value of lc is
itself an uncertain parameter measurements of turbulence in molecular clouds have produced values of
lc  103  101 pc houde et al 2011 2016 however local outflow driving may produce smaller scale
turbulence that is unresolved by detectors values of
the correlation length that are this large give values for
the path length that are larger than the size of our grid
cells in the offner  chaban 2017 simulations turbulence is followed selfconsistently from the size of the
outflow down to the size of a few grid cells  0001
pc but smaller scales are effectively underturbulent
due to numerical dissipation as discussed in section
221 our algorithm requires particles to resample their
path length but not their direction when they enter a
new grid cell therefore the path length should be sufficiently small that the particles are resampling their
direction a few times in each cell given this we adopt
lc  105 pc which explores the possibility of small
scale turbulence that may result from local outflow driving within dense cores and is not resolved by detectors
or by the simulation we also test lc  104 pc which
is included in the appendix
we also vary the relative power of the turbulence by
exploring different values of  2  as in the case of lc 
the value of  2 is not well constrained for dense cores
we assume  2 is constant across the grid for each run
similar to fraschetti et al 2018 houde et al 2009
measured the value of hb 2 ihb02 i in omc1 and found
hb 2 ihb02 i  028 in contrast pineda et al 2020
estimated b  27g inside the dense core barnard
5 which is  5 of the previously estimated value of
the static magnetic field of b0  500g corresponding
to  2  0003 we study three different values  2 
001  2  01 and  2  10 as did fraschetti et al
2018 this spans a wide range of possibilities for the
turbulent power from conditions where the turbulence

10

fitz axen et al

is negligible  2  001 to those where it is significant
 2  10
to model energy losses we use the loss function from
padovani et al 2009 for protons in a molecular cloud
between 100 kev and 1 gev energy losses are dominated by collisions with molecular hydrogen exciting
electronic excitations and inducing ionizations at gev
and higher energies energy losses are dominated by pion
production resulting in gamma radiation
3 results

31 cr flux in protostellar cores
the flux as a function of radius is computed as
x  wi  particles
1
1
jeb  r 
 17
4r2 de 1i
i
scm2 ev
n r
hit

where the sum is over nhit r particles that reach position r in bin eb  i  n  v is the cosine of the crossing
angle of particle i and wi is the weight of particle i
the subscript b for the energy refers to the fact that the
particle is in an energy bin b and thus can have a range
of values using the weight function given in equation
15 the flux can be written

pc as a function of the effective column density they
pass through as they propagate for both times at
both times the lower energy particles lose all their energy before traveling through very much of the core
material while the higher energy particles can propagate through most of the gas without losing any energy however the particle behavior between the two
grids differs at intermediate energies ei  566 mev
ei  1681 mev and ei  4851 mev due to differences in the density and magnetic field at t  03
myr the particles traveled through an average column
density of n  1022  1023 cm2  while at t  05
myr the particles traveled through a column density of
n  1021  1022 cm2  as a result in the t  03 myr
run particles with higher initial energies experienced
more significant energy losses than at the t  05 myr
and the value of eturn r is slightly greater at t  03
myr than at t  05 myr
32 impact of outflow geometry on cr propagation

during particle propagation the code tallies the particle position as a function of solid angle in addition to
radius the flux in one angular bin is calculated as
 2
r
n n 1
jeb  r b  b  

r
np e 1i
 2


x


1
r
1
jinit eiinit  particles
x
jinit eiinit  particles

jeb  r 
2

19
r
np e 1i
i
scm ev
nhit r
i
scm2 ev
nhit rb b 
18
we first compute the cr proton spectrum as a funcwhere nhit r b  b  is the number of particles that
tion of radius away from the protostar for our fiducial
reached position r in bin b  b  and the extra factors
configuration  2  0 figure 4 shows the attenuated
of n and n are the numbers of polar and azimuthal
cr proton spectra computed at t  03 myr and t  05
angle bins respectively and account for the crossing area
myr for both times the spectra show an overall decline
of each bin relative to that of the entire sphere the anwith radius due to geometric attenuation and a turnover
gular bins are discretized uniform in cos and  using
in the spectrum due to energy losses the similarity of
n  40 and n  40 giving each bin a solid angle
the spectra at higher energies to the solutions at rstart 
of   4n n   785  103 sr the subscripts b
shown by the dashed black curves implies that partifor the solid angle quantities refer to the fact that simcles of these energies do not change energy significantly
ilar to energy particles can have a range of values of 
as this would change the slope additionally at higher
and  and we do not add to the tally when b or b
energies the spectra follow the free streaming solution
changes for a particle i since equation 19 accounts for
shown by the colored dashed lines in the panels the
the area of each bin it would give the same result for
point at which the spectra turn over eturn r is roughly
each angular bin as equation 18 if particle propagation
equal to the point at which they deviate from the free
were isotropic as has been assumed in previous studies
streaming solution the similarity of the spectrum to
to distinguish the location of the outflowwe compare
the free streaming solution at energies above eturn r
the flux in different regions of the grid with different
implies that the geometry of the magnetic field does
values of the tracer fraction ft  we compute the tracer
not change the particle travel directions significantly befraction in spherical coordinates and then categorize evcause if the particles scattered significantly the flux at
ery spherical bin as being either in the outflow with
these energies would be higher than the free streaming
ft  01 or outside the outflow with ft  01 we
solution
then compute the average values of jeb  r b  b  using
figure 5 shows the relative change in energy eei
different lower limit cutoffs of ft  we denote these averexperienced by a subset of 1000 particles out to 01
ages over select angular bins at a radius r as jeb  rft 

protostellar crs

11

figure 4 cr proton energy spectrum as a function of radius at t  03 myr and t  05 myr solid black lines show the
unattenuated spectrum at r  while dashed black lines show the attenuated spectrum at rstart  0001 pc colored lines show
the spectrum at different distances from the star with the free streaming solution from rstart plotted in dashed lines black
dots show eturn r which is the energy at which the spectrum is a maximum below eturn r the spectrum turns over due to
energy losses

figure 5 relative change in energy experienced by 1000 particles per initial energy for t  03 myr and t  05 myr as a
function of effective column density they pass through as they propagate starting at eight different energies

12

fitz axen et al

figure 6 shows these results for three different radiir  001 pc r  005 pc and r  01 pc we define jeb  r01  jeb  rout as the average flux in the
outflow region
for both times the flux in the outflow cavity is higher
at all energies and distances than the average flux in the
core this is due to two possibilities the first is that the
magnetic field becomes aligned with the outflow region
and can funnel particles into it creating a higher flux
inside the outflow region than outside the second is
that the gas densities inside the outflow are lower then
the gas densities outside the outflow decreasing energy
losses in these regions
the prevalence of the magnetic field alignment can
be deduced by comparing the shape of the average flux
spectrum and the outflow flux spectrum above eturn r
at energies above eturn r particles are not affected
by higher density regions and are only affected by the
magnetic field properties this means that the magnetic field behavior can be deduced from the spectrum
at these energies and if the flux in the outflow is higher
than average at these energies there is a tendency for
the magnetic field to be leading particles into the outflow this can be seen in all six panels of figure 6
the spatial properties of the gas density can be inferred by comparing the offset of the outflow flux from
the average flux above and below eturn r if the offset
between the curves is higher below eturn r than above
eturn r then there is a positive correlation between
lower gas densities and the outflow region this behavior can be seen in figure 6 for all three panels of t  03
myr top row for the three panels of t  05 myr
bottom row the spectrum is relatively even across all
energies indicating a minor correlation or no correlation although there is the caveat that at large distances
low energy particles are present mostly because they are
repopulated by the higher energy particles losing energy
so in some sense they are following what the higher energy particles are doing and it is harder to infer density
information
figures 7 and 8 show visual representations of the cr
flux in a single energy bin computed at the two times
the size and color of the dots indicates the magnitude
of the cr flux relative to the other regions of the panel
with blank areas indicating no cr flux in that area
these plots show the prevalence for particles to be more
highly concentrated in the outflow shown by the background colorscale than in other regions of the grid for
example for e  eturn r for t  03 myr bottom
row of plots in figure 7 all three panels show many
regions with zero flux however the areas inside the regions with a higher tracer fraction for each plot are al

most completely filled this is what gives the outflow
fluxes above the average at high energies shown in the
top row of plots of figure 6 the same effect is true at
e  eturn r depicted visually in the top row of plots
of figure 7
these plots also show that the flux of high energy particles is more stochastically distributed than the flux of
low energy particles for example at r  001 pc for
t  03 myr left panels of figure 7 there are visibly
more regions with a nonzero flux in the bottom plot depicting the flux for e  eturn r than there are for the
top plot depicting the flux for e  eturn r this is because particles of all energies follow magnetic field lines
but particles of lower energies are kept out of certain
regions due to higher gas density the consequence of
this is that all regions of the core with a nonzero flux
of low energy particles also have a nonzero flux of high
energy particles but the converse is not always true
33 cosmic ray ionization rate
using the results for jeb  r shown in figure 4 we
compute the ionization rate the ionization rate at a
radius r is calculated as
z
r  4 jeb  r ion eb de
20
where  ion is the proton ionization cross section rudd
et al 1985 rudd 1991 padovani et al 2009 we also
compute the ionization rate as a function of solid angle
similarly to equation 20 it is given by
z
r b  b   4 jeb  r b  b  ion eb de 21
as with our results for the flux we compute the average
values of r b  b  using angular bins with ft  001
ft  005 and ft  01 and denote these averages
rft  figure 9 shows the ionization rate at t  03
myr and t  05 myr
for both times the average ionization rate in the outflow is higher than the total average at all distances from
the star furthermore the offset between the average
flux and the outflow flux is reflected in the offset of the
average and outflow ionization rates for example as is
seen in the bottom three panels of figure 6 at t  05
myr the discrepancy between the outflow flux and the
average flux widens with increasing distance from the
star this is reflected in the right panel of figure 9 in
which the ionization in the outflow is further offset from
the average ionization rate at further distances this
reflects particles being funneled into the outflow as they
propagate outwards
the high gas densities in the core cause the average
ionization rate to be lower than the fiducial value of

protostellar crs

13

figure 6 average flux for all spherical bins with ft  001 yellow ft  005 red and ft  01 brown for t  03 myr
top and t  05 myr bottom at r  001 pc r  005 pc and r  01 pc black dots show eturn r which is the energy at
which the radial spectrum is a maximum

figure 7 flux in particles s1 cm2 ev1 for energy bins with eb  22  27 mev top and eb  1070  1315 mev bottom
computed in different regions of the grid for t  03 myr at r  001 pc r  005 pc and r  01 pc the legends indicate the
range of flux values each dot represents where larger darker colored dots represent higher flux regions without any dots have
zero flux colorscale indicates the tracer fraction

14

fitz axen et al

figure 8 flux in particles s1 cm2 ev1 for energy bins with eb  22  27 mev top and eb  1070  1315 mev bottom
computed in different regions of the grid for t  05 myr at r  001 pc r  005 pc and r  01 pc the legends indicate the
range of flux values each dot represents where larger darker colored dots represent higher flux regions without any dots have
zero flux colorscale indicates the tracer fraction

protostellar crs

15

  1016 s1  but some regions of the grid can have
much higher ionization rates for example at t  03
myr left panel the five innermost radii have average
ionization rate values between 1018 and 1016 s1  but
the peak ionization rates measured there are all between
1016 and 1014 s1  this highlights the importance of
considering the geometry of the magnetic field and density in cr propagation calculations as these can cause
variations in the ionization rate greater than two orders
of magnitude
figure 10 shows the angular distribution of ionization
rates for the two times at r  001 pc r  005 pc
and r  01 pc these plots have more dotted regions
indicating a nonzero ionization rate than appear in figures 7 and 8 because they include the influence of the
flux at all fifty energy bins rather than a single bin as is
plotted in the top and bottom rows of figures 7 and 8
however many of the same regions that have a nonzero
flux shown in figures 7 and 8 are reflected by a higher
ionization rate in figure 10 for example at r  005
pc for t  03 myr middle column of figure 7 the outflow regions have a higher average flux of both high and
low energy particles than the averages for those energies
outside the outflow similarly the spatial distribution of
the ionization rate for this case top middle plot of figure 10 shows a much higher average inside the outflow
than outside with all of the regions with no ionization
occurring outside the outflow

of this is that we expect there to be a large variation in
ionization over time especially if the star is undergoing
intense frequent bursts
one factor that we do not consider in these models
is the coupling of the crs to the gas in the accretion
flow because it occurs on lengthscales smaller than the
simulation grid resolution as crs travel through the
accretion flow between the star and the inner disk they
will experience energy losses offner et al 2019 the
extent of the losses depends in part on the covering fraction of the accretion over the stellar surface which is expected to be larger for higher accretion rates hartmann
et al 2016 stars with low accretion rates may have significant enhancement of radionuclide production in the
disk due to the enrichment from uncoupled crs gaches
et al 2020 although stars with high accretion rates
have a higher unattenuated cr spectrum at the stellar
surface due to the shock properties the crs may experience more energy losses close to the star compared to
the low accretion case offner et al 2019 parametrize
this uncertainty using a parameter  which quantifies
the interaction between the crs and the accretion flow
a value of   1 indicates the accretion rate is constant
and that all of the crs traverse the full accretion column here we essentially assume   0 for all models
ie that crs propagating through the core and outflow
are not strongly coupled to the accretion streams and
do not undergo energy losses

34 impact of different protostellar properties

35 impact of small scale magnetic turbulence

as discussed in section 23 several parameters affect
the input cr spectrum in particular the accretion
rate varies over several orders of magnitude and consequently has a large impact on the cr spectrum additionally the radius of the star at any time is uncertain
due to our accretion model finally the other parameters of the cr spectrum model the filling fraction shock
efficiency and stellar magnetic field are not well constrained observationally or theoretically in this section
we assess the impact of different stellar assumptions on
the resulting ionization rate
figure 11 shows the ionization rate as a function of
radius using the different input cr spectra indicated in
table 2 and shown in figure 3 the high accretion rate
models for both times have regions where the ionization
rate is above the milky way value of 1016 s1 throughout the core the low accretion rate models did not
have any regions where the ionization rate was above the
milky way value except at r001 pc although we examine the impact of the accretion rate at both times we
expect higher accretion on average in younger stars undergoing bursts of accretion an important consequence

we computed the cr energy spectra as a function of
radius using lc  105 pc for different values of the
turbulent power  2  figure 12 shows the results at two
different radii for t  03 myr increasing the amount of
turbulence in the core from the fiducial value of  2  00
changes the shape of the spectrum and increases the
value of eturn r this can be seen in both panels of
figure 12 in which the values of eturn r are plotted as
black points on each spectrum the positive correlation
in the flux with higher turbulence at energies greater
than  500 mev is caused by the increase in particle
scattering at low energies energy losses dominate over
scattering and more turbulence causes lower values of
the flux
figure 13 shows the average ionization rates for t 
03 myr and t  05 myr for most of the values of
the turbulent power that we tested there is a minimal change in the average ionization rates computed
throughout the core while stronger turbulence increases scattering and thus the flux of higher energy
crs this contribution to the ionization rate is offset
by the larger energy losses that attenuate the lower en

16

fitz axen et al

figure 9 ionization rate as a function of radius for t  03 myr and t  05 myr blue lines show the average over all angular
bins computed at a given radius and the averages for ft  001 ft  005 and ft  01 are shown in yellow brown and
red respectively maximum values of any angular bin at a given radius are shown by the green points the gray line indicates
  1016 s1  which is the measured ionization rate for the milky way

figure 10 ionization rate for t  03 myr top and t  05 myr bottom computed in different regions of the grid at r  001
pc r  005 pc and r  01 pc the magnitude of the ionization rate is indicated by the size and color of the dots which each
represent a range of values with larger darker colored dots indicating a higher ionization rate regions without any dots have
no ionization colorscale indicates the tracer fraction

protostellar crs

17

figure 11 ionization rate as a function of radius for t  03 myr and t  05 myr for different input spectrum properties
indicated in table 2 blue lines show the averages over all angular bins computed at a given radius averages for ft  01
are shown in red and the maximum values of any angular bin at a given radius are shown by the green points different
linestyles indicate the evolution of the ionization rate assuming different cr spectra injected at the protostar with the solid
lines representing the highest initial spectra and the dashdot lines representing the lowest initial spectra the gray line indicates
  1016 s1  which is the measured ionization rate for the milky way

figure 12 cr energy spectrum at t03 myr for r  001 pc and r  005 pc using lc  105 pc and four different values of
 2  black dashed lines show the attenuated spectrum at rstart  0001 pc dashed red lines show the free streaming solution
at each radius black dots show eturn r which is the energy at which the spectrum is a maximum

18

fitz axen et al

ergy crs for example for t  03 myr figure 12
shows that there is a noticeable difference in the spectra
between  2  001 and  2  01 with  2  01 having
a higher value of eturn r for both distances from the
core however the left panel of figure 13 demonstrates
that the average ionization rates throughout the core for
the two cases are indistinguishable
when there is a large enough amount of turbulence
the increase in the flux at high energies can no longer
compensate for the energy losses at low energies and
the average ionization rate decreases the left panel of
figure 13 displays this behavior for  2  10 where the
value of the ionization rate for this case is lower at all
distances from the core than for the lower values of  2 
this effect is sensitive to density as is demonstrated by
the lack of this feature in the right panel of figure 13
the distribution of crs becomes more isotropic as the
amount of turbulence increases this is because increasing the amount of turbulence reduces the influence of the
bulk magnetic field which introduces asymmetries by
funneling particles into regions with a strong bulk magnetic field component figure 14 shows the spatial distribution of ionization rates for t  03 myr at r  005
pc for the four different values of  2  this figure demonstrates that even a small amount of turbulence changes
the distribution of ionization rates for  2  001 a
larger fraction of the domain experiences nonzero ionization than for  2  00 this effect is even more
pronounced for  2  01 bottom left and  2  10
bottom right where the entire grid at r  005 pc
experiences a nonzero ionization rate
as the ionization throughout the core becomes more
isotropic the maximum ionization rate declines for example at t  03 myr figure 13 shows the maximum
ionization rates for  2  00 are orders of magnitude
higher than the maximum values for the nonzero values
of  2  increasing the amount of turbulence further decreases the maximum values and the values for  2  10
are the lowest for the four values tested although turbulence increases the likelihood that a region of the core
will have some ionization it decreases the chance of it
having a particularly large ionization
appendix b shows results of the same calculations using lc  104 pc we find that using a larger correlation
length produces similar results
4 discussion

41 comparison with observations
while the cr ionization rate from embedded protostars cannot be directly measured the local ionization
rate can be indirectly constrained through observations
of the transition lines from various ions several re

cent studies have used transition line measurements to
place constraints on the ionization rates from different
sources in particular n2 h and hco emission have
been used to infer the ionization rates from the protocluster omc2 fir4 and the bow shock of the lowmass protostar l1157mm although these constraints
have considerable uncertainties gaches et al 2019a
omc2 fir4 is one of the closest known
intermediatemass protoclusters and has been observed
in detail by the hifi spectrometer aboard the herschel
satellite ceccarelli et al 2014 it is located within the
orion molecular cloud omc at a distance of 420 pc
has a total mass of approximately 30 m  and a total
luminosity of 103 l kim et al 2008 crimier et al
2009 lpezsepulcre et al 2013 it contains three
protostellar sources of approximately 110 m each
lpezsepulcre et al 2013 ceccarelli et al 2014
used measurements of n2 h and hco emission towards omc2 fir4 to estimate the ionization rate in
the cluster they assumed that most of the emission
comes from the central source and treated it using a
twocomponent model with a warm inner region at
12503000 au 61  103 15  102 pc from the source
and a cold outer envelope at 35005000 au 17  102 24  102 pc they found that the inner and outer regions were well fit by ionization rates of  6  1012 s1
and 4  1014 s1 respectively fontani et al 2017
confirmed the estimate of   4  1014 s1 using measurements of hc3 n and hc5 n and favre et al 2018
measured the same value using c  c3 h2 
as can be seen in table 2 none of our models have an
accretion luminosity that is as high as that observed for
omc2 fir4 the highest luminosity model that we
have is the high accretion rate model at t  03 myr
which has a luminosity approximately ten times lower
given this discrepancy we do not expect to measure
ionization rates as high as the observed value for omc2 fir4 the left panel of figure 11 shows that for
r  002 pc the average ionization rate we measure
in the core was  2  1017 s1  roughly two orders of
magnitude lower still the measurements studied by
ceccarelli et al 2014 are not an azimuthal average
and depend on the direction of the telescope relative to
the outflow the highest ionization rates we measure
at r  002 pc were  4  1015 s1  only a factor of
ten lower than the ceccarelli et al 2014 observations
therefore accounting for the luminosity difference our
model is consistent with their results
another well studied source is the low mass class 0
protostar l1157mm which has a luminosity of  4l
podio et al 2014 approximately equal to the luminosities of our fiducial models the star drives the pro

protostellar crs

19

figure 13 average ionization rate as a function of radius for t  03 myr and t  05 myr using lc  105 pc turbulent
power is indicated by the shade of blue maximum values of any angular bin at a given radius are shown by the green points
with larger dots symbolizing more turbulence dashed lines and translucent points at r  005 pc indicate the region where
our results may be uncertain due to our simulation boundary conditions the gray line indicates   1016 s1  which is the
measured ionization rate for the milky way

tostellar outflow l1157 which has a bright bow shock
l1157b1 located at a distance of  01 pc from the
protostar podio et al 2014 podio et al 2014 used
emission measurements from l1157b1 of n2 h  hco
and other molecules to constrain the value of the ionization rate in the shock they computed an ionization rate
of   3  1016 s1  figure 9 shows that crs can be
directed into the outflow cavity raising the average ionization rates in the outflow still the maximum values
we measure for our fiducial models at r  01 pc from
the star are  1017 s1  an order of magnitude lower
than the podio et al 2014 results however padovani
et al 2016 showed that crs can also be reaccelerated in the bow shocks of protostars which may be a
contributing source of cr acceleration in the l1157b1
shock therefore we do not consider our results completely inconsistent with the podio et al 2014 results
in addition to predicting the radial evolution of the
ionization rate our models predict azimuthal variation
especially with respect to the location of the outflow
cavity spatially resolved observations of molecular ions
such as hco and n2 h  which are sensitive to the cr
ionization rate may provide evidence of nonuniform cr
flux cleeves et al 2015 seifert et al 2021 the distribution and abundance of complex organic molecules
such as methanol ch3 oh acetaldehyde ch3 cho
and methyl formate hcooch3  which can be pro

duced by cr heating of dust mantles ivlev et al 2015
jimnezserra et al 2016 lpezsepulcre a et al 2017
harju et al 2020 may also point to elevated andor
anisotropic cr flux however obtaining highresolution
maps of these tracers toward protostellar cores is challenging even with alma in addition external sources
of ionization together with gas temperature and density variations may make it difficult to attribute any
observed variation to cr anisotropies
since observations constrain the total ionization rate
it is also difficult to disentangle the relative contributions of xrays and crs to the ionization young stars
are strong xray emitters eg preibisch et al 2005
hard xray photons produced through accretion and
stellar flares can provide a substantial source of ionization at intermediate densities glassgold et al 1997
cleeves et al 2015 however the radiation spectrum
of protostellar sources which have lower effective temperatures and larger radii than their ttauri counterparts eg hosokawa et al 2011 are thought to have a
softer xray spectrum and produce less ionizating radiation skinner et al 1997 thus we expect crs are the
dominant source of ionization in dense core envelopes
and protostellar disks offner et al 2019
many previous studies have only considered the effect
of crs accelerated outside the molecular cloud on the
cloud gas while our calculations suggest that the el

20

fitz axen et al

figure 14 ionization rate for t  03 myr using lc  105 pc computed in different regions of the grid at r  005 pc for four
different values of  2  the size and color of the dots indicates the magnitude of the ionization rate with larger darker colored
dots representing a higher ionization rate regions without any dots have no ionization colorscale indicates the tracer fraction

evated ionization rates observed in omc2 fir4 and
l1157b1 could be produced by local protostellar crs
we note that a nearby supernova remnant snr that
efficiently accelerates crs may have the same effect
snrs are likely to be the main cr acceleration mechanism contributing to the galactic cr gcr spectrum
however they are probably not the only one snr remnants are unlikely to be able to accelerate particles up
to pev energies and cannot explain deviations observed
in the isotopic ratios of the gcr spectrum from solar
system values drury et al 2001 bykov et al 2020
while protostellar crs do not explain these features
our calculations are able to explain the elevated ionization rates without assuming snr acceleration as a
nearby snr would likely produce other observational
signals
42 implications for the chemistry of protostellar
cores and molecular clouds

our results have implications for studies of the chemical abundances in protostellar cores and molecular
clouds these studies solve chemical networks to determine the evolution of the core or cloud chemistry and
are used to link observations of the abundances to other
properties very few studies consider internal sources of
cr acceleration or even a spatially variable cr ionization rate gaches et al 2019a
observations determining the abundances of deuterated molecules in protostellar cores are used to determine the core collapse history which is important for
determining the dynamical mechanism of core formation
and evolution bacmann et al 2003 flower et al 2006
caselli et al 2008 emprechtinger et al 2009 fontani
et al 2011 kong et al 2015 2016 the deuterium fracn2 h
tion dfrac
n2 d n2 h  has been calculated using
transition line measurements for a number of protostellar cores with typical values of  01  1 and used

21

protostellar crs
to place constraints on the ages of the cores crapsi
et al 2005 emprechtinger et al 2009 pagani et al 2009
2013 kong et al 2016 however these studies showed
that variations in the value assumed for the cr ionization rate change the time evolution of the formation of
n2 h
n2 d and the final equilibrium value of dfrac
 another observational indicator of the core age is the ratio
of ortho to para abundances of deuterated molecules
such as h2 d  but this also depends on the value assumed for the cr ionization rate caselli et al 2008
brnken et al 2014
several studies found variations in the core evolution when they varied the cr ionization rate from
 1018  1015 s1 crapsi et al 2005 pagani et al
2009 fontani et al 2011 pagani et al 2013 brnken
et al 2014 kong et al 2015 2016 figures 9 and
11 show that the ionization rates throughout the core
are not uniform and span this range with higher values in certain regions such as the outflow this suggests
that the abundance depends on the viewing angle and
measuring a single value of the deuterium abundance
towards a protostellar core will not place a tight constraint on the age of the core additionally some studies used observations of deuterium molecules to place
upper limits on ionization rates in cores kong et al
2015 concluded that to reproduce the deuterium abundance observations in typical cores an ionization rate of
  1016 s1 is needed figures 9 and 11 show that
there are regions of some protostellar cores with higher
ionization rates than this which indicates that the deuterium fraction may vary throughout the core
similar methods are used to determine how the cr
ionization rate impacts the formation of neutral organic molecules in cores shingledecker et al 2018
calculated the abundances of hoco no2  hc2 o and
hcooch3 in a protostellar core varying the ionization
rate between 1017 and 1014 s1  they found an anticorrelation between cr ionization rate and neutral organic molecule abundance as the gas became dominated
by ions figure 9 shows that because of the heterogeneous distribution of ionization rates in the core the
maximum ionization rates throughout most of the core
fall in the range   1017 s1  this suggests that some
regions of protostellar cores have reduced abundances of
neutral organic molecules
in molecular clouds the ionization rate affects the
abundances of co and ci which are used to estimate the mass of h2 gas in the cloud papadopoulos
et al 2004 bolatto et al 2013 bisbas et al 2015
in order to use these transition lines as mass estimators the relative abundances of coh2  or cih2 
must be known numerical studies have calculated how

these abundance ratios are affected by different values
of the cr ionization rate in molecular clouds however
they mostly assumed a constant cr ionization rate of
1017 s1 throughout the cloud and examined the effect of varying it glover  clark 2012 offner et al
2013 2014 glover et al 2015 glover  clark 2016
bisbas et al 2017 an increase in the cr ionization
rate causes a decrease in the abundance of co and an
increase in the abundance of ci and at ionization rates
23 orders of magnitude greater than 1017 s1 co is
almost completely depleted and ci is the dominant gas
tracer glover  clark 2012 bisbas et al 2017 gaches
et al 2019b
gaches et al 2019ab found that including internal sources of cr acceleration from protostellar accretion shocks accurately reproduced the observed ionization rates and abundances of coh2  and cih2  in
molecular clouds figures 9 and 11 show that in regions
of cores near the outflow and throughout the core in
higher accretion sources the cr ionization rate is comparable to the value frequently assumed in the literature
of 1017 s1  consequently protostellar sources of cr
acceleration will impact the abundances of co and ci
near the sources in molecular clouds studies using more
realistic cloud morphologies and star formation distributions will calculate more accurate ionization rates in the
clouds
finally we note that the cr flux in molecular clouds
also affects the cloud temperature as some of the cr
energy goes into heating the gas consequently clouds
with significant cr ionization are also warmer by  3050 k bisbas et al 2017 gaches  offner 2018 higher
temperatures increase the thermal pressure of the gas
which may inhibit star formation mckee  ostriker
2007
43 comparison with prior models
several studies have used analytical models to predict
the cr ionization rate in protostellar cores gaches 
offner 2018 calculated the cr attenuation and resulting ionization rates in protostellar cores using a simple
radial density profile they calculated the ionization
for free streaming propagation ie assuming the crs
are not coupled to a magnetic field and for diffusive cr
propagation which corresponds to a turbulent magnetic
field their fiducial model considered a 05 m star and
accretion rate of  14  105 m yr see their equation 4 which is similar to our mp45 03 high model
the offner  chaban 2017 simulations we use as inputs assume an initially uniform field in the z direction which imposes a degree of order even with the gas
turbulence so free streaming is a reasonable approxi

22

fitz axen et al

mation for our calculations with  2  00 for this
model they computed   1014 s1 at n  1021 cm2 
which drops to   1019 s1 at the edge of the core
where n  1023 cm2 see their figure 11 as can be
seen in figure 11 the average values we measure are
between  1019 s1 and 1016 s1  so our results are
roughly consistent with those computed by gaches 
offner 2018 however figure 11 also demonstrates
that the cr ionization rate can vary substantially at
a given radius and column density when asymmetries
due to the magnetic field gas structure and outflow are
considered
silsbee  ivlev 2019 derived analytical solutions for
the attenuation of the cr ionization rate including energy losses as a function of effective column density
their solutions assume a bulk magnetic field b0 x and
a turbulent magnetic field bx the inputs of their
model include the properties of the initial cr spectrum
and loss function appendix c2 provides further details of their model modified to account for the spherical geometry of our problem we compare their analytic
model to our monte carlo calculations we compute the
average radial density profile for both of our grids and
derive what the silsbee  ivlev 2019 solutions for the
ionization rate would be given our initial spectra we
also perform calculations using this radially averaged
density which should give the same results we expect
these curves to be similar but not necessarily equal to
the average ionization rates we compute for our grids
shown by the curves in figure 9
figure 15 shows the results of this test as can be
seen the solutions are within a factor of a few of each
other however the green points demonstrate that at
each radius we compute a wide range of ionization rate
values that are not captured by the silsbee  ivlev
2019 model or by other studies which take a radial
density profile the ranges of ionization rates that we
compute at each radius shown by the green shading
are all greater than five orders of magnitude this test
shows that while our calculations give similar average
results as other models they provide a more nuanced
view of the ionization rates in different regions around
the star
44 caveats
our simulations make some approximations that may
impact our results for one thing the properties of the
protostellar disk are not resolved to account for cr
energy losses in the innermost regions of the core we
use the maximum resolution grid with xamr  26 au
to compute the radial attenuation of the cr spectrum
out to rstart  0001 pc this resolution does not re

solve the circumstellar disk density and magnetic field
cr propagation in the disk may cause a nonradially
symmetric cr spectrum at rstart  with lower fluxes of
crs in regions near the disk due to energy losses inside
the disk offner et al 2019 this could affect the angular distribution of ionization rates shown in figure 10
especially at smaller radii and cause lower ionization
rates throughout the core
as discussed in section 222 our treatment of the
two component magnetic field is less accurate than resolving the turbulence as some other studies do eg
giacalone  jokipii 1999 fraschetti et al 2018 our
method is less computationally expensive but it is an
approximation of the behavior of particles in the presence of magnetic fields using the path length to sample
the particle step size is a reasonable approximation over
solving the full lorentz equation as the gyroradius is
orders of magnitude smaller than the path length however by not resolving the turbulence we are forced to
choose the direction of travel statistically figures 12
13 and 14 show the qualitative effects that low and high
amounts of turbulence can have on particle propagation
and ionization throughout the core furthermore as described in appendix c our code reproduces the correct
solution in the free streaming and diffusion limits further studies are needed will show how well the quantitative results approximate the full numerical treatment
additionally our treatment of turbulence only accounts for spatial diffusion of the crs momentum diffusion is included in many cr propagation codes and
causes cr reacceleration strong  moskalenko 1998
if the gas is strongly supersonic ms  1 and superalfvnic ma  1 then it may be able to reaccelerate
crs significantly to relativistic energies for both of
our grids the radially averaged values of the sonic and
alfvnic mach numbers had upper limits of ms  2 and
ma  07 for r  002 pc respectively and less then
10  of the gas in the core was both supersonic and
superalfvnic therefore we do not expect there to be
efficient reacceleration of crs in most of the core
our model also does not account for the effects of cr
energy deposition which may modify the turbulence in
the gas to examine how this would impact the outcome of the gas in the orion calculations we computed
the radially averaged cr energy density and gas kinetic
energy density throughout the core we found that
ke cr  10  105  which indicates that the energy
budget of the crs is not high enough to significantly alter the outcome of the gas however it is large enough
to damp out the smallest scales of the turbulent energy
which may develop at lower scales than the resolution
of the offner  chaban 2017 simulations assuming

23

protostellar crs

figure 15 average ionization rate as a function of radius for t  03 myr and t  05 myr dark blue curves use the densities
in our grids light blue curves show numerical results using the radially averaged density profile in each grid black curves
show the silsbee  ivlev 2019 model solutions using this density profile and our input loss function and cr spectra green
points show the maximum and minimum values of any angular bin at a given radius

that the turbulence roughly follows a kolmogorov power
spectrum ke k  k 53  with a numerical viscosity
that is roughly the size of a grid cell the cr energy
would damp the turbulent energy at  1100th of the
cell length this provides reassurance that the viscosity
set by the grid scale of the mhd simulations is only a
couple orders of magnitude higher than the true viscosity set by crs and small scale turbulence is unlikely to
significantly alter the evolution of the magnetic field in
the mhd simulations
additionally our code assumes time independence
under this assumption the initial cr spectrum at the
accretion shock is the same for all times and the speed
at which the particles of different energies propagate
does not effect our results clearly this assumption is
not true as protostars undergo changes in their mass
radius and accretion rate which affect the initial cr
spectrum however the timescales for cr propagation
are much less than that for accretion the time for a
particle traveling at speed c100c to cross a grid cell of
0001 pc is  0003  03 years or  1100 days while
small flickering in the accretion rate can occur on the
timescales of days episodic accretion is characterized by
variations that occur on timescales of months to years
audard et al 2014 this timescale is also less than the
dynamical timescale of the gas to cross one cell which
is approximately a year therefore time independence
is a reasonable assumption for our calculations

finally our results are limited by the boundary conditions we impose for our grid we discuss this further
in appendix a1
5 conclusions

in this work we use a monte carlo cosmic ray transport code to investigate the propagation of cosmic rays
accelerated by protostellar accretion shocks in protostellar cores in order to account for realistic physical
asymmetries we postprocess simulations of turbulent
magnetized protostellar cores which include protostellar outflows the turbulence is modeled using a statistical method that samples the particle travel direction and step size as a function of the turbulent power
parametrized by  2  bb0 2  we calculate the ionization rate as a function of both radius and solid angle
around the star we explore the effect of varying the accretion properties and amount of turbulence in the core
on the cr propagation and resulting ionization rates
the cr flux is nonuniform when there is negligible
subgrid turbulence in the core and is focused in the direction of the outflow which is similar to the flashlight
effect observed for photons yorke  sonnhalter 2002
cunningham et al 2011 this creates elevated cr ionization rates in the outflow region we find that at a
given distance from the star the average ionization rate
in the outflow can be up to an order of magnitude higher
than the ionization rate averaged over all angular bins at

24

fitz axen et al

that radius the maximum ionization rates calculated
at a given radius can be up to two orders of magnitude
or higher than the average at that radius
our results are sensitive to the accretion rate and
other stellar parameters a two order of magnitude
range in the accretion rate causes differences in the ionization rates in the core by up to two orders of magnitude in contrast to the stellar parameters varying
 2 by two orders of magnitude increases the uniformity
of the cr distribution and changes the shape of the
spectrum but does not have a significant effect on the
resulting ionization rates the increased scattering of
the cr particles with higher turbulence enhances the
flux at high energies and decreases it at low energies
offsetting the net impact on the ionization rate

for our fiducial calculations the radially averaged ionization rates throughout the core are not as high as the
measured value for the milky way of   1016 s1 
due to attenuation by the dense gas however within
r  004 pc the maximum ionization rates exceed the
measured milky way value throughout most of the
core the maximum ionization rates exceed 1017 s1 
which is the value often assumed in astrochemistry studies
in summary our calculations suggest protostellar
cores with low levels of turbulence have nonuniform cr
fluxes that produce a broad range of ionization rates
this has important implications for the chemistry of
molecular clouds protostellar cores and accretion disks
we conclude that accurate models of cr propagation
must take into account the geometry of the magnetic
field and gas density

appendix

a resolution limitations

a1 grid boundary conditions
our results are limited by the boundary conditions we impose for our grid in this section we investigate the impact
of the domain size on our results figures 13 and 17 show the cr ionization rate out to 01 pc roughly the size of the
core however this distance is close to the edge of the grid so we stop tracking cr propagation once the crs reach
this radius consequently they cannot scatter back and increase the ionization as they would if the grid were much
larger we can use results calculated at a smaller radius to evaluate how accurate our results are with this caveat
for each value of  2 and lc  105 pc we compute the ionization rate out to rtest  0025 pc with three different
values for the maximum radius of propagation rbound  we test rbound  rtest  0025 pc rbound  2rtest  005 pc
and rbound  4rtest  01 pc the tests with rbound  rtest are analogous to the results we present in figures 9 and
13 while the other two calculations offer insights into how the chosen grid boundary impacts the ionization rates
figure 16 shows the results for  2  001 and  2  10 for each value of  2 the curves are within a factor of a few
of each other out to r  rtest 2  00125 pc past this radius the curves with rbound  rtest start to decline further
but the discrepancy is still less than an order of magnitude at r  45rtest  002 pc from these results we conclude
that the results in figures 13 and 17 are accurate to within a factor of a few out to r  005 pc and we plot our
results at r  005 pc using solid lines for r  005 pc we use dashed lines to indicate regions where scattering
may increase the ionization rates and the curve represents a lower limit
a2 number of particles
statistical counting errors are inherent in monte carlo methods in our fiducial runs with  2  00 this effect is
negligible because there is only random sampling for the initial particle directions and the rest of the particles motion
is dictated by the bulk magnetic field for  2  00 sampling the particle direction and step size creates a source of
statistical noise that may effect our results for the particle flux and ionization rates around the star
for each of our simulations we use np e  103 particles starting in each energy bin which gives a total particle count
of n  5  104 particles here we demonstrate that this is enough particles to achieve convergence in our results for
the ionization rate in different regions of the core we analyze our results for t  03 myr using  2  0 and lc  105
pc our highest turbulence run using different values of np e  we define the relative error in the ionization rate as
2000 np e   np e   2000 2000 where 2000 is the ionization rate for np e  2  103 particles we calculate this
quantity for the average ionization rate in the outflow and the maximum ionization rates computed over the whole
grid as these quantities have fewer particle counts and consequently are more sensitive to changes in np e than the
radial average ionization rate

protostellar crs

25

figure 16 left ionization rate for three different values of rbound  using lc  105 pc at t  03 myr right relative error
in the outflow and maximum ionization rates where the reference value is np e  2  103 particles the model adopts the
simulation at t  03 myr using lc  105 pc and  2  10

the right panel of 16 shows our results as can be seen the average ionization rates computed in the outflow region
are not very sensitive to np e  all values of np e  tested have an uncertainty in the outflow ionization rate of less
than 100  throughout the core and 103  has an uncertainty of less than 50  throughout the core computing an
ionization rate in a single angular bin such as for the maximum ionization rates shown by the green points have a
higher uncertainty this is in part a function of how many solid angle bins we use and the uncertainty would be lower
if we use fewer bins for our grid 103   1 at the edge of the core corresponding to a factor of two discrepancy
all the same given the magnitude of the uncertainties in our setup this is a minor effect
b impact of the correlation length

in this section we explore the impact of the value of the correlation length on our results as discussed in section
233 the value of the correlation length of turbulence in molecular clouds is uncertain but the limitations of our
sampling require that we test parameters that give path lengths roughly the size of a grid cell or smaller for the
simulations presented in figure 13 we test lc  105 pc which fits this criteria for our particle energy range we
also run our simulations for lc  104 pc which produces path lengths that approach the cell size but is still small
enough to give accurate results
figure 17 shows the average ionization rates at t  03 myr and t  05 myr for different values of the turbulent power
 2 using lc  104 pc the ionization rates have the same features as most curves in figure 13 show increasing
 2 decreases the maximum ionization rate computed at each radius but has little effect on the radially averaged
ionization rates compared to  2  0 this makes intuitive sense when considering equation 16 a larger correlation
length decreases the effect of the turbulence meaning that we would expect even less change for these simulation runs
from the  2  0 case than is shown in figure 13
if we tested our simulations with a small enough value of the correlation length our results would show similar
features to the  2  1 curve in the left panel of figure 13 because of the increase in turbulence however because of
the computational expense of such a calculation we leave this for another study
c analytical solution tests

many cr propagation codes treat the propagation of cr particles as being either completely free streaming or
completely turbulent to test these limits we modify the way the particles chose the direction of their next step

26

fitz axen et al

figure 17 average ionization rate as a function of radius for t  03 myr and t  05 myr using lc  104 pc turbulent
power is indicated by the shade of blue maximum values of any angular bin at a given radius are shown by the green points
with larger dots symbolizing more turbulence dashed lines and translucent points at r  005 pc indicate the region where
our results may be uncertain due to our simulation boundary conditions the gray line indicates   1016 s1  which is the
measured ionization rate for the milky way

for the free streaming tests all direction changes are turned off so that the particles propagate away from the star
following their initial velocity direction for the diffusion tests we set the particles to always sample their direction
randomly rather than sometimes following the direction of the bulk magnetic field to set the value of sc  we test
 2  001  2  01 and  2  10 using lc  105 pc and b0 x  100g in every cell even though we set a uniform
value of b0 x in every cell in order to obtain a nonzero value of sc  the direction of it is irrelevant for these tests
and thus its implementation differs from our normal grid setup
we test each case using np e  103 particles the solutions for the attenuation are simple and can be derived
analytically if particle energy losses are turned off we test this scenario first to benchmark our calculations with a
model that includes energy losses we use the model developed by silsbee  ivlev 2019
c1 solutions without energy losses
the simplest tests we perform are for free streaming and diffusive transport where we do not allow the particles to
lose energy as is described in section 32 in these limits the attenuation of the cr flux with radius can be derived
analytically and follows a power law je r  jin er  the values of  are fr  2 and dr  1 for free streaming
and diffusion respectively since the flux is uniformly attenuated at all energies the ionization rate is also attenuated
radially by r2 and r1 for free streaming and diffusion for these tests we compute the particle trajectories only out
to r  104 pc because the diffusion tests are computationally expensive with a small value of sc  for each case we
compute the radial ionization rate following equation 20 the left panel of figure 18 shows that our code correctly
reproduces the analytic solution in these limits
c2 solutions with energy losses
we also compare the results of our code in the free streaming and diffusive limits to the model presented in silsbee
 ivlev 2019 modified to account for the spherical geometry of this test problem for these tests we compare our
results to exact solutions for the free streaming and diffusive ionization rates the models take as inputs a powerlaw
exponent of the initial cr spectrum a and a powerlaw exponent of the energy loss function b as discussed in
section 23 the powerlaw exponent for our initial cr spectrum is a  19 we use the same loss function as silsbee 

27

protostellar crs

figure 18 left ionization rate for free streaming and diffusion with no energy losses dashed lines show comparisons to
fr  2 and dr  1 which are the analytic solutions for cr attenuation in these limits right relative error in the ionization
rate   n  a a  for free streaming and diffusion with energy losses where a is to the analytic model developed by
silsbee  ivlev 2019

ivlev 2019 which follows b  082 in the energy range that is important for ionization  01 mev 1 gev padovani
et al 2018
the solutions for the attenuation of the ionization rate with column density are functions of the column density
n  in order to compare to the analytical solutions we adopt a uniform density of nh2   107 cm3  in this case
n r  nh2 r the solution for the ionization rate for free streaming propagation is given by
1 1  2b j0 l0 e0 if
fs r 
4r2 a  2b




nh2 r
n0f

 ab1
1b 


c1

e0
where   37 ev if  107a  b  1  042 and n0f  l0 1d
 we choose a reference value of e0  1 mev and
j0 and l0 are the values of the initial cr spectrum and loss function at e0  the solution for the ionization rate for
diffusive propagation is also a function of the power of the turbulence  2  it is given by

1
diff   r 
nh2 
2

z

emax

e0

z

emax

e 0 e



1
0
4ke  e  32




j0

e0
e0

a


exp

r2
4ke 0  e  



dede 0 

c2

where   76  b for a kolmogorov spectrum and
1

k

d0 e0

nh2 v0 l0

c3

where d0  sc e0 v0 3 is the diffusion coefficient at e0 
for these tests we propagate the particles out to rcore  001 pc and compute the radial ionization rate the right
panel of figure 18 shows the relative error in the ionization rate as defined   n  a a  where n and a are
the numerical solution and the analytic solution respectively all values of n have a relative error of less than 75
throughout the core for all values of  2  given the orders of magnitude involved in our calculations throughout this
study we consider our results in good agreement with the analytic solution

28

fitz axen et al
acknowledgments

this work was supported by the us department of energy through the los alamos national laboratory los alamos
national laboratory is operated by triad national security llc for the national nuclear security administration of
us department of energy contract no 89233218cna000001 this research was supported in part by the national
science foundation under grant no nsf phy1748958 and by nasa atp grant 80nssc20k0507 this material
is based upon work supported by the us department of energy office of science office of advanced scientific
computing research department of energy computational science graduate fellowship under award number desc0021110 we thank an anonymous referee for helpful comments that improved the manuscript

references
ainsworth r e scaife a m m ray t p et al 2014
apjl 792 l18
amato e 2014 international journal of modern physics
d 23 1430013
anglada g rodrguez l f  carrascogonzlez c
2018 astronomy and astrophysics review 26 3
artigau  kouach d donati jf et al 2014 in
society of photooptical instrumentation engineers
spie conference series vol 9147 groundbased and
airborne instrumentation for astronomy v ed s k
ramsay i s mclean  h takami 914715
audard m brahm p dunham m m et al 2014 in
protostars and planets vi ed h beuther r s klessen
c p dullemond  t henning 387
bacmann a lefloch b ceccarelli c et al 2003 apjl
585 l55
bai xn 2016 apj 821 80
bai xn ostriker e c plotnikov i  stone j m
2019 the astrophysical journal 876 60
httpsdoiorg1038472f153843572fab1648
balbus s a  hawley j f 1991 apj 376 214
bally j 2016 araa 54 491
berezhko e g 2008 the astrophysical journal letters
684 l69
bisbas t g papadopoulos p p  viti s 2015 apj
803 37
bisbas t g van dishoeck e f papadopoulos p p
et al 2017 apj 839 90
bolatto a d wolfire m  leroy a k 2013 araa
51 207
brnken s sipil o chambers e t et al 2014
nature 516 219
bykov a m marcowith a amato e et al 2020
ssrv 216 42
caselli p vastel c ceccarelli c et al 2008 aa 492
703
ceccarelli c dominik c lpezsepulcre a et al 2014
the astrophysical journal letters 790 l1

cleeves l i bergin e a qi c adams f c 
berg k i 2015 apj 799 204
crapsi a caselli p walmsley c m et al 2005 apj
619 379
crimier n ceccarelli c lefloch b  faure a 2009
aa 506 1229
cunningham a j klein r i krumholz m r 
mckee c f 2011 apj 740 107
dalgarno a 2006 proceedings of the national academy of
science 103 12269
donati j f bouvier j walter f m et al 2011
mnras 412 2454
drury l o 1983 reports on progress in physics 46 973
drury l o ellison d e aharonian f a et al 2001
ssrv 99 329
dutrey a semenov d chapillon e et al 2014 in
protostars and planets vi ed h beuther r s klessen
c p dullemond  t henning 317
emprechtinger m caselli p volgenau n h stutzki j
 wiedner m c 2009 aa 493 89
fatuzzo m  adams f c 2014 apj 787 26
favre c ceccarelli c lpezsepulcre a et al 2018
the astrophysical journal 859 136
fiedler r a  mouschovias t c 1993 the
astrophysical journal 415 680
fitz axen m speicher j hungerford a  fryer c l
2021 mnras 500 3497
flower d r pineau des forts g  walmsley c m
2006 aa 449 621
fontani f palau a caselli p et al 2011 aa 529 l7
fontani f ceccarelli c favre c et al 2017 aa 605
a57
fraschetti f drake j j cohen o  garraffo c 2018
apj 853 112
fryer c l liu s rockefeller g hungerford a 
belanger g 2007 apj 659 389
gaches b a l  offner s s r 2018 apj 861 87

protostellar crs
gaches b a l offner s s r  bisbas t g 2019a
apj 878 105
 2019b apj 883 190
gaches b a l walch s offner s s r  mnker c
2020 apj 898 79
gammie c f 1996 apj 457 355
giacalone j  jokipii j r 1999 apj 520 204
girart j m rao r  marrone d p 2006 science
313 812
glassgold a e najita j  igea j 1997 apj 480 344
glover s c o  clark p c 2012 mnras 426 377
 2016 mnras 456 3596
glover s c o clark p c micic m  molina f
2015 mnras 448 1607
harding j p fryer c l  mendel s 2016 apj 822
102
harju j pineda j e vasyunin a i et al 2020 apj
895 101
hartmann l herczeg g  calvet n 2016 araa
54 135
hosokawa t offner s s r  krumholz m r 2011
apj 738 140
houde m hull c l h plambeck r l vaillancourt
j e  hildebrand r h 2016 apj 820 38
houde m rao r vaillancourt j e  hildebrand
r h 2011 apj 733 109
houde m vaillancourt j e hildebrand r h
chitsazzadeh s  kirby l 2009 apj 706 1504
indriolo n  mccall b j 2012 apj 745 91
indriolo n neufeld d a gerin m et al 2015 the
astrophysical journal 800 40
ivlev a v rcker t b vasyunin a  caselli p
2015 apj 805 59
jimnezserra i vasyunin a i caselli p et al 2016
apjl 830 l6
johnskrull c m 2007 apj 664 975
johnstone c p jardine m gregory s g donati
j f  hussain g 2014 mnras 437 3202
kim m k hirota t honma m et al 2008 pasj 60
991
kirk h friesen r k pineda j e et al 2017 apj
846 144
kong s caselli p tan j c wakelam v  sipil o
2015 apj 804 98
kong s tan j c caselli p et al 2016 apj 821 94

29

krumholz m r mckee c f  klein r i 2004 in
astronomical society of the pacific conference series
vol 323 star formation in the interstellar medium in
honor of david hollenbach ed d johnstone f c
adams d n c lin d a neufeeld  e c ostriker
401
lee j w y hull c l h  offner s s r 2017 apj
834 201
li p s martin d f klein r i  mckee c f 2012
apj 745 139
lpezsepulcre a taquet v snchezmonge  et al
2013 aa 556 a62
lpezsepulcre a sakai n neri r et al 2017 aa
606 a121
httpsdoiorg10105100046361201630334
mckee c f  ostriker e c 2007 araa 45 565
morlino g 2017 highenergy cosmic rays from
supernovae ed a w alsabti  p murdin 1711
morlino g  gabici s 2015 mnras 451 l100
myers p c fuller g a goodman a a  benson
p j 1991 apj 376 561
nutter d  wardthompson d 2007 mnras 374
1413
offner s s r bisbas t g bell t a  viti s 2014
mnras 440 l81
offner s s r bisbas t g viti s  bell t a 2013
apj 770 49
offner s s r  chaban j 2017 apj 847 104
offner s s r gaches b a l  holdship j r 2019
apj 883 121
offner s s r klein r i mckee c f  krumholz
m r 2009 apj 703 131
padovani m galli d  glassgold a e 2009 aa
501 619
padovani m hennebelle p marcowith a  ferrire k
2015 aa 582 l13
padovani m ivlev a v galli d  caselli p 2018
aa 614 a111
padovani m marcowith a hennebelle p  ferrire k
2016 aa 590 a8
padovani m marcowith a snchezmonge  meng
f  schilke p 2019 aa 630 a72
padovani m ivlev a v galli d et al 2020 ssrv
216 29
pagani l lesaffre p jorfi m et al 2013 aa 551
a38
pagani l vastel c hugo e et al 2009 aa 494 623
papadopoulos p p thi w f  viti s 2004 mnras
351 147

30

fitz axen et al

pineda j e schmiedeke a caselli p et al 2020 apj
submitted
podio l lefloch b ceccarelli c codella c 
bachiller r 2014 aa 565 a64
preibisch t kim yc favata f et al 2005 apjs
160 401
rodgerslee d taylor a m ray t p  downes
t p 2017 mnras 472 26
rodrguezkamenetzky a carrascogonzlez c araudo
a et al 2017 the astrophysical journal 851 16
rudd m e 1991 phrva 44 1644
rudd m e kim y k madison d h  gallagher
j w 1985 reviews of modern physics 57 965

sanna a moscadelli l goddi c et al 2019
astronomy  astrophysics 623 l3
seifert r a ilsedore cleeves l adams f c  li
zy 2021 arxiv eprints arxiv210310971
shingledecker c n tennis j le gal r  herbst e
2018 apj 861 20
silsbee k  ivlev a v 2019 apj 879 14
silsbee k ivlev a v padovani m  caselli p 2018
apj 863 188
skinner s l guedel m koyama k  yamauchi s
1997 apj 486 886
strong a w  moskalenko i v 1998 apj 509 212
thomas t  pfrommer c 2019 mnras 485 2977
wakelam v herbst e loison j c et al 2012 the
astrophysical journal supplement 199 21
yorke h w  sonnhalter c 2002 apj 569 846

