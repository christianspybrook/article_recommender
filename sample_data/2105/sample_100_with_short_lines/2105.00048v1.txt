learning fluid physics from highly turbulent data using sparse physicsinformed
discovery of empirical relations spider
daniel r gurevich
program in applied and computational mathematics
princeton university princeton nj 08544 usa

patrick a k reinbold

arxiv210500048v1 physicsfludyn 30 apr 2021

data analytics and computational intelligence
lowes companies inc mooresville nc 28117 usa

roman o grigoriev
school of physics georgia institute of technology atlanta ga 30332 usa
dated may 4 2021
we show how a complete mathematical description of a complicated physical phenomenon can
be constructed from observational data via a hybrid approach combining three simple and general
ingredients physical assumptions of smoothness locality and symmetry a weak formulation of
differential equations and sparse regression to illustrate this we extract a complete system of governing equations describing flows of incompressible newtonian fluids  the navierstokes equation
the continuity equation and the boundary conditions  from numerical data describing a highly
turbulent channel flow in three dimensions the hybrid approach is remarkably robust yielding
accurate results for very high noise levels and should thus work equally well for a wide range of
experimental data in addition this approach provides easily interpretable information about the
relative importance of different physical effects such as viscosity as well as useful insight into the
quality of the data making it a useful diagnostic tool

physical theories are traditionally constructed in an iterative manner at each step discrepancies between predictions and existing experimental observations are used
to improve the theory making it more general and accurate these improvements are usually instructed and
constrained by first principles including both general and
domain knowledge after this new predictions are made
and new experiments are designed to test these predictions closing the loop humans play a key role in all
aspects of this traditional procedure and can become a
weak link when the amount of data becomes overwhelming or the patterns in the data are too complex
recent advances in machine learning have started to
change the scientific paradigm guiding the construction
of physical theories by gradually taking humans out of
the loop for lowdimensional systems physical relations
in the form of algebraic and even differential equations
can be constructed using symbolic regression directly
from experimental data without using any physical intuition 13 for highdimensional systems purely datadriven approaches become intractable and some physical intuition becomes necessary to guide the process 4
the question is therefore what physical considerations
can and should be used to constrain the problem sufficiently for the datadriven analysis to become tractable
while leaving enough freedom to enable identification of
physically meaningful relationships
for instance an equation describing the evolution of
momentum for a weakly turbulent flow in a thin layer of
fluid could be identified from either synthetic 5 or exper

imental data 6 after the form of the equation was constrained by a few extremely general physical constraints
smoothness locality and the relevant symmetries for
nonrelativistic systems the symmetries include translations in time and euclidean symmetry translations
rotations and reflections in space in fact many of
these constraints have been implicitly assumed in most
efforts to identify evolution equations from synthetic data
generated by a variety of canonical pdes 711 however evolution equations are just one type of a relation
that may be required to fully describe a physical process other examples include physical constraints such
as energy and mass conservation for an inviscid incompressible fluid or the curlfree condition for the electric
field in electrostatics as well as boundary conditions
in this letter we introduce a flexible datadriven approach for identifying a complete mathematical description of a physical system which we call sparse physicsinformed discovery of empirical relations spider we
illustrate spider by discovering the evolution equations constraints and boundary conditions governing
the flow of an incompressible newtonian fluid from noisy
data using only the assumptions of smoothness locality and symmetry to enable this the data have to
exhibit sufficient variation to sample the state space of
the physical problem 12 here this is accomplished by
using the numerical solution of a highreynolds number flow through a rectangular channel from the johns
hopkins university turbulence database 13 the data
set includes the flow velocity u and pressure p fully re

2

1

02

0

0

02

1
4

5

6

fig 1 snapshot of the spanwise velocity uz over a
portion of the entire domain sample integration
domains shown as dotted boxes near the edge of the
channel are much narrower than those in the center due
to the nonuniform grid spacing in the y direction

solved in space and time the channel dimensions are
lx  ly  lz  lt  8  2  3  26 in nondimensional units and the data are stored on a spatiotemporal
grid of size 2048  512  1536  4000 the viscosity is
  5  105 and the corresponding friction reynolds
number is re  1000 a representative snapshot of the
data is shown in figure 1
the immense size of the entire data set comprising
261013 measurements illustrates the challenges faced
by a purely datadriven approach the locality property
radically reduces the number of possible functional relations between measurements by constraining these to a
small spatiotemporal neighborhood of a given point in
particular for smooth continuous fields such functional
relations have to be expressed in terms of their values and
partial derivatives for systems that are invariant with
respect to spatial and temporal translation a functional
relation can be expressed in the form of volterra series
x

cn fn  0

1

n

where cn are coefficients and fn are multiplicative functions of the fields and their partial derivatives for systems with translational symmetry in space and time the
most general relations of this type are nonlinear partial
differential equations pdes with constant coefficients
most prior work focused on evolution equations which
are special cases of 1 where c1  1 and f1 is the firstorder temporal derivative of one of the fields other
special cases include differential equations that do not

involve temporal derivatives and algebraic relations between the fields that involve no derivatives at all
our aim here is to identify a parsimonious mathematical model of the flow in the form of a system of pdes
involving the velocity and pressure fields u and p with
appropriate boundary conditions the key observation
here is that the form of the functional relations 1 can
be restricted sufficiently using the rotational symmetry
constraint all terms fn have to transform in the same
way under rotations and reflections with the transformation rule corresponding to a particular representation
of the rotational symmetry group for instance for nonrelativistic systems the symmetry group involves rotations about any axis in threedimensional space with the
representations corresponding to tensors of various ranks
here we will restrict our attention to the two lowest rank
tensors ie scalars and vectors although the same approach is trivially extended to tensors of any rank
in the present problem the data consist of a scalar
field p and a vector field u the differential operators
that transform as a scalar and a vector respectively are
t and  using these objects we can construct tensors
of any rank as tensor products for instance the terms
u t u and p all transform as vectors to illustrate
the procedure we will restrict the terms fn to be at most
cubic in p u t  and  which yields a scalar equation
c1 p  c2   u  c3 t p  c4 p2  c5 u2
 c6 u  p  c7 2 p  c8 t p2   c9 t2 p
2

2

2

 c10 p  u  c11 u p  c12 t u   0
and a vector equation
c1 u  c2 t u  c3 p  c4 pu  c5 u  u  c6 2 u
 c7 t2 u  c8 u2 u  c9 p2 u  c10 p2   c11 u  u
 c12 u2  c13   u  c14 pt u  c15 ut p  0
3
reflection symmetry ensures that pseudovectors such as
  u do not appear in the latter equation these two
pdes will form the libraries of the candidate relations
describing fluid physics in the bulk it is straightforward
to expand these by including higherorder terms
parsimonious scalar and vector relations between velocity and pressure can be identified by performing sparse
regression using the libraries 2 and 3 respectively
terms involving higherorder derivatives such as 2 p
and 2 u can be very sensitive to noise 9 14 which
is present in any experimental measurements to make
the regression more robust we use the weak form of both
pdes following the approach introduced in our earlier
work 15 specifically we multiply each equation by
a smooth weight function wj x t and then integrate
it over a rectangular spatiotemporal domain k of size
hx  hy  hz  ht cf table i the derivatives are
shifted from the data u and p onto the weight func

3
hx
hy
hz
ht
edge 13 27 150 34 15 33 14 38
center 13 27 15 32 15 33 14 38

table i dimensions of the integration domains k in
physical units and grid points in parentheses

tions wj whenever possible via integration by parts after which the integrals are evaluated numerically using
trapezoidal quadratures for equation 2 we use scalar
weight functions of the form
wj x t  wj1 xwj2 wj3 zwj4 t
wl s  s2  1 pl s

4

where pl is the lth legendre polynomial and the bar denotes nondimensionalization relative to the size of the integration domain eg x  2x  xk hx  here we chose
l  0 or 1 for each of the coordinate directions yielding
2d1 different weight functions for an integration domain
with one temporal and d spatial dimensions we choose
  6 to i ensure that all the boundary terms vanish
after integration by parts and ii increase the accuracy
of numerical quadrature 15 to integrate 3 we instead use vector weight functions wji x t  wj x t for
i  1     d varying over the indices of the spatial dimensions resulting in a total of d 2d1 different weight
functions
by repeating this procedure for a number of integration domains k centered at different locations and for
different weight functions wj  the problem of determining
the unknown coefficients c  c1      cn  is recast as the
solution of an overdetermined linear system of the form
qc  0

5

where q  q1    qn  and the columns qn correspond to
the integrals of the terms fn in 1 we sampled the data
using 30 rectangular domains chosen to lie either in the
center or at the edge of the channel as shown in fig 1
and randomly distributed in the spanwise z streamwise
x and temporal directions yielding 30  2d1 linear
equations on the coefficients cn in 2 and 30d  2d1
linear equations on the coefficients in 3
solutions of 5 have a degree of freedom corresponding to the normalization of c which is conventionally
eliminated by setting one of the coefficients say c1  to 1
however we generally cannot guarantee that any given
term is present in the correct sparse model instead we
treat all of the terms on even footing and compute c
as the right singular vector of q corresponding to the
smallest singular value in fact this is the solution of a
constrained least squares problem for qt qc  0
c  arg min kqt qck
kck1

6

it is worth noting that when multiple singular values of
q are small there may be several good solutions for c
in order to obtain a parsimonious model we must find
a sparse coefficient vector c such that the residual kqc k
is comparable to the residual kqck with c given by 6
if the parsimonious model contains multiple terms it can
usually be identified by an iterative greedy algorithm at
each iteration we use the singular value decomposition
of qn   q1    qn  to find cn  as described previously we also compute the residual  n   kqn  cn  k
next we consider all of the candidate models formed
by dropping one of the terms and eliminating the corresponding column from qn   we select the candidate
model with n  1 terms that achieves the smallest residual and then repeat until only one term remains this
yields a sequence of increasingly sparse models described
by n dimensional coefficient vectors cn forming an approximately pareto optimal set 16
there are many reasonable ways to select a final model
from this collection based on the tradeoff between their
parsimony ie number of terms n  and accuracy quantified by the residuals  n   for instance one might select
the simplest model which achieves a relative residual of
less than say 1 or the model for which discarding a
single term results in the largest relative increase in the
residual in this letter we follow ref 15 specifically
we choose the model described by the coefficient vector
cn  where n  maxn   n  n1   where the parameter   3 was selected empirically this procedure
was repeated for 10 replications with random choices of
domain locations and for noisy data realizations of noise
in order to verify that the results are reproducible
to test the effects of noise on the results of sparse
regression in addition to the original simulation data we
also used synthetic data with varying levels of additive
white gaussian noise specifically we define the noisy
data by p  p  n1 sp and u  u   diagn2 su 
where  is the scalar noise level ranging from 0 to 50
n1 and the three components of n2 are independently
sampled standard normal random variables at each point
in space and time and sp and su are the sample standard
deviations of the pressure and each component of the flow
velocity computed across the original dataset
figure 2 illustrates the sparsification of the vector relation 3 for a representative distribution of integration
domains with d  3 both near the wall of the channel
and in the center the residual  remains nearly constant
until only four or five terms remain and grows quickly
when more terms are discarded in the noiseless case
shown in figure 2a the magnitude of the residual for
n  5 is essentially determined by the discreteness of the
data both in the numerical simulations and in evaluating
the integrals using quadratures 15 in the noisy case
shown in figure 2b the magnitude of the residual is
determined by the level of noise and is higher than in the
noiseless case as expected however qualitatively the

4

1

1

101

101

euler
navierstokes

10

2

10

3

10

4

10

navierstokes

2

augmented ns
103

1

5

10

9

a

4

1

5

9

b

fig 2 dependence of the residual kqck on the number of terms n retained in the vector relation 3 for a
noiseless data and b data with 50 noise black white squares represent data collected near the edge in the
middle of the channel the models selected by the greedy algorithm in each case are shown by the arrows

dependence of  on the number of terms n remaining in
the model is the same in all of the cases
the relations selected by the greedy algorithm are
summarized in table ii which shows the surviving terms
fn  their coefficients cn  and the respective contributions
of different terms in each relation the table also shows
the standard deviation of the coefficients found across different replications for data from the edge of the channel
sparse regression consistently identifies the navierstokes
equation with correct coefficients including the viscosity
 for noise levels up to at least 50 for data from the
middle of the channel with low noise up to 4 sparse
regression yields the navierstokes equation with an additional linear term which is discussed further below
for more noisy midchannel data with  up to 48 the
euler equation also with correct coefficients is reconstructed instead
while the greedy sparsification algorithm was found
to be wellsuited for identifying relations involving multiple terms it fails for singleterm relations this difficulty which is not adequately addressed by past sparse
regression literature is illustrated well by the regression
problem for the scalar library 2 the data describe an
incompressible fluid for which
u0

7

as a result the terms   u u  u and   u in
2 all have very small magnitudes and are thus quickly
discarded from the library by the greedy algorithm for
this reason we start by computing the magnitude kqn k
of each term which equals the residual of the corresponding singleterm model comparing kqn k with the residual
 for the identified multiterm model allows determination of whether the parsimonious relation should include
one or several terms with this enhancement spider

correctly identified the continuity equation 7 from the
scalar library 2 for data from either the edge or the
center of the channel across all replications and for all
noise levels up to the maximum   50
spider can also be used to discover boundary conditions in this case the rotational symmetry is partially
broken instead of rotations in all three spatial directions the problem is only invariant with respect to rotations about the normal n to the boundary the library
of terms that transform as vectors near the boundary include n in addition to u and  we exclude time derivatives because these can be eliminated with the help of
the bulk equations we also exclude the dependence on p
to keep the library to a reasonable size this dependence
is trivial to restore retaining terms that contain each
of u and  at most once yields a vector equation
c1 u  c2 n  c3 u  nn  c4 u  n
 c5 n  u  c6 n  u  0

8

next we separate the normal and tangential components
by applying the projection operators p  nn and pk 
1  nn to the library 8 where nn represents the tensor
product of the normals we eliminate all terms which
have identically vanishing projections furthermore we
can also eliminate all terms involving   u since we have
already identified the continuity equation 7
since the boundary conditions only hold on the solid
walls y  1 each projection of the relation 8 is integrated over rectangular 2  1dimensional domains k
of size hx  hz  ht constrained to one of the walls
respectively the weight functions wj are constructed as
products of three onedimensional functions wl s where
s  x z or t note that the derivatives of the data
with respect to the wallnormal y coordinate cannot be
eliminated using integration by parts in this case instead

5

t u u  u
p
2 u
cn 0 0999
1
0995 493  105
50 1002
1
0989 497  105
4
4
sn 0 410
810
1103
6108
3
3
3
50 710
810
810
1106
n 0 0905
1
0407
0487
50 0908
1
0405
0489


t u u  u
cn 0 1000
1
48 1000
1
sn 0 2104 2104
48 1102 1102
n 0 0987
1
48 0986
1

a

p
2 u
u
1000 526105 00022
0998
0
0
3104
4107
7106
3102
0
0
00528
00027
00065
00529
0
0
b

table ii vector relations identified from data with different noise levels described by  a near the edge of the
channel and b in the center the rows show the mean values of the coefficients cn  their standard deviation sn 
and the magnitudes of terms n  kcn fn k normalized relative to the largest term

we evaluate them directly using finite differences for all
noise levels up to the maximum   50 valid singleterm boundary conditions were always identified specifically for the normal component two equivalent relations
p u  p u  nn  u  n  0 are identified for the
tangential component pk u  0 is identified these can
be combined into the algebraically simplest boundary
condition u  0 which is the wellknown noslip boundary condition
as we have shown physicallyinformed sparse regression can successfully identify a complete quantitatively
accurate mathematical model of the fluid flow using a
tiny fraction of the available data even when the data
are extremely noisy in fact at low noise levels such
a model can be identified using only a single integration
domain in the bulk and its projection onto the boundary
provided sufficiently many weight functions are used in
particular the noslip boundary condition u  0 and
the incompressibility condition 7 are always correctly
identified
the most general vector relation identified is a generalization of the navierstokes equation
t u  u  u  p  2 u  u  0

9

with some nonnegative  and  the last two terms may
or may not be identified depending on the sampled region
of the flow and the magnitude of noise in the dataset
the term 2 u represents the effect of viscosity which
is wellknown to play an important role in the boundary
layer as reflected by its large relative magnitude n 
05 in that region in fact in the boundary layer the
greedy algorithm selects the navierstokes equation for
any level of noise with all of the terms having comparable
magnitudes as shown in table ii
in the center of the channel the effect of viscosity is
negligible due to the lack of smallscale structures so the
flow is described quite accurately by both the navierstokes and the euler equation indeed in that region
of the flow the dominant balance is between the terms
t u and u  u while the viscous term is more than
two orders of magnitude smaller the linear term u is
similarly small it is then not surprising that at higher

noise levels the greedy algorithm discards both the viscous and the linear term yielding the euler equation
the unexpected observation is the presence of the linear term u which does not appear in the navierstokes
equation in the relation identified from midchannel data
with low levels of noise this term is larger in magnitude
than the viscous term and is reliably identified by the
greedy algorithm regardless of the distribution of the integration domains or noise realization suggesting that it
is not spurious the sign of  indicates that this term
is destabilizing unlike the viscous term indicating a numerical instability in the simulation used to generate the
data the computational grid is nonuniform in y and
is coarsest in the middle of the channel which explains
why numerical instability is found there but not near the
wall of the channel
in conclusion it should be noted that other physical relations can also be identified using the approach outlined
here for instance the energy equation can be derived
by multiplying the vector relation 9 by u it can also
be obtained from data by applying the greedy algorithm
to the scalar library 2 provided the latter is expanded
to include terms up to quadratic in both u and 
to summarize we have shown that a combination of
very general physical constraints weak formulation of
pdes and sparse regression yields an extremely powerful model discovery tool which we call spider it
allows one to identify complete and easily interpretable
quantitative mathematical models of continuum systems
not limited to evolution equations from even very noisy
data moreover spider provides information about the
relative importance of different physical phenomena and
can also serve as a valuable diagnostic tool for validating
and troubleshooting numerical simulations or experimental setups
this material is based upon work supported by nsf
under grants no cmmi1725587 and cmmi2028454

1 j p crutchfield and b s mcnamara equation of motion from a data series complex systems 1 417 1987

6
2 j bongard and h lipson automated reverse engineering of nonlinear dynamical systems proceedings of the
national academy of sciences 104 9943 2007
3 m schmidt and h lipson distilling freeform natural
laws from experimental data science 324 81 2009
4 a karpatne g atluri j h faghmous m steinbach
a banerjee a ganguly s shekhar n samatova and
v kumar theoryguided data science a new paradigm
for scientific discovery from data ieee transactions on
knowledge and data engineering 29 2318 2017
5 p a reinbold d r gurevich and r o grigoriev using noisy or incomplete data to discover models of spatiotemporal dynamics physical review e 101 010203
2020
6 p a reinbold l m kageorge m f schatz and r o
grigoriev robust learning from noisy incomplete highdimensional experimental data via physically constrained
symbolic regression nature communications 2021 to
appear arxiv210212006
7 m br r hegger and h kantz fitting partial differential equations to spacetime dynamics physical review
e 59 337 1999
8 d xu and o khanmohamadi spatiotemporal system
reconstruction using fourier spectral operators and struc

ture selection techniques chaos 18 043122 2008
9 s h rudy s l brunton j l proctor and j n kutz
datadriven discovery of partial differential equations
science advances 3 e1602614 2017
10 h schaeffer learning partial differential equations via
data discovery and sparse optimization proceedings of
the royal society a mathematical physical and engineering sciences 473 20160446 2017
11 m raissi and g e karniadakis hidden physics models
machine learning of nonlinear partial differential equations journal of computational physics 357 125 2018
12 h schaeffer g tran and r ward extracting sparse
highdimensional dynamics from limited data siam
journal on applied mathematics 78 3279 2018
13 johns hopkins turbulence database channel flow http
turbulencephajhueduchannelflowaspx
14 p a reinbold and r o grigoriev datadriven discovery of partial differential equation models with latent
variables physical review e 100 022219 2019
15 d r gurevich p a reinbold and r o grigoriev
robust and optimal sparse regression for nonlinear pde
models chaos 29 103113 2019
16 k miettinen nonlinear multiobjective optimization
vol 12 springer science  business media 2012

