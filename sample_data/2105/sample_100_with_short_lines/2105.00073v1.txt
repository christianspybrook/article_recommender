on numerical approximations of fractional and
nonlocal mean field games

arxiv210500073v1 mathap 30 apr 2021

indranil chowdhury olav ersland and espen r jakobsen

abstract we construct numerical approximations for mean field games with
fractional or nonlocal diffusions the schemes are based on semilagrangian approximations of the underlying control problemsgames along with dual approximations
of the distributions of agents the methods are monotone stable and consistent
and we prove convergence along subsequences for i degenerate equations in one
space dimension and ii nondegenerate equations in arbitrary dimensions we also
give results on full convergence and convergence to classical solutions numerical
tests are implemented for a range of different nonlocal diffusions and support our
analytical findings

contents
1 introduction
2 assumptions and preliminaries
3 discretisation of the mfg system
4 convergence to the mfg system
5 on the sl scheme for the hjb equation
6 on the dual sl scheme for the fpk equation
7 proof of convergence  theorem 41 and 43
8 numerical examples
appendix a proof of proposition 34
appendix b proof of lemma 56 ii and iii
appendix c proof of lemma 69
acknowledgements
references

1
4
8
13
17
22
28
30
34
34
35
36
36

1 introduction
in this article we study numerical approximations of mean field games mfgs with
fractional and general nonlocal diffusions we consider the mean field game system


in 0 t   rd 
 ut  lu  hx du  f x mt
1
mt  l m  divmdp hx du  0
in 0 t   rd 


ut x  gx mt  m0  m0
in rd 
where
z
2

lx 
z0



x  z  x  1z1 dx  z dz

2020 mathematics subject classification 35q89 47g20 35q84 49l12 45k05 35k61 65m12
91a16 65m22 35r11  35r06
key words and phrases mean field games jump diffusion anomalous diffusion nonlocal operators
fractional pdes nonlocal pdes degenerate pdes semilagrangian scheme convergence compactness
fokkerplanck equations hamiltonjacobibellman equations duality methods
1

2

i chowdhury o ersland and e r jakobsen

is a nonlocal diffusion operator possibly degenerate  is a lvy measure see assumption 0 and the adjoint l is defined as l  l2   ll2 for    cc rd 
the first equation in 1 is a backward in time hamiltonjacobibellman hjb equation with terminal data g and the second equation is a forward in time fokkerplanckkolmogorov fpk equation with initial data m0  here h is the hamiltonian and the
system is coupled through the cost functions f and g there are two different types
of couplings i local couplings where f and g depend on point values of m and ii
nonlocal or smoothing couplings where they depend on distributional properties induced
from m through integration or convolution here we work with nonlocal couplings
a mathematical theory of mfgs were introduced by lasrylions 49 and caines
huangmalhame 44 and describes the limiting behavior of n player stochastic differential games when the number of players n tends to  18 in recent years there
has been significant progress on mfg systems with local or no diffusion including eg modeling wellposedness numerical approximations long time behavior convergence of nash equilibria and various control and game theoretic questions see
eg 5 27 18 13 39 43 and references therein the study of mfgs with nonlocal
diffusion is quite recent and few results exist so far stationary problems with fractional laplacians were studied in 30 and parabolic problems including 1 in 33 and
37 we refer to 48 and references therein for some development using probabilistic
methods
the difference between problem 1 and standard mfg formulations lies in the type of
noise driving the underlying controlled stochastic differential equations sdes usually
gaussian noise is considered 49 51 20 26 5 or there is no noise the first order case
17 19 here the underlying sdes are driven by pure jump lvy processes which
leads to nonlocal operators 2 in the mfg system in many real world applications
jump processes model the observed noise better than gaussian processes 9 50 34
54 prototypical examples are symmetric stable processes and their generators the

fractional laplace operators 4 2  in economy and finance the observed noise is not
symmetric and stable but rather nonsymmetric and tempered a typical example is
c
gz  m z 
the onedimensional cgmy process 34 where d
for c g m 
dz z  z1y e
0 and y  0 2 such models are covered by the results of this article our assumptions
on the nonlocal operators cf 1 are quite general allowing for degenerate operators
and no restrictions on the tail of the lvy measure 
there has been some development on numerical approximations for mfg systems
with local operators finite difference schemes for nondegenerate second order equations
have been designed and analyzed eg by achdou et al 1 2 3 4 7 8 6 and gueant
40 42 41 semilagrangian sl schemes for mfg system have been developed by
carlinisilva both for first order equations 23 and possibly degenerate second order
equations 24 other numerical schemes for mfgs include recent machine learning
methods 28 29 52 for high dimensional problems we refer to the survey article 6
for recent developments on numerical methods for mfg we know of no prior schemes
or numerical analysis for mfgs with fractional or nonlocal diffusions
in this paper we will focus on sl schemes they are monotone stable connected
to the underlying control problem easily handles degenerate and arbitrarily directed
diffusions and large time steps are allowed although the sl schemes for hjb equations
have been studied for some time see eg 38 16 14 35 there are few results for fpk
equations but see 25 and the coupled mfg system for nonlocal problems we only
know of the results in 15 for hjb equations
our contributions
a derivation we construct fully discrete monotone numerical schemes for the
mfg system 1 these dual sl schemes are closely related to the underlying control

approximation of nonlocal mfgs

3

formulation of the mfg in our case it is based on the following controlled sde
dxt  t dt  dlt 
where t is the control and lt a pure jump lvy process cf 6 note that lt can
be decomposed into small and large jumps where the small jumps may have infinite
intensity we derive our approximation in several steps
1 approximate small jumps the small jumps are approximated by brownian motion
see 7 following eg 10 15 36 this is done to avoid infinitely many jumps per
timeinterval and singular integrals and gives a better approximation compared to
simply neglecting these terms
2 sl scheme for hjb we discretise the resulting sde from step 1 in time and approximate the noise by random walks and approximate compound poisson processes in
the spirit of 15 section 31 from the corresponding discrete time optimal control
problem dynamic programming and interpolation we construct an sl scheme for
the hjb equation section 32
3 approximate control we define an approximate optimal feedback control for the
sl scheme in step 2 from the continuous optimal feedback control as in 23 24

 dp h dud  where ud is a regularization of the interpolated solution
approx
from step 2 section 33
4 dual sl scheme for fpk the control of step 3 and the scheme in step 2 define
a controlled approximate sde with a corresponding discrete fpk equation for the
densities of the solutions we explicitly derive this fpk equation in weak form and
obtain the final dual sl scheme taking test functions to be linear interpolation basis
functions section 34
see 18 and 24 in section 3 for the specific form of our discretizations these seem
to be the first numerical approximations of mfg systems with nonlocal or fractional
diffusion and the first sl approximations of nonlocal fpk equations our dual sl
schemes are extensions to the nonlocal case of the schemes in 23 24 25 but a clear
derivation of such type of schemes seems to be new the schemes come in the form of
nonlinear coupled systems 27 that need to be resolved numerically we prove existence
of solutions using fixed point arguments see proposition 34
b analysis we establish a range of properties for the scheme including monotonicity consistency stability discrete regularity convergence of individual equations and
convergence to the full mfg system
1 hjb approximation for the approximation of the hjb equation we prove pointwise consistency and uniform discrete l  lipschitz and semiconcavity bounds
convergence to a viscosity solution is obtained via the half relaxed limit method
12
2 fkp approximation we prove consistency in the sense of distributions preservation of mass and positivity l1 stability tightness and equicontinuity in time in
dimension d  1 we also prove uniform lp estimates for all p  1  convergence
is obtained from compactness and stability arguments
3 the full mfg approximation we prove convergence along subsequences to viscosityvery weak solutions of the mfg system in two cases i degenerate equations in
dimension d  1 and ii nondegenerate equation in rd under the assumption that
solutions of the hjb equation are c 1 in space full convergence follows for mfgs
with unique solutions and convergence to classical solutions follows under certain
regularity and weak uniqueness conditions applying the results to the setting of
37 we obtain full convergence to classical solutions in this case
because of the nonlocal or smoothing couplings the hjb approximation can be analysed almost independently of the fkp approximation the analysis of the fkp scheme

4

i chowdhury o ersland and e r jakobsen

on the other hand strongly depends on boundedness and regularity properties of solutions of the hjb scheme compactness in measure is enough in the nondegenerate case
when the hjb equation has c 1 solutions while stronger weak  compactness in lp
for some p  1  is needed in the degenerate case as in 23 we are only able to
prove this latter compactness in dimension d  1 a priori estimates and convergence
for p  1  seems to be new also for local mfgs
in this paper we study general lvy jump processes and nonlocal operators this
means that the underlying stochastic processes may not have first moments whatever
initial distribution we take like eg stable processes with   1 and then we can no
longer work in the commonly used wasserstein1 space p1  d1  for the fkp equations
instead we work in the space p d0  of probability measures under weak convergence
metrizised by the rubinsteinkantorovich metric d0 see section 2 surprisingly a
result from 31 proposition 61 allow us to prove tightness and compactness in this
space without any moment assumptions we refer to section 43 for a more detailed
discussion along with convergence results in the traditional p1  d1  topology when first
moments are available
this p d0  setting can be adapted to local problems to give results also there without
moment assumptions finally we note that our results for degenerate problems cover the
first order equations and improve 23 in the sense that more general initial distributions
m0 are allowed p  lp for some p  1  instead of p1  l for some   0
c testing we provide several numerical simulations in example 1 and 2 we
use a similar setup as in 24 comparing the effects of a range of different diffusion
operators fractional laplacians of different powers cgmydiffusions a degenerate
diffusion a spectrally onesided diffusion as well as classical local diffusion and the case
of no diffusion in example 3 we solve the mfg system on a long time horizon and
observe the turnpike property in a nonlocal setting finally in example 4 we study the
convergence of the scheme
outline of the paper in section 2 we list our assumptions and state mostly known
results of the mfg system 1 and its individual hjb and fkp equations in section
3 we construct the discrete schemes for the hjb fkp and full mfg equations from
the underlying stochastic control problemgame the convergence results are given in
section 4 along with extensions and a discussion section in sections 5 and 6 we analyze
the discretisations of the hjb and fkp equations respectively including establishing a
priori estimates stability and some consistency results using these results we prove
the convergence results of section 4 in section 7 in section 8 we provide and discuss
numerical simulations of various nonlocal mfg systems finally there are three appendices with proofs of technical results
2 assumptions and preliminaries
we start with some notation by c k we mean various constants which may change
from line to line the euclidean norm on any rd type space is denoted by    for
any subset q  rd or q  0 t   rd  and for any bounded possibly vector valued
function on q we will consider lp spaces lp q and spaces cb q of bounded continuous
functions often we use the notation k  k0 as an alternative notation for the norms in
cb or l  the space cbm q is the subset of cb q with m bounded and continuous
derivatives and for q  0 t   rd  cblk q is the subset of cb q with l bounded and
continuous derivatives in time and k in space by p rd  we denote the set of probability
measure on rd  the kantorovichrubinstein distance d0 1  2  on the space p rd  is
defined as
nz
o
d0 1  2  
sup
f xd1  2 x 
rd
f lip11 rd 

approximation of nonlocal mfgs

5

n
o
where lip11 rd   f  f is lipschitz continuous and kf k0  kdf k0  1  we define the
legendre transform l of h as

lx q  sup p  q  hx p 
prd

we use the following assumptions for equation 1
0 lvy condition  is a positive radon measure that satisfies
z
1  z2 dz  
rd

1 growth near singularity there exists constants   0 2 and c  0 such
that the density of  for z  1 satisfies
0

d
c
 d  for z  1
dz
z

l0 continuity and local boundedness the function l  rd  rd  r is
continuous in x q and for any k  0 there exists cl k  0 such that
sup lx q  cl k

x  rd 

qk

l1 convexity and growth the function lx q is convex in q and satisfies
lim

q

lx q
 
q

x  rd 

l2 lipschitz regularity there exists a constant ll  0 independent of q
such that
lx q  ly q  ll x  y
l3 semiconcavity there exists a constant cl  0 independent of q such
that
lx  y q  2lx q  lx  y q  cl y2 
f1 uniform bounds there exists constants cf  cg  0 such that
f x   cf  gx   cg 

x  rd    p rd 

f2 lipschitz assumption there exists constants lf  lg  0 such that


f x 1   f y 2   lf x  y  d0 1  2  


gx 1   gy 2   lg x  y  d0 1  2  
f3 semiconcavity there exists constants cf  cg  0 such that
f x  y   2f x   f x  y   cf
gx  y   2gx   gx  y   cg
m initial condition we assume m0  p rd 
m the dimension d  1 and m0  p r  lp r for some p  1 
by l1 the legendre transform h  l is welldefined and the optimal q is q  
dp hx p to study the convergence of the numerical schemes we further assume local
uniform bounds on the derivatives of hamiltonian
h1 the function dp h  crd  rd  and for every r  0 there is a constant
cr  0 such that for every x  rd and p  br we have dp hx p  cr 

6

i chowdhury o ersland and e r jakobsen

h2 the function dp h  c 1 rd rd  for every r  0 there exists a constant
cr  0 such that for every x  rd and p  br we have
dpp hx p  dpx hx p  cr 
remark 21 we impose most of the conditions on l and not on h as l appears in
optimal control problem which would be the basis of our semilagrangian approximation assumptions l1 and l2 but not l3 would immediately carry forward to
the corresponding hamiltonian h from the definition of legendre transform whereas
we require to assume h1h2 on h in contrary to the other assumptions as it does
not follow from the condition on l in general however when the lagrangian l behaves
like   r in q variable for large q and r  1 the growth of the corresponding hamiltonian
r
h would be    r1 in p variable for large p cf 32 proposition 21 the growth of
the derivatives of h for large p can be computed similarly which would correspond to
similar condition as in h1h2
in most of this paper solutions of the hjb equation in 1 are interpreted in the
viscosity sense we refer to 46 and references therein for general definition and wellposedness results while solutions of fpk equation in 1 are considered in the very weak
sense defined as follows
definition 22 a if u  cb01 0 t   rd  a measure m  c0 t  p rd  is a very
weak solution of the fpk equation in 1 if for every   cc rd  and t  0 t 
z
z
x dmtx 
x dm0 x
rd
rd
3
z tz 


lx  dp hx du  dx dmsxds
0

rd

b if u  l 0 t  w 1 rd  and p  1  a function m  c0 t  p rd  
lp 0 t   rd  is a very weak solution of the fpk equation in 1 if 3 holds for
every   cc rd  and t  0 t 
remark 23 inequality 3 holding for every   cc rd  and t  0 t  is equivalent to
z
z
t x dmt x 
0 x dm0 x
rd

rd

z

t

z


0




t s x  ls x  dp hx du  ds x dmsxds

rd

holding for every   cb12 0 t   rd  cf 31 lemma 61
definition 24 a pair u m is a viscosityvery weak solution of the mfg system 1
if u is a viscosity solution of the hjb equation and m is a very weak solution of the
fpk equation see definition 22
proposition 25 fix   c0 t  p rd  let 0 l2 and f1 hold
a comparison principle if u is a viscosity subsolution and v is a viscosity supersolution of the hjb equation in 1 with ut   vt  then u  v
b there exists a unique bounded viscosity solution u  cb 0 t   rd  of the hjb
equation in 1 and for any t  0 t  we have kutk0  cf t  cg 
c if l2 and f2 hold then the viscosity solution u is lipschitz continuous in space
variable and for every t  0 t  and x y  rd we have

ut x  ut x  y  t ll  lf   lg y

approximation of nonlocal mfgs

7

in addition if l3 and f3 hold then u is semiconcave in space variable and for every
t  0 t  and x y  rd we have

ut x  y  ut x  y  2ut x  t cl  cf   cg y2 
proof these results are by now standard a follows by a similar argument as for
46 theorem 31 b follows by eg perrons method and c by adapting the comparison arguments of 46 in a standard way we omit the details under some extra
assumptions b and c also follows from theorem 54 and lemma 53 below

proposition 26 assume 0 1 h1 and m
a if u  c0 t  cb1 rd  then there exists a very weak solution m  c0 t  p rd 
of the fpk equation in 1
b if d  1 u  c0 t  w 1 r u semiconcave and m holds then there exists
a very weak solution m  c0 t  p r  lp 0 t   r of the fpk equation in 1
moreover kmtklp r  ect km0 klp r for some constant c  0 and t  0 t 
proof the results follow from the convergence of the discrete scheme in this article
the proof of a follows the proof of theorem 43 setting duh  du the proof of
b follows the proof of theorem 41 and theorem 67 setting duh  du note that
semiconcavity of u is crucial for the the lp bound of theorem 67

existence and uniqueness results are given in 37 for classical solutions of mfgs with
nonlocal diffusions under additional assumptions
2 growth near singularity there exists constants   1 2 and c  0 such
that the density of  for z  1 satisfies
d
c

 for z  1
zd
dz
f4 there exists constants cf  cg  0 such that kf  mkcb2  cf and
kg mkcb3  cg for all m m  p rd 
f5 f and g satisfy monotonicity conditions
z
f x m1   f x m2  d m1  m2  x  0

m1  m2  p rd 

rd

z
g x m1   g x m2  d m1  m2  x  0

m1  m2  p rd 

rd

h3 the hamiltonian h  c 3 rd  rd  and for every r  0 there is cr  0

such that for x  rd  p  br    nn
0    3 then d hx p  cr 
h4 for every r  0 there is cr  0 such that for x y  rd  u  r r  p 
rd  h x u p  h y u p   cr p  1 x  y
h5 uniform convexity there exists a constant c  0 such that
2
dpp
h x p  cid 

1
c id



m the probability measure m0 has a density also denoted by m0  m0  cb2 
theorem 27 assume 0 1 2 f2 f4 h3h4 and m
a there exists a classical solution u m of 1 such that u  cb13 0 t   rd  and
m  cb12 0 t   rd   c0 t  p rd 
b if in addition f5 and h5 hold then the classical solution is unique

8

i chowdhury o ersland and e r jakobsen

this is a consequence of 37 theorem 25 and theorem 26 we refer to 37 for
more general results where in particular assumptions 1 and 2 can be relaxed to
allow for a much larger class of nonlocal operators l in the nondegenerate case for the
individual equations in 1 we also have uniqueness of viscosityvery weak solutions and
existence of classical solutions uniqueness for hjb equations and existence for hjb
and fpk equations follows by theorem 53 theorem 55 and proposition 68 in 37
we prove uniqueness for very weak solutions of fpk equations here
proposition 28 uniqueness for the fpk equation assume 0 1 2 and
dp hx dut  cb02 0 t   rd  then there is at most one very weak solution of the
fpk equation in 1
proof let m
 1  m2 be two very weak solutions define m  m1  m2 and take any
  cc rd  for any   0 t  the terminal value problem
t   l  d  dp hx du  0

in rd  0  

and x    x

in rd 

has a unique classical solution   cb12 0    rd  essentially by 37 theorem 55
the result follows from proposition 58 with k  2 and the observation that the proof
of theorem 55 also holds for k  2 using the definition of very weak solution see
remark 23 we get
z
z z

t   l  d  dp hx du dmtx dt  0
x dm x 
rd

rd

0

for any   0 t  since  was arbitrary it follows that m   0 in p rd  for every
  0 t  and uniqueness follows

3 discretisation of the mfg system
to discretise the mfg system 1 we first follow 15 and derive a semilagrange
approximation of the hjb equation in 1 using this approximation and the optimal
control of the original problem we derive an approximation of the fpk equation in 1
which is in approximate duality with the approximation of the hjbequation
this derivation is based on the following control interpretation of the hjb equation
for a fixed given density m   the solution u of the hjb equation in 1 is the value
function of the optimal stochastic control problem

4
ut x  inf j x t  


where t is an admissible control j is the total cost to be minimized
z t 



j x t   e
lxs  s   f xs  s ds  gxt  t  
5
t

and xs 

xsxt


6

solves the controlled stochastic differential equation sde
r
r
dxs  s ds  z1 z  dz ds  z1 zn dz ds s  t
xt  x

where n a poisson random measure with intensitylvy measure dzds and  
n dz ds  dzds is the compensated poisson measure1
31 approximation of the underlying controlled sde
1the n integral is just a difficult way of writing a compound poisson jumpprocess while the
 integral is a centered jump process with an infinite number of small jumps per time interval as
9

approximation of nonlocal mfgs

9

a approximate small jumps by brownian motion first we approximate small jumps
in 6 by vanishing brownian motion2 cf 10 for r  0 1 let xs  xsxt solve

r
dxs  bs ds  r dws  zr zn dz ds s  t
7
xt  x
where ws is a standard brownian motion bs    s  br  and
z
br 
8
z dz
rz1

12
 z
1
t
zz dz

r 
2 zr

9

the last integral in 7 is a compound poisson process cf eg 9 for any t  0
z tz
10

zn dz dt 
0

zr

nt
x

jj

j1

where the number of jumps up to time t is nt  poissontr  the jumps jj j are iid
rvs in rd with distribution r and j0  0 and for r  0 1
z
11
r   1zr
and
r 
r dz
rd

the infinitesimal generators l and l of the sdes 6 and 7 are cf 9
l x  t    l1 x  l1 x

l x  bt   x  tr rt  d2 x  r  lr x
for   cb2 rd  where
12

lx  lr x  lr x
z

z



x  z  x  1z1 dx  z dz
zr

zr

the operator l is an approximation of l 
lemma 31 47 if 1 holds and   cb3 rd  then for lr and r defined in 12
and 9 respectively we have

lr x  tr rt  d2 x  r   cr3 kd3 k0 
if in addition   cb4 rd  and the lvy measure  is symmetric then

lr x  tr rt  d2 x  r   cr4 kd4 k0 
t
b time discretization of the approximate sde fix a time step h  n
 0 1 for some
n  n and discrete times tk  kh for k  0 1     n  following 15 we propose
the following eulermaruyama discretization of the sde 7 let xntl x  xttnl x  where
xn  xntl x solves


xl  x



d

 x
m
13
xn  xn1  hbn1   h
rm n1
 n  l  ni  1     l  ni1  1


m1


x
x
j 
lni1

2

lni1 1

i

to avoid singular integrals and infinite number of jumps per time interval

10

i chowdhury o ersland and e r jakobsen

here the control n is constant on each time interval rm is the mthcolumn of r  and
n  n1      nd  is a random walk in rd with

1

p ni  1 
2d
the processes jk and nk defines an approximation of the compound poisson part of 7
through equation 10 where nt is replaced by an approximation
t  maxk  t1  t2      tk  t
where exponentially distributed waiting times time between jumps are replaced by
approximations tk kn 3 tk  hnk  hnk  nk1  where nk    n  0
n0  0 and nk iid with approximate hr exponential distribution given by
pnk  j  ehr j

for j  0 1 2    

then for pj  p nk  j p0  0 and
pj  p nk  j  1  pp
nk  j 
p

ejhr ehr  1 for j  0 we find that j0 pj  1 and enk   j0 ejhr 
ehr

ehr 1

note that in each time interval approximation 13 either diffuses the second
equation or jumps the third equation and that we have ignored the unlikely event of
more than one jump per time interval for the scheme to converge we will see that we
need to send both h  0 and hr  0 in this case enk    and the jumps become
less and less frequent and the random walk dominates the evolution of xk which is to
be expected
32 semilagrangian approximation of the hjb equation
a control approximation of the hjb equation we approximate the control problem
4  6 by a discrete time control problem define the value function

14
h tl  x  inf jh x tl  n  
n 

where the controls n  are piecewise constant in time the cost function jh is given by
15


 nx
1 


jh x tl  n   e
lxn  n   f xn  tn  h  gxn  tn  
nl

and the controlled discrete time process xn  xntl x is the solution of 13 by the
discrete time dynamic programming principle it follows that
x

lp 

tl x
h tl  x  inf e
lxntl x  n   f xntl x  tn  h  h tlp1  xlp1
 
n

nl

for l  p  1  n  taking p  0 and computing the expectation using conditional
probabilities the probability to jump in a time interval is p1  1  ehr  we find a
discrete time hjb equation

d
h ehr x

h tl  x  inf hf x tl   hlx  
h tl  h x  hb  hdrm 

2d m1
z
iff

 1  ehr
16
 h tl  h x  hb  hdrm  
h tl  h x  zdz 
r
zr
3in the new model  still gives the number of jumps up to time t
t

approximation of nonlocal mfgs

11

b interpolation and the fully discrete scheme for   0 we fix a grid g  i  i  zd 
and a linearmultilinear g interpolation i for functions f  g  r
x
17
if x 
f xi i x
x  rd 
izd

where the j s are piecewise linearmultilinear basis functions satisfying
x
j  0 j xi   ji 
j x  1 and ki  k0  kd2 k0 2
j

for any   cb2 rd  a fully discrete scheme is then obtained from 16 as follows
18

ik   shr k1  i k k  n

and in   gxi  tn 

where

shr v i k  inf


19

hf xi  tk   hlxi   

1  ehr
r

z
ivxi  zdz
zr


d



ehr x 
m
m

ivxi  hb  hdr   ivxi  hb  hdr  
2d m1

finally we extend the solution of the discrete scheme ik  to the whole rd  0 t 
by linear interpolation in x and piecewise constant interpolation in t
x

20 h t x  i  ht   x 
i x i ht   for any t x  0 t   rd 
izd

33 approximate optimal feedback control
for the hjb equation in 1 satisfied by the value function 4 it easily follows that
the optimal feedback control is
t x  dp hx dut x
based on this feedback law we define an approximate feedback control for the discrete
time optimal control problem 1315 in the following way for h    0 and t x 
rd  0 t 
21

num t x  dp hx dh t x

where h  is given by 20
h t x  h t    x

r
and the mollifier  x  1d  x for 0    cc rd  with rd xdx  1 we state a
standard result on mollification
22

lemma 32 if u  w 1 rd    0 and u  u    then u  cb rd  and there
exists a constant c  0 such that for all   0
ku  uk0  kduk0 

and

kdp u k0  c kduk0 1p for any p  n

by construction we expect num to be an approximation of the optimal feedback
control for the approximate control problem with value function 14 when h   are
small and h is close to u
34 dual sl discretization of the fpk equation

12

i chowdhury o ersland and e r jakobsen

a dual approximation of the fpk equation first note that if xs  xs0z0 solves
6 with t  0 and x0  z0  a rv with distribution m0  then the fpk equation for
m  lawxs  is

mt  l m  divm  0
m0  m0 
setting   num  this equation becomes an approximation of the fpk equation in 1
with this choice of  we further approximate m by the density mk  lawxk  of the
approximate process xk  xk0z0 solving 13 with l  0 and x0  z0 
we now derive a fpk equation for mk which in discretised form will serve as our
approximation of the fpk equation in 1 to simplify we consider dimension d  1
by definition of mk 
z
exk1  
x dmk1 x
r

for   cb rd  and k  n  0 let ak be the event of at least one jump in tk  tk1 
ie ak    nk1   nk   1 where nk is the random jump time defined in
section 31 b then by the definition of xk in 13 the fact that nk  jk  and k are
iid and hence independent of xk  and conditional expectations we find that
z
x dmk1 x  exk1 
r

 exk1 ack  p ack   exk1 ak  p ak 

 ehr exk  hbnum   hr k   1  ehr exk  ji 
z



ehr
x  hbnum   hr   x  hbnum   hr  mk dx

2
r
z z
dz
 1  ehr 
x  z
mk dx
r
r zr

r
let ei  xi  2  xi  2  mjk  ej mk dx we approximate the above expression
r
by a midpoint quadrature approximation ie ej f xmk dx  f xj mjk  then by
choosing x  j x linear interpolant for j  z and using j xi   ji we get a
fully discrete approximation
mjk1 

x

mik

h ehr 
2

iz




j xi  hbnum  

1  ehr
r

z

hr   j xi  hbnum  




hr 

i
j xi  zdz 

zr

in arbitrary dimension d we denote
23

 



hdrp 
jkp  xj  h hp xj  dh tk  xj   br 

for j  zd  k  0     n  p  1     d redefining ei  xi  2 1 1d and reasoning
as for d  1 above we get the following discrete fpk equation

x

mik1  
mjk  bhr hp  dh i j k


zjzd
24



dm0 x
 mi0
ei

approximation of nonlocal mfgs

13

where
bhr hp  dh i j k 



25

d


er h x 
 
i 



i
jkp
jkp
2d p1

z
1  er h
i xj  zdz 

r
zr

the solution is a probability distribution on g  hnh  where nh  0     n 
lemma 33 let mik  bepthe solution of 24 if m0  p rd  then mik i  p zd 
ie mik  0 i  zd  and jzd mjk  1 for all k  nh 
proof first note that mik  0 follows directly from
p the definition of the scheme and
mi0  0 changing the order of summation and as i bhr hp  dh i j k  1
we find that
x
xx
x
mik1 
mjk bhr hp  dh i j k 
mjk 
i

i

j

the result follows by iteration since

j

p

j

mj0  1



we extend mik  to rd by piecewise constant interpolation in x and then to 0 t 
by linear interpolation in t for t  tk  tk1  and k  nh 
tk1  t 
t  tk 
26
mh tk1  x 
mh tk  x
mh t x 
h
h
p
where mh tk  x  1d izd mik  1ei x note that mh   c0 t  p rd 
and the duality with the linear in xconstant in t interpolation used for h in 20
35 discretisation of the coupled mfg system
the discretisation of the mfg system is obtained by coupling the two discretisations
above by setting   mh  with this choice and u   and m  m we get the
following discretisation of 1

uik  shr mh uk1  i k






 uin  gxi  mh tn 
27
p


mik1  jzd mjk bhr hp  duh i j k




r

mi0  ei dm0 x
where shr  bhr  uh  mh are defined above
the individual discretisations are explicit but due to the forwardbackward nature
of the coupling the total discretisation is not explicit it yields a nonlinear system
that must be solved by some method like eg a fixed point iteration or a newton type
method
the approximation scheme 27 has a least one solution
proposition 34 existence for the discrete mfg system assume 0 1 l1
l2 f1f2 h1 and m then there exist a pair uh  mh  solving 27
the proof of this result is nonconstructive and given in appendix a
4 convergence to the mfg system
in this section we give the main theoretical results of this paper various convergence
results as h   r  0 under cflconditions the proofs will be given in section 7 and
require results for the individual schemes given in sections 5 and 6

14

i chowdhury o ersland and e r jakobsen

41 convergence to viscosityvery weak solutions we consider degenerate and
nondegenerate cases separately for the degenerate case the convergence holds only in
dimension d  1
theorem 41 degenerate case d  1 assume 0 1 l1l3 f1f3
h1h2 m uh  mh h0 are solutions of the discrete mfg system 27
if n  hn  n  rn  0 under the cfl conditions


2n hn
hn
  
hn  rn
n

 o1 then

i un hn n is precompact in cb 0 t   k for every compact set k  r
ii mnn hn n is sequentially precompact in c0 t  p r and a in l1 weak if
p  1  in m or b in l weak  if p   in m
iii if u m is a limit point of un hn  mnn hn n  then u m is a viscosityvery
weak solution of the mfg system 1
note that mh  is precompact in c0 t  p rd  just by assuming m for the
initial distribution but in the degenerate case this is not enough for convergence of
the mfg system due to lower regularity of the solutions of the hjb equation no
longer c 1  therefore we need assumption m and the stronger compactness given by
theorem 41ii part a or b this latter result we are only able to show in d  1
in arbitrary dimensions we assume more regularity on solutions of the hjb equation
in 1
u let um be a viscosity solution of the hjb equation in 1 for any m 
c0 t  p rd  and t  0 t  umt  c 1 rd 
remark 42 assumption u holds in nondegenerate cases eg under assumption
2 see theorem 27 and the discussion below
we have the following convergence result in arbitrary dimensions
theorem 43 nondegenerate case assume 0 1 l1l3 f1f3 h1
h2 u m uh  mh h0 are solutions of the discrete mfg system 27 if
n  hn  n  rn  0 under the cfl conditions


2n hn
hn



h n rn
n

 o1 then

i un hn n is precompact in cb 0 t   k for every compact set k  rd 
ii mnn hn n is precompact in c0 t  p rd 
iii if u m is a limit point of un hn  mnn hn n  then u m is a viscosityvery
weak solution of the mfg system 1
these results give compactness of the approximations and convergence along subsequences to be precise by part i and ii there are convergent subsequences and by
part iii the corresponding limits are solutions of the mfg system 1
we immediately have existence for 1
corollary 44 existence of solutions of 1 under the assumptions of either theorem
41 or 43 there exists a viscosityvery weak solution u m of the mfg system 1
if in addition we have uniqueness for the mfg system 1 then we have full convergence of the sequence of approximations
corollary 45 under the assumption of either theorem 41 or theorem 43 if the
mfg system 1 has at most one viscosityvery weak solution then the whole sequence
un hn  mnn hn n converges to a limit u m which is the unique viscosityvery weak
solution of the mfg system 1
42 convergence to classical solutions in the case the individual equations are
regularising we can get convergence to classical solutions of the mfg system to be
precise we need

approximation of nonlocal mfgs

15

1 weak uniqueness of individual pdes the hjb equation have unique viscosity solutions and the fpk equation have unique very weak solutions
2 smoothness of individual pdes both equations have classical solutions
this means that viscosityvery weak solutions of the mfg system automatically by
uniqueness for individual equations are classical solutions if in addition
3 classical uniqueness for mfg classical solutions of the mfg system are
unique
we get full convergence of the approximate solutions to the solution of the mfg system
we now give a precise result in the setting of 37 see theorem 27 in section 2 for
existence and uniqueness of classical solutions of 1
corollary 46 assume 02 l1l3 f1f4 h3h4 and m let
uh  mh  be solutions of the discrete mfg system 27 if n  hn  n  rn  0 under
the cfl conditions


2n hn
hn



hn rn
n

 o1 then

un hn  mnn hn n
d

a
has a convergent subsequence in the space cbloc 0 t   rd  
c0 t  p r  and any limit point is a classicalclassical solution of 1
b if in addition f5 and h5 hold then the whole sequence in a converges to the
unique classicalclassical solution u m of 1
proof 1 assumption u holds by theorem 27 and then by theorem 43 there is
a convergent subsequence un hn  mnn hn n such that un hn  mnn hn   u m and
u m is a viscosityvery weak solution of 1
2 since m  c0 t  p rd  the viscosity solution u is unique by proposition 25
b see also 37 theorem 53 hence it coincides with the classical cb13 0 t   rd 
solution given by 37 theorem 55
3 now dp hx dut  cb2 rd  by part 2 and h3 and then by proposition 28 there
is at most one very weak solution of the fpk equation hence it coincides with the
classical cb12 0 t   rd  solution given by 37 proposition 68
4 in addition if f5 and h5 hold there is a most one classical solution u m by
theorem 27 b
5 this shows compactness smoothness and uniqueness that all convergent subsequences of un hn  mnn hn n have the same limit and thus the whole sequence
converges to u m the unique classical solution of 1

43 extension and discussion
extension to more general lvy operators the results of theorem 41 and 43
hold under much more general assumptions on the lvy operator l in 37 they use
0 together with the assumptions
z
z
z
2
2
1

0
1  r
z d  r
zd  r
d  c r  0 1
zr

rz1

rz1

0

2  there are   1 2 and k  0 such that the heat kernels k and k of
l and l satisfy for k  k  k  k  0 kkt kl1 rd   1 and

1
1
kd kt klp rd   kt  1 p d
for t  0 t 
and any p  1  and multiindex   nd  0
where the heat kernel of the operator l is defined as the fundamental solution of the heat
equation t ulu  0 these assumptions cover lots of new cases compared to 0 1
and 2 new cases include i sums of operators satisfying 1 on subspaces spanning

16

i chowdhury o ersland and e r jakobsen

rd  having possibly different orders ii more general nonabsolutely continuous lvy
measures and iii lvy measures supported on positive cones an example of i cf
37 is
  2 d 2
  2 1 2







1      d  1 2
l 
x21
x2d
pd
dzi
which satisfies 10  with   mini i and dz 
i1 zi 1i j6i 0 dzj  this
is a sum of onedimensional fractional laplacians of different orders an example of
iii is given
r  by the spectrally positive fractional laplacian in one space dimension
lu  c 0 ux  z  ux  dux  z 1z1 z 1 dz
we have the following generalization of the wellposedness result for classical solutions
given in theorem 27
theorem 47 37 theorem 27 holds when you replace 1  2 by 10   20 
it follows that u holds whenever theorem 47 holds since 1 implies 10  and
the integrals in 10  are what appear in the different proofs it is easy to check that
all estimates in this paper are true for lvy measures satisfying 10  instead of 1
this means that under assumption 10  and 20  we have the following extensions of
theorems 41 and 43 and corollary 46
theorem 48 theorem 41 holds when you replace 1 with 10 
theorem 49 theorem 43 holds when you replace 1  2 by 10   20 
corollary 410 corollary 46 holds when you replace 1  2 by 10   20 
the wasserstein metric d1 versus our metric d0  the typical setting for the
fpk equations in the mfg literature seems to be the metric space p1 rd  d1  that
is the 1wasserstein space w1 of probability measures with finite first moment this
is also the case in 25 where convergence results are given for sl schemes for local
nondegenerate mfgs in rd  in this paper we can not assume finite first moments if
we want to cover general nonlocal operators an example is the fractional laplacian

 2 for   1 where the underlying stable process only has finite moments of
order less than  instead we consider the weaker metric space p rd  d0  which is
just a metrization of the weak weak in cb  convergence of probability measures in
this topology we can consider processes probability measures and solutions of the fpk
equations that do not have any finite moments or any restrictions on the tail behaviour
of the corresponding lvy measures
of course under additional assumptions convergence in d0 implies convergence in d1 
lemma 411 if mn converges to m in p rd  d0  and mn and m has uniformly
bounded 1  moments for   0 then mn  m in p1 rd  d1 
convergence in p1 rd  53 definition 68 is by definition equivalent to weak convergence plus convergence of first moments and the result follows from eg proposition
11 and lemma 15 in 5
we then have the following version of theorem 41 and theorem 43
r
corollary 412 assume m0  p1 r rd b1 z1 dz   for some   0 and
the assumptions of theorem 41 and theorem 43 then the statements of theorem 41
and theorem 43 hold if we replace p d0  by p1  d1  in part ii
note that the number of moments of m is determined by the number of moments of
1z1  and m0  see eg the discussion in section 23 in 37 moreover if 1z1  has
at most  finite moments then lu is welldefined only if u has at most order  growth
at infinity hence in the nonlocal case there is duality between the moments of m and

approximation of nonlocal mfgs

17

the growth ofr u note that um will always be integrable which is natural since then eg
euxt  t  ux tmdx t is finite
in our case we assume no moments and have to work with bounded solutions u
on moments and weak compactness in lp in the degenerate case previous
results for semilagrangian schemes in the first order and the degenerate second order
case 23 24 cover the case m0  p1 r  l r which means that m0 has finite firstmoments our results assume m0  p r  lp r for p  1  and hence no moment
bounds and possibly unbounded m0  when p   we have weak compactness in l1
instead of weak compactness in l 
since our results in the degenerate case allows for l  0 they immediately give an
extension to this p  lp setting for the convergence results for first order problems of
23 moreover the same conditions arguments and results easily also holds in the local
diffusive case considered in 24
5 on the sl scheme for the hjb equation
we prove results for the numerical approximation of the hjb equation including
monotonicity consistency and different uniform a priori stability and regularity estimates using the halfrelaxed limit method 12 we then show convergence in the
form of vn hn n tn  xn   vt x where v is the viscosity solution of the continuous hjb equation let bg  be the set of all bounded functions defined on g 
theorem 51 assume 0 l1  h r  0   c0 t  p rd  and let shr 
denote the scheme defined in 18
i bounded control if   liprd  shr  i k has a minimal control and
  k where k only depends on kdx k0 and the growth of l as x  
ii monotonicity for all v w  bg  with v  w we have
shr v i k  shr w i k for all i  g  k  0     n  1
iii commutation by constant for every c  r and w  bg 
shr w  c i k  shr w i k  c for all i  g  k  0     n  1
assume also 1 and f2
n

2

iv consistency let n  hn  rn  0 under cfl conditions hnn  hrn  o1
n
grid points tkn  xin   t x and n    c0 t  p rd  such that n  
then for every   cc rd  0 t 

1 
tkn 1  xin sn hn rn n kn 1  in  kn 
lim
n hn


  t t x  inf lx   d    lx  f x t
rd

proof i since
h 

d


ehr x
ixi  hb  hrm   ixi  hb  hrm 
2d m1

is lipschitz in  maximum linear growth at infinity while lx  is coercive more
than linear growth at infinity by l1 there exists a ball br  where r depends on the
lipschitz constant of i and the growth of l such that the minimizing control  of
shr  i k belongs to br 
ii and iii follows directly from the definition of the scheme

18

i chowdhury o ersland and e r jakobsen

iv for ease of notation we write  h r  instead of n  hn  rn  n  a 4th order taylor
expansion of  gives


x  hb hdrm   x  dx  hb  hdrm 
 3
hd m t 2
h2

r  d xrm  d h 2 bt d2 xrm  bt d2 xb
2
2
x d x
x d  


hb  hd rm  
hb  hd rm  


3
4
r
r
for some   rd  using that b   rz1 zdz and by 1 rz1 zdz 
or1  we get that


28
x  hb  hdrm   x  hb  hdrm   2x
z

 2hdx    2h
dx  zdz  hdrm t  d2 x  rm  o h2 r22 


rz1
2
used that h2 bt d2 xb
3 33
2 1

is of order oh2 r22  the 3rd order terms are of orwe

der oh r
h r
 and the 4th order terms are of order  hdr 4  oh2 r42 
then the error of the taylor expansion is oh2 r22  using lemma 31
xi   shr  i k

d
ehr x 
 xi   inf hf xi  tk1   hlxi   
2xi   2hdxi   

2d m1
z

m t 2
m
 hdr  d xi r  2h
dxi   zdz
rz1


z
1  ehr
xi  zdz  o2   oh2 r22 

r
zr


29  hf xi  tk1   inf hlxi    hehr dxi     1  ehr xi 

z


 hehr lr xi   or3   hehr
dxi   zdz
rz1
hr



1e
r
r

z

xi  zdz  o2  h2 r22 

zr

using that zr z2 dz  kr2 by 1 for the small jump operator lr defined
in 12 we have
lr xi   ehr lr xi   hr r2 kd2 k0 
r
r
again as rz1 zdz  kr1 and z1 dz  k for the long jump operator
lr defined in 12 we have that
z
z
1  ehr
r
hr
xi  z  xi dz
l xi   e
dxi   zdz 
hr
zr
rz1


1  ehr  1
 k1  ehr r1 kdk0  k 1 
r
kdk0  kk0
hr


1
31
 k hr r
kdk0  hr kk0 
30

recalling that lxi   lr xi   lr xi  combining 29 with 30 and 31 we find


xi   shr  i k  hf xi  tk1   h inf lxi    dxi     hlxi 


approximation of nonlocal mfgs

19


 o h2 r  hr3  h2 r r1  2  h2 r22 
as r   cr  we have

tk  xi   tk1  xi 
1
tk1  xi   sh k1  i k

h
h




 t tk  xi   ltk1  xi   f xi  tk1   inf lxi    dtk1  xi   


 o h  hr  r3  hr12 
hence the result follows by taking the limit n   with

2n hn

hn  rn


2
 hr22 
h
 o1



theorem 52 comparison assume 1  2  c0 t  p rd  0 and l1 let
uh 1  and uh 2  be defined by the scheme 20 for   1  2  respectively then
kuh 1   uh 2 k0  t kf  1   f  2 k0  kg 1 t   g 2 t k0 

hdrm  and note that
proof let c
m   hb 
x
32
iuk1 1 x  iuk1 2 x 
p xupk1 1   upk1 2 
pzd

by 18 and the definition of inf for any   0 there is   rd such that
d
ehr x h
iuk1 2 xi  c
m  
2d m1
i 1  ehr z

 iuk1 2 xi  cm   
iuk1 2 xi  zdz  
r
zr

uik 2   hf xi  2 tk   hlxi    
33

we then find using 18 32 33

uik 1   uik 2   h f xi  1 tk   f xi  2 tk   hlxi     lxi   
d 

x  ehr x


p c




c


upik1 1   upik1 2 


p m

m
2d m1
pzd

z

1  ehr

p z upik1 1   upik1 2  dz  
r
zr
 hkf  1   f  2 k0  c sup uik1  ik1   
i

where since

p

p

p  1

d
 1  ehr z
x
ehr x x 


p cm    p ci   
p zdz  1
c
2d m1
r
zr
d
d
pz

pz

since uin 1   uin 2   kg 1 tn   g 2 tn k0  a symmetry and iteration
argument shows that
uik 1   uik 2   n  khkf  1   f  2 k0  kg 1 tn   g 2 tn k0 
the result then follows from interpolation and t  n h



the sl scheme is very stable in the sense that we have uniform in h   boundedness
lipschitz continuity and semiconcavity of the solutions uik 
lemma 53 let   c0 t  p rd  and uik  be defined by the scheme 18

20

i chowdhury o ersland and e r jakobsen

a lipschitz continuity assume 0 l2 and f2 then
uik  ujk 
 lf  ll t  tk   lg 
xi  xj 

i j  zd  k  0 1    n 

b semiconcavity assume 0  l3 and f3 then
uijk  2uik  uijk
 cf  cl t  tk   cg  i j  zd  k  0 1    n 
xj 2
c uniformly bounded assume 0 l0l2 f1 and f2 then
i j  zd  k  0 1    n 

uik   cf  cl kt  tk   cg 
where k is defined in theorem 51 i

proof a note that since m xj  x  mj x
x
34
p xupjk1  upik1 
iuk1 xj  x  iuk1 xi  x 
pzd

then by l2 f2 and similar computations as in theorem 52 we find that
ujk  uik  hlf  ll xi  xj   sup uik1  ujk1   
j

since uin 1  ujn 1   gxi  mtn 1   gxj  mtn 1   lg xi  xj  by f2 the
result follows by iteration
b similar to 34 we see
iuk1 xij  x  2iuk1 xi  x  iuk1 xij  x
x

p xi  xupjk1  2upk1  upjk1 
pzd

then by l3 f3 and similar computations as in theorem 52 we find that
uijk  2uik  uijk  cl  cf hxj 2  supuijk1  2uik1  uijk1 
i
2

since uijn  2uin  uijn  cg xj  by f3 the result follows by iteration
c by part a and theorem 51 i   k and then a direct calculation shows that




 sup hf   l  sup ujk1   uik  sup hf   l  sup ujk1  
k

j

k

the result follows from l1 and f1

j



theorem 54 convergence of the hjb scheme assume 0 1 f1 f2 l2
n
2
n  hn  rn  0 under cfl conditions hnn  hrn  o1 n   in c0 t  p rd 
n
and un hn n  is the solution of the scheme 18 defined by 20 then there is a
continuous bounded function u such that un hn n   u locally uniformly in rd 
0 t  and u is the viscosity solution of the hjb equation in 1 for m  
proof the result follows from the barlesperthamesouganidis relaxed limit method
12 using the monotonicity consistency and l stability properties of the scheme cf
theorem 51 ii iii and lemma 53 c and the strong comparison principle for the
hjb equation in proposition 25 a we refer to the proof of 23 theorem 33 for a
standard but more detailed proof in a similar case

we recall that the continuous extensions uh t x and uh t x are defined in
20 and 22 respectively the results of lemma 53 transfers to uh t x
lemma 55 let   c0 t  p rd  and uh  be given by 22

approximation of nonlocal mfgs

21

a lipschitz continuity assume 0 l2 and f2 then
uh t x  uh t y  ll  lf t  lg x  y
b approximate semiconcavity assume 0 l2l3 f2 and f3 then
there exist a constant c1  0 independent of  h  and  such that
2
uh t x  y  2uh t x  uh t x  y  c1 y2  2   and


2 


2
hduh t y  duh t x y  xi  c1 x  y  2 

c assume d  1 0 l3 and f3 then there exists a constant c2  0
independent of  h  and  such that for each i j  zd and k  nh
hduh tk  xj   duh tk  xi  xj  xi i  c2 xj  xi 2 
proof a since uik satisfies the discrete lipschitz bound of lemma 53 a uh  is
lipschitz with same lipschitz constant as uik by properties of linear interpolation and
uh  is lipschitz with same constant as uh  by properties of mollifiers lemma
32
b for i j  zd we have by lemma 53 b uij  uij  2ui  cxj 2  multiplying
both sides by i x and summing over zd  we get
uh x  xj   uh x  xj   2uh x  cxj 2 
letting x  x  z multiplying by a positive mollifier  z and integrating we get
uh x  xj   uh x  xj   2uh x  cxj 2 
we multiply both sides with j y and sum over zd 
iuh x  y  iuh x  y  2iuh x  ci  2 y  cy2  2 
2

by lemma 32 and part a we have that iuh   uh   kkd2 uh k0 2  k  
where the lipschitz bound k depends on the constants in l2 and f2 thus
uh x  y  uh x  y  2uh x  cy2  2 

2



the second part of b then follows as in 3 remark 6
c the proof is given in 23 lemma 36



under our assumptions the continuous hjb equation has a viscosity solution ut 
w 1 rd  that is the derivative exists almost everywhere 37 theorem 43 we have
the following result for duh 
n

theorem 56 assume 0 1 l1l2 f1f2 n  hn  rn  n  0 under
2
cfl conditions hnn  hrn  o1 and n   in c0 t  p rd  let unn hn n  be
n
defined by 22 and u the viscosity solution of the hjb equation in 1 for m  
then
i unn hn n   u locally uniformly
ii assume also l3 f3 and nn  o1 then dunn hn n t x  dut x
whenever dut x exists that is the convergence is almost everywhere
iii assume also l3 f3 nn  o1 and u then dunn hn n   du
locally uniformly
proof i this follows from the convergence result theorem 54 and lemma 32
ii and iii we refer to 23 theorem 35 and 25 proposition 51 estimates from
lemma 55 are needed for completeness we give the proof in appendix b


22

i chowdhury o ersland and e r jakobsen

6 on the dual sl scheme for the fpk equation
in this section we establish more properties of the discrete fpk equation 24 including tightness equicontinuity in time l1 stability of solutions with respect to  and
lp bounds in dimension d  1 to prove tightness we will use a result from 31
proposition 61 assume 0 and m then there exists a function 0    c 2 rd 
with kdk0  kd2 k0   and lim x   such that
x

z
35


x  z  z dz  

sup
xrd

z
x m0 dx  

and
rd

z1

proof we use 31 lemma 49 on the family
of measures 1  m0  where 1 is defined
p
in 11 to get a function x  v0  1  x2  such that v0  0   0  is a
nondecreasing subadditive function kv00 k0  kv000 k0   lim v0 x   and
x
z
x dx  
for
  1  m0 
rd

we immediately get the result except for the first part of 35 but this estimate follows
from subadditivity and 1 integrability of v0  see 31 lemma 413 ii

r
c
 zd
for z  1 and rd x2 m0 dx   for 1  2  0
remark 62 a if d
1
p dz
then z  log 1  z2  is a possible explicit choice for the function in proposition
61
b since   c 2 rd  the first part of 35 is equivalent to klk0   see 31 lemma
413 ii
lemma 63 assume  a  p rrd  and there exists a function 0    crd 
such that limx x   and sup rd x dx  c then   is tight
this result is classical and can be proved in a similar way as the chebychev inequality
theorem 64 tightness assume 0 1 l1l2 f2 h1 m the cfl
2
condition h  hr12  o1   c0 t  p rd  and mh  is defined by 26 take
 as in proposition 61 then there exists c  0 independent of  h  and  such
that
z
x dmh t  c
for any
t  0 t 
rd

proof essentially we start by multiplying the scheme 24 by  and integrating in
space by the definition of mh  mh  in 26 and 24 we find that
z
z
1 x
xdmh tk1   d
mik1
xdx

rd
ei
d
iz
x 1 z
x

xdx
mjk bhr hp  duh i j k
d

ei
d
j
iz

by the definition of bhr in 25 and interchanging the order of summation and integration we have
z
d x z
x mjk  er h x
 

x i 
xd mh tk1  
jkp   i jkp  dx
d

2d p1 d ei
rd
iz
jzd

r h z
xz
1e

xi xj  zdx dz 
r
zr
ei
d
iz

approximation of nonlocal mfgs

23

since   c 2 rd  by properties
of midpoint approximation
and linearmultilinear
r
p
interpolation we have 1d ei xdx  xi   x  izd i xxi   o2 
therefore
 r h x
z
d
x

e
 

mjk
36
xd mh tk1  
 
jkp   jkp
2d
rd
p1
jzd

r h z
1e

xj  z dz  o2 
r
zr

we estimate the terms on the right hand side let 
jkp  xj  ahj where
 




37
hrp 
a

h
d
h
x

du
t

x


b
p
j
j
h k
r 
hj

by the fundamental theorem of calculus



xj  a
hj   xj  ahj   2xj   ahj  ahj   dxj   e1





where a
hj  ahj  2h dp h xj  duh tk  xj   br and
z 1h

i



e1  
a
hj  dxj  tahj   dxj   ahj  dxj  tahj   dxj  dt

38

0

by lemma 55 a and h1 we find that kdp h duh k0  cr with r  ll 
lf t  lg  1 and then that

 2
2
2
2
2
 2
p 2
e1   kd2 k0 a
hj   ahj    4kd k0 h cr  br    hr  
to estimate the nonlocal term we write
z
z
xj  z dz 
xj  zdz
zr

z1

z

z

z
n
xj   z  dxj  

rz1


z1

1

h
i o
z  dxj  tz  dxj  dt dz

0


xj  z  xj  dz  r xj   br  dxj 
z
 kd2 k0
z2 dz
rz1

 r xj   br  dxj   e2 
where e2 is finite and independent of  h  by proposition 61 and
going back to 36 and using the above estimates then leads to
z
xd mh tk1 

r
z1

z2 dz  

rd

d




er h x 
2xj   2h dp h xj  duh tk  xj   br  dxj   e1 
2d p1
jzd

1  er h 

r xj   br  dxj   e2  c2
r


x

mjk xj   c h2 r br   h2 br 2  h  2 



x



mjk

jzd
r h

where we used her h  1er

  23 r h2 and

1er h
r

 h to get the last inequality

24

i chowdhury o ersland and e r jakobsen

r
with ak1  rd xd mh tk1  the above estimate becomes ak1  ak  e
where e  cr h2 br   h2 br 2  h  2  by iteration br 2  r br   cr12 by
0 1 and k  n  ch  we find that

2 
39
ak1  a0  k  1e  a0  c hr12  1 

h
r
2
by assumption h  hr12  o1 and by proposition 61 a0  rd xd m0  
therefore
z
xd mh tk   c
for
k  0 1     n
rd

for some constant c  0 independent of  h   and hence by 26 the result follows
for t  0 t 

theorem 65 equicontinuity in time assume 0 1 l1l2 f2 h1
2
m   c0 t  p rd  and mh  is defined by 26 let h  rh  o1 if
2

  0 1 or h  hr12  o1 if   1 2 then there exists a constant c0  0
independent of  h  and  such that for any t1  t2  0 t 
p
d0 mh t1  mh t2   c0 t1  t2 
proof we start by the case   1 for   0 let      for  defined just before
lemma 32 with mh  mh  we first note that
z


d0 mh t1  mh t2   sup
xmh t1   mh t2 dx
lip11 rd
z
nz
o


 sup
   mh t1   mh t2 dx 
 mh t1   mh t2 dx
rd
rd
lip11
40
z
 2kdk0 

sup
lip11

rd

 mh t1   mh t2 dx

r
where lemma 32 was used to estimate the    term and mh dx  1 since mh
r
r
and rd  xmh t xdx are affine on each interval tk  tk1  rd  x mh  xdx 
w 1 0 t  and
z
d
 x mh  xdx  sup ik 
dt rd
0
k


r
mh tk1 xmh tk x
where ik  rd  x
dx it follows that
h
z
41
 mh t1  x  mh t2  xdx  t1  t2  sup ik 
rd

k

let us estimate ik  by 26 24 25 the midpoint quadrature approximation error
bound and the linearmultilinear interpolation error bound we have
z
1x 1
ik 
 x dxmik1  mik 
h i  d ei
z
h
i
1 x
 d
 xdx mjk bhr hp  duh i j k  mik ij
h ji
ei
h
i
x
x
1

mjk
 xi bhr hp  duh i j k   xj   ckd2  k0 2
h j
i

approximation of nonlocal mfgs



25

d
h er h  x

1x

mjk
 






2
x



j
jkp
jkp
h j
2d
p1
z
i

1  er h
 xj  z   xj  dz  ckd2  k0 2 

r
zr


since 
jkp  xj  ahj by 37 a 2nd order taylors expansion gives us



1x
mjk er h hdp h xj  duh tk  xj   hbr   d xj 
ik 
h j
d
 1  er h  
kd2  k0 x  2
2
br  d xj 
ahj   a


hj
2d
r
p1
z
z

 kd2  k0
z2 dz  2k k0
dz  ckd2  k0 2



z1

rz1




1 
h


hkdp h duh k0  h2 r br  kd k0  c3 hk k0


2

 c1 h

2
kdp h duh k

2

h

2
br 

2

2

 hr   h  



2

kd  k0

x

mjk 

j
r h

the above inequality follows since  1er
 hehr   h2 r used for the br  d r
r
2
terms and rz1 z dz  z1 dz  c independently of r by 0 and 1
by lemma 55 a and h1 kdp h duh k0  cr with r  ll  lf t  lg  1
p
0
since
mjk  1   lip11  kd2  k0  kdk
 and br 2  r br   kr12 by

0 1 we get that
2  1

h 
to conclude the proof in the case   1 we go back to 40 and 41 in view of the
2
above estimate on ik and the assumption that h  hr12  o1 we find that

1
d0 mh t1  mh t2   2  ct1  t2  1 


p
p
finally taking   t1  t2  we get d0 mh t1  mh t2   c t1  t2 
ik   c1  hr12   c 1  h  hr12 

when   1 we find that br   c and hence that
ik   c1  hr   c 1  h  hr 
by assumption hr 

2
h

2  1

h 

 o1 so again we find that


1
d0 mh t1  mh t2   2  ct1  t2  1 


and can conclude as before



we also need a l1 stability result for mh  with respect to variations in 
lemma 66 l1 stability assume 0 h1 and mh  is defined by 26 then
for 1  2  c0 t  p rd 
sup kmh 1 t   mh 2 t kl1 rd 
t0t 



ckt hr
e
dp h duh 1   dp h duh 2 


0



26

i chowdhury o ersland and e r jakobsen

proof let   dp h duh 1    dp h duh 2  mjk  mjk 1  and mjk 
mjk 2  by 25 and lemma 33 bhr i j k  0 and mjk  0 so that
x
x x
mik1  mik1 
mjk bhr i j k  mjk bhr i j k
i



i

xx
i

since

j


mjk bhr i j k  bhr i j k  mjk  mjk bhr i j k 

j

p

i

p
bhr i j k  1 follows from i i  1 and 25
xx
x
mjk  mjk bhr i j k 
mjk  mjk 
i

j

j

moreover since only a finite number
kd of i s are nonzero at any given point i is
p
lipschitz with constant c  and j mjk  1 by lemma 33 by the definitions of bhr
25 and 
jkp 23
xx
mjk bhr i j k  bhr i j k
i

j



x
j

d
ehr x x

mjk
i 
jkp 1   i jkp 2 
2d p1 i

 i 
jkp 1   i jkp 2   kd

chehr
k  k0 


an iteration then shows that
x
x
ckd t hr
mik1  mik1 
mi0  mi0 
e
k  k0 

i
i
r
since mi0  mi0  ei m0 dx the result follows by interpolation



we end this section by a uniform lp bound on mh in dimension d  1
theorem 67 lp bounds assume d  1 0 1 l1 l3 f3 h2 m
  c0 t  p rd  and mh  be defined by 26 then mh   lp r and there
exist a constant k  0 independent of  h  and  such that
kmh  tklp r  ekt km0 klp r 
to prove the theorem we need few technical lemmas
lemma 68 assume d  1 0 1 l1 l3 f3 and h2 there exists a
constant c0  0 independent of  h   such that



dp h xj  duh tk  xj   dp h xi  duh tk  xi  xj  xi   c0 xj  xi 2 
proof by l1 and h2 for r  lf  ll t  lg   1 we have



dp h xj  duh tk  xj   dp h xi  duh tk  xi  xj  xi 
z 1 

d
 xj  xi 
dp h xj  t duh tk  xj   1  tduh tk  xi  dt
0 dt



 xj  xi  dp h xj  duh tk  xi   dp h xi  duh tk  xi 
z 1

 xj  xi 
dpp h xj  t duh tk  xj 
0


 1  tduh tk  xi  duh tk  xj   duh tk  xi  dt

approximation of nonlocal mfgs

27




 xj  xi  dp h xj  duh tk  xi   dp h xi  duh tk  xi 
 cr c2 xj  xi 2  cr xj  xi 2 
where the last inequality follows from convexity of h since l is convex by l1 semiconcavity of uh in lemma 55 c and regularity of h in h2

lemma 69 assume d  1 0 1 l1 l3 f3 h2   c0 t  p rd 
and let 
jk  be defined in 23 there exist a constant k0  0 independent of   h 
such that for all i  z and k  nh 
nx
o
x
max
i 
i 
jk 
jk   1  k0 h
jz

jz

the proof of this result is similar to the proof of 23 lemma 38  a slightly expanded
proof is given in appendix c a similar result holds for the integralterm
lemma 610 assume d  1 then we have
z
1 x
i xj  zdz  1
r
zr
jz

proof by 11 and properties of the basis functions j we have
z
z
z
x
1 x
1
1
i xj  zdz 
ij zdz 
dz  1
r
r zr
r zr
zr
jz



jz

proof of theorem 67 by definition of mh in 26 and the scheme 24
z
z  x
p
1
mik1 1ei x dx
mh x tk1 p dx 
r
r  i
p
x
1 xx
1
mik1 p  p1
mjk bhr i j k 
 p1


i
j
iz

where bhr  bhr hp  duh  is defined in 25 by jensens inequality we have
p x  x
p1  x

xx
p
mjk bhr i j k 
bhr i p k
mjk bhr i j k 
iz

j

iz

j

pz

and by lemma 69 and 610
x

bhr i p k  1  k0 h

pz

p
where
k0 is independent of i  h  and  since i bhr i p k  1 follows from
p
i i  1 we find that
x
x
p x
mik1 p  1  k0 hp1
mjk
bhr i j k
iz



p1

j

kmh tk  kplp r 1

i

 k0 hp1 
1

by iteration and kmh  t0 klp  km0 klp  kmh tk1  klp  ek0 t 1 p  km0 klp  and
the result follows for p  1 
the proof of p   is simpler and in view of lemma 69 and 610 the proof follows
as in 24 for 2nd order case


28

i chowdhury o ersland and e r jakobsen

7 proof of convergence  theorem 41 and 43
the main structure of the proofs are similar so we present the proofs together we
proceed by several steps
step 1 compactness of mnn hn  in view of theorem 64 and 65 mh is precompact
in c0 t  p rd  by the prokhorov and arzelascoli theorem hence there exist a
subsequence mnn hn  and m in c0 t  p rd  such that
mnn hn  m

in c0 t  p rd 

this proves theorem 43 a ii and the first part of theorem 41 a ii
if m holds with p   then theorem 67 and hellys weak  compactness theorem
imply that mh  is weak  precompact in l 0 t   r and there is a subsequence


mnn hn  and function m such that mnn hn  m in l 0 t   r if m holds with
p  1  then mh  is equiintegrable in 0 t   r by theorem 64 and 67 and de
la valle poussins theorem by dunfordpettis theorem it is then weakly precompact
in l1 0 t   r and there exists a subsequence mnn hn  and function m such that
mnn hn  m in l1 0 t   r the second part of theorem 41 a ii follows
step 2 compactness and limit points for un hn  part i and limit points u as
viscosity solutions in part iii of both theorem 41 and 43 follow from step 1 and
theorem 56 i
step 3 consistency for mnn hn  let u m be a limit point of unn hn  mnn hn n 
then by step 2 u is a viscosity solution of the hjb equation in 1 we now show that
m is a very weak solution of the fpk equation in 1 with u as the input data ie
m satisfies 3 for t  0 t  and   cc rd  in the rest of the proof we use  h r 
b
b
instead of n  hn  rn  n to simplify we also let m
b  mnn hn  w  unn hn m
b and take
 t 
tn  hn hn  then we note that
z

z
b
xdmt
b n x 

rd

0dm0 x 
rd

n1
xz
k0

rd

b
b
xdmt
b k1   mt
b k 

so to prove 3 we must estimate the sum on the right
by the midpoint approximation and 26 the scheme 24 and 25 combined with
linearmultilinear interpolation and finally midpoint approximation again we find that
z
z
x
1 x
b
xdmt
b k1   d
mik1
xdx 
mik1 xi   o2 

rd
e
i
i
izd
x
x
xi 
mjk bhr hp  dwi j k  o2 

i



x

j

mjk

d
 er h x

2d

j



x mjk
j

d

z
ej



jkp   jkp  

p1

e

1  er h
r

z


xj  zdz  o2 

zr

d
r h x

2d



kp x  kp x

p1

1  er h

r

z


x  zdz dx  o2   e  e 

zr

 


where 
hdrp 
jkp is defined in 23 kp x  x  h hp x dwtk  x  br 
and e  e is the error of the last midpoint approximation since  is smooth uh

approximation of nonlocal mfgs
ckdu

29

k

h 0
 and by assumption h2
uniformly lipschitz lemma 55 a kd2 wk0 

z
1


jkp   d
kp xdx
 ej
z
z
kdk0
hkdk0

dp hxj  dwtk  xj   dp hx dwtk  x dx
x

x
dx

j
d
d
ej
ej


h
 k 1  hkhpp k0 kd2 wk0  khpx k0   k 1  kduh k0 

2

h
2
and hence e  o h
  similarly e  oh r   o r  
from the above estimates we find that
z
z  r h x
d

e

b
b
b k1   mt
b k  x 
xd mt

kp x  kp x  2x
2d p1
rd
rd
z


1  er h
h h2 
b

x  z  x dz dmt
b k x  o 2 
  
r

r
zr

by a similar argument as in 28 and using lemma 31





kp x  kp x  2x   2h dx  dp hx dwtk  x  br  dx
 2hlr x  oh2 r22  hr3 
hence using 30 and 31 we have
z
b
b
xdmt
b k1   mt
b k x
rd
z


b
h
 dx  dp hx dwtk  x  lr x  lr x dmt
b k x
rd

h h2
   h2 r22  hr3 

r
summing from k  0 to k  n  1 and approximating sums by integrals we obtain
z
z
b
b
xdmt
b n x 
xdmt
b 0
 oh2 r  h2 r12  h2 r22   o2 

rd

rd

h

n1
xz



rd

k0

42


b
 dx  dp hx dwtk  x  lx dmt
b k x

 n o2 
z

z


rd

0

h h2
   h2 r  hr3 

r

tn




b
 dx  dp hx dws x  lx dmsx
b
ds


 2  h
3


r
 e
h

r
where e is riemann sum approximation error let ik x  dxdp hx dwtk  x
b
lx and use timecontinuity m
b in the d0 metric theorem 65 that w x is
ckduh k0
 to conclude that for s 
constant on tk  tk1  h1 h2 and kd2 wk0 

tk  tk1 
z tk1 z



b
b
s  tk
ik xd mt
b k   ms
b
xds  h kik k0  kdik k0 c0 sup
o

tk

 2



rd




1 
 kh 1  kdwk0  kd2 wk0 h  kh 1 
h


stk tk1 

30

i chowdhury o ersland and e r jakobsen



pn1 r tk1 r
b
b
summing over k we have e 
b k   ms
b
xds  o h 
i xd mt
k0 tk
rd k
b
since m
b converges to m in c0 t  p rd  and   cc rd  implies l  cb rd 
we have
z z t
z z tn
n
b
43
lxdmsx
lxdmsx
b

rd

rd

0

0

it now remains to show convergence of the dp hterm and pass to the limit in 42 to
get that m is a very weak solution satisfying 3
step 4 proof of theorem 41 a iii now d  1 and part ii of theorem 41 a

b
b
implies that m
b  m in l 0 t  r if m0  l r or m
b  m in l1 0 t  r if
p

m0  l r for p  1  we also have dwt x  duh t x  dut x almost
everywhere in 0 t   r by theorem 56 ii since d  cc r and dp h dw
uniformly bounded by the triangle inequality and the dominated convergence theorem
we find that
z z tn
b
dxdp hx dws x dmsx
b
r 0
z z t
dx  dp hx dus x dmsx

r

0

then by passing to the limit in 42 using the above limit 43 and the cfl conditions
2 h
h
2
h  r     o1 note that   h for large n we see that 3 holds and m is a very
weak solution of the fpk equation this completes the proof of theorem 41 a iii
now u holds and dw  duh  du lor
b
b
 1 by
cally uniformly by theorem 56 iii since d  cc rd  and rd dmsx
continuity and uniform boundedness of dp h dw it follows that
z z tn
b
dx  dp hx dws x dmsx
b
rd 0
z z tn
b
44
dx  dp hx dus x dmsx

b
rd 0
z
b
 t kdk0 kdpp hk0 kdw  dukl supp
dmsx
b
 0

step 5proof of theorem 43iii

rd

b
since m
b  m in c0 t  p rd  and d  dp h dut  cb rd  by u we get
z z tn
b
dxdp hx dus x dmsx
b
rd 0
z z t

dx  dp hx dus x dmsx
rd

0

then by passing to
the limit in 42 using the above limit 44 43 and the cfl

2
conditions h  rh  h  o1 we see that 3 holds and m is a very weak solution of the
fpk equation this completes the proof of theorem 43iii
8 numerical examples
for numerical experiments we look at

45


1
2
2

 ut   lu  2 ux   f t x  k   mt x
2 
mt   l m  divmux   0


ut x  gx mt 
mx 0  m0 x

in 0 t   a b
in 0 t   a b
in a b

approximation of nonlocal mfgs

31
x2

where a  b are real numbers l is a diffusion operator   12 e 22  k some real
number and f is some bounded smooth function we will specify these quantities in
the examples below
artificial boundary conditions our schemes 18 and 24 for approximating 45
are posed in all of r to work in a bounded domain we impose artificial exterior
conditions
u1 u  ku0 k0  t  kf kl 0t ab in r  a b  0 t 
m1 m  0 in r  a b  0 t  and m0 is compactly supported in a b
condition u1 penalize
being in a bc ensuring that optimal controls  in 18 are such

that xi  h  hr  a b moreover the contributions to nonlocal operators of u
from a bc will be small away from the boundary condition m1 ensures that the mass
of m is essentially contained in a b up to some finite time but some mass will leak
out due to nonlocal effects and there is no contribution from a bc when we compute
nonlocal operators of m we will present numerical results from a region of interest
that is far away from the boundary of a b and where the influence of the artificial
exterior data is expected to be negligible
evaluating the integrals to implement the scheme we need to evaluate the integral
z
x
if xi  zdz 
f xi ji 
zr

jz

where
z
ji 

ji zdz
zr

see 17 in addition we need to compute the values of r  br  and r see 9 8 and
11 to compute the weights ji we use two different methods for the fractional
laplacians we use the explicit weights of 45 while for cgmy diffusions we calculate
the weights numerically using the inbuilt integral function in matlab when tested on
the fractional laplacian the matlab integrator produced an error of less than 1015 
below the quantities r  br  r are computed explicitly except in the cgmy case where
we use numerical integration
solving the coupled system we use a fixed point iteration scheme i let   m0 
and solve for uh in 1820 ii with approximate optimal control duh as in 21
we solve for mh in 24 iii let new  mh  2 and repeat the process with
  new  we continue until we have converged to a fixed point to within machine
accuracy
remark 81 instead new  mh  we take new  mh  2 ie we use a fixed
point iteration with some memory this gives much faster convergence in our examples
example 1 problem 45 with 0 t   a b  0 2  0 1 g  0 f t x  5x 
rb
x052
051  sin2t2  m0 x  ce 012  where c is such that a m0  1 furthermore
1
in accordance
with the cflconditions of theorem 41 we let h    0005 r  h 2s 

  h  00707   009   04 k  1
s
for the diffusions we consider l   2 for s  05 15 19 l   and l  0
in figure 1 we plot the different solutions at time t  05 and t  15
in figure 2 we plot the solution with s  15 on the time interval 0 2
example 2 problem 45 with the same cost functions as in example 1 but different
diffusions with parameter s  15

32

i chowdhury o ersland and e r jakobsen

a t  05

b t  15

figure 1 the solutions m in example 1

a mt x

b ut x

figure 2 solution m and u in example 1 with diffusion parameter
s  15
s

i  l   2 r 2 
ii  l   2 cds r ux  y  ux  dux  y 1y1  10 ydy
1s 
r
2
iii  l   cds r ux  y  ux  dux  y 1y1  10505c ydy
1s 
r
2
10y  y  dy
iv  l   cds r ux  y  ux  dux  y 1y1  e
y1s 
where cds is the normalizing constant for the fractional laplacian see 45 case i
is the reference solution a symmetric and uniformly elliptic operator case ii is nonsymmetric and nondegenerate case iii is symmetric and degenerate and case iv is
a cgmydiffusion see eg 34 we have plotted m at t  05 and t  15 in figure 3
example 3 long time behaviour under certain conditions see eg 22 21 the
solution of time dependent mfg systems will quickly converge to the solution of the
corresponding stationary ergodic mfg system as the time horizon t increases we
check numerically that this is also the case for nonlocal diffusions in 45 we take
s
l   2  with s  15 0 t   a b  0 10  1 2 gx  x  22  f t x  x2 
and m0 x  112 x we expect from the cost functions f and g that the solution
m will approach the line x  0 quite fast and then travel along this line until it goes
towards the point x  2 in the very end our numerical simulations shows that this
is the case also for nonlocal diffusions here we have considered the cases k  0 no

approximation of nonlocal mfgs

a t  05

33

b t  15

figure 3 the solutions m in example 2
coupling in the u equation and k 04 some coupling the parameters used in the
simulations are h    001   h r  h12s  and the results are shown in figure 4

a f

b f  04

figure 4 the solutions m in example 3
the players want to avoid each other in the case of k  04 so the solution is more
spread out in space direction than in the case of k  0
example 4 we compute the convergence rate when f  g m0 are as in example 1
s  15   02   04 and the domain 0 t   a b  0 05  0 1 we take   h
1
r  h 2s  and for simplicity   025
we calculate solutions for different values of h and compare with a reference solution
computed at h  210  we calculate l and l1 relative errors restricted to the xinterval  13  23  to avoid boundary effects and t  0 for u and t  t for m
erru 

kuh 0   uref 0 kl  31  32 
kuref 0 kl  13  32 



errm 

kmh t   mref t kl1  31  23 
kmref t kl1  31  23 



the results are given in the table below
h
erru
errm

22
03155
08055

23
01951
04583

24
25
00920 00446
02886 01869

26
00218
01023

27
28
00097 00035
00596 00300

29
00013
00186

we see that when we halve h the error is halved ie we observe an error of order oh

34

i chowdhury o ersland and e r jakobsen

appendix a proof of proposition 34
the proof is an adaptation of the schauder fixed point argument used to prove existence for mfgs we will use a direct consequence of theorem 64 and 65
corollary a1 assume 01 l1l2 h1 f2 m  is given by proposition 61 and mh  is defined by 26 then there is ch  0 such that for any
  c0 t  p rd  and t s  0 t 
z
d0 mh t mh s
p
 ch 
x dmh t 
t  s
rd
the point is that  h  are fixed in this result let
n
c    c0 t  p rd   0  m0 
hz
o
d0 t s i
sup
xdt x  p
 ch 
t  s
ts0t 
rd
where ch is defined in corollary a1 for   c let uh  be solution of 18 and
uh  defined by 22 then mh  s is defined to the corresponding solution of
24 note that a fixed point of s will give a solution u m of the scheme 27 we
now conclude the proof by applying schauders fixed point theorem since
1 c is a convex closed compact set it is a convex and closed by standard arguments
and compact by the prokhorov and arzelascoli theorems
2 s is a selfmap on c the map s maps c into itself by corollary a1 tightness and
equicontinuity and lemma 33 positivity and mass preservation
3 s is continuous let n   in c by theorem 52 comparison and f2
kuh n   uh k0
 t sup f x n t  f x t  sup gx n t   gx t 
tx

x

 t lf sup d0 n t t  lg d0 n t  t   0
t
u  u
 
u uijk 
supi ik n  ijk n  ik


then
duh k0  0 and finally by lemma 66

sup kmh n t   mh t kl1 rd  
t0t 

 0 uniformly for ij  1 kduh n 
ckt hr
e
kduh n   duh k0  0


hence s is continuous
appendix b proof of lemma 56 ii and iii
fix t x  0 t   rd and consider a sequence tk  xk   t x for any y  rd  a
taylor expansion shows that
unn hn n tk  xk  y  unn hn n tk  xk   dunn hn n tk  xk   y
z 1
z 1
46


dunn hn n tk  xk  sy  dunn hn n tk  xk   y ds 
is  y ds
0

0

using first lemma 55 a and then part two of lemma 55 b we find that
z  ny
n
n
n
 2ll  lf t  lg 
is  y ds  2kdunn hn n k0

n
n
0
z 1
z 1
z 1 

2
1

1 2n 
ds
is  y ds  c1
sy2  2n ds  c1 y2
s
n
n
n
s
n
s y2 2n
 y
 y
 y
n

n

n

approximation of nonlocal mfgs

 c1 y2

z

1



n
n y

35

1 
s  s2 ds  c1 y2 
s

by lemma 55 a the sequence dunn hn n tk  xk  is precompact now take any
convergent subsequence as n k   and nn  o1 if p is the limit then by passing
to the limit in 46 along this subsequence we have
ux  y  ux  p  y  c1 y2

for every y  rd 

and p  d ut x the superdifferential of ut x at points x t where u is
differentiable d ut x  dut x and p  dut x and then since the
subsequence was arbitrary in the above argument and all limit points p coincide
lim sup
tk xk txn

47



dunn hn n tk  xk 

lim inf
tk xk txn

dunn hn n tk  xk 

 dut x
we conclude that dunn hn n   du at t x part ii now follows since u is
lipschitz in space by proposition 25 c and then xdifferentiable for ae x and every
t
to prove part iii we note that u is c 1 by u so now 47 holds for every t x
then in view of the uniform lipschitz estimate from lemma 55 a local uniform
convergence follows from 11 chapter v lemma 19 the proof is complete
appendix c proof of lemma 69
we first show strong separation between any two characteristics   by lemma
68



 2

x

x

h

h

h
dp hxj  duh tk  xj   br



r
r
j
i
jk
ik
2
 dp hxi  duh tk  xi   br



 xj  xi 2  2h dp h xj  duh tk  xj   dp h xi  duh tk  xi  xj  xi 
 1  c0 hxj  xi 2 
hence we have
n
o p
p









48
min 
 1  c0 hj  i   1  c0 h
jk
ik
jk
ik
the result now holds following the proof of 23 lemma 38 we give the proof for
completeness
since the diameter of the support of a hat basis functions i is 2 by 48 there can
be at most 3 characteristics inside the suppi  for small enough h the result is trivial
if there is only one in characteristic suppi  when suppi  contains 2 characteristics



say 
j1 k and j2 k  we see by 48 check the different orderings of xk  j1 k  j2 k 
that
i 
j1 k 



i j

2 k

1 

2 

xi  
j1 k


j1 k




1


j2 k

xi  
j2 k

2


p
1  c0 h  1  k0 h

36

i chowdhury o ersland and e r jakobsen



finally assume supporti  contains 3 characteristics 
j1 k  j2 k and j3 k  by 48
that all three characteristics can not be on one side left or right of xi  without loss


of generality we assume 
j1 k  xi  j2 k  j3 k  and find


i 
j1 k   i j2 k   i j3 k   1 

 3


j2 k




j1 k






j3 k



xi  
j1 k


1


j2 k  xi


1


j3 k  xi



j2 k


p
p
 3  2 1  c0 h  1  21  1  c0 h  1  k0 h
combining all three cases we get
x
i 
jk   1  k0 h for any i  z
jz

the estimate of

p

jz

i 
jk  is similar this completes the proof
acknowledgements

the authors are supported by the toppforsk research excellence project waves and
nonlinear phenomena wanp grant no 250070 from the research council of norway
ic is partially supported by the croatian science foundation under the project 4197
the authors would like to thank elisabetta carlini for sharing the code of the numerical
methods introduced in 23
references
1 y achdou f camilli and i capuzzodolcetta mean field games numerical methods for the
planning problem siam j control optim 50177109 2012
2 y achdou f camilli and i capuzzodolcetta mean field games convergence of a finite
difference method siam j numer anal 51525852612 2013
3 y achdou f camilli and l corrias on numerical approximation of the hamiltonjacobitransport system arising in high frequency approximations discrete contin dyn syst ser b
193629650 2014
4 y achdou and i capuzzodolcetta mean field games numerical methods siam j numer
anal 48311361162 2010
5 y achdou p cardaliaguet f delarue a porretta f santambrogio mean field games lecture
notes in mathematics cime vol 2281 springer 2020
6 y achdou and m laurire mean field games and applications numerical aspects arxiv
preprint arxiv200304444 2020
7 y achdou and v perez iterative strategies for solving linearized discrete mean field games
systems netw heterog media 72197 2012
8 y achdou and a porretta convergence of a finite difference scheme to weak solutions of the system of partial differential equations arising in mean field games siam j numer anal 541161
186 2016
9 d applebaum lvy processes and stochastic calculus cambridge university press 2009
10 s asmussen and j rosiski approximations of small jumps of lvy processes with a view towards
simulation j appl probab 382482493 2001
11 m bardi and i capuzzodolcetta optimal control and viscosity solutions of hamiltonjacobibellman equations birkhuser 1997
12 g barles and p e souganidis convergence of approximation schemes for fully nonlinear second
order equations asymptotic anal 43271283 1991
13 a bensoussan j frehse and p yam mean field games and mean field type control theory springerbriefs in mathematics springer 2013
14 f camilli and m falcone an approximation scheme for the optimal control of diffusion processes
rairo modl math anal numr 29197122 1995
15 f camilli and e r jakobsen a finite element like scheme for integropartial differential hamilton
jacobibellman equations siam j numer anal 47424072431 2009
16 i capuzzo dolcetta on a discrete approximation of the hamiltonjacobi equation of dynamic
programming appl math optim 104 367377 1983

approximation of nonlocal mfgs

37

17 p cardaliaguet weak solutions for first order mean field games with local coupling in analysis
and geometry in control theory and its applications volume 11 of springer indam ser pages
111158 springer cham 2015
18 p cardaliaguet f delarue jm lasry and pl lions the master equation and the convergence problem in mean field games annals of mathematics studies vol 201 princeton university press 2019
19 p cardaliaguet and p j graber mean field games systems of first order esaim control optim
calc var 213690722 2015
20 p cardaliaguet p j graber a porretta and d tonon second order mean field games with degenerate diffusion and local coupling nodea nonlinear differential equations appl 2251287
1317 2015
21 p cardaliaguet jm lasry pl lions and a porretta long time average of mean field games
with a nonlocal coupling siam j control optim 51535583591 2013
22 p cardaliaguet jm lasry pl lions and a porretta long time average of mean field games
netw heterog media 72279 2012
23 e carlini and f j silva a fully discrete semilagrangian scheme for a first order mean field
game problem siam j numer anal 5214567 2014
24 e carlini and f j silva a semilagrangian scheme for a degenerate second order mean field
game system discrete contin dyn syst 3594269 2015
25 e carlini and f j silva on the discretization of some nonlinear fokkerplanckkolmogorov
equations and applications siam j numer anal 56421482177 2018
26 r carmona and f delarue probabilistic analysis of meanfield games siam j control optim
51427052734 2013
27 r carmona and f delarue probabilistic theory of mean field games with applications iii probability theory and stochastic modelling 84 springer 2018
28 r carmona and m laurire convergence analysis of machine learning algorithms for the numerical solution of mean field control and games iithe finite horizon case arxiv preprint
arxiv190801613 2019
29 r carmona m laurire and z tan linearquadratic meanfield reinforcement learning convergence of policy gradient methods arxiv preprint arxiv191004295 2019
30 a cesaroni m cirant s dipierro m novaga and e valdinoci on stationary fractional mean
field games j math pures appl 1229122 2017
31 i chowdhury e r jakobsen and m krupski on fully nonlinear parabolic mean field games
with examples of nonlocal and local diffusions arxiv preprint arxiv210406985 2021
32 m cirant on the solvability of some ergodic control problems in rd  siam j control optim
52640014026 2014
33 m cirant and a goffi on the existence and uniqueness of solutions to timedependent fractional
mfg siam j math anal 512913954 2019
34 r cont and p tankov financial modelling with jump processes crc press 2003
35 k debrabant and e r jakobsen semilagrangian schemes for linear and fully nonlinear diffusion
equations math comp 8228314331462 2013
36 s elghanjaoui and k h karlsen a markov chain approximation scheme for a singular investmentconsumption problem with lvy driven stock prices online available url
httpsciteseerxistpsueduviewdocdownloaddoi1011152182reprep1typepdf 2002
37 o ersland and e r jakobsen on fractional and nonlocal parabolic mean field games in the
whole space arxiv preprint arxiv200312302 2020
38 m falcone and r ferretti semilagrangian approximation schemes for linear and hamiltonjacobi equations society for industrial and applied mathematics siam 2014
39 d a gomes e a pimentel and v voskanyan regularity theory for meanfield game systems
springerbriefs in mathematics springer 2016
40 o guant mean field games equations with quadratic hamiltonian a specific approach math
models methods appl sci 2209 2012
41 o guant new numerical methods for mean field games with quadratic costs netw heterog
media 72315336 2012
42 o guant mean field games with a quadratic hamiltonian a constructive scheme advances in
dynamic games pages 229241 springer 2013
43 o guant jm lasry and pl lions mean field games and applications in parisprinceton
lectures on mathematical finance 2010 lecture notes in mathematics 2003 205266 springer
2011
44 m huang r p malham and p e caines large population stochastic dynamic games closedloop mckeanvlasov systems and the nash certainty equivalence principle commun inf syst
63221251 2006

38

i chowdhury o ersland and e r jakobsen

45 y huang and a oberman numerical methods for the fractional laplacian a finite differencequadrature approach siam j numer anal 52630563084 2014
46 e r jakobsen and k h karlsen continuous dependence estimates for viscosity solutions of
integropdes j differential equations 2122278318 2005
47 e r jakobsen k h karlsen and c la chioma error estimates for approximate solutions
to bellman equations associated with controlled jumpdiffusions numer math 1102221255
2008
48 v n kolokoltsov m s troeva and w yang mean field games based on stablelike processes
autom remote control 771120442064 2016
49 jm lasry and pl lions mean field games jpn j math 21229260 2007
50 r metzler and j klafter the random walks guide to anomalous diffusion a fractional dynamics
approach phys rep 3391177 2000
51 a porretta weak solutions to fokkerplanck equations and mean field games arch ration
mech anal 2161162 2015
52 l ruthotto s j osher w li l nurbekyan and s w fung a machine learning framework for
solving highdimensional mean field game and mean field control problems proc natl acad
sci usa 1171791839193 2020
53 c villani optimal transport old and new springer science  business media 2008
54 w a woyczyski lvy processes in the physical sciences lvy processes pages 241266 springer
2001
i chowdhury department of mathematics faculty of science university of zagreb
croatia
email address indranilchowdhuryntnuno indranill2011gmailcom
o ersland norwegian university of science and technology norway
email address olaverslandntnuno
e r jakobsen norwegian university of science and technology norway
email address espenjakobsenntnuno

