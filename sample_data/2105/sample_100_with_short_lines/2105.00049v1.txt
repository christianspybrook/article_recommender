limit distributions and sensitivity analysis for entropic
optimal transport on countable spaces
shayan hundrieser

 

marcel klatt



axel munk

  

arxiv210500049v1 mathpr 30 apr 2021

april 30 2021

abstract
for probability measures supported on countable spaces we derive limit distributions
for empirical entropic optimal transport quantities in particular we prove that the
corresponding plan converges weakly to a centered gaussian process furthermore its
optimal value is shown to be asymptotically normal the results are valid for a large
class of ground cost functions and generalize recently obtained limit laws for empirical
entropic optimal transport quantities on finite spaces our proofs are based on a
sensitivity analysis with respect to a weighted l1 norm relying on the dual formulation
of entropic optimal transport as well as necessary and sufficient optimality conditions
for the entropic transport plan this can be used to derive weak convergence of the
empirical entropic optimal transport plan and value that results in weighted borisovdudleydurst conditions on the underlying probability measures the weights are
linked to an exponential penalty term for dual entropic optimal transport and the
underlying ground cost function under consideration finally statistical applications
such as bootstrap are discussed

keywords optimal transport entropy regularization central limit theorem bootstrap
sensitivity analysis
msc 2020 subject classification primary 60b12 60f05 62e20
secondary 90c06 90c25 90c31

1

introduction

over the last decades the theory of optimal transport ot originating in the seminal
work by monge 1781 and later by kantorovich 1958 has gradually established itself as
an active area of modern mathematical research and related areas see rachev  rschendorf
1998ab villani 2008 santambrogio 2015 or galichon 2016 for comprehensive
monographs recently ot and variants thereof have also been recognized as an important tool for statistical data analysis eg in genetics evans  matsen 2012 fingerprint
identification sommerfeld  munk 2018 computational biology schiebinger et al 2019
tameling et al 2021 deformation analysis zemel  panaretos 2019 and medical imaging chen 2020 among others however for routine data analysis the computational
speed to solve the underlying linear program is still a bottleneck and the development
of algorithms for fast computation is a highly active area of research common linear ot solvers for bounded costs such as the auction algorithm bertsekas 1981


institute for mathematical stochastics university of gttingen goldschmidtstrasse 7 37077 gttingen
cluster of excellence multiscale bioimaging from molecular machines to networks of excitable cells
mbexc university of gttingen germany

max planck institute for biophysical chemistry am fassberg 11 37077 gttingen


1

bertsekas  castanon 1989 or orlins algorithm orlin 1988 have a worst case complexity n 3  for n denoting the size of the data and where  suppresses polylogarithmic
terms the best known theoretical worst case complexity to solve ot as a linear program
is given by n 25  lee  sidford 2014 for which however no practical implementation is known as an alternative approach cuturi 2013 suggests to replace the original
ot optimization problem by an entropy regularized surrogate the proposed algorithm
based on the work by sinkhorn 1964 1967 solves the corresponding optimization problem in about on 2  elementary operations altschuler et al 2017 dvurechensky et al
2018 since then entropy regularized ot erot has become a frequently used computational scheme for the approximation of ot peyr  cuturi 2019 amari et al 2019
clason et al 2021 tong  kobayashi 2021
in this paper we are concerned with erot on countable spaces x  x1  x2      and
y  y1  y2      possibly x  y a probability measure r on x s on y is represented
as an element in l1 x  resp l1 y the space of absolutely summable sequences indexed
over x resp y such that xx rx  1 and r  0 the set of couplings between r and s
also known as transport plans on the product space x  y is defined by
r
r s    l1 x  y a       0 
s
where a is the marginalization operator

 
   yy xy xx  
xx xy yy

a l1 x  y  l1 x   l1 y

for a cost function c  x  y  r and a regularization parameter   0 the entropic optimal
transport value between probability measures r and s is defined as
erot  r s 

inf

c   m 

rs

erot

the quantity c   xyx y cx yxy denotes the total costs associated to a transport
plan   r s and m  represents the mutual information
m    xy log
xx
yy



xy
xy
  0 
  xy log 
rx sy
  y y xy  x x x y   xx
yy

where by convention 0 log0  0 if there exists   r s such that c   m   
and erot  r s   ie if erot is feasible then there exists a unique minimizer
  r s  argmin c   m 

11

rs

known as entropic optimal transport plan proposition 21 plugging   r s into the
functional for total costs c  yields the sinkhorn costs
s  r s  c   r s

moreover erot is a convex optimization problem and hence exhibits a dual formulation
sup  r   s    exp 

l1r x 
l1s y

xx
yy

x  y  cx y
rx sy  rx sy 

2

derot

where l1r x  and l1s y denote the spaces of functions on x  y with finite expectation
under r and s respectively for a general dual formulation on polish spaces see chizat et al
2016 elements   x xx  l1r x    y yy  l1s y attaining the supremum in
derot are called optimal entropic dual potentials and the quantities  r  xx x rx 
 s  yy y sy are equal to their expectation with respect to r and s
statistical questions arise as soon as the probability measures r and s are estimated by
discrete empirical measures
rn 

1 n
 x
n i1 i

and

1 m
 y
m j1 j

m 

iid

12

iid

for samples x1      xn  r and independent y1      ym  s where x is the dirac measure at x this scenario occurs eg if the underlying probability measures are unknown
genevay et al 2019 when subsampling methods are applied for randomized approximations sommerfeld et al 2019 or if statistical inference based on erot is aimed for
bigot et al 2019 klatt et al 2020b fundamental to such tasks are asymptotic limit
laws of the empirical erot value and its corresponding plan so far existing results are
limited to certain restrictions on the ground space for probability measures supported on
finitely many points bigot et al 2019 proved that the limit law for the empirical erot
value centered by its population counterpart is normal and klatt et al 2020b showed
asymptotic normality for the empirical erot plan and empirical sinkhorn costs for the
euclidean space rd and squared euclidean costs mena  nilesweed 2019 derived a normal limit law of the empirical erot value when sampling from subgaussian probability
measures in contrast to the finite case the centering constant is given by the expected
value of the empirical estimator rather than the population quantity
herein we extend such results to countable spaces under suitable assumptions to
be discussed below on the ground costs and probability measures r s we prove that the
empirical erot value is asymptotically normal


nerot  rn  s  erot  r s  n 0 2 rs
d

13

d

as n   theorem 41 throughout this paper  denotes weak convergence billingsley
1999 the asymptotic variance 2 rs depends on the variance of the optimal entropic
dual potential  for derot with respect to r and is equal to
2 rs   x 2 rx    x rx  
2

xx

xx

concerning the erot plan we show for the empirical version centered by its population
counterpart as n   that

d
n  rn  s    r s  g0  rs

14


d
2
ns  rn  s  s  r s  n 0 
 rs

15

for a centered gaussian process g with covariance  rs theorem 42 the covariance  rs can be stated explicitly and depends on the regularization parameter 
and the erot plan   between r and s notably weak convergence in 14 takes place in
a suitable weighted l1 space over x  y this allows to characterize the limit distribution
of empirical sinkhorn costs corollary 44

3

2
as n   the asymptotic variance 
 rs is given by

2
 

 cx ycx  y  rsxyx y  
 rs 
xx x
yy  y

our limit laws are generically gaussian for r  s and r  s this is in strict contrast to
limit results obtained for the empirical nonregularized   0 ot value tameling et al
2019 and for the ot plan klatt et al 2020a on discrete spaces heuristically speaking whereas the asymptotic law of the nonregularized ot quantities depends on the
geometry of the boundary of the underlying transport simplex the entropy regularization
smoothes such quantities unique solutions are attained in the interior of the simplex
consequently gaussian fluctuations in the marginals translate to gaussian fluctuations
of erot quantities
additionally our results extend to the twosamples case and our method of proof
implies consistency of the nave noutofn bootstrap theorem 49 which is also in
contrast to nonregularized ot sommerfeld  munk 2018 the latter being useful as
the limit quantities in 14 and 15 are in general not accessible and its estimation from
data is computationally cumbersome
our analysis reveals an interesting interplay between the cost function and the probability measures r and s in order to guarantee weak convergence of empirical quantities an
issue which does not arise for finite ground spaces bigot et al 2019 klatt et al 2020b
in analogy to asymptotic results on finite spaces for uniformly bounded ground costs
sup
xyx y

cx y  

we find that our convergence results are valid if the borisovdudleydurst condition

16
 rx  
xx

durst  dudley 1980 borisov 1981 1983 is fulfilled this condition is known to be
necessary and sufficient for the function class h  1k  k  x  to be rdonsker1 which

is equivalent to weak convergence of the empirical process nrn  r in l1 x  towards
a centered tight gaussian process for unbounded ground costs a careful modification
of the usual l1 norm to a weighted version is required given a strictly positive function
x  x  1  we introduce the weighted l1 norm
al1



x

x 



  x xax 
xx

a weak limit of the empirical process nrn  r to a centered gaussian process in the
corresponding weighted l1 space is then achieved by the weighted borisovdudleydurst
condition yukich 1986 tameling et al 2019

17
 x x rx  
xx

in analogy to 16 weak convergence of the empirical process in l1x x  is equivalent
to the weighted function class hx  x 1k  k  x  being rdonsker the function


a class of real functions g on x is called rdonsker if the empirical process nrn r converges weakly

in the banach space l g of uniformly bounded real functions on g equipped with supremum norm
al g  supgg ag towards a tight borelmeasurable random element van der vaart  wellner
1996
1

4

x is linked to the ground cost and the exponential penalty term of the dual formulation
derot in an intricate fashion more precisely we assume throughout that there exist
possibly unbounded functions cx  cx  x  r cy  cy  y  r with cx  cx and cy  cy
such that
cx x  cy y  cx y  cx x  cy y
18

for all x y  x  y then the sum of absolute values of the functions cx and cx cy
and cy  multiplied with an exponential term of their respective difference see section 22
yields the function x  x  1  resp y  y  1  of the weighted l1 norm for
l1x x  resp l1y y ie
cx x  cx x


c y  cy y

y y  1  cy y  cy y exp  y


x x  1  cx x  cx x exp 

for all x  x 

for all y  y

as a consequence we require for our limit laws on the empirical erot value 13 in
addition to the weighted borisovdudleydurst condition 17 for r a moment condition
for s given by
 y xsy  
19
yy

note that the different nature of the conditions 17 and 19 results from the fact that
the measure r is randomly perturbed sampled while s is assumed to be fixed for the
related twosample results for which both r and s are randomly perturbed we also need
to consider the squareroot of sy in the sum hence the conditions become symmetric
our results on the empirical erot plan and sinkhorn costs additionally require the
dominating functions cx  cx to satisfy
sup cx x  cx x  
xx

this condition is met eg for squared euclidean costs cx y  x  y22 when the ground
space x is bounded whereas y may be selected to be unbounded section 411 or for
costs induced by a metric if the ground spaces x and y fulfill certain geometrical properties
section 412 the respective summability constraints for our limit laws of the empirical
erot plan 14 and sinkhorn costs 15 are similar to 19 we distinguish between
three types of cost functions and refer to table 1 for an overview let us emphasize that
our conditions on the probability measures r and s to ensure weak convergence of the
empirical erot plan are sharp under uniformly bounded ground costs or ground costs
with bounded variation remark 45
our proof technique is based on a general functional delta method with respect to
hadamard differentiable functionals in a weighted l1 space to verify this notion of differentiability for the erot value we use the dual formulation derot exploit strong
duality and explicitly use the weighted l1 structure concerning the erot plan we
employ an optimality criterion for primal and dual optimizers of erot and perform a
sensitivity analysis that is based on an implicit function approach additional mathematical challenges come into play as a certain operator is only invertible on a rather small
domain which avoids an adhoc application of a standard implicit function theorem for
hadamard differentiable functionals rmisch 2004 proposition 4 we refer to remark
37 for further details instead we carefully assess the individual error terms that are
caused by the perturbation and exploit explicit bounds for primal and dual optimizers
5

table 1 interplay between cost functions and weighted borisovdudleydurst conditions
on the probability measure r for weak limits of empirical erot plan and sinkhorn costs
type
bounded costs
costs with
bounded variation
costs with bounded
variation in x component

cost

cl x y  

cx  cx l x   
cy  cy l y  

cx  cx l x   

weighted borisovdudleydurst condition

xx rx  

xx 1  cx x  cx x rx  
yy 1  cy y  cy ysy  

xx 1  cx x  cx x rx  

yy 1  cy y  cy y rx  
c yc y
 exp 4 y  y sy  

the paper is structured as follows section 2 introduces basic notation states an
optimality criterion for primal and dual optimizers of erot and shows existence and
uniqueness of optimizers furthermore we derive explicit bounds for optimal solutions
and prove continuity of primal and dual optimizers section 3 proves that the erot value
and plan are hadamard differentiable in a weighted l1 space with respect to their marginal
probability measures theorems 32 and 34 herein we also motivate our candidates for
the respective derivative of erot value and plan section 4 presents the main results
on limit distributions for the empirical erot value and plan theorems 41 and 42
as particular cases we investigate the setting of squared euclidean costs as well as cost
functions which are induced by a metric furthermore we study the behavior of the
limit distributions as the regularization parameter tends to zero section 42 and verify
that the nave noutofn bootstrap is consistent for the empirical erot value and plan
theorem 49 section 5 contains the proofs for our sensitivity analysis of the erot
value and plan in section 6 we discuss our results and conclude with open questions
for future research the appendix contains proofs for results of section 2 and technical
details that are employed in the proof of the sensitivity for the erot plan
we finally stress that our results have immediate statistical applications which will be
detailed in subsequent work we briefly mention here biological colocalization of protein
networks recorded with superresolution microscopy which can be defined as a certain
functional of the regularized ot plan this has been done by klatt et al 2020b in
the context of finite ground spaces ie for the setting of a finite number of pixels our
conditions in table 1 can be viewed as a guarantee for the stability of this method for
large scale images with many pixels corresponding to the support of the intensity profile
of protein structures

2

preliminaries

in this section we state some basic results for erot most of which are well known and
the purpose here is to generalize them to a broader class of cost functions for the sake
of readability the technical details are deferred to appendix a
throughout this work we denote by l1 x  the space of summable sequences indexed
over x and equipped with total variation norm al1 x   xx ax  note that l1 x  can
be interpreted as the space of finite signed measures on x  its dual space can be identified
by l x  with norm bl x   supxx bx  given a positive function f  x  0 
we introduce the weighted l1 space l1f x  and its corresponding dual space l
f x  with
6

respective norms
al1 x    f xax 
f

and

xx

bl x   sup f x1 bx 
f

xx

for a  l1f x  and b  l
f x  we denote their dual pairing by a b  xx bx ax and
1
let px   r  l x  xx rx  1 r  0 be the set of probability measures on x 
we emphasize that we equip x with the discrete topology and do not embed it eg in
rd  hence for any probability measure r  px  its topological support is equal to
suppr  x  x  rx  0 and r is of full support if and only if rx  0 for all x  x  for a
probability measure r  px  we define with slight abuse of notation l1r x  as the space
of functions on x with finite expectation with respect to r for the weighted l1  and
l spaces on y and x  y we adapt the same notation

21

primal and dual optimizers

without loss of generality we assume that the cost function c is nonnegative otherwise
according to 18 define the nonnegative function
c x  y  0 

cx y  cx y  cx  cy x y

with cx cy x y  cx xcy y which is bounded by cx y  cx cx xcy cy y
and satisfies for any   r s that c   c   cx  r  cy  s hence in case
cx  l1r x  and cy  l1s y it follows that the objective functions of erot with cost
function c and with the shifted nonnegative cost function c only differ by a constant which
does not affect the set of minimizers
we start with a general result for existence of optimizers for erot and formulate a
necessary and sufficient optimality criterion recall that the primal problem erot and
its dual derot are said to satisfy strong duality if their respective optimal values are
equal
proposition 21 if the primal problem erot is feasible then there exists a unique
erot plan    r s and a pair       l1r x   l1s y of optimal entropic dual
potentials for derot unique up to a constant shift ie for any pair of optimal entropic
dual potentials       l1r x   l1s y there exists a constant   r with
x  x  y  y  

for all x  suppr y  supps moreover strong duality holds and the elements  
l1 x  y and    l1r x l1s y are optimal for erot and derot respectively
if and only if
xy  exp 

 xy  rx

yy

x  y  cx y
rx sy

and

 xy  sy

xx

for all x y  x  y

for all x  x and y  y

21
22

the assertion on strong duality follows by chizat et al 2016 theorem 32 which also
contains an optimality criterion that is however limited to    l x   l y for
an extension to potentials in l1r x   l1s y we follow a technique by braunsmann 2018
details can be found in appendix a

7

remark 22 according to proposition 21 optimal entropic dual potentials      are
uniquely characterized by the relation


y  cx y



  log   exp 
sy 


yy




  cx y
rx 
y   log   exp  x

xx

x

22

for all x  suppr
for all y  supps

23

bounds and continuity for entropic optimizers

bounds for optimal entropic dual potentials turn out to be of crucial importance as they
will be of particular use for proving hadamard differentiability of the erot value and
plan for squared euclidean costs such bounds are readily available by mena  nilesweed
2019 it is the purpose of this section to generalize their argument to a broader class of
functions to simplify notation we define for   0 and   r the functions
cx  x  1  x  1  cx x  cx x

cx x  cx x


c x  cx x

x  x  1  x  cx x exp  x

x  x  1  x  exp 

24

where we note by cx  cx and cx  1 for   0 that 1  x  x  further we set x  1x 
x  1x and define likewise the functions cy  y  y on y

proposition 23 let r  l1 x  s  l1 y be two probability measures and suppose that
erot  r s is feasible then there exists an r salmost surely unique pair of optimal
entropic dual potentials       l1r x   l1s y with   r     s  12 erot  r s  0
and
cx x  cx  r   logy  s  x  cx x  cy  s
cy y  cy  s   logx  r  y  cy y  cx  r

for all x  suppr y  supps further for the erot plan   in 11 it holds for all
x y  x  y that

 xy

cx  r  cy  s
x  r1 y  s1

c  r  cy  s
 rx sy x x y y exp  x


1
rx sy 1
x xy y exp 

in particular we note that the upper bounds for the optimal entropic dual potentials    
are finite if cx  l1r x  and cy  l1s y whereas the lower bounds are finite if additionally
the condition x  l1r x  and y  l1s y is fulfilled these bounds imply a variety of
convergence results for erot  as well as for optimizers of erot and derot we
fix an element y1  y and assume that sy1  0

8

proposition 24 let rk  sk kn  l1x x l1y y be pairs of probability measures on x
and y that converge to r s and consider corresponding dual optimizers k  k kn       

rx  ry of derot for rk  sk kn  r s respectively such that ky
 y1  0 for all
1
k  n for each x  suppr and y  supps it then follows as k tends to infinity that
kx  x

and


 y 
ky

as a consequence we obtain for k   that
erot  rk  sk 

  rk  sk 

 erot  r s


  r s

and

in l1cx cy x  y

proposition 24 states that the erot value resp plan is a continuous mapping from
a subset of l1x x   l1y y into r resp l1cx cy x  y this observation will be
strengthened by a refined sensitivity analysis which is the focus of the next section

3

sensitivity analysis

in this section we prove hadamard differentiability of the erot value and plan with respect to the marginal probability measures for a suitable weighted l1 norm
definition 31 a mapping   u  v between normed spaces u v is said to be hadamard
h
differentiable at u  u if there exists a continuous linear map du
  u  v such that for
any sequence hn  u converging to h and any positive sequence tn nn with tn  0 such
that u  tn hn  u it holds


 u  tn hn    u
h
 du
 h  0
tn
v

31

for n   further let u0  u then  is hadamard differentiable tangentially to u0 at u
if the limit 31 exists for all sequences hn  t1
n kn  u converging to h where kn  u0
and tn  0 the hadamard derivative is then defined on the contingent bouligand cone
to u0 at u
tu u0   h  u  h  lim t1
n kn  u kn nn  u0  tn nn  r0  tn  0 
n

concerning the derivative of the erot value defined in erot we recall by the relation
between primal and dual optimizers        for r s proposition 21 that

 rx sy     r     s
erot  r s    r     s    xy
xx
yy

this indicates that the hadamard derivative of erot  at r s is characterized by   
    an observation that is in line with findings on finite ground spaces by bigot et al
2019 and klatt et al 2020b on countable spaces this is also valid under suitable
conditions on the cost functional and the probability measures r s

theorem 32 assume the cost function satisfies 18 and let r  l1 x  s  l1 y be
x

9

y

probability measures with full support then for   0 the function

erot  p x   l1 x   p y  l1 y  r
x

y

is hadamard differentiable at r s tangentially to p x   l1 x   p y  l1 y
x
y
with hadamard derivative
h
drs
erot   trs p x   l1 x   p y  l1 y  r
x

h  h     h     h 
x

y



x



y

y

where      are optimal entropic dual potentials for derot with marginals r s
herein the set
trs p x   l1 x   p y  l1 y





 y 1

x
1
x
y
 h  l x   hx  0  h  l y  hy  0
x
y




xx
yy


x

y

represents the contingent cone at r s with respect to l1 x   l1 y
x

y

the proof is deferred to section 51 at its heart is the strong duality statement proposition 21 in conjunction with pointwise convergence of optimal entropic dual potentials
proposition 24 we explicitly exploit the weighted l1 convergence for hadamard differentiability of the erot value on countable spaces remark 51
deriving the hadamard derivative of the erot plan is more challenging and requires
sophisticated considerations before we state this in a formal way we give a heuristic
derivation for this purpose we consider the fixed element y1  y from previous section
and adapt the notation that for any element b  ry we set b  by2  by3       ryy1  
ie the element where we omit the entry at y1  in particular we define






1
p y  s  l yy1   sy  0 1 s  0




yyy1 



as the set of probability vectors on y where we omit the entry for y1  note that
for a given element s  p y we obtain the associated probability measure by s 
1  yyy1  sy  sy2  sy3      at the core of our approach is the reformulation of
the optimality criterion proposition 21 as an operator defined on suitable spaces we
introduce the marginalization operator omitting the entry at y1  ie
a  l1 x  y  l1 x   l1 yy1 


xy xx


   yy
xx xy yyy1 

its dual operator a mapping l x   l yy1   l x  y will be extended as
follows
at  rx

r

yy1 

r

x y



ax1
a b   ax2
 

10

ax1  by2 ax1  by3 
ax2  by2 ax2  by3  




these operators enable us to define
f l1 x  y  rx  ryy1    l1 x   l1 yy1   rx y  rx  ryy1  
1
t
  exp   a     c  r  s

    r s   
r
a    


s

where  denotes the componentwise product and  is defined as the tensor product of the
probability measures r  sxy  rx sy for all x y  x  y in terms of f the optimality
criterion from proposition 21 is restated as follows
corollary 33 for given probability measures r s  p x p y and   0 the element
  l1 x  y and the potentials  0    l1r x   l1s y  rx  ry are optimal for
erot and derot respectively if and only if
f    r s   0

32

equation 32 intuitively contains a proposal for the hadamard derivative of    indeed
a nave application of the usual calculus of partial derivatives denoted by d from finitedimensional spaces with respect to r s yields the partial derivative of f at r s  p x  
p y for fixed elements   l1 x  y     rx  ryy1   given by
drs

  rs 

h

x

 hy


f l1 x   l1 yy1   rx y  rx  ryy1  

1
 exp   at     c  r  hy  hx  s


hx





y


h

y
y
where hy   yyy1  hy
y  hy2  hy3      likewise the nave partial derivative of f
with respect to    for the elements     r s  is equal to

d

  rs 

f l1 x  y  rx  ryy1   rx y  rx  ryy1  


hx y  hx   hy


hx y  1 exp  1 at     c  r  s  at hx   hy




x
y



a h

motivated by an implicit function approach a proposal for the hadamard derivative of  
at the pair of probability measures r s  p x   p y is
 d     rs f


1


 drs     rs f


33

let us stress that the operator in 33 is neither obtained by rigorous mathematical considerations nor is it clear that such an operator is bounded or even exists it is the content
of the next statement to make 33 mathematically precise this requires assumptions on
the cost function and the probability measures r and s for their formulations we remind
the reader of the functions cx and cy from section 22
theorem 34 suppose cx  cx l x    cy  cy l y   and let r  l1cx x 

s  l1cy y be probability measures with full support further consider the erot plan
11

  r s for   0 as a mapping

   p x   l1cx x   p y  l1cy y  l1cx cy x  y

then   is hadamard differentiable at r s tangentially to p x   l1cx x   p y 
l1cy y with hadamard derivative given by
h
drs
   trs p x   l1cx x   p y  l1cy y  l1cx cy x  y

hx  hy    d    rs f


1


 drs    rs  f hx  hy
 


the derivative is a welldefined and bounded operator and the contingent cone at r s
with respect to l1cx x   l1cy y is given by
trs p x   l1cx x   p y  l1cy y





 y 1

y
y
h

l

0



0

h
 hx  l1cx x   hx

cy
x
y




yy
xx


the proof is deferred to section 52 but we like to sketch its main arguments here
sketch of proof we first verify that the proposed operator for the derivative 33 is welldefined and bounded proposition 52 herein we require that cx  cx l x    to
ensure the validity of the neumann seriescalculus we then proceed with the proof of
hadamard differentiability of the erot plan by definition this requires to consider a
1
y
sequence tn nn such that tn  0 and a converging sequence hx
n  hn nn  lcx x  
1
y
1
l1cy y with limit hx  hy  and r  tn hx
n  s  tn hn   p x   lcx x   p y  lcy y
for each n  n to this end we verify that erot plan is locally lipschitz continuous
proposition 53 and show that the difference quotient for finitely supported perturbations
can be approximated by the proposed derivative proposition 54 these results in
conjunction with a notion of finite support approximation appendix c allow us to find
for any   0 an integer n  n such that for all n  n holds


y
  r  tn hx
h
n  s  tn hn   r s
 drs
  hx  hy 
tn
l1

cx cy

x y

 

remark 35 for any r r   p x   l1cx x  s s  p y  l1cy x  it holds that
  r s    r   s l1

cx cy x y

 max r  r  l1

cx

x 

 s  s l1

cx

x 



this implies under cx  cx l x    and cy  cy l y   for a sequence tn nn 

1
y
1
0  such that tn  0 and a converging sequence hx
n  hn nn  lcx x   lcy y with
1
1
y
x
y
x
limit h  h  and r  tn hn  s  tn hn   p x   lcx x   p y  lcy y for all n  n

12

that
h
drs
  hx  hy 

l1c

x cy

x y

 lim 
n

 lim max hx
n l1
n

h
which asserts drs
   0

cx

x 

y

  r  tn hx
n  s  tn hn    r s

tn
l1

cx cy

 hy
n l1

cy x 

  max hx l1

cx

x 

 hy l1

x y

cy y



remark 36 generalization to unbounded ground costs our proof technique
generalizes to an asymmetric setting where we assume cx  cx l x    and allow for
cy  cy l y   for this extension we employ the space l14 y which exhibits a
strictly stronger norm than l1cy y when cy  cy l y   in fact we show in our
proof in section 52 that
y

   p x   l1cx x   p y  l14 y  l1cx cy x  y
y

is hadamarddifferentiable with an analogous derivative as in theorem 34 in the proof
we specifically make use of the fact that at least one component of the cost function has
bounded variation it remains an open problem if this can be relaxed to account for general
unbounded ground costs remark 55
remark 37 our proof for the sensitivity of the erot plan does not rely on a standard
implicit function theorem for hadamard differentiable functions rmisch 2004 proposition 4 the main issue in employing this result lies in the selection of suitable normed
spaces for the domain and range of f to ensure that the mapping f is welldefined the
range space has to be chosen sufficiently large while at the same time the range space has
to be sufficiently small such that the operator d     rs  f1 is welldefined on



a neighborhood around the origin in the range space as it turns out by lemma b1 in
appendix b the operator d     rs  f1 only has a fairly small domain re


mark b2 hence to prove the claim on hadamard differentiability we instead perform a
careful analysis of the individual perturbation errors and show that they tend towards zero

4

limit distributions

we derive in this section the limit distributions of the empirical erot value and plan
more precisely we estimate the erot quantities erot  r s and   r s by plugin
estimators erot  rn  m  and   rn  m  based on empirical counterparts rn and m
12 of the probability measures r and s we then characterize the statistical fluctuation
erot  rn  m  and   rn  m  around their respective population version erot  r s
and   r s by limit distributions herein weak convergence of measures is denoted by
d

 and we refer to van der vaart  wellner 1996 for a general introduction the
underlying metric space in which weak convergence of the empirical erot plan occurs is
a suitable weighted l1 space
our results are based on an application of the functional delta method for tangentially
hadamard differentiable functionals van der vaart  wellner 1996 hence as our sensitivity analysis section 3 is based on a weighted l1 space l1f x  for a suitable choice

of f  x  0  we emphasize that the empirical process nrn  r has to converge
13

weakly in this respective space l1f x  to guarantee such weak convergence it is necessary
and sufficient that the probability measure r satisfies the weighted borisovdudleydurst

condition xx f x rx   yukich 1986 theorem 6tameling et al 2019 lemma
26 we note that weak convergence of the empirical process in l1f x  is equivalent to the
function class hf  f 1k  k  x  being rdonsker overall this leads to conditions as
summarized in 19 and table 1 the limit law is characterized by a zero mean gaussian
process with covariance r  rx x  defined by


rx 1  rx  if x  x 
rxx  
41



r
r
if
x

x


x
x


analogous assertions hold for the empirical process mm  s with covariance s 
ryy

41

empirical entropic optimal transport

without loss of generality we assume that r and s have full support else we consider
x  suppr and   supps as the respective ground spaces we first state our main
results on limit laws of erot quantities for general cost functions implications to more
popular ground costs such as squared euclidean costs are derived in further subsections
recall the definition of x in 24

theorem 41 suppose that the cost functions c satisfies 18 and let r  p x l1 x 
and s  p y  l1 y be two probability measures for   0 denote by      correy
sponding optimal entropic dual potentials of derot
x


iid
i one sample suppose x1      xn  r and that xx x x rx   then as n
tends to infinity weak convergence holds


nerot  rn  s  erot  r s  gr     n 0 2 rs
d

d

where gr is a tight centered gaussian process with covariance r defined in 41
and
2
2 rs   x 2 rx    x rx  
xx

xx

ii two samples suppose in addition that y1      ym  s independently of the xi s


and that xx x x rx   and yy y y sy   then for minm n  
m
with mn
   0 1 it follows that



nm
d 
erot  rn  m   erot  r s  gr     1  gs    
nm
d
2
r s
 n 0 

where gr  gs are tight centered independent gaussian processes with associated
covariances r and s respectively and
2
r s    x 2 rx    x rx    1    y 2 sy    y sy  

2

xx

xx

2

yy

yy

for our main results on the empirical erot plan 11 we require additional assumptions
on the cost function
14

theorem 42 assume the cost function satisfies 18 such that cx  cx l x   
and cy  cy l y   further let   0 and consider probability measures r  p x  

l1cx x  and s  p y  l1cy y


iid
i one sample suppose x1      xn  r and that xx cx x rx   then as n
tends to infinity weak convergence holds

d
h
n  rn  s    r s  drs
  gr  0

in l1cx cy x  y

where gr is a tight centered gaussian process with covariance r from 41 and
d h the hadamard derivative in theorem 34
ii two samples suppose in addition that y1      ym  s independently of the xi s


and that xx cx x rx   and yy cy y sy   further let minm n  
m
with mn
   0 1 then it follows that




nm
d
h
  rn  m     r s  drs
   gr  1  gs 
nm

in l1cx cy x  y with independent gaussian processes gr  gs as in theorem 41

h
remark 43 by linearity of the hadamard derivative drs
  it follows that the weak
limits for the onesample and twosamples case are both centered gaussian processes

proofs of theorems 41 and 42 we start with the assertions on the erot value in theorem 41 by our summability constraints 17 and 19 for assertion i we obtain using
tameling et al 2019 lemma 26 for n   the weak convergence

d
nrn  r  gr in l1 x 
x

further by portmanteaus characterization of weak convergence in terms of closed sets
van der vaart  wellner 1996 theorem 134ii it follows that

1  lim sup p  nrn  r  hx  l1 x   hx
x  0
x
n

xx

 p gr  hx  l1 x   hx
x  0 
x
xx

ie the weak limit gr takes values in hx  l1 x  xx hx
x  0 for assertion ii
x
we conclude by the weighted borisovdudleydurst conditions for r and s combined with
independence of the samples x1      xn and y1      ym using van der vaart  wellner
m
1996 corollary 145 for minm n   mn
  that




nm
d
rn  m   r s   gr  1  gs 
nm

in l1 x   l1 y
x

where gr is independent from gs and the pair gr  gs  takes values in

y
1
y
hx  l1 x   hx
x  0  h  ly y  hy  0
x
xx

yy

15

y

concluding by theorem 34 the erot value is hadamard differentiable tangentially to
p x   l1 x   p y  l1 y note that the underlying topology for hadamard
x
y
differentiability and for the weak convergence coincide hence all assertions from theorem
41 on the limit law follow as an application of the functional delta method for tangentially
hadamard differentiable functions van der vaart  wellner 1996 theorem 394 in
particular by linearity of the tangential hadamard derivative the asymptotic distribution
is characterized by a zero mean gaussian distribution where the limiting variance for the
onesample case is given by
2 rs   x x rxx   x 2 rx    x rx  
2

xx x

xx

xx

the calculation for two samples is analogous for the assertions on the erot plan we
use the same proof strategy and apply the functional delta method in conjunction with
hadamard differentiability theorem 34
as a simple corollary we derive the limit laws of empirical sinkhorn costs we only
present the one sample case the twosamples case is analogous

corollary 44 assume the same setting as for assertion i of theorem 42 then as
n tends to infinity it follows that


h
ns  rn  s  s  r s  c drs
  gr  0 
d

notably by continuity and linearity of c   l1cx cy x  y  r the weak limit is also
centered gaussian
remark 45 sharpness of conditions for cost functions with bounded variation
cx  cx l x    cy  cy l y   and in particular uniformly bounded ground
costs cl x y   our stated assumptions for the validity of our limit laws for the
empirical erot plan are sharp this is a simple consequence of the fact that weak

convergence of the empirical erot plan n  rn  n     r s in l1cx cy x  y re

quires that the marginal empirical processes nrn  r and nn  s converge weakly in
l1cx x  and l1cy y respectively such weak convergence holds if and only if the respective


weighted borivovdudleydurst conditions xx cx rx   yy cy sy   are fulfilled
tameling et al 2019
remark 46 generalizations and degeneracy of limit laws i as discussed in
section 21 our theory generalizes to cost functions which might attain negative values
ii our sensitivity analysis on the erot plan can be extended to the asymmetric case
where cx  cx l x    and cy  cy l y   remark 36 this covers
limit results for the empirical erot plan and sinkhorn costs to this setting for
these limit laws we require that r  l1cx x  and s  l14 y as well as a weighted
x

borisovdudleydurst condition 17 for the probability measures from which samples are taken a summary of the different settings for cost function and associated
summability constraints for the onesample case from r is detailed in table 1

iii for a common countable metric ground space x  d ie x  y our results for the
cost function cx y  dp x y p  1 show no substantial difference in the limit
16

law for empirical erot quantities between the cases r  s and r  s additionally
our derived limit distributions generally do not degenerate as optimal entropic dual
potentials are typically nonconstant due to their relation with each other remark
h
22 and since the hadamard derivative drs
  does not vanish for any r s remark 35 these observations are in line with previous findings for finite spaces
bigot et al 2019 klatt et al 2020b and for continuous spaces with squared euclidean costs mena  nilesweed 2019 in fact for probability measures with
finite support our required summability constraints are trivial and our findings coincide with results by bigot et al 2019 and klatt et al 2020b
vi in contrast limit results for the empirical nonregularized ot value obtained by
tameling et al 2019 show a clear distinction in the limit behavior between the cases
r  s and r  s further for x  y and cx y  dp x y with p  1 the obtained
limits by tameling et al 2019 degenerate for r  s with suppr  x if and only
if x has no isolated point this illustrates again that limit laws for empirical nonregularized ot differ fundamentally from their entropy regularized counterparts
411

squared euclidean costs

for squared euclidean costs the theory of nonregularized optimal transport is well developed eg existence of an optimal map to the monge problem brenier 1987 1991
or for gradient flows in the 2wasserstein space on rd santambrogio 2015 we like
to contribute to this theory by stating explicit results for the framework of squared euclidean costs cx y  x  y22 with ground spaces x  y  rd for some d  n by youngs
inequality it holds for p q  1 with p1  q 1  1 and   0 for all x y  x  y that
x22 

2 xpp
p

 y22 

2 yqq
q

 x  y22  x22 

2 xpp
p

 y22 

2 yqq
q



hence we see that the dominating functions from 18 can be chosen as
cx x



x22



2 xpp
p

cy y



x x  1  x2p
2p  exp 



y22



2 yqq
q



y y  1  y2q
2q  exp 

4
xpp 
p

4
yqq 
q

where  denotes the maximum between two numbers and f  g states the existence of two
constants k k  0 such that kg  f  kg
notably the assertions of theorem 41 for the empirical erot value hold if r  l1 x 

s  l1 y and an associated weighted borisovdudleydurst condition 17 is satisfied
y
in case of p  q  2 these conditions require that the probability measures r s are subgaussian up to a certain order these findings complement results by mena  nilesweed
2019 on the limit law of the empirical erot value for subgaussian probability measures
on rd of any order however in contrast to our findings the centering constant in their
central limit theorem is given by the expected value of the empirical estimator instead of
the population version moreover our limit laws remain valid if one probability measure
is not subgaussian provided that the other one is sufficiently concentrated
in case both ground spaces x  y are bounded subsets in rd  we note that the cost
function is uniformly bounded hence our results on the empirical erot value theorem
41 as well as the empirical erot plan theorem 42 and empirical sinkhorn costs
x

17

corollary 44 are valid as long as the probability measures satisfy the usual unweighted
borisovdudleydurst condition if only the ground space x is contained in a closed ball
br 0  x  rd  x2  r whereas y is an unbounded set we obtain by cauchyschwarz
inequality for all x y  x  y that
x22  2r y2  y22  x  y22  x22  2r y2  y22 

upon defining the functions cx x  x22 and cy y  y22  2r y2 we see that
cx  cx l x   0 and cy  cy l y   as a consequence it follows that the weight
functions for our results on the erot value theorem 41 are characterized by
x x  1

y y  1  y22  exp 

4
y2 


for our limit results on the erot plan theorem 42 and sinkhorn costs corollary
44 we require that r  l1cx x  s  l14 y as well as associated borisovdudleydurst

conditions 17 on the measure from which sampling occurs remark 46 ii the
underlying weight functions are chosen as
y

cx x  1
412

4y y  1  y22  exp 

16
y2 


general metric costs

cost functions in regularized optimal transport on general metric spaces are typically
defined by the underlying metric assuming both ground spaces x  y to be subsets of a
common metric space m d let the cost function be cx y  dx y for all x y  x  y
given some fixed element z  m we see by triangle inequality that
cx x  dx z

cx x  0

cy y  dy z

cy y  0

are suitable dominating functions for the cost function satisfying 18 hence the weight
functions for our limit laws on the empirical erot value theorem 41 are equal to
x x  1  dx z exp 

dx z



y y  1  dy z exp 

dy z



in order to obtain weight functions without the exponential term we assume that the
ground metric d fulfills
 

sup
xyx y

dx z  dz y  dx y  

42

this condition is satisfied if x is contained in a bounded set ie in case supxx dx z  
it also holds for m d  rd  1  with x   a y  b  for some a b  rd  in
fact condition 42 is a separability constraint ie the larger the distances dx z and
dz y the better the separation between x and y meaning the larger the distance dx y
most notably both ground spaces x and y can be unbounded sets under condition 42
we can select the functions cx  cy as
cx x  dx z  2

and

18

cy y  dy z  2

which yields that cx  cx l x    and cy  cy l y   hence it follows that the
exponential terms in the weight functions x and y disappear
x x  cx  1  dx z

and

y y  cy  1  dy z

in particular we note that our results on the limit laws of the empirical erot value
and plan theorems and 41 and 42 are both valid under identical assumptions ie
r  l1cx x  and s  l1cy y as well as a weighted borisovdudleydurst condition 17

42

relation to nonregularized optimal transport

we assess the limit behavior of the empirical erot value and sinkhorn costs in the
regime   0 for this purpose we introduce the nonregularized optimal transport
value between r and s as
ot r s  inf c 
ot
rs

provided that cx  l1r x  cy  l1s y it follows by villani 2008 theorem 59 that
ot r s is finite and that there exists a possibly nonunique optimal solution  0  r s
such that ot r s  c  0  for our analysis we require an upper bound for the quantities
erot  r sot r s and s  r sot r s hence let  0 be an ot plan for the nonregularized problem ot for r s and denote for   0 its entropy regularized counterpart
by    by optimality for their respective optimization problem it follows that
c  0   c     c     m     c  0   m  0 

where m    represents the mutual information this yields

0  s  r s  ot r s  erot  r s  ot r s  m  0 

most notably if one of the probability measures has finite entropy ie
hr s  min   rx log 
xx

1
1
  sy log    
rx yy
sy

we obtain by the bound 0  m   hr s for any   r s cover  thomas 1991
theorem 241 that
s  r s  ot r s  erot  r s  ot r s  hr s  o

note that if a probability measure fulfills the borisovdudleydurst condition then it
necessarily has finite entropy
remark 47 for finitely supported probability measures it was shown by cominetti  san martn
1994 that s  r s  ot r s  oexp for some constant   0 depending on r
and s as  tends to zero however as noted by weed 2018 the upper bound oexp
appears to fail in general for countably supported probability measures where instead the
rate s  r s  ot r s  o seems to be tight
iid

for a sequence of iid samples x1      xn  r and its associated empirical measure rn
we obtain by antos  kontoyiannis 2001 corollary 1 that limn hrn  s  hr s
hence lim supnn hrn  s   performing a decomposition gives

nerot n rn  s  erot n r s


 nerot n rn  s  ot rn  s  not r s  erot n r s

 not rn  s  ot r s
19


for n  o1 n the first and second term converge to zero whereas the third term
converges weakly as described by tameling et al 2019 in our notation the weak limit
of the empirical nonregularized ot value as n tends to infinity is characterized by

d
  gr 
not rn  s  ot r s  max


 s

43

where s  denotes the set of dual optimizers of ot and gr represents the gaussian
process with covariance r these considerations are valid if r  l1cx x  s  l1cy y
and r additionally satisfies an associated weighted borisovdudleydurst condition 17
both limit laws for nonregularized ot value and its entropy regularized counterpart
are essentially governed by the respective set of dual optimizers however unlike the
entropic variant where the limit law is always characterized by a gaussian due to uniqueness of dual optimizers the set of dual optimizers for the nonregularized ot problem
may not be unique resulting in a maximum of gaussian distributions which in general

fails to be gaussian in case of n  o1 n we also obtain a similar limit law for

ns n rn  s  s n r s as n tends to infinity
remark 48 degeneracy of limit law as noted by tameling et al 2019 the limit
distributions provided in 43 may degenerate in certain cases namely when the set of dual
optimal solutions s  for the nonregularized ot problem only contains constant elements
this occurs on a common metric space x  d ie x  y under r  s with suppr  x for
a cost function cx y  dp x y with p  1 if and only if x has no isolated points hence

for n  o1 n the limit distribution of the empirical erot value and sinkhorn costs
may degenerate in contrast for fixed   0 the limit law generally does not degenerate
since optimal entropic dual potentials are typically nonconstant remark 22 and as the
hadamard derivative of the erot plan differs from zero remark 35

43

bootstrap

our findings from theorems 41 and 42 on the distributions of the empirical erot
value and plan are asymptotic results in order to estimate the respective nonasymptotic
distribution typically bootstrap methods are applied on finite and countable spaces
sommerfeld  munk 2018 and tameling et al 2019 showed that the nonregularized
ot value is only directionally hadamard differentiable ie that the hadamard derivative
with respect to r and s is nonlinear as a consequence the nave noutofn bootstrap
for the approximation of the distribution of the empirical nonregularized ot value fails
however the erot plan on countable spaces is hadamard differentiable with a linear
derivative therefore it follows that the nave noutofn bootstrap appears to be a
consistent estimation method
to make this statement precise we follow van der vaart  wellner 1996 denote the
p

notion of convergence in outer probability by  and consider for a given banach space
b the set of bounded lipschitz functions with lipschitz modulus at most one
bl1 b  g b  r  sup gx  1 gx1   gx2   x1  x2 b x1  x2  b 
xb

with this notation we will prove the consistency of the bootstrap for the erot value
and plan as an application of the functional delta method in conjunction with consistency
of the bootstrap empirical process

20

iid

theorem 49 consider an empirical measure rn derived by a sample x1      xn  r
and denote by rn  n1 ni1 xi the empirical bootstrap estimator for rn based on a sample

x1      xn  rn  under the same setting as in assertion i of theorem 41 the nave
bootstrap is consistent for the erot value ie as n tends to infinity it holds that
iid

sup
hbl1 r


e h nerot  rn  s  erot  rn  sx1      xn 

p
e h nerot  rn  s  erot  r s   0

likewise under the same assumptions as for assertion i of theorem 42 the erot plan
is also consistent for the nave bootstrap ie as n tends to infinity it holds that
sup
hbl1 r


e h n  rn  s    rn  sx1      xn 

p
e h n  rn  s    r s   0

analogous statements on bootstrap consistency are valid for the twosamples case ie
iid
iid
when y1      ym  sm are independent bootstrap realizations from x1      xn  rn 

proof for a positive function f  x  0  we prove that if xx f x rx   then
sup

hbl1 l1f x 



p
e h nrn  rn x1      xn   e h nrn  r  0

44

as n tends towards infinity the assertion then follows by tangential hadamard differentiability of the erot value and plan theorems 32 and 34 in conjunction with
the functional delta method for the bootstrap van der vaart  wellner 1996 theorem
3911 for the function class hf  f 1k  k  x  we define the banach space l hf 
as the space of uniformly bounded real functions on hf equipped with supremum norm
al hf   supghf ag then it holds by van der vaart  wellner 1996 theorem
361 for n   that
sup
hbl1 l hf 



p
e h nrn  rn x1      xn   e h nrn  r  0

if hf is rdonsker indeed by yukich 1986 theorem 6 the function class hf is r
donsker if and only if xx f x rx   as l1f x  can be continuously embedded into
l hf  and since any bounded lipschitz function on l1f x  whose modulus is bounded
by one can be extended to a bounded lipschitz function on l hf  mcshane 1934

theorem 1 we conclude that the condition xx f x rx   implies 44

5

proofs for sensitivity analysis

we recall that the cost function c is dominated by functions cx  cx  cy  cy as in 18
additionally let us recall the functions cx  1  cx   cx  x  exp  cx  cx  and
x  cx x for given parameters   r and   0 since cx  cx as well as cx  1 it
holds for any   0 that 1  x  x  further given another real number   r it holds


 the functions y and y are defined analogously and feature similar
that x x  x
properties
21

51

sensitivity of erot value

proof of theorem 32 the claim on the contingent cone is a simple consequence of aubin  frankowska
1990 proposition 421 in conjunction with r and s having full support for given probability measures r  p x   l1 x  s  p y  l1 y denote the objective of
x
x
derot by

drs l
cx x   lcy y   

    r   s    exp 
xx
yy

x  y  cx y
 rx sy  rx sy 


by definition of hadamard differentiability consider tn nn with tn  0 and a converging
y
1
1
x
y
x
y
sequence hx
n  hn nn  l x l y with limit h  h  such that rtn hn  stn hn  

p x   l1 x   p y  l1 y for all n  n denote by n  n  and     
x

y

y
the optimal entropic dual potentials for r  tn hx
n  s  tn hn  and r s respectively as in
proposition 24 notably we consider those potentials that are equal to zero outside of the
support of the underlying probability measure by definition of these optimal potentials
we see that
x

y

drtn hn stn hn       drs     
x

y

 drtn hn stn hn n  n   drs     
x

y

 drtn hn stn hn n  n   drs n  n 
x

y


y
the term from the second line is equal to erot  rtn hx
n  stn hn erot r s hence
it follows that

1
y

 x
 y
erot  r  tn hx
n  s  tn hn   erot r s    h     h 
tn
x
y
1
  drtn hn stn hn       drs         hx      hy 
tn
x
y
1
  drtn hn stn hn n  n   drs n  n     hx      hy  
tn


51
52

once we show that the terms in 51 and 52 converge to zero as n tends to infinity our
proof is finished denoting the erot plan for r s by   we obtain using the relation
between primal and dual optimizers proposition 21 that
x
y
1
drtn hn stn hn       drs         hx      hy 
tn

xy

x
 y
y
y
rx  tn hx
  hx

n  h     hn  h  
nx sy  tn hny   rx sy 
tn xx rx sy

yy

y
x
 y
  hx
n  h     hn  h   tn  exp 

x  y  cx y

xx
yy



y
hx
nx hny 

53

y
herein we exploit the fact that xx hx
nx  yy hny  0 for all n  n for the first term
of 53 it follows by hlders inequality for n   that
x
 x
x
  hx
n  h    x hnx  hx   
xx

xx

22

x  x
h  hx
x cx x
cx x nx

  l

cx

x 

x
hx
n  h l1

cx

 0

x 

54

where we explicitly made use of the weighted l1 convergence of hn towards h and our
bounds for  from proposition 23 to ensure that  l x    likewise it follows
cx

y
for n   that    hy
n  h   0 for the third term of 53 we note by our bounds from
1
1
y
proposition 23 and convergence of hx
n  hn  in l x   l y that
x

y

rr
x  y  cx y x y rrrr
rrr
sup rrr  exp 
hnx hny rrrr

rr
nn rr xx
r yy
r
rr
rrr
c  r  cy  s
y rrr
h
 sup rrrr  y xy yhx
 exp  x
nx ny rrr  

rr
nn rrr xx
r
r yy

55

which implies by tn  0 that all terms of 53 tend towards zero for the terms from
52 we obtain
x
y
1
drtn hn stn hn n  n   drs n  n     hx      hy 
tn
y
 y
 y
x

 n    hx     hx
n  h   n    h     hn  h 







56

nx  ny  cx y

y
 rx  tn hx
 exp 
nx sy  tn hny   rx sy  
tn xx


57

yy

recall that we already showed that the second and the last term in 56 converge to zero
for the first and third term of 56 we use pointwise convergence of the optimal entropic
dual potentials proposition 24 in conjunction with our bounds from proposition 23 to
apply lebesgues dominated convergence theorem at last it remains to show that the
series in 57 converges to zero to simplify notation we write xn and n instead of
y
suppr  tn hx
n  and supps  tn hn  respectively exploiting the relation between primal
and dual optimizers proposition 21 we see by a direct computation as in 53 and due
to our convention of n  n vanishing on xn c  n c for the term in 57 that




nx  ny  cx y

y
 rx  tn hx
 exp 
nx sy  tn hny   rx sy 
tn xx

yy

  

hy
ny

yn

 

 tn  exp 

nx  cx y

xxn
yn

 tn   exp 


 cx y
nx  ny



xxn
yn

xxn

   exp 

xxn
yn

hx
nx



rx hy
ny

cx y x y
hnx hny 


   exp 
xx n
yn

y
hx
nx hny 


ny
 cx y



hx
nx sy

58

59

510

herein we used for the terms in 59 and 510 that rx  tn hx
x  0 holds if and only if
y

0
in
the
following
we
show that all these terms
and
likewise
for
s

t
h
rx  tn hx
x
n
y
x
23

tend to zero we start with the terms from 58 by convergence of hy
n towards the
x
element hy  which satisfies yy hy

0
and
since


suppr

t
h

converges
in a
n
n
y
n
settheoretical sense to y  suppr it follows that the first sum in 58 tends to zero
for n   similarly the second sum also tends to zero for increasing n for the third
term of 58 we recall by our bounds on optimal entropic dual potentials and the type of
y
convergence for hx
n  hn  that the sum stays uniformly bounded over all n  n whereas
tn  0 hence all terms from 58 converge to zero for the first term in 59 the bounds
for n proposition 23 imply
  exp
xxn
yn

 nx  cy y  cx y 
 nx  cx y 
rx hy
exp



rx hy

ny
ny 






xx
n

yn

y
 k  x x rx    y y hy
ny   k  x x rx    y y hny 
xxn

xx

yn

yn

for some constant k  0 by the type of convergence of hy
n and since n  y we obtain
y
that the quantity yn y y hny  tends to zero for n   likewise the second term
from 59 also converges to zero lastly by nonnegativity of the cost function we obtain
for the term in 510 that
tn   exp 
xxn
yn

cx y x y
y
 hnx hny   tn   hx
nx   hny  

xx
y
n

n

which also converges to zero for n   and finishes the proof
remark 51 for hadamard differentiability of erot  at r s we need to show for
n   that


1

 x
 y
y
erot  r  tn hx
n  s  tn hn   erot r s    h     h   0
tn

x
y
y
our proof technique relies on the weighted l1 convergence of hx
n  hn  towards h  h 
in combination with hlders inequality equation 54 and 55 in particular the
weighted l1 norm appears to be a necessary condition for hadamard differentiability of the
erot value functional on countable spaces

52

sensitivity of erot plan

the proof of theorem 34 for the hadamard differentiability of the erot plan requires
three key results welldefinedness and boundedness of the proposed derivative a local
lipschitzcontinuity property for the mapping    and convergence of the difference quotient of   for finitely supported perturbations towards the proposed derivative for the
sake of readability these three statements are proven separately in propositions 52 53
and 54
furthermore the proof employs various approximation results for an element hx 
l1 x  we define its finite support approximation of order l  2 denoted by x
l  for x  x 
x1  x2      as

x
x


hx1  il1 hxi if x  x1 


x
x
if x  x2      xl 
lx  hx




else
0
24

similarly we define for hy  l1 y its finite support approximation by y
l  the relevant
properties of this type of approximation are shown in appendix c lemmas c1 c2 and
c3 and will play in important role in the following
proof of theorem 34 according to the definition of hadamard differentiability consider
x
y
1
1
y
a sequence tn nn such that tn  0 and hx
n  hn   lcx x l4 y converging to h  h 

such that it holds for each n  n

y

1
y
1
r  tn hx
n  s  tn hn   p x   lcx x   p y  l4 y
y

the assertion on the contingent cone follows by aubin  frankowska 1990 proposition
421 in conjunction with r and s having full support the quantity of interest is


y

  r  tn hx
h
n  s  tn hn    r s
 drs
  hx  hy 
tn
l1

cx cy

x y

for which we need to prove that it converges to zero as n tends to infinity let   0 then
h
there exists by lemma c1 and by boundedness of drs
  proposition 52 an integer

y
x
y
l  n such that it follows for the finite support approximations x
l of h and l of h 
respectively that

hx  x
l l1

cx

x 

 hy  y
l l1

4
y

y



1

h
drs
  
op
4

further denote by 0  0 the radius from proposition 53 such that   is lipschitz with
modulus   0 on the set
b0 r s  r s  p x   l1cx x   p y  l14 y
y

r  rl1

cx

x 

 s  sl1

4
y

y

 0 

moreover by lemma c3 there exists n1  n such that it follows for all n  n1 that
x
x
x
r  tn x
l  r  tn nl  p x  with suppr  tn l   suppr  tn nl   x  and likewise
y
y
y
s  tn y
l  s  tn nl  p y with supps  tn l   supps  tn nl   y additionally
lemma c2 asserts existence of n2  n such that it holds for all n  n2 that
y
y
x
y
x
r  tn hx
n  s  tn hn  r  tn nl  s  tn nl  r  tn l  s  tn l   b0 r s

using lemma c1 there also exists n3  n such that it follows for all n  n3
x
hx
n  nl l1

cx

x
nl

x 

 x
l l1 x 
c
x

y
 hy
n  nl 

l1 4 y

 y
nl



y

 y
l l1 y
4


y




4





4

and

finally by proposition 54 there exists n4  n such that it follows for n  n4

x
x
y

x
x
  r  tn x
x

x
x
l  s  tn l    r s
h
 x
y x
x
x
x
x
 

d






x
x
l
rs
l
x
x
tn
4
x
x
x
x
x
xl1cx cy x y
25

summarizing for all n  maxn1  n2  n3  n4  we obtain that



y
  r  tn hx
h
n  s  tn hn    r s
 drs
  hx  hy 
tn
l1

x y

x
y x
y

x
x
x
  r  tn hx
x
n  s  tn hn    r  tn nl  s  tn nl  x
x
x
x
x
x
x
x
x
x
x
x
x
t
x
x
n
x
x
x
xl1cx cy x y
x
y
y x

x
x
x
  r  tn x
x
x
x
nl  s  tn nl    r  tn l  s  tn l  x
x
x
x
x
x
x
x
x
x
x
t
x
x
n
x
x
x
xl1cx cy x y
x   r  t x  s  t y     r s
x
x
x
x
n l
n l
x
x
h
 x
y x
x
x
x

d






x
x
l
rs
l x
x
x
t
x
x
n
x
x
x
xl1cx cy x y
cx cy

h
y
h
 x
y
 drs
  x
l  l   drs  h  h 



   
  
4 4 4 4



l1c

x cy

x y



which proves the claim
we continue with our assertions on the welldefinedness and boundedness of the proposed derivative the local lipschitz property for the erot plan as well as our result
concerning the convergence of the difference quotient for finitely supported perturbations
for the sake of readability we first state these results and prove them afterwards notably
for all of these results we assume that cx  cx l x   

proposition 52 let r  l1cx x  s  l12 y be two probability measures with full sup

port ie suppr  x and supps  y then the linear mapping given by
y

 d rs rs f

1

is welldefined and bounded

 drsrs rs  f l1cx x   l12 yy1  
l1cx cy x

y


 y  l
x x   ly yy1 

proposition 53 let r s  l1cx x   l12 y be probability measures with full support
denote for   0 the set

y

b r s  r s  p x   l1cx x   p y  l12 y
y

r  rl1

cx

x 

 s  sl1

2
y

y

 

then there exist 0     0 such that for any r s r   s   b0 r s with suppr   
suppr and supps   supps it follows that
  r s    r   s l1

cx cy x y

  r s  r   s l1

cx

 r s   r   s 1suppr  l x    r s  r   s l1

x l1 2 y

cx

26





511



512

y

x l1 2 y


y

  r s    r   s 1supps  l


y

y

  r s  r   s l1

cx

x l1 2 y




513

y

where      represent optimal entropic dual potentials as in proposition 24 ie y1 
0
proposition 54 let r s  l1cx x   l14 y be probability measures with full support
given l  n consider n  n as in lemma c3 such that for all n  n holds
y

1
y
1
r  tn x
l  s  tn l   p x   lcx x   p y  l4 y
y

y
with suppr  tn x
l   x and supps  tn l   y then it follows as n tends to infinity
that



y

  r  tn x
l  s  tn l    r s
h  x
 drs
 l  y
l 
tn
l1

cx cy

 0
x y

note that proposition 52 and 53 both can be stated for the spaces l1cx x  and l12 y

for the probability measures r s whereas proposition 54 uses the spaces l1cx x  and
l14 y where the latter space has a strictly stronger norm if cy  cy l y  
y

y

1
1
proof of proposition 52 given a pair hx  hy
   lcx x   l2 yy1  we need to show
y

  l1cx cy x  yl x l
that there exists a unique element hx y  hx   hy

y yy1 
such that
  drs rs rs fhx  hy
d rsrs  fhx y  hx   hy

 

514

denoting the erot plan for r s as   and by the relation between optimizers of erot
and derot proposition 21 equation 514 can be rewritten as
h


x y




 at hx   hy

x y

a h






 rs
 r  hy  hx  s




hx


y


h


515

in order to solve this system of countably many equations we set
hx y 
which reduces 515 to
a 




 at hx   hy
 r  hy  hx  s


rs



hx

 at hx   hy
 r  hy  hx  s   y  

h

rs

516

517

 for 517 exists for this
we now have to show that a unique solution hx   hy

purpose we evaluate for x  x the corresponding componentwise equation of 517 and
obtain

xy
1




hx
x

 






xy

xy
y 
x 
y
x



 
hx  hy    
rx hy  hx sy 
 hx
x

 yy rx sy
yyy1  

 


27

 




xy
xy

rx x  
y 
y
x



 
h
hy    
hy 
  hx
 x
 yy sy

yyy1  
 



note for all x  x it holds that yy

 1 this leads to


xy
rx



 

  xy   hx 


x
yy rx 









xy

xy
y 
y
 


 



h
h
hx


y 
y 
x


yy rx sy 

yyy1  rx





similarly since for any y  yy1  holds xx


xy
sy

 1 we deduce that







xy
xy



y
x  
hx   hy    
hx


x
xx rx sy 
xx sy






summarizing we have to solve a system of countably many linear equations for suitable
matrices of countable dimension this can be rewritten as
 1


 0


 


 
 x y
 12
 sy2
 
  x1 y 3

 sy3
 

 0


 0



  
 x1 y 2
 rx s y
 1 2
 x y
 13
 rx 1 s y 3
 

x1 y3
rx 1
x2 y3
rx 2







1

0




0


1


x1 y1
rx 1 s y 1
x2 y1
rx 2 s y 1

x1 y2
rx 1 s y 2
x2 y2
rx 2 s y 2



0

0




0


0




1





x2 y2
sy2
x2 y3
sy3


0



0



x2 y2
rx 2 s y 2
x2 y3
rx 2 s y 3



x 
 hx1 
  x  
 hx 
2
















  y 
hy2 




  y 
  hy 
3 








x1 y2
rx 1
x2 y2
rx 2

0





 idx



















  





1yy1   



y

idyy1  hy2 



 y 
hy3 


  

518

hx
x1
hx
x2

where we denote the operator of the lhs by m  m r s    and the composition of
both operators on the rhs with the factor  by q  q r s    as we will show these
operators are defined on the following spaces


m  m r s    l x   l
 yy1   l x   l yy1 

q  q r s 

y



 l1cx x   l12

y

yy1   l

y



x   l
y yy1 

herein we equip the product of l1 spaces with sum of the norms of each subspace and for
the l spaces we consider the maximum of the norms of the subspaces we now derive a
bound for the operator norm of q and afterwards show that m is invertible the operator
norm of the mapping
idx




1yy1    l1cx x   l12 yy1   l1cx x   l12 y
y
y
idyy1  
28

can be computed as follows denote the closed ball of radius 1 by
1
x
1
b1  hx  hy
   lcx x   l2 y h l1
y

cx

x 

then the operator norm is given by

 hy
 l1

2
y

yy1 

 1

rr
rr
rrr
2
y rrr


y

r
h

y 1 rr
y rrr
yy1 
cx
rryy1
rr
2
hx hy
y
 b1
r
r
rrr
rrr
2

y

1
rrr  1  sup y
 1  2y y1 
2y y1  rrrr  hy
1
sup
2 y
rrryy y rrrr

y
yy
x
1
h h b1
y
r
r 1
 hy
 l1
x 

hx l1

sup

moreover based on our bounds for   proposition 23 it follows for each x  x and
hy  l12 y that
y

rr
r
cx  r  cy  s  cx  cx l x 
rrr
xy y rrrr
hy rrr  exp 
 hy l1 y
rrr 


rr yy rx sy rr
y
r
r




cx  r  cy  s  cx  cx l x 
 exp 
 hy l1 y 

2
y

likewise it follows for each y  yy1  and hx  l1cx x  that
y y

1

cx  r  cy  s  cx  cx l x 
xy x

hx   exp 
 hx l1 x  
cx
r
s

x
y
xx

hence we obtain for the operator norm of q that
qop  1  2y y1  exp 

cx  r  cy  s  cx  cx l x 


next we show that m is invertible note that m can be represented by
m



p

idl x 

r
id
l yy1  

y

519

520



for some suitable linear operators p  p r    l
y yy1   l x  and r  rs  
l x   l
y yy1  we prove existence of the inverse of m by applying the neumannseries calculus for id  m  sasane 2017 theorem 29 in particular this requires to
k
show that the series 
k0 id  m  converges in operator norm to this end we perform
a change to the norm l
 yy1  which does not change the topology we first label
y

y  y1  y2       and set   inf xx rxyx 1  0 which is strictly positive by the lower bounds
for   proposition 23 and since  using the upper bound for   proposition 23 we
obtain that


y y


xy

rx

which shows that y y

 exp 


xy
rx

cx  cx l x   cx  r  cy  s


2y ysy 

is summable over y  y as s  l12 y  l12 y notably the

dominating function is independent of x  x  hence there exists some n  n such that
y




xy
i

in 1

rx

 y yi   1
29





2

y

for such n  n it follows for all x  x that




i2


xy
i

rx



  y yi   1


xy
i

rx

in 1

1


xy
1

rx





1
2
2

521

to change the norm of l
 yy1  we define the weight function
x



1
y y  


y y

y  y  1 

if y  y1      yn 
else

where we note that l1
y y y  y y  y y for ly  maxi1n y y consequently
it follows that l y  l y  ly l y  hence we can consider the operators




y

p r as mappings



y

y

yy1   l x 
p  l


r l x   l
yy1 


y

y

respectively and introduce m likewise based on 521 we then note that p op  1 2

and since xx

 1 for all y  yy1  it follows that rop  1 thus we assert that


xy
sy


id  m 2 op  max  rp op  p rop   1  
2

k
which implies that the neumannseries 
k0 id  m  converges in operator norm with




k0

k0

m 1 op   id  m k op   idop  id  m op   id  m 2 op
k

4
2
  

1  1  2 

this also yields that m 1 op  4ly  concluding there exists a unique pair of elements
1
  l x   l
hx   hy

y yy1  that solves equation 518 and m q is a bounded
operator
finally we prove that hx y from 516 is contained in l1cx cy x  y this follows
by the following calculation
hx y l1

cx cy



 2


x y



 at hx   hy


l1

cx cy


 r  hy  hx  s
rs
l1

cx cy





 l1

cx 

y

x y




r  s l

1x 
y

x y


 hx  l x   hy




x y

x y

l
yy1 


2 rl1

cx

y

y
x  h l1 y

y



 hx l1

1x

522

x 

sl1



y

y 

where we used in the second inequality for x y  x  y the following bound
cx x  cy xy y  cx xy y  y y  2cx xy y
30

in particular it holds by the upper bound for   proposition 23 that
  l1

cx 



y

x y




cx xy yxy



xyx y

cx xy yy y exp 



xyx y
cx  r  cy  s  cx

 exp 



cx  r  cy  s  cx  cx l x 

 cx l x 







xyx y

rx sy

cx x2y yrx sy  

which is finite by r s  l1cx x   l12 y by the same upper bound we see that the term

   r  sl

y

1x 
y

x y

sup
xyx y

is bounded by


xy
rx sy 

y y

 exp 

cx  r  cy  s  cx  cx l x 


  

  l x   l
this also shows that hx y continuously depends on hx   hy

 y and

1
1
hx  hy
   lcx x   ly y and thus concludes the proof on welldefinedness and boundedness of the operator of the claim
y

remark 55 crucial for the welldefinedness of the proposed derivative for the erot
plan proposition 52 for the setting cx  cx l x    is that the operator m  l x  


l
y yy1   l x   ly yy1  in 520 has a bounded inverse for which we employ
the neumannseries calculus to this end we verify that there exists   0 and construct
a function y  y  1  with y  ky for some k  0 such that


yyy1 

1

y y



xy

rx

xy

y y xx sy

1

for all x  x 

1

for all y  y

generalizing this approach to ground costs with unbounded variation in both components
cx  cx l x    and cy  cy l y   would require existence of   0 and suitable
functions x   1  y   1  with x  kx and y  ky for some k  0 such
that

xy
1
1
for all x  x 
 y y
x x yyy1 
rx


xy
1
1
 x x
y y xx
sy

for all y  y

the explicit construction of such functions x  y remains challenging is and is left for
future research
proof of proposition 53 the proof consists of two steps we first show the claims for
finitely supported probability measures and extend them afterwards to probability measures with countable support
the lipschitz bound will be derived by showing that the operator norm of the derivative
of primal and dual optimizers for a given pair of probability measures with respect to
31

perturbations on the same support can be uniformly bounded for the proof we first
define the quantity
  sup exp 
rsb1

cx  r  cy  s  cx  cx l x 


we further introduce the quantity   0 1 by
 

inf

rsb1

  1 

cx  r  cy  s  2 cx  cx l x 
s y1
1
exp 
 y  s 
2


and define 0  4 next we consider r   b0 with finite support note that
the inequality y1  sy1 2  0 holds furthermore we define x  suppr   supp
and introduce for given positive function f  x  0  the spaces l1f x   l1f x x  and
l x   l x  with this notation we define the operator  as a from section 3
f

f x

restricted to l1cx x   l12 y1  and similarly introduce f as f from section 3 with
y

a modified domain and range space

1
1
f l1cx cy x    l x   l
 y1   lcx x   l2 y1 
y

y

r

x x 1



by corollary 33 the triplet          l1cx cy x    l x   l
y  are optimizers of erot and derot for the probability measures r  if and only if
f       r   0 furthermore the function f is frchet differentiable averbukh  smolyanov
1967 the derivative in this notion will be denoted by d f  following the arguments by
klatt et al 2020b the partial derivative of f with respect to     at optimizers
       for r  in matrix representation is then given by
f
d


 

    r 



idl1
x 
cx cy




1


f 

exp  1 t      c  r    t 


0



which is an invertible operator since the identity operator is invertible in conjunction with
a having full rank of order x   1 and because 1 exp  1 at      c r   is
componentwise strictly positive by the implicit function theorem this induces a mapping
on an open set u  l1cx x   l12 y1  with r   u
y



 u  l1cx cy x    l
 x   l y1 
x

y

such that for any r s   u the relation f r s r s  0 holds in particular if
r s   p x   p  it follows that r s coincides with the triplet of optimizers of
       for these respective probability measures
moreover the implicit function theorem yields that  is frchet differentiable at r 
with derivative
f
f
dr
   d
f

 r r 

32

1

f
 drs
f 
 r r 

hence it remains to bound this operator adapting the notation of the proof for proposition 52 we know that there exist suitable operators m  q such that the derivative for
the component of  in l x   l
  ie the component for optimal entropic dual
y

potentials is given by m 1 q for the operator q we know that
qop 

1  2y y1  exp 

cx  r  cy    cx  cx l x 


 1  2y y1   1  



for a bound on the operator norm of m we obtain by proposition 23 the lower bound

minxx xy
r rx   moreover we choose n  n such that
1


2
 y yi syi  
4
in 1

by definition of 0 we obtain for all r s  b0 that


 y yi syi  syi   0 
2

i1



4

which yields by our choice on n for each r s  b0 and x  x that


 y yi   1

in 1


xy
r s
i

rx



  y yi   1 exp 
in 1


cx  cx l x   cy yi   cy yi   cx  r  cy  s




  2y yi syi   2y yi syi  syi   syi   
2
in 1
in 1

syi



in particular it follows that 
in 1 y yi   1xyi r rx  2 for all x  x and the
quantity ly  supi1n y y is finite hence by the neumannseries calculus we obtain
that the operator norm of m 1 can be bounded by

m 1 op  ly

4
 2 


which yields m 1 qop  1 2    by definition this bound is independent from
r  ie for any two pairs of probability measures r s r   s   b0 with finite coinciding support it follows that 513 is valid for the lipschitzconstant   moreover by
proposition 24 we note that 513 generalizes to the setting of suppr    suppr and
supps   supps
next we derive the lipschitz property for the erot plan   in case of finitely supported probability measures to this end we again consider the pair r  and note by
516 from the proof of proposition 52 that the derivative for the component of  in
l1cx cy x   denoted by   is given by
f
 l1 x   l12 y1   l1cx cy x  
dr
  cx
y

x  y


  r 
  r 


 t m 1 qx  y
 r  y  x  


r  
33

similar to the upper bound for 522 we see that
f
 
dr
 

op



sup
rsb0

 2

21   r sl1

cx 

 r s

r  s l


1x 
y

x y

y

x y



 rl1

cx

x 

 sl1



y

y 

   

is finite since the upper bound is independent from r  it follows for any two pairs
of probability measures r s r   s   b0 with coinciding support that the following
inequality is valid
  r s    r   s l1

cx cy x y

  r s  r   s l1

cx

x l1 2 y




y

by proposition 24 this inequality also holds in case of suppr  suppr and supps 
supps and thus finishes the first step of the proof
for step two of this proof it remains to show that these lipschitz bounds extend to
probability measures r s r   s   b0 with suppr    suppr supps   supps
where at least one probability measure has infinite support concerning the lipschitz
property for the erot plan we consider finite support approximations of the probability
measures by proposition 24 it follows for given   0 that there exists l  n such that
rl  sl  rl  sl   b0 with
  r s    rl  sl l1

cx cy

x y


 
2

  r   s     rl  sl l1

cx cy

x y


 
2

by our lipschitz bounds for finitely supported probability measures it then follows that
  r s    r   s c

x cy

   rl  sl     rl  sl c

  rl  sl   rl  sl l1

cx



x cy

x l1 2 y




y

 cx x1   2y y1  r s  r   s l1

cx

x l1 2 y


 

y

as   0 can be chosen arbitrarily small we deduce the local lipschitz property with
modulus   cx x1   2y y1 
for the dual solutions we only prove the claim for   for   the proof is analogous
consider x  suppr   then it follows by proposition 24 for given   0 that there exists
l  n such that x r s  x rl  sl   2 and x r   s   x rl  sl   2 as well as
rl  sl  rl  sl   b0  applying our lipschitz bound then yields
x r s  x r   s   x rl  sl   x rl  sl   
  rl  sl   rl  sl  1

lc x l1 2 y
x





y

  cx x1   2y y1  r s  r   s l1

cx

x l1 2 y


choosing  arbitrarily small and setting    cx x1   2y y1  gives
x r s  x r   s    r s  r   s l1

cx

x l1 2 y

taking the supremum over all x  suppr   then proves the claim
34



y



y

 

proof of proposition 54 define the mapping from probability measures to optimizers of
erot and derot
 p x   l1cx x   p y  l14 yy1   p x  y  rx  ryy1  
y

r s    r s  r s  r s


where we select     according to proposition 24 ie such that the element 0   
ry represents a dual optimizer recalling the function f from section 3 it holds by
corollary 33 for each n  n that
y
y
x
0  fr s  r s   fr  tn x
l  s  tn l  r  tn l  s  tn l 

which yields

y
0  fr s  r s   fr s  r  tn x
l  s  tn l 
y
x
y
 fr  tn x
l  s  tn l  r  tn l  s  tn l 
y
 fr s  r  tn x
l  s  tn l 

adding another three terms of nontrivial zeros leads to the following equation
y
drs rs  f r  tn x
l  s  tn l   r s 
y
 tn drsrs rs  f x
l  l 

y
 fr s  r s   fr s  r  tn x
l  s  tn l 

523
524

y
 tn drs rs rs f x
l  l 

y
 fr s  r  tn x
l  s  tn l 

525

y
x
y
 fr  tn x
l  s  tn l  r  tn l  s  tn l 

 d

y
x
 rs rtn l s tn l 

y
f r  tn x
l  s  tn l   r s  

y
  d rs rs f r  tn x
l  s  tn l   r s 

 d

y
x
 rs rtn l s tn l 

526

y
f r  tn x
l  s  tn l   r s  

where drs f d f represent the nave componentwise derivatives as employed in
section 3 for the term in 523 we already know by proposition 52 that applying
1
d rs rs f is welldefined

we need to show that applying d rsrs  f on each of the summands
524 525 and 526 is also welldefined and that the l1cx cy x  ynorm of the
resulting component in l1cx cy x  y ie the component decreases with order otn 
for n   this part of the proof is technical and deferred to lemma b3 in appendix
1

35

b most notably for this purpose we require s  l14 x  as a consequence we obtain for
x
n   that


y

  r  tn x
l  s  tn l    r s
h  x
 drs
 l  y
l 
tn
l1

y
x
x
x
x
x  r  tn l  s  tn l    r s 
x
x
x
x
tn
x
x
x

  d rs rs f

 o1

1


cx cy

x y

x
x
x
y x
x
 drs rs rs  fx



x
l
l x
x
x
x
xl1cx cy x y

which proves the assertion

6

discussion

it remains an open question if the conditions on limit laws for empirical erot plan and
value for partially bounded ground costs or generally unbounded ground costs can be
weakened omitting the exponential term in 17 19 and table 1 by a refined sensitivity analysis in particular it would be interesting to investigate the sensitivity of the
erot plan in case of generally unbounded ground costs notably in our results the condition cx  cx l x    is of particular use for the neumann seriescalculus of bounded
operators in case of ground costs that are generally unbounded this proof technique does
not generalize well therefore limit distributions for the empirical erot plan remain
unknown remark 55 although a similar structure is reasonable to conjecture
in addition to our limit results for fixed regularization parameter   0 we characterize in section 42 the asymptotic behavior of the empirical erot value and sinkhorn

costs for the regime of a decreasing regularization parameter n  o1 n we see
that the resulting limit law is given by the respective limit law of the empirical nonregularized ot value which is fundamentally different tameling et al 2019 naturally

for n of slower order than o1 n the question arises whether the empirical erot
value still converges weakly towards a suitable limit distribution and when a phase transition to the obtained gaussian limit occurs recent results demonstrate that the sample complexity of the erot value e erot  rn  n   erot  r s decreases of order oexpd2 n12  for some   0 in certain settings in rd as n tends to infinity genevay et al 2019 extensions are provided by mena  nilesweed 2019 and
chizat et al 2020 who refine this to o1  d2 n12  consequently when n
decreases sufficiently slow such that the sample complexity rate stays bounded from above

it follows by markovs inequality that nerot n rn  n   erot n r s is a tight
sequence of random variables by prokhorovs theorem there exists a subsequence which
converges weakly towards a tight limit
the analysis of the limit behavior of the empirical erot plan on countable spaces
for the regime   0 is even more involved mimicking section 42 two aspects appear to
us as crucial first it is necessary to obtain suitable bounds between erot plans and
nonregularized ot plans these bounds are available on finite spaces weed 2018 but
unknown for countable ground spaces second the limit distribution of the empirical nonregularized ot plan on countable spaces has to be characterized for finitely supported
probability measures with a unique nonregularized ot plan klatt et al 2020a recently
36

obtained such a limit law explicitly relying on finitedimensional linear programming this
approach does not generalize well to infinitedimensional linear programming and hence
similar statements for countable spaces remain to be investigated in further studies

acknowledgements
s hundrieser and a munk acknowledge funding by the deutsche forschungsgemeinschaft dfg german research foundation under germanys excellence strategy  exc
20671 390729940 further m klatt acknowledges support from the dfg research
training group 2088 discovering structure in complex data statistics meets optimization and inverse problems

references
altschuler j nilesweed j  rigollet p 2017 nearlinear time approximation
algorithms for optimal transport via sinkhorn iteration in i guyon u v luxburg
 others eds advances in neural information processing systems volume 30
curran associates inc
amari si karakida r oizumi m  cuturi m 2019 information geometry
for regularized optimal transport and barycenters of patterns neural computation
315 827848
antos a  kontoyiannis i 2001 convergence properties of functional estimates for
discrete distributions random structures  algorithms 1934 163193
aubin j  frankowska h 1990 setvalued analysis modern birkhuser classics
springer
averbukh v i  smolyanov o g 1967 the theory of differentiation in linear topological spaces russian mathematical surveys 226 201258
bertsekas d p 1981 a new algorithm for the assignment problem mathematical
programming 211 152171
bertsekas d p  castanon d a 1989 the auction algorithm for the transportation
problem annals of operations research 201 6796
bigot j cazelles e  papadakis n 2019 central limit theorems for entropyregularized optimal transport on finite spaces and statistical applications electronic
journal of statistics 132 51205150
billingsley p 1999 convergence of probability measures wiley series in probability
and statistics wiley
borisov i s 1981 some limit theorems for empirical distributions in abstracts of
reports third vilnius conference on probability theory and mathematical statistics
volume 1 pages 7172
borisov i s 1983 problem of accuracy of approximation in the central limit theorem
for empirical measures siberian mathematical journal 246 833843

37

braunsmann j 2018 the entropyregularized wasserstein distance as a metric for
machine learning based postprocessing of structural mr images of the brain masters
thesis university mnster
brenier y 1987 decomposition polaire et rearrangement monotone des champs de
vecteurs comptes rendus de lacadmie des sciences  sries i  mathematics 305
805808
brenier y 1991 polar factorization and monotone rearrangement of vectorvalued
functions communications on pure and applied mathematics 444 375417
chen c 2020 spatiotemporal imaging with diffeomorphic optimal transportation
arxiv eprints page 201111906
chizat l peyr g schmitzer b  vialard fx 2016 scaling algorithms for
unbalanced transport problems mathematics of computation 87314 25632609
chizat l roussillon p lger f vialard fx  peyr g 2020 faster wasserstein
distance estimation with the sinkhorn divergence in h larochelle m ranzato 
others eds advances in neural information processing systems volume 33 pages
22572269 curran associates inc
clason c lorenz d a mahler h  wirth b 2021 entropic regularization
of continuous optimal transport problems journal of mathematical analysis and
applications 4941 124432
cominetti r  san martn j 1994 asymptotic analysis of the exponential penalty
trajectory in linear programming mathematical programming 6713 169187
cover t  thomas j 1991 elements of information theory wiley series in telecommunications wiley
csiszr i 1975 idivergence geometry of probability distributions and minimization
problems the annals of probability 31 146158
cuturi m 2013 sinkhorn distances lightspeed computation of optimal transport
in c j c burges l bottou  others eds advances in neural information
processing systems volume 26 curran associates inc
dessein a papadakis n  rouas jl 2018 regularized optimal transport and the
rot movers distance journal of machine learning research 191 590642
durst m  dudley r m 1980 empirical processes vapnikchervonenkis classes and
poisson processes probability and mathematical statistics 12 109115
dvurechensky p gasnikov a  kroshnin a 2018 computational optimal transport
complexity by accelerated gradient descent is better than by sinkhorns algorithm
in j dy  a krause eds proceedings of the 35th international conference on
machine learning volume 80 of proceedings of machine learning research pages
13671376 pmlr
evans s n  matsen f a 2012 the phylogenetic kantorovichrubinstein metric
for environmental sequence samples journal of the royal statistical society series
b statistical methodology 743 569592
38

feydy j sjourn t vialard fx amari si trouve a  peyr g 2019
interpolating between optimal transport and mmd using sinkhorn divergences in
k chaudhuri  m sugiyama eds proceedings of machine learning research
volume 89 of proceedings of machine learning research pages 26812690 pmlr
galichon a 2016 optimal transport methods in economics princeton university press
genevay a chizat l bach f cuturi m  peyr g 2019 sample complexity
of sinkhorn divergences in k chaudhuri  m sugiyama eds proceedings of
machine learning research volume 89 of proceedings of machine learning research
 pages 15741583 pmlr
kantorovich l 1958 on the translocation of masses management science 51 14
klatt m munk a  zemel y 2020a limit laws for empirical optimal solutions in
stochastic linear programs arxiv preprint 200713473
klatt m tameling c  munk a 2020b empirical regularized optimal transport
statistical theory and applications siam journal on mathematics of data science
22 419443
lee y t  sidford a 2014
path finding methods for linear programming solving

linear programs in o rankiterations and faster algorithms for maximum flow
in 2014 ieee 55th annual symposium on foundations of computer science pages
424433
mcshane e j 1934 extension of range of functions bulletin of the american mathematical society 4012 837  842
mena g  nilesweed j 2019 statistical bounds for entropic optimal transport
sample complexity and the central limit theorem in h wallach h larochelle 
others eds advances in neural information processing systems volume 32 pages
45414551
monge g 1781 mmoire sur la thorie des dblais et des remblais in histoire de
lacadmie royale des sciences de paris pages 666704
orlin j 1988 a faster strongly polynomial minimum cost flow algorithm in proceedings
of the twentieth annual acm symposium on theory of computing stoc 88 pages
377387 association for computing machinery
peyr g  cuturi m 2019 computational optimal transport with applications to
data science foundations and trends in machine learning 1156 355607
rachev s  rschendorf l 1998a mass transportation problems volume i theory
probability and its applications springer
rachev s  rschendorf l 1998b mass transportation problems volume ii applications probability and its applications springer
rmisch w 2004 delta method infinite dimensional in s kotz n balakrishnan 
others eds encyclopedia of statistical sciences wiley
santambrogio f 2015 optimal transport for applied mathematicians calculus of variations pdes and modeling progress in nonlinear differential equations and their
applications springer
39

sasane a 2017 a friendly approach to functional analysis essential textbooks in
mathematics world scientific publishing company
schiebinger g shu j tabaka m cleary b subramanian v solomon a gould
j liu s lin s berube p lee l chen j brumbaugh j rigollet p
hochedlinger k jaenisch r regev a  lander e s 2019 optimaltransport
analysis of singlecell gene expression identifies developmental trajectories in reprogramming cell 1764 928  943e22
sinkhorn r 1964 a relationship between arbitrary positive matrices and doubly
stochastic matrices the annals of mathematical statistics 352 876879
sinkhorn r 1967 diagonal equivalence to matrices with prescribed row and column
sums the american mathematical monthly 744 402405
sommerfeld m  munk a 2018 inference for empirical wasserstein distances on finite
spaces journal of the royal statistical society series b statistical methodology
801 219238
sommerfeld m schrieber j zemel y  munk a 2019 optimal transport fast
probabilistic approximation with exact solvers journal of machine learning research 20 123
tameling c sommerfeld m  munk a 2019 empirical optimal transport on
countable metric spaces distributional limits and statistical applications the annals
of applied probability 295 27442781
tameling c stoldt s stephan t naas j jakobs s  munk a 2021 colocalization for superresolution microscopy via optimal transport nature computational
science 1 199211
tong q  kobayashi k 2021 entropyregularized optimal transport on multivariate
normal and qnormal distributions entropy 233 302
van der vaart a  wellner j 1996 weak convergence and empirical processes with
applications to statistics springer series in statistics springer
villani c 2008 optimal transport old and new a series of comprehensive studies in
mathematics springer
weed j 2018 an explicit analysis of the entropic penalty in linear programming
in s bubeck v perchet  p rigollet eds conference on learning theory
colt 2018 stockholm sweden 69 july 2018 volume 75 of proceedings of machine
learning research pages 18411855 pmlr
yukich j e 1986 metric entropy and the central limit theorem in banach spaces
in x fernique b heinkel  others eds geometrical and statistical aspects of
probability in banach spaces pages 113128 springer
zemel y  panaretos v m 2019 frchet means and procrustes analysis in wasserstein space bernoulli 252 932976

40

a

proofs for preliminary results

proof of proposition 21 existence of a unique erot plan   and strong duality follow
by chizat et al 2016 theorem 32 for the existence of dual optimizers we first prove
the optimality criterion with an approach that is inspired by braunsmann 2018 proposition 3318 and theorem 3319 assume that        are optimal and define   rx y
as
 x  y  cx y 
xy  exp
rx sy  0




for all x y  x  y note that   l1 x  y because otherwise      could not be
optimizers further denote the objective of derot by
drs     r   s    exp 
xx
yy

x  y  cx y
rx sy  rx sy 


then it follows by optimality of  for any x  l x  that d  tx     is finite for
each t  r and differentiable at t  0 with
0

d
     cx y
x
drs   tx       x
 rx sy
exp


r


x
x x
dt t0

xx
xx
yy

  x
x rx   exp 
xx

yy





    cx y
 rx sy    x
x rx   xy 

xx
yy

likewise it follows for any y  l y that
0

d
drs      ty    y
y sy   xy  
dt t0
yy
xx

since x and y were arbitrary we see that  is contained in r s next we show that
 optimizes erot and thus coincides with    to this end we note that t  t logtat
with a  0 is strictly convex and differentiable on 0  with derivative logta since
supp  suppr  s we obtain for any other feasible transport plan   r s and
x y  suppr  s that
xy
xy
  xy   cx yxy  xy log 
  xy 
rx sy
rx sy
xy
 cx y   log 
xy  xy   x  y xy  xy 
rx sy

cx yxy  xy log 

a1

a2

note that the terms from a1 for x y  suppr  s sum up to zero due to   l1r x 
and    l1s y the terms on the rhs of a2 are absolutely summable over x  y and
also sum up to zero consequently summing up both sides of a1 and a2 over x  y
yields
c   m   c   m   0
a3
which proves optimality of  for the converse suppose that    satisfy conditions
21 and 22 condition 21 implies xy  0 for each x y  x  y by 22 we then
41

obtain that   r s an analogous argument as in a1 a2 yields that  is an
erot plan for the optimality of  we note for arbitrary x  l x  that
d
drs   tx     x
x rx   xy   0
dt t0
xx
yy

where the last equality holds due to   r s likewise it follows for any y  l y
d
that dt
drs    ty   0 which yields by strict concavity of drs   that   are
t0
optimal for derot for our assertions on existence and uniqueness up to a constant
of optimal entropic dual potentials we perform a similar calculation as in dessein et al
2018 proposition 8 and obtain
c   m   1x y  r  s  k    klk  


 exp cx y rx sy for all x y  x  y and 1x y represents the constant
where kxy
function on x  y with value 1 by nonnegativity of the cost function we note that
k   l1 x  y and thus 1x y  k     hence since erot is feasible it follows that
minrs klk   is also feasible most notably the sets of optimizers coincide and existence of a unique erot plan   yields     argminrs klk   moreover since
the derivative of log diverges to  near 0 and by lower semicontinuity of kl  k  
there exists an element   r s with supp  supprs and klk     consequently by csiszr 1975 corollary 32 there exist functions a x  0  b y  0 
with loga  l1r x  and logb  l1s y such that


xy
 ax by kxy
 exp 

 logax    logby   cx y
rx sy for all x y  x  y


by optimality criterion 21 we deduce that    loga and     logb are optimal
entropic dual potentials additionally given another pair of optimal entropic dual potentials       l1r x   l1s y we see by uniqueness of the erot plan for all x y  x  y
that
x  y  cx y
x  y  cx y

rx sy  xy
 exp 
rx sy 
exp 



this can be rewritten to the following system of equations
x  x  y  y

for all x  suppr y  supps

setting   x  x for some x  suppr then yields the claim

proof of proposition 23 the proof is based on recent findings by mena  nilesweed
2019 by relation 21 between primal and dual optimizers for erot any pair of
optimal entropic dual potentials       l1r x   l1s y satisfies erot  r s    r 
   s almost sure uniqueness of dual optimizers up to a constant proposition 21
then allows us to select potentials such that   r     s  erot  r s2  0 recall
by section 21 that c  0 optimality of      implies by proposition 21 for all
x  suppr and y  supps that


y  cx y



exp

x   log 
s

y 



yy





cx
y
y   log   exp  x
rx  

xx
42

a4

as noted in remark 22 this condition is not only necessary but also sufficient for optimality
of potentials applying jensens inequality for the convex function  log   and by our
choice of      it then follows for each x  x that
x   log   exp 

y  cx y

yy



sy      s   cx ysy  cx x  cy  s
yy

note that the bound holds trivially if cy  s   likewise it follows for all y  y that
y  cy y  cx  r for the lower bound of x consider the upper bound of y as well as
the lower bound on c and see
x   log   exp 
yy

  log   exp 


y  cx y


sy 

cy y  cx  r  cx x  cy y
sy 


yy

cx x  cx  r   logx  s

indeed the lower bound for x is valid if cx  r   or x  s   the lower bound for
  follows analogously lastly the bounds for the erot plan follow from the correspondence to the optimal entropic dual potentials proposition 21 and their bounds
proof of proposition 24 for the pointwise convergence of optimal entropic dual potentials we follow the approach by mena  nilesweed 2019 who were inspired by feydy et al
2019 and afterwards exploit for the convergence of the erot plan the relation between
primal and dual optimizers proposition 21
as a first step we state a bound for k  k  that is uniform over all k  n recall

that we consider optimal entropic dual potentials such that ky
 0 by convergence of
1
1
rk kn to r with respect to lx x  and similar for sk kn to s in l1y y it follows that
kx  supx  rk   

and

kn

ky  supy  sk   
kn

let us denote by k  k kn the optimal entropic dual potentials for probability measures
rk  sk kn which satisfy k  rk   k  sk  by proposition 23 we then infer for all k  n
and x  supprk  y  suppsk  that
cx x  kx  ky  kx  cx x  ky 

 cy y  kx 
cy y  kx  ky  ky



note for all k  n that k  ky
 k  ky
 is rk  sk almost surely equal to k  k 
1
1

moreover since k  supkn ny
   this leads for all k  n x  supprk  y  suppsk 
1
to the following bounds

cx x  kx  ky  k  kx  cx x  ky  k 


 cy y  kx  k 
cy y  kx  ky  k  ky

a5

a diagonalization argument proves existence of a subsequence km  km mn converging

pointwise for each x  suppr and y  supps to a limit   
  rx  ry  it


remains to show that     is an optimizer for derot for probability measures

r and s uniqueness up to constant for each x y  suppr  s and y
 0 then implies
1
43


  
       relabelling we may assume that the sequence k  k  already
converges pointwise this leads for each x  suppr y  supps to

exp 

x


exp 

  lim exp 
k


y



  lim exp 
k

kx




k yy


ky



  lim  exp 


ky
 cx y

  lim  exp 

ky  cx y

sky 



k xx

rkx 

once we show that the limit expression and the sum on the rhs can be interchanged

optimality of   
 follows by condition a4 based on bound a5 it follows for all
y  supps and k  n that
exp 


ky
 cx y



cy y  cy y kx  k
  exp 





a6

convergence of sk kn in l1 x  implies that there exists for all   0 a finite set s  y
x
such that for all k  n holds
 exp 

ys


ky
 cx y




sky  
4

 exp 


y
 cx y



ys


sky  
4

further by pointwise convergence of k there exists n1  n such that it holds for all
k  n1 and y  s that
rr
rrr


rrrexp  ky  cx y   exp  y  cx y rrrr   
rrr 4
rrr


rr
rr
moreover by a6 there exists n2  n such that for all k  n2 follows
rrr
rr

rrr exp  y  cx y s  s rrrr   
y rr
ky
rrr 

rr 4
rryy
r

these previous four inequalities yield for k  maxn1  n2  that

rrr


rrrr
y
 cx y
rrr exp  ky  cx y s 
rrr  
s
exp



y
ky
rrr
rrrryy


yy
r
r

as   0 can be chosen arbitrarily small it holds for all x  suppr that
exp 

x


  lim  exp 
k yy


ky
 cx y



sky   exp 


y
 cx y

rkx   exp 

x  cx y



yy

likewise it follows by an analogous argument for all y  supps that
exp 


y



  lim  exp 
k xx

kx  cx y


xx



sy 
rx 

which finishes the proof for pointwise convergence of dual optimizers hence we obtain
in conjunction with our optimality criterion 21 the asserted convergence result for the
erot value as k tends to infinity ie
erot  rk  sk   erot  r s  k  rk   k  sk     r     r

 k  rk  r  k  sk  s  k    r  k     r  0
44

herein the first term of the second line tends to zero by our bounds on k  k kn from
a5 in conjunction with the type of convergence of rk  sk  towards r s whereas the
second term converges to zero by dominated convergence the assertion on the convergence
for the erot plan follows by an analogous argument and explicitly uses that x  cx x
as well as y  cy y 

b

lemmas for sensitivity analysis

for the proof of lemma b3 we employ the following result on invertibility of the operator
1
d rs rs f and the norm of the resulting element
lemma b1 let r  l1cx x  and s  l14 y be two probability measures on x and
y

y respectively with full support and consider a monotone possibly unbounded function
4
 n  1  such that 
i1 iy yi syi   further define the function




xyi 
xy 


  max sup 
 sup 

3

r
s
i
y

xx yy
x yi y xx yi
i 


y



  rx y  0 

and consider an element   l1cx cy x  y with     then applying the operator

d rs rs f onto  0 0  rx y  rx  ryy1  is welldefined and gives an
element in l1cx cy x  y in particular there exists   0 which is independent from 
such that
1

drs rs  f

1


 0 0

l1c

x cy

x y

  

proof we will show that there exists a unique triplet  x y   x   y   l1cx cy x  y
l x   l
yy1  such that
3
y

 x y 


 
 at  x   y  
  0 
 0
a  x y 




where we exploited on the lhs the relation between primal and dual optimizers of
erot proposition 21 by setting
 x y   


 at  x   y 


b1

we reduce the system of countably many equalities then it remains to find  x   y  
l x   l
yy1  such that
3
y

a 


 at  x  y   a 


this relation means that for all x  x the following equation is valid

xy
1



xx  



yyy1 


xy



y
    xy
xx   y
yy

45



xy y
rx x 
x  
y    xy 

yy
yyy1  
which is equivalent to


xx  


xy

yyy1 

rx

y

y


 xy 
rx yy

b2

similarly we obtain for each y  yy1  that



xy



xx

y
    xy
xx   y
xx

 sy y

   xy 
xx   y

 
xx 
xx

xy

which implies that



xx

  x 

y
   xy 
x   y
sy
sy xx

b3

the equalities b2 and b3 can therefore be represented by
m  x   y   

b4

where m  l x   l
yy1   l x   l
yy1  denotes the operator from the
3
3
y

y

proof of proposition 52 with different domain and range notably by our assumption
    it follows that


x1 y
x y
xy2
xy3
  2  

     l x   l

3y yy1 
yy rx1 yy rx2

xx sy2 xx sy3

3
moreover since 
i1 iy yi syi   it follows by a similar argument as in the proof
of proposition 52 that m has a bounded inverse operator and thus there exists a unique
yy1  for equation b4 hence we obtain that
solution  x   y   l x   l
3
y

 x   y 

l x l

yy1 
3
y

 m 1 op  

finally it remains to show that  x y  as defined in b1 is contained in l1cx cy x  y
exploiting the upper bound for   proposition 23 yields that
 x y l1




cx cy

xyx y

   l1

x y

x y

cx xxy

cx 3
y





xyx y

  x y l1

x y

cx xrx

cx cy



xyx y

x y

x y

cy yxy

 2  x   y 

x y
xy


rx





    at  x   y 

xyi x y

l x l

3
y

x cy

x y

yy1 

icy yi 3y yi syi
46

l1c

x y
xy

i

i3y yi syi

 rl1

cx

x   sl1

4
y

   rl1

cx

 exp 

x 

y exp 

 sl1

3
y

cx  r  cy  s  cx  cx l x 


y

 rl1

cx

x 

 sl1

4
y

cx  r  cy  s  cx  cx l x 

2 m 1 op  

y

2 m 1 op      



which proves that the claim
remark b2 we like to discuss the domain of the operator d rs rs f 
for an element   l1cx cy x  y the previous proof shows that the element  0 0t 
1

yy1  has a welldefined image under the mapping drs rs  f
l1cx cy x  yl x l
3

yy1  if and only if
in l1cx cy x  y  l x   l
3
y

y



x1 y
x y
xy2
xy3
  2  

     l x   l

3y yy1 
yy rx1 yy rx2

xx sy2 xx sy3

b5

in particular by lemma b4 one can construct for any   0 and  satisfying b5 an

element    l1cx cy x  y such that     l1
x y   but where  does not fulfill
cx cy

b5 hence the domain of drs rs  f
in l1cx cy x  y

1

does not even contain an open ball

we now proceed with the proof of the error bounds from proposition 54

lemma b3 assume the same setting as in proposition 54 and denote by  the mapping
as defined in its proof then it follows for n   that
 d rs rs f

1


fr s  r s 

b6

y
 fr s  r  tn x
l  s  tn l 

y
 tn drs rs rs f x
l  l 

l1c

 d rs rs f

1


x cy

x y

y
fr s  r  tn x
l  s  tn l 

b7

y
y
x
 fr  tn x
l  s  tn l  r  tn l  s  tn l 

 d

y
x
 rs rtn l s tn l 

 r s 

l1c

x cy

x y

 d rs rs f
 d

y
f r  tn x
l  s  tn l 

1


 d rs rs f

y
x
 rs rtn l s tn l 

47

f 

b8

1

y
r  tn x
l  s  tn l   r s 

 otn 

l1c

x cy

x y

proof we prove this assertion using lemma b1 by showing for each term on which we
1
apply d rs rs f that the corresponding quantity   given some function
 decreases with order otn  the resulting image element then tends to zero with respect
to l1cx cy x  y with order otn 
let us start with the term in b6 a straightforward calculation gives
y
fr s  r s   fr s  r  tn x
l  s  tn l 


y
2
 tn drs rs rs f x
l  l   tn 




rs 
rs

y 
 x
1 n
l  l 

0
   0  
  0 
0

since 1 n is only finitely supported it is contained in l1cx cy x  y and given   1
we note that  1 n  ot2n   otn  which yields by lemma b1
d rs rs f

1


1 n 0 0

l1c

x cy

x y

 otn 

for the second term ie the one term in b7 denote by      and n  n  the
y

optimal entropic dual potentials for r s and rtn x
l  stn l  with y1  0 respectively
further consider the closed ball b0 r s from proposition 53 and let n be sufficiently
y
large such that r  tn x
l  s  tn l   b0 r s lemma c2 this guarantees that dual
optimizers are lipschitz proposition 53 a straightforward calculation yields
y
 fr s  r  tn x
l  s  tn l 

y
y
x
 fr  tn x
l  s  tn l  r  tn l  s  tn l 

y
 drs rtn x s tn y  f r  tn x
l  s  tn l   r s  
l

l

a    c
y
r  tn x
  
l   s  tn l   exp 



0

0
t









at
 n   n  



2 n
  0  
 0 





where  is given by  r  r0  x  expx  1  x and is evaluated componentwise

for each entry of at n    n
   the function  is smooth nonnegative and
its derivative vanishes at zero hence for a positive nullsequence xn  0 it follows that
xn   oxn  in addition for each x  0 the inequality x  x is satisfied before
we apply lemma b1 let us state a componentwise bound for 2 n for this purpose let
y
1

  exp 1 supcx  r  tn x
l    supcy  s  tn l   
nn

nn

48

and recall by our bounds from proposition 23 that exp 1 at      c  x 
y  hence for all n  n it holds that
at      c


rr

at n    n
   rrrr
r
 rrrrr
rrrr

rr
rr
r
r
y


s

t






 r  tn x
n
l
x
y
l

y
2 n  r  tn x
l   s  tn l   exp 

 

at n






 n



  



y
 r  tn x
l   s  tn l   x  y 

 at 

n   
  y


b9


n

  



b10


for some constant   0 herein we use for the second inequality that  is lipschitz with
modulus expt on the bounded domain t t for t  0 in conjunction with our bounds

for n    n
   proposition 23 which assert for x y  x  yy1  that
rr


nx  x  rrrr
nx  x   ny
 y

rrr


  
rrrr   y ny
rrr
 y



rr
rr
r
r

b11

notably based on b10 we infer by r s  l1cx x   l14 y that 2 n  l1cx cy x  y
y

in order to apply lemma b1 let us consider a monotonous unbounded function  n 
4
1  such that 
i1 iy yi syi   lemma b4 for this function  we now show
that  2 n  otn  so let i  n and consider x  x  then it holds that


yy
i



i1

y
rx  tn x
lx   sy  tn ly 

rx

r

 y rrrr
 x  y  cx y  rrrr  nx  x  ny
rrr
rr
exp


 rrrr 
rrrr


y
rx  tn x
lx   syi  tn lyi 



 

rx

x xy yi 

y
rx  tn x
lx   syi  tn lyi 

rx


 yi  
 nx  x   ny
i




 x xyi 3y yi 

rrr     rrr rrr      rrr
yi rr
nyi
x rr rr
nx
rr
r
  rrrr
rrr 

rrrr rrrr yi y yi  rrrr
r
r r
r
x




lx 
 1  tn max
 x l x  s  tn y
l l1 y

xx1 xl  rx 

y
ii1



i


 n   l x   maxi1 nyi  yi  





x

 n   l x  
lx  

 1  tn max

 x l x  s  tn y
1
l l 2 y
xx1 xl  rx 





y
x

lx  
 x l x  s  tn y
 1  tn max
l l1 3 y
xx1 xl  rx 


y
49





n    l


i

y

y


   1 n   l x   maxii1 ny
 yi   i1 n    l
i


y

y



for some   0 that is independent of i and x  x  by the local lipschitz property
proposition 53 we know that
y
n   l x   tn  x
l  l l1

n    l


cx

y

y

y
 tn  x
l  l l1

cx

x l1 2 y


x l1 2 y


hence for   0 select i  n large enough such that


n    l


y

y

i

y
 i1 tn   x
l  l l1

cx



y



y

x l1 2 y


and choose n  n sufficiently large such that for all n  n holds

y



tn

2


 yi 
  1 n   l x   maxii1 ny
i


 tn
y

   tn 1 1  maxii1 x i x
l  l l1 x l1 y 
cx
2


2
y

consequently we obtain that supxx yy 2 nxy rx  tn and thus it holds that supxx yy 2 nxy rx 
otn  to show that  2 n  otn  let us again consider some integer i  n for
yi  y1      yi  we employ the upper bound b10 and see for some   0 independent
from yi and i that


xx

y
rx  tn x
lx   syi  tn lyi 

exp

syi i3y yi 


 yi  
 x  yi  cx yi    nx  x   ny
i




 



ly  
ny
 yi 

i

2

r  tn x


 1  tn max


x l x 
l l1 x 
iy yi 
yy1 yl  sy 

y

b12

note that the first four factors can be bounded by a constant independent of i and y  y
for the last factor in b12 we employ the local lipschitz property of dual optimizers
with modulus  proposition 53 and obtain

ny
 yi 
i

iy yi 

y
 i1 tn  x
l  l l1

cx

x l1 2 y

hence for   0 we may choose i sufficiently large such that
y
i1 tn  x
l  l l1

cx

x l1 2 y


y

 tn





y

for all i  i

b13

for each yi  y1      yi  we then use the upper bound from b9 in conjunction with a
similar bound as in b11 and obtain for some   0 independent from yi and i that


xx

y
rx  tn x
lx   syi  tn lyi 

syi i3y yi 


 yi 
 x  yi  cx yi    nx  x  ny
i

exp


 



50


r  tn x
y
 yi  
 ny

l l1 x  
ly  
i
2



y

 1  tn max

x l x  y i
yy1 yl  sy 
i3y yi 






 yi   otn 
 yi   ony
 ony
i
i

b14

here we exploited the local lipschitz property of   for the components yi  y1      yi 
as a result we obtain by b13 and b14 that  2 n  otn  hence lemma b1
implies that
d rs rs f

1


2 n 0 0

cx cy

for the last term ie for b8 we obtain

 otn 

y
 d rs rs f r  tn x
l  s  tn l   r s 

 drs

y
x
 rtn l s tn l 

y
f r  tn x
l  s  tn l   r s  

a    c
y
y
2 x
tn x

l  s  tn r  l  tn l  l   exp 



0

0
t









at
 n   n  



3 n
  0  
 0 





y
since r s  l1cx x   l14 y and as x
l  l both have finite support we obtain that

3 n  l1cx cy x  y to finish the proof we show that  3 n  otn  where we
select   1 for any x  x it then follows using the lipschitz property for dual optimizers
proposition 53 that
y

1
y
x y
tn   x
lx sy  rx ly  tn lx ly 
rx
yy



tn n

 exp 





x  y  cx y

l x   n


  l


 y 
nx  x   ny





y

 exp 

cx  cx l x 




x

lx   
y
2

  1  max
 sy  1  tn ly y y


xx1 xl  rx  yy






y

 o tn n   l x   tn n    l


y

y

likewise we see for all y  y that
tn  
sy 3y y
xx
1

 exp

y
x y
x
lx sy  rx ly  tn lx ly 

  ot2n   otn 

 x  y  cx y  

nx  x   ny
 y  



51





c  cx 
 tn 2y y1 n   l x   n    l y exp  x




2
y
ly  

  1  max
  rx  1  tn x
lx 
yy1 yl  sy  xx

y



 o tn n   l x   tn n    l y  ot2n   otn 


2
y

this yields  3 n  otn  which concludes by lemma b1 the proof since
d rs rs f

1


3 n 0 0

l1c

x cy

x y

 otn 

lemma b4 let an nn be a nonnegative sequence such that 
i1 ai   then
there exists an unbounded and monotonously increasing function  n  1  such that

i1 iai  
proof we define the function  by an iterative scheme we start with 0  1 and select
for any k  n the integer nk  maxk nk1  as small as possible such that
n k

 k1 iai 

i1

1 
2k1 iai  2    ai 
k i1
in k1




we then define the monotone function


k1 i
k i  


2k1 i

if i  n k
if i  n k

note that k1  k for each k  n and since n k   it holds for all i  n k that
k1 i  k i further as n k  k for all k  n the sequence k converges pointwise
to a monotone function  which is unbounded and satisfies by monotone convergence


i1 iai  2 i1 ai 

c

properties of finite support approximation

in this section we show a variety of useful characteristics of finite support approximations
based on the notation in the proof of theorem 34 we consider a probability measure
r  l1cx x  on x with full support further let tn nn be a sequence such that tn  0
x
x
1
1
and hx
n nn  lcx x  with limit h and that r  tn hn  p x   lcx x  for each n  n
additionally for an integer l  2 we denote the finite support approximations for hx by
x
l  ie labelling

x

hx
if x  x1 

x1  il1 hxi


 x
x
lx  hx
if x  x2      xl 




else
0
lemma c1 for   0 there exist l  n such that
hx  x
l l1

cx

52

x 

 

additionally there is n  n such that for all n  n holds
x
x
l  nl l1

x 

cx

x
hx
n  nl l1

 

cx

x 

 

x
proof choose l large enough such that cx x1  
il1 cx xi hxi   6 then we see



x


cx xi hx

c
x

h


x
1
xi   
x
i
x 
cx
3
il1
il1

hx  x
l l1

let n be large enough such that cx x1  hx  hx
n l1

cx

x
x
l  nl l1

cx

x 

 3 for all n  n  this yields



l

il1

i2

x
x
x
x
x
 cx x1  hx
x1  hnx1   hxi  hnxi    cx xi  hxi  hnxi 
x 

 cx x1  

xx

cx x hx
x

 hx
nx 

 cx x1  hx  hx
n l1

cx

x 


 
3

which implies by triangle inequality
x
hx
n  nl l1

cx

x 

x
 hx
n  h l1

cx

x 

and thus finishes the proof

 hx  x
l l1

cx

x 

x
 x
l  nl l1

cx

x 

 

lemma c2 it holds that
k  hx l1

cx

x 

 sup hx
n l1
nn

cx

x 

 sup x
nl l1

cx

nln

x 

 

further for   0 there is n  n such that it follows for all n  n and l  n that
x
x
1
r  tn hx
n  r  tn nl  r  tn l  r  lcx x  r  rl1

cx

x 

  

x
1
proof by convergence of hx
n towards h with respect to lcx x  we see that

hx l1

cx

x 

 sup hx
n l1
nn

cx

x 

further for given l n  n and it follows that x
nl l1

cx

 

x 

 cx x1  hx
n l1

cx

x 

 which

yields that k   for n  n large enough such that tn  k 1 we conclude the second
claim
lemma c3 for given l  n and a probability measure r with suppr  x there exists
x
an integer n  n such that for all n  n it holds r  tn x
l  p x  and r  tn nl  p x 
x
with suppr  tn x
l   suppr  tn nl   x 

x
proof first we note that xx hx
nx  0 for all n  n implies xx hx  0 by construction
of the finite support approximation it also follows for any l n  n that xx x
nlx 
x
xx lx  0 hence it remains to show for given l  n that there exists n  n such that
x
the elements r  tn x
l  r  tn nl are strictly positive in each entry to this end consider

53

k  0 as in lemma c2 and choose n  n large enough such that it holds for all n  n
that tn  2k1 mini1l minrxi  1  rxi  this yields for any i  1     l that
rxi  tn x
lxi


x
 rxi  12 minrxi  1  rxi   21 rxi 
lxi 
 rx i  t n k 

1
1
k 

 rxi  2 minrxi  1  rxi   2 rxi

1
2

 1
 0

further since x
 x1      xl  it follows for all n  n that rx  tn x
x  0 for all x 
lx  rx 
x
x
0 1 which shows that r  tn l  p x  and suppr  tn l   x  the same argument
x
implies for all n  n that r  tn x
nl  p x  and suppr  tn nl   x 

54

