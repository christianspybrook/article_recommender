Long-distance quantum key distribution based on the physical
loss control
N. S. Kirsanov, N. R. Kenbaev, A. B. Sagingalieva, D. A. Kronberg, V. M. Vinokur,
G. B. Lesovik
Terra Quantum AG, St. Gallerstrasse 16A, CH-9400 Rorschach, Switzerland

arXiv:2105.00035v1 [quant-ph] 30 Apr 2021

May 4, 2021
Abstract
Existing quantum cryptography is resistant against secrecy-breaking quantum computers but
suffers fast decay of the signal at long distances. The various types of repeaters of propagating
quantum states have been developed to meet the challenge, but the problem is far from being solved.
We step in the breach and put forth long-distance high secrecy optical cryptography, creating the fast
quantum key distribution over distances up to 40,000 kilometers. The key element of the proposed
protocol is the physical control over the transmission line.

1

Introduction

Existing quantum cryptography is robust against secrecy-breaking quantum computers but is subject to the fast decay of the signal with the distances. To amend the signal losses, the various types
of repeaters of the propagating quantum states have been developed [1–16], but yet the long distance
transmission looks like an impossible task for existing protocols. Directly applying the principle of quantum irreversibility [17–19], we step in the breach and put forth long-distance high secrecy cryptography,
creating the fast quantum key distribution over the globe distances of about 40,000 kilometers.
On a practical level, the information transfer efficiency, both in classical and quantum cases, is
hindered by the optical fiber losses. The conventional approach to quantum communication is doublesuffering: firstly, the losses themselves harm efficiency; secondly, the commonly accepted concept is
that an eavesdropper (Eve) can use all the transmission line losses to decipher the communication
successfully. However, the lion share of losses occurs due to Rayleigh scattering of the signal propagating
through the optical fiber. This propagation is similar, to no small extent, to the evolution of the
ensemble of particles experiencing scattering on the quenched disorder potential described by the kinetic
equation [20], generalizing the classical Boltzmann equation. This implies that the particle dynamics
is accompanied by the entropy growth and, therefore, irreversible as expressed by the Second Law of
Thermodynamics. Taking that the line carries a scatterer per a wavelength, we conclude that at least
about 109 quantum Maxwell Demon-like devices are required to collect photons scattered in a one
kilometer long fiber and to reverse and unify the dynamics of the related quantum states. This makes
collection of the Rayleigh-scattered information an impossible task. These considerations supply us with
a new paradigm for establishing an innovative quantum key distribution (QKD) protocol based on the
physical control of the optical fiber line.
In a basic optical QKD scheme electromagnetic states representing different bit values are transmitted
from the sender (Alice) to the receiver (Bob) which allows them to securely share a secret random
sequence. As we have just pointed out, the major irreversibility's implication is that Eve cannot collect
any useful information about the random bits from the scattering. However, the possibility of the local
rerouting of the part of the transmitted signal remains. Physically this can be implemented, for example,
by a local bending the fiber, which leads to mixing of the major propagating mode with the higher-order
leaking modes. This local imperfection, in turn, allows for eavesdropping on the information carried by
the major mode. Had the signal been classical, this "bending" would have opened unlimited access to
the full content of the message for Eve. However, any electromagnetic signal is quantized and can be
viewed as a sequence of photons. The discreet statistics of photons imposes a major limitation on Eve's

1

EDFA

EDFA

EDFA

Bob

Alice
Eve

Figure 1: Schematics of the setup realizing the exemplary protocol. Alice encodes a random bit string
into a sequence of coherent pulses and sends it to Bob via the optical fiber. The pulses pass through
a sequence of optical amplifiers and the resulting signals are then received and measured by Bob. Eve
can seize part of the signal: for instance, by bending the transmitting optical fiber and detecting the
transcending optical modes. However, Alice and Bob monitor the losses in the line, and always know
the proportion of the signal stolen by eavesdropper. Importantly, they can identify the exact losses
caused and exploited by Eve. This knowledge enables Alice and Bob to adopt the most efficient bit
ciphering and measurement scheme: depending on how many photons Eve intercepts, Alice picks certain
values of signal intensities which are optimal as far as the informational advantage over Eve is concerned;
in a concerted manner, Bob adjusts his measurement routine. This in particular gives the authorized
parties additional leverage as far as post-selection is concerned: after transmitting and receiving the
random bit string, Alice and Bob use an authenticated public classical channel to perform information
reconciliation (increasing their informational advantage over Eve) and privacy amplification – with the
optimal parameters of ciphering and measurement these procedures allow to eradicate Eve's information
without sacrificing too many bits.
ability to extract information from measuring seized signal. If the initial signal contains, on average,
N photons, and the local leakage is quantified by transparency rE , only the small fraction of the signal
containing nE = rE N photons comes to Eve. In the case of the coherent √
signal state, the unavoidable
fluctuation of the photon number follows the Poisson statistics,
δn
=
rE N . Therefore, with the
E
√
decrease of rE , the relative fluctuations grow as δnE /nE = 1/ rE N . If, for instance, Alice encodes bit
values into pulses with two different intensities, high fluctuations make it difficult for Eve to distinguish
them. In turn, if Bob gets the signal pulse comprising NB photons for which fluctuations δNB fi NB ,
then even a single-shot measurement provides him with a high-probability reliable recognition of whether
the received signal represents 0 or 1. This establishes that the critical condition of security guarantee
is ensuring that Bob gets the share sufficient for identifying the recognition of the signal, while the
controlled value of rE limits the distinguishability of the signal portion seized by Eve.
An efficient control over rE rests on a careful analysis of the optical fiber's state and the emergent
scattering matrix that can be accomplished by standard telecom technology methods, particularly, using
the optical time-domain reflectometry. We propose an efficient technique for controlling the optical fiber
based on the direct measurement of the propagation of the signal from Alice to Bob. This technique,
together with the cascade signal amplification as a mean for preserving signal intensity lays the foundation
for our QKD protocol unlocking unprecedented key generation rates and global transmission distances.

2

Method description

We propose a method for long-distance QKD based on the signal amplification and physical control
of the transmission line (see the schematics in Fig.1). Two principal ideas behind the method are: (i)
2

the random bits are encoded into non-orthogonal coherent pulses which are amplified by a cascade of
the in-line optical amplifiers, e.g., Erbium Doped Fiber Amplifiers (EDFAs) to achieve long-distance
transmission, and (ii) Alice and Bob can determine the exact proportion of the signal stolen by the
eavesdropper (Eve) and distinguish it from the natural losses in the line (caused primarily by the Rayleigh
scattering). Alice and Bob use the knowledge about losses to accurately estimate their informational
advantage over Eve which in turn allows them to pick the pulses' intensities, adopt the measurement
routine and perform post-selection in the most efficient way, leaving Eve no information about the final
shared key.
0. Initial preparation.– The reflectometry methods allows to determine losses with high precision and
distinguish local losses (which could be caused by Eve) from the intrinsic natural losses homogeneous across the whole line and caused mainly by the Rayleigh and Raman scattering. As a part
of the initial equipment setting, Alice and Bob determine the natural losses r0 in the transmission
line which cannot be caused by Eve. Bob and Alice share the value of r0 via the authenticated
classical communication channel.
1. Alice and Bob determine a total signal loss rt in the communication channel via transmitting test
pulses. After that, they obtain the signal loss rE caused by an eavesdropper by comparing the
intrinsic signal loss r0 with the total signal loss rt . Bob and Alice share the value of rE via the
authenticated classical communication channel.
For example, let us consider a section of the communication channel which does not comprise
amplifiers. If the intrinsic loss in this section is r0 and Eve seizes a proportion rE of the signal,
then the total loss rt is determined from the equation (1 − rt ) = (1 − rE )(1 − r0 ). Further below
we describe a beam splitter attack of Eve 5 at a single location along the communication channel.
The proposed method and our analysis presented further below also generalizes to the case where
Eve intrudes the communication channel at several locations.
2. Using a physical random number generator (possibly quantum), Alice generates a bit sequence of
length L.
3. Alice ciphers her bit sequence into a series of L coherent light pulses which she sends to Bob. The
bits 0 and 1 are defined by the coherent states |γ0 i = |γi and |γ1 i = |−γi respectively, – without
loss of generality, assume that γ ∈ R – and the value of γ is chosen optimally given the known
specific value of rE . This means that Alice uses such coherent states that they correspond to the
maximum key generation speed with respect to the losses in the channel. The intensity of the pulse
|±γi is determined by the average photon number
hni = |γ|2 .

(1)

4. The signal is amplified by a cascade of optical amplifiers installed equidistantly along the whole
optical line. Each amplifier compensates the losses in such a way that the amplified signal intensity
equals to the initial one. As a coherent pulse passes through amplifiers its state becomes mixed.
Bob receives the signal and performs the homodyne measurement, the parameters of which are
again determined by the known value of rE .
5. Alice and Bob apply information reconciliation. Some of Bob's measurements will have inconclusive
results and the corresponding bits must be discarded. To do so, Bob announces positions of invalid
bits to Alice publicly via an authenticated public classical channel.
6. Alice and Bob estimate the error rate and perform the error correction procedure.
7. Alice and Bob perform privacy amplification. Using a special protocol, Alice and Bob produce a
shorter key, which Eve has no (or negligibly small) information about. Once again, Alice and Bob
may need to use their authenticated public classical channel.
8. Alice and Bob perform steps 1 to 7 until the length of the shared key is appropriate.
The outlined protocol is based on phase ciphering. However, in the case of very long transmission
distances, the preservation of the pulses' polarization and the efficient phase reference transmission
necessary for homodyne detection may be challenging. These practical difficulties can be lifted, by,
for example, using intensity ciphering, in which case the bit values are encoded into the two pulses
3

with different intensities. This has already been mentioned in the Introduction and is analyzed below in
Section 3.1. In the main part of the paper, we will concentrate primarily on the phase ciphering approach
which ensures faster information transmission. In the forthcoming publication we will analyse in detail
the special measures necessary for compensating phase fluctuations hence improving considerably the
phase ciphering protocol.

3

Signal amplification

The crucial component of the proposed scheme is the cascade of amplifiers preserving the signal
intensity necessary for achieving long distance transmission. We start this section with estimates illustrating how amplification impacts the signal fluctuations and the precision in detecting leakage. We then
introduce the formal framework based on the P-function representation and show how the signal state
evolves under the ideal amplification process. After that, we consider the practical case of amplification
in doped fibers with the associated losses in the channel. We further show that a cascade of amplifiers can
be theoretically reduced to one effective amplifier – we will use this formal property in further sections
for the analysis of legitimate users' informational advantage over the eavesdropper.

3.1

Preliminary estimates

The challenge to meet is reaching the global distances of the transmission exceeding 20,000 km. In
order to estimate possible enhancement of the transmission distance we use, for illustrative purposes,
simple and transparent estimates based on the robustness of the strength of our pulses. Let us estimate
the strength of our pulses that allows for their stable analogue amplifying, transmitting the signal without distorting its shape and phase with the minimal generated noise and, at the same time, preserving
the degree of protection against eavesdropping. A crucial component needed to ensure such an enhancement are just the standard telecom amplifiers preserving the analog signal including erbium-doped fiber
amplifier and Raman amplifier. To give an idea how it works, we present simple estimates leaving the
detailed description for the technical part of the paper.
Let us consider the control precision for the representative line of 20,000 km. In general, the exact
optimal distance between amplifiers is to be calculated. Here for the estimate we take the standard
telecom practice distance of d = 50 km. On this distance the signal drops by factor of 10 (the transmission
probability T = 0.1); correspondingly the amplifying coefficient is to be G = 10. Suppose that the initial
14
14
= 1013 on the 50 km end.
photons, which drops down to T * nA
test signal carries nA
T = 0.1 * 10
T = 10
A
14
14
An amplifier restores it back to G * T * nT = 10 * 0.1 * 10 = 10
q but adds noise. Since photons follow
6
the Poisson statistics, the fluctuations before the amplifier are T * nA
T ' 3 * 10 . These fluctuations are
amplified with the factor G as well, giving
q
7
A
δnG
(2)
T ' G T nT ' 3 * 10 .

Coming through√the sequence of M amplifiers which add fluctuations independently, the total fluctuation
raises by factor M , giving for 400 amplifiers on the 20,000 km line the twenty-fold fluctuation increase.
The fluctuation on Bob's end is thus
√
8
δnB
M δnG
(3)
T '
T ' 6 * 10 .
At the end of the day, we have
B
−6
δnB
.
T /nT ' 6 * 10
min
rE

(4)
−6

This determines the minimum detectable leakage
' 6 * 10 . Our qualitative considerations agree
with the rigorous calculations provided in Sec. 3.5.
For illustrative purposes, let us use the intensity ciphering instead of the phase ciphering. If Eve gets
∼ 1 photons (stealing signal in the vicinity of Alice), unity relative error would make it impossible for
her to distinguish between the different pulses provided that their intensities are of the same order. A
min
pulse hard for eavesdropping must thus contain n ∼ 1/rE
∼ 105 photons; in this case, the fluctuation
at Bob's amounts to
√
δn = GM n ∼ 104 ;
(5)
δn/n ∼ 0.1.
4

(6)

This allows, especially taking into account additional informational postprocessing measures exercised
by both Bob and Alice, more elaborate encoding and measuring procedures, the readable Alice to Bob
transmission that cannot be intercepted by Eve. The fact that scalability behaves as square root of the
line length, enables us to execute a major breakthrough in safe communication sending the decipherable
signal over a global distance of 40,000 km.

3.2

P-function and its evolution under amplification

Let us introduce our theoretical framework for the rigorous description of losses and amplifications.
Consider a single photonic mode with bosonic operators â and â† acting in the Fock space. To understand
the effect of the amplification on the bosonic mode state, it is most convenient to use the P-function
representation of the latter. Such representation allows to express any density operator as a quasi-mixture
of coherent states:
Z
ρ̂ = d2 α P(α) |αihα| ,
(7)
where d2 α ≡ dRe(α) dIm(α) and the quasi-probability distribution P(α) is not necessarily positive. For
a given state described by density matrix ρ̂ the P-function can be written as
P(α) = trρ̂ : δ(â − α) :
where

1
: δ(â − α) := 2
π

Z

d2 β eαβ

∗

(8)

−α∗ β βâ† −β ∗ â

e

e

,

(9)

see [21] for details.
Phase-amplification is described by a quantum channel given by
AmpG=cosh2 (g) : ρ̂ 7→ AmpG [ρ̂] = trb Ûg ρ̂ ⊗ |0ih0|b Ûg†
† †

Ûg = eg(â

b̂ −â b̂)

(10)

,

where g is the interaction parameter characterizing the amplifier, G = cosh2 (g) is the factor by which
the intensity of the input signal is amplified (as we will explicitly see in the following formulae), and
annihilation operator b̂ corresponds to the auxiliary mode starting in the vacuum states. An explicit
Kraus representation of the channel can be written as
∞
X

AmpG (ρ̂) =

K̂n ρ̂K̂n

(11)

n=0
n

†

(g) †n
√
with K̂n = tanh
â cosh(g)−â â see e.g. [22].
n!
To show how the P-function of a state changes under the amplification process let us consider a
simple situation where the input signal is in the pure coherent state |γihγ| with the corresponding initial
P-function Pi (α) = δ(α−γ) (delta-function on complex numbers). After the amplification the P-function
becomes
P (α; γ, g) = tr : δ(â − α) : AmpG [|γihγ|] .
(12)

Bearing in mind that
it is easy to see that

Amp∗G [â] = Ûg† â Ûg = cosh(g)â + sinh(g)b̂† ,

(13)

!
√
1
|α − Gγ|2
P (α; γ, g) =
exp −
.
π(G − 1)
G−1

(14)

√
In other words, the output state is a √
mixture of normally distributed states centered around | Gγi; the
width of the distribution is (G − 1)/ 2.

5

Figure 2: (a) Two loss or amplification channels can be reduced to one. (b) Loss and amplification
channels can be effectively rearranged. (c) A series of losses and amplifiers can be reduced to one pair
of loss and amplification.

3.3

Amplification in doped fibers and losses

In Er/Yt doped fiber the photonic mode propagates through the inverted atomic medium. To keep
the medium inverted, a seed laser of a different frequency co-propagates with the signal photonic mode
in the fiber and is then filtered out at the output by means of wavelength-division multiplexing (WDM).
The interaction between the inverted atoms at position z and propagating light field mode â is precisely
given by the Hamiltonian
H = i(â† b̂†z − âb̂z ),
(15)
where b̂z corresponds to a collective decay of one of the atoms at z. Hence, the evolution of the signal
mode after its propagation through EDFA is set by a composition of infinitesimal phase-amplifications
which, as we show in the next subsection, can be effectively reduced to a single amplification channel.
In practice, the performance of EDFA suffers from technical limitations, which come in addition to
the amplification limits on added quantum noise. These limitations are mainly caused by two factors: (i)
the atomic population may be not completely inverted throughout the media, (ii) coupling imperfection
between the optical mode and EDFA or optical fiber. Both of these mechanisms can be taken into
account as a loss channel acting on the state before the amplification, as shown in [23].
Let us introduce the loss channel describing all possible losses in the line. Equation (13) describes
the action of amplifier on the annihilation operator in the Heisenberg picture. In the same way we can
express the canonical transformation associated with losses
ˆ † âŪ
ˆ = cos(λ)â + sin(λ)ĉ
Loss∗T [â] = Ū
λ
λ
√
√
= T â + 1 − T ĉ,

(16)

2

T = cos (λ),
where λ is the interaction parameter, T is the proportion of the transmitted signal, the annihilation
ˆ = eλâ† ĉ−λâ ĉ† .
operator ĉ corresponds to the initially empty mode which the lost photons go to, and Ū
λ

3.4

Composition of amplifiers and losses

In our cryptographic scheme, the amplification is used to recover the optical signal after it suffers
from losses. Long-distance QKD requires a cascade of amplifiers, in which case signal's evolution is
determined by a sequence of multiple loss and amplification channels. In this section we prove that
any such sequence can be mathematically reduced to a composition of one loss and one amplification
channels. We will later adopt this simple representation for the informational analysis of our protocol.

6

Statement 1. Two loss or amplification channels can be reduced to one
First, we show that a pair of loss or amplification channels can be effectively reduced to the one
channel, see Fig.2(a). To that end, let us consider two consequent loss channels:
ˆ † Ū
ˆ† ˆ ˆ
(LossT2 ◦ LossT1 )∗ [â] = Ū
λ1 λ2 â Ūλ2 Ūλ1
p
p
= LossT1 ( T2 â + 1 − T2 ĉ2 )
p
p
p
= T2 T1 â + T2 (1 − T1 )ĉ1 + 1 − T2 ĉ2
p
p
= T2 T1 â + 1 − T1 T2 ĉ,
where we defined operator

p
√
T2 (1 − T1 )ĉ1 + 1 − T2 ĉ2 )
√
ĉ =
,
1 − T1 T2

(17)

(18)

acting on the vacuum state and satisfying the canonical commutation relation [ĉ, ĉ† ] = 1. We can thus
represent two channels in a form of one effective channel:
LossT2 ◦ LossT1 = Loss(T =T1 T2 )

(19)

The same reasoning applies to amplifiers:
AmpG2 ◦ AmpG1 = Amp(G=G2 G1 )

(20)

Statement 2. Loss and amplification channels can be effectively rearranged
Let us show that a composition of an amplification channel followed by a loss channel can be mathematically replaced with a pair of certain loss and amplification channels acting in the opposite order,
see Fig.2(b). Consider the transformation corresponding to the amplification followed by the loss
ˆ †0 â Ū
ˆ Û
(LossT 0 ◦ AmpG0 )∗ [â] = Ûg†0 Ū
λ g
λ
√
√
∗
= AmpG0 [ T 0 â + 1 − T 0 ĉ]
p
p
√
= T 0 G0 â + (1 − T 0 )ĉ + T 0 (G0 − 1)b̂† .

(21)

In the case of the opposite order we have
ˆ † Û † â Û Ū
ˆ
(AmpG ◦ LossT )∗ [â] = Ū
g λ
λ g
√
√
= Loss∗T [ Gâ + G − 1b̂† ]
p
√
√
= T Gâ + G(1 − T )ĉ + G − 1b̂† .

(22)

It is easy to see that the two transformations are identical if
LossT 0 ◦ AmpG0 = AmpG ◦ LossT
G0 T 0
,
(G0 − 1)T 0 + 1
G = (G0 − 1)T 0 + 1.
T =

(23)

In other words, the two types of channels "commute" provided that the parameters are modified in
accord with these relation. In particular, the parameters in the equation above are always physically
meaningful G ≥ 1, 0 ≤ T ≤ 1, meaning that we can always represent loss and amplification in form of a
composition where loss is followed by amplification (the converse is not true).

7

Statement 3. A series of losses and amplifiers can be reduced to one pair of loss and
amplification
Let us finally show that a sequence of loss and amplification channels can be mathematically represented as one pair of loss and amplification, see Fig.2(c). Consider the transformation
ΦM = (AmpG ◦ LossT )◦M ,

(24)

corresponding to the series of M identical loss and amplification channels, for which we want to find a
simple representation. According to Statement 2, we can effectively move all losses to the right end of the
composition, i.e., permute the channels in such a way that all the losses act before amplification. Every
time a loss channel with transmission probability T(i) is moved before an amplifier with amplification
factor G(i) , the parameters are transformed in accord with Eq. (23):
T(i) 7→ T(i+1) =

G(i) T(i)
,
(G(i) − 1)T(i) + 1

(25)

G(i) 7→ G(i+1) = (G(i) − 1)T(i) + 1.
In our sequence we can pairwise transpose all neighbouring loss with amplifier (starting with the first
amplifier and the second loss). After repeating this operation M − 1 times, bearing in mind Statement
1, we find that
ΦM = AmpG(0) ◦ AmpG(1) ◦ * * * ◦ AmpG(M −1)
◦ LossT(M −1) ◦ LossT(M −2) ◦ * * * ◦ LossT(0)

(26)

= AmpG◦ ◦ LossT◦ ,
where
T◦ =

M
−1
Y

T(i) ,

i=0

G◦ =

M
−1
Y

(27)
G(i) ,

i=0

i.e., a series of losses and amplifiers is equivalent to the loss channel of transmission T◦ followed by the
amplifier with amplification factor G◦ .
Note now that the value μ ≡ G(i) T(i) = GT cannot be changed by permutations. Let us define
F(i) = (G(i) − 1)T(i) + 1,

(28)

and bear in mind that
F(i+1) = (G(i+1) − 1)T(i+1) + 1 =

(F(i) − 1)
TG + 1 = μ
F(i)



F(i) − 1
F(i)


+ 1.

(29)

We can write
T(i+1) =

TG
,
F(i)

(30)

G(i+1) = F(i) ,
and
G◦ = G

M
−2
Y

F(i) ,

i=0

T (T G)M −1
(T G)M
T◦ = QM −2
=
.
G◦
i=0 F(i)

(31)

Let us find the explicit form of G◦ and T◦ by solving the recurrence relation. Define An and Bn through
the relation
An
F(n−1) =
.
(32)
Bn
8

Then
F(n+1) =

(μ + 1)F(n) − μ
(μ + 1)An+1 − μBn+1
=
.
F(n)
An+1

(33)

It follows from (32) and (33) that Bn+1 = An and
An+1 = (μ + 1)An − μBn = (μ + 1)An − μAn−1 .

(34)

We see that the solution of this equation has a form
An = c1 + c2 μn ,

(35)

where c1 and c2 are the constants, which are determined by F0 = (G−1)T +1: we take A1 = (G−1)T +1
and A0 = 1, and obtain
(G − 1)T
T −1
c2 =
.
(36)
c1 =
GT − 1
GT − 1
−2
Notably, the product ΠM
n=0 F(n) appearing in the final expression becomes relatively simple
M
−2
Y
n=0

F(n) =

M
−2
Y
n=0

AM −1
An+1
=
An
A0

(37)

(G − 1)(GT )M + G(T − 1)
=
,
G(GT − 1)
and we have
ΦM = (AmpG ◦ LossT )◦M = AmpG◦ ◦ LossT◦ ,
(G − 1)(GT )M + G(T − 1)
,
GT − 1
(T G)M
T◦ =
.
G◦

G◦ =

(38)

The case of T G = 1 is particularly interesting as the average intensity of the transmitted signal
remains preserved (which is different from the total output intensity as it has the noise contribution).
In the limit G → 1/T we have
G◦ = G(M (1 − T ) + T ),
T
.
T◦ =
M (1 − T ) + T

3.5

(39)

Fluctuations

Let us calculate the fluctuation of the number of photons in a pulse after it passes through a sequence
of M loss regions and amplifiers. Let |γ|2 be the input intensity; as follows from (7) and (14), the average
number of photons n in the output signal is
n = hâ† âi = |γ|2 + G◦ − 1,

(40)

where G◦ and T◦ are given by Eq. (39). The variance of the output photon number is
δn2 = h(â† â)2 i − (hâ† âi)2 = GM (1 − T )(GM (1 − T ) + 1) + |γ|2 (2GM (1 − T ) + 1).

(41)

In the limit |γ|2 fl GM fl 1 we obtain the same result as we got from the qualitative considerations in
Sec. 3.1:
√
(42)
δn ' nGM .

9

4

Control of the transmission line

To monitor the eavesdropper's activity, Alice sends, at appropriate intervals, special test pulses
(individual or many, see the discussion below) and cross-checks the intensities with Bob. The test pulses
should comprise a large number of photons, but must not, however, damage Bob's detection equipment.
By producing and analysing the corresponding scattering matrix, Alice and Bob can determine the losses
in the channel. To prevent an inconspicuous Eve's intrusion into the optical fiber, the physical loss control
should be conducted constantly and should not halt even during the pauses in the key distribution. We
emphasize that the authorized parties can discriminate between the losses of the general origin and losses
that are caused and can be exploited by Eve.
If the optical fiber is properly installed, it should not have points of significant inflections and crude
junctions. Then, most of the intrinsic natural losses in the line occur due to Rayleigh scattering. Such
losses are distributed across the whole line. Therefore, Eve cannot pick up the dissipated signal effectively,
unless she has an antenna covering a significant part of the line; moreover, as we discussed in the
Introduction, the effective deciphering of the dissipated signal requires a multitude of Maxwell demonlike devices, which is not practically feasible. The only option remaining to the eavesdropper is to take
away part of the signal deliberately, that is to create and exploit the losses additional to the natural
ones (namely, by bending the optical fiber intentionally). Alice and Bob can identify and measure such
artificial losses. To do that, they must first determine the magnitude of losses not associated with the
eavesdropper's activity; this can be done by measuring the losses appearing homogeneously across the
whole line before the beginning of the protocol. After that, Alice and Bob can precisely determine
the newly appearing local leaks of the signal (with proportion rE ) possibly intercepted by Eve. This
knowledge ensures the most efficient ciphering and measurements routines, determining in turn the
post-selection procedure.
In the case that Eve knows the parameters of the test pulses, she can completely seize them and send
the fake ones to mask her presence. In order to prevent that, Alice should parametrize the test sequences
randomly and compare the parameters with Bob only after he measures the pulses. This arrangement
would force Eve to first measure the pulses and then reproduce them which in turn would prolong the
transmission. Such a delay can be easily detected by Alice and Bob. Possible testing protocols:
1. Individual pulses.– Alice sends a single testing pulse the parameters of which are chosen randomly.
The preparation of the pulse implies generating an auxiliary random bit sequence and translating
it into the random intensity, phase, length and shape of the pulse. After Bob measures the test
pulse, he verifies its parameters with Alice, and they determine the losses in the channel.
2. Sequence of pulses.– Alice sends a sequence of test pulses in which she encodes an auxiliary random
sequence. This involves generating an auxiliary random sequence and ciphering it in a sequence of
pulses. Bob measures the pulses, verifies the encoded message with Alice, after what they determine
the losses.
Let τS be the length of the signal pulse, and τT be the total length of a sequence of test pulses (test
pulses may look completely like the signal ones, but their sequence must contain much more photons
than one signal pulse). Both types of pulses can be characterized by the same constant power, e.g.,
P = 20 mW, but τT must be much greater than τS , e.g., τT = 1 ms and τS = 1 ns. The average number
P τT
14
of photons in the test pulse is nA
T = hν ∼ 10 , where ν is the light frequency. The measurement
8
error on Bob's side is determined by Eq. (42): δnB
T ∼ 6 * 10 . The test pulse allows to detect leakage of
magnitudes
rE ≥ δTT = δnT /hnT i = 6 * 10−6 .
(43)
Similar control and analysis of the reflected signal must be performed on Alice's end.

5

Measurement scheme
The state of the optical signal can be described in terms of its quadratures given by operators
â† + â
,
2
i(â† − â)
p̂ =
.
2
q̂ =

10

(44)

Figure 3: Optical phase diagram of states corresponding to bit values 0 and 1 after they pass through
the
√ sequence of losses and amplifications. The two output states constitute Gaussians centered at
± 1 − rE γ, where rE is the proportion of signal stolen by Eve.
These operators represent the real and imaginary parts of the signal's complex amplitude, and by measuring one of the quadratures one can distinguish between different signals.
Bob needs to distinguish between two states |γ0 i = |γi and |γ1 i = |−γi (with γ ∈ R) transformed by
losses and amplifiers, – two Gaussians with centers laying on the real axis (q-axis) of the optical phase
space, see the phase diagram displayed in Fig. 3 – and for this he measures the q̂-quadrature. Bob does
his measurements by means of homodyne detection described by the following operators:
Z∞
dq |qi hq| ,

Ê0 =
Θ

Z−Θ

(45)
dq |qi hq| ,

Ê1 =
−∞

Êfail = Iˆ − Ê0 − Ê1 ,
where |qi is the eigenstate of q̂, and the parameter Θ is tuned by Bob depending on the amount of losses
possibly stolen by Eve, see the discussion below. Here, Ê0(1) determines the bit value 0(1), whereas Êfail
is associated with the bad outcome and the respective bit must be discarded by Alice and Bob on the
stage of post-selection. By looking at Fig. 4, one can see that Êfail corresponds to the phase space region
where the two states (Gaussians) overlap the most, and thus the associated outcome is inconclusive.

6

Error estimate and correction

After the measurements and post-selection procedure of discarding invalid bits, Alice and Bob must
perform error correction procedure. The quadrature value q obtained from homodyne measurement, allows to estimate the probability of error in the corresponding bit – one can easily compute the conditional
error probability for every q. In reality, the error rate is also determined by channel imperfections and
Eve's detrimental activities. Therefore, in practice, instead of the theoretical prognosis, the error correction procedure should be mainly predicated on the direct measurement of an error, e.g., by disclosing
a part of the raw key to observe the error.
One option for the practical error estimation is to disclose one half of the raw key. But if the raw
key is long enough, already a relatively short part can provide an accurate error estimate. According to
this method, Alice and Bob use their public authenticated channel to select a number of bit positions in
the raw key and publicly announce the corresponding bit values. Then, using Bayes' theorem, they can
make a guess about the expected error rate for the remaining part of the raw key. Alternatively, instead
of the bit values Alice and Bob can disclose the parity bits for some selected blocks of raw key positions.
This method gives a better estimate for small error rate values, but is worse for high error rates. The
decision about the block size can be made taking into account the theoretical estimates based on the
observed values of q. For example, if the raw error estimate is approximately 6%, blocks of length 10 can
be used, since the probability for parity bits mismatch in this case is approximately 36%, which is large,
but still below 50%, meaning that the parity data reveal a lot of information about the real error rate.
11

Figure 4: Schematic representation of the measurement operators employed by Bob. The two signal
states are Gaussians overlapping the most in the region of phase space corresponding to Êfail . Therefore,
Alice and Bob consider the associated outcome inconclusive and discard it on the post-selection stage.
The outcomes associated with Ê0 and Ê1 are considered conclusive. The value of Θ is varied to perform
the most efficient post-selection procedure as far as the final key generation rate is concerned.
After estimating the error rate, Alice and Bob can carry out the error correction procedure. To do
that, they can use the low-density parity-check (LDPC) codes [24]. The input for such codes are the
probabilities of zero or one at each bit position and the syndrome of the correct bit string – the set of
parity bits which are sufficient to correct the errors, taking into account the a priori probabilities for each
position. LDPC codes are particularly good for error correction after homodyne measurement, since the
measurement result q itself allows to calculate the probabilities for correct and erroneous results.
After Alice and Bob correct errors in a (possibly small) part of the raw key, they have to take into
account the number of errors in this part to yield a more accurate error estimate for the remaining
key. We propose the following adaptive procedure: Alice and Bob first take a relatively short subset
of the original raw key (which size depends on the codeword's length, e.g., 1000 bits), and apply error
correcting procedure which is designed for high error rates (e.g., 10% in the case that the preliminary
crude estimation gave just 5% error probability). After correcting error in this small subset, Alice and
Bob know the number of errors therein, and have a better error rate estimate for the remaining part
of the key. Then, they should take another short (e.g., once again, 1000 bits) subset and perform error
correction according to the new improved error rate estimate, and so on. With each iteration, the error
estimate becomes more accurate making the error correction procedure more efficient. This method can
be applied without having initial error estimate at all which can save Alice and Bob a large part of the
raw key.
The error correction procedure discloses some information about the key. For linear codes like LDPC
codes, one syndrome bit discloses no more than one bit of information about the key, thus the syndrome
length is appropriate upper bound for the information leakage.

7

Privacy amplification

Although after the error correction procedure, Alice and Bob share the same bit string, which is
still correlated with Eve, thus it cannot be used as the final secret key. The privacy amplification
procedure [25–27], aimed at eradicating Eve's information, produces a new, shorter, bit string. This new
string can finally be used as a secret key as Eve does not possess any (or almost any) information about
it.
To eliminate the eavesdropper information, Alice and Bob can, for instance, use universal hashing
method [28]. This method requires them to initially agree on the family H of hash functions h ∈ H.
At the privacy amplification stage, they randomly select such a function h : {0, 1}l1 → {0, 1}l2 from this
12

Figure 5: (a) Beam splitter attack on the protocol. Eve seizes part of the signal somewhere along the
optical line. (b) Scheme equivalent to (a). The losses and amplifiers before and after the point of Eve's
intervention are represented by two pairs of loss and amplification channels defined by the parameters
{T1 , G1 } and {T2 , G2 } respectively.
family, that it maps the original bit string of length l1 to the final key of length l2 . If Eve is estimated
to have e bits of information about the raw key, l2 must be equal to l1 − e.
One example of H is the Toeplitz matrices family [29]. Alice and Bob can use a random binary
Toeplitz matrix T with l1 rows and l2 columns. Then they represent their bit string as a binary vector
v, and the final key k is given by
k = T * v.

8

Eve's attack

In this section, we demonstrate how the protocol works in the case where Eve performs the beam
splitter attack seizing the part of the signal somewhere along the optical line as shown in Fig. 5(a) (we
will use the term "beam splitter" in referring to the point of Eve's intervention into the line). The beam
splitter is ideal, meaning that there is no reflection in Alice's direction. If the signal intensity incident
to the beam splitter is 1, then intensity rE goes to Eve, and 1 − rE goes to Bob's direction.
Quantum cryptography also studies attacks exercising the partial blocking of the signal and the
subsequent unauthorised substitution of the blocked part. However, any attack like this will inevitably
and permanently (even if Eve at some point decides to disconnect from the line) affect the scattering
matrix of the transmission line, and hence will be detected by the legitimate users. Therefore, we do
not concentrate on this kind of attacks here. Furthermore, at this point we accept that the attacks
specifically focusing on amplifiers can be reduced to the beam splitter kind of attacks. The associated
subtleties and details will be the subject of our forthcoming publication.

8.1

Losses and amplifiers

The proportion of the transmitted signal on the distance d between two neighbouring amplifiers is
determined by
T = 10−μd ,
(46)
where μ = 1/50 km−1 is the parameter of losses typical for the optical fibers. As was mentioned before,
the amplification factor of each amplifier is G = 1/T . Let DAB(AE) be the distance between Alice and
Bob (Alice and Eve), then the numbers of amplifiers before and after the beam splitter M1 and M2 are
given by
M1 = DAE /d,

(47)

M2 = (DAB − DAE )/d.

(48)

13

As we showed previously, the scheme can be simplified by reducing the losses and amplifications before
and after the beam splitter to two loss and aplification pairs with the parameters {T1 , G1 } and {T2 , G2 }
respectively
1
10−μd
T
, G1 =
=
,
−μd
−μd
M1 (1 − T ) + T
(1 − 10
)DAE /d + 10
T1
1
T
10−μd
, G2 =
T2 =
=
.
−μd
−μd
M2 (1 − T ) + T
(1 − 10
)(DAB − DAE )/d + 10
T2
T1 =

8.2

(49)

Evolution of systems' state

Let us describe the progressive evolution of the combined systems' state. The initial state of Alice's
random bit (A) – her random number generator – and the corresponding signal (S) is given by
ρ̂iAS =

1
1
|0i h0|A ⊗ |γi hγ|S + |1i h1|A ⊗ |−γi h−γ|S .
2
2

(50)

As the signal undergoes transformations associated with losses and amplifications, the state of the ASsystem just before the signal passes the beam splitter is given by
Z
1
ρ̂→
=
|0i
h0|
⊗
d2 αP√T1 γ,G1 (α) |αi hα|S
AS
A
2
Z
(51)
1
+ |1i h1|A ⊗ d2 αP−√T1 γ,G1 (α) |αi hα|S .
2
Defining
ρ̂→
AS [α] =

1
1
|0i h0|A ⊗ |αi hα|S + |1i h1|A ⊗ |−αi h−α|S ,
2
2

(52)

we can rewrite Eq. (51) as
ρ̂→
AS =

Z

d2 αP√T1 γ,G1 (α)ρ̂→
AS [α].

(53)

Just after the signal passes the beam splitter, the state of the joint system comprising Alice's random
bit (A), the signal going to Bob (S) and signal seized by Eve (E) is described by
Z
ρ̂→
=
d2 αP√T1 γ,G1 (α)ρ̂→
(54)
ASE
ASE [α]
where

√
√
√
√
1
|0i h0|A ⊗ | 1 − rE αi h 1 − rE α|S ⊗ | rE αi h rE α|E
2
(55)
√
√
√
√
1
+ |1i h1|A ⊗ |− 1 − rE αi h− 1 − rE α|S ⊗ |− rE αi h− rE α|E ,
2
and rE is the proportion of signal stolen by Eve. After the signal undergoes the second sequence of losses
and amplifiers and just before it is measured by Bob, the state of the joint system is
Z
ρ̂→Bob
=
d2 αP√T1 γ,G1 (α)ρ̂→Bob
(56)
ASE
ASE [α]
ρ̂→
ASE [α] =

with
ρ̂→Bob
ASE [α] =

Z

√
√
1 X
|ai ha|A ⊗
d2 βP√(1−r )T (−1)a α,G (β) |βi hβ|S ⊗ |(−1)a rE αi h(−1)a rE α|E .
2
2
E
2 a=0,1

(57)
Bob receives the signal, measures it and, together with Alice, performs post-selection, which lays in
discarding the bits associated with the fail-outcome by communicating through the classical channel.
The probability that Bob's measurement outcome is b = {0, 1} given that Alice sent bit is a = {0, 1}
can be written as
h

i Z
(58)
p(b|a) = trASE 2 * |ai ha|A ⊗ Êb ⊗ 1E ρ̂→Bob
= d2 αP√T1 γ,G1 (α)p(−1)a α (b|a),
ASE

14

where

Z
p(−1)a α (b|a) =

d2 βP√(1−r

a
E )T2 (−1) α,G2

(β) hβ| Êb |βiS .

(59)

Thus, the probability of a conclusive outcome which means that the bit will not be discarded on the
stage of post-selection is
Z
X pα (b|0) + p−α (b|1)
1 X
p(X) =
p(b|a) = d2 αP√T1 γ,G1 (α)
.
(60)
2
2
b=0,1

a,b=0,1

The final state of Alice's random bit (A), Bob's memory device storing the measurement outcome (B)
and the signal stolen by Eve (E) after the post-selection, i.e., conditional to the successful measurement
outcome, is
Z
ρ̂fABE =

where

d2 αP√T1 γ,G1 (α)ρ̂fABE [α]


X
√
√
1
pα (b|0)
ρ̂fABE [α] = |0i h0|A ⊗ 
|bi hb|B  ⊗ | rE αi h rE α|E
2
p(X)
b=0,1


X
√
√
p−α (b|1)
1
+ |1i h1|A ⊗ 
|bi hb|B  ⊗ |− rE αi h− rE α|E .
2
p(X)

(61)



(62)

b=0,1

8.3

Probabilities

To obtain the probabilities p(b|a), a, b ∈ {0, 1}, we must first calculate |hβ|qi|2 :
r


Z
Z
 †

1
2 −2(Reβ−q)2
1
ip â 2+â −q
ip(q̂−q)
2
dpe
|βi =
dp hβ| e
|βi =
e
.
|hβ|qi| = hβ|
2π
2π
π
After substituting |hβ|qi|2 into Eqs. (58, 59) we obtain
i



p
√ h

2 Θ − γ G1 T1 G2 T2 (1 − rE )
1
 ,
1 − erf  p
p(0|0) =
2
1 + 2(G2 − 1) + 2G2 T2 (1 − rE )(G1 − 1) 

(63)

(64)

i



p
√ h

2 Θ + γ G1 T1 G2 T2 (1 − rE )
1
 ,
p(1|0) =
1 − erf  p
2
1 + 2(G2 − 1) + 2G2 T2 (1 − rE )(G1 − 1) 

(65)

i



p
√ h

2 Θ + γ G1 T1 G2 T2 (1 − rE )
1
 ,
p(0|1) =
1 − erf  p
2
1 + 2(G2 − 1) + 2G2 T2 (1 − rE )(G1 − 1) 

(66)

i



p
√ h

2 Θ − γ G1 T1 G2 T2 (1 − rE )
1
 ,
1 − erf  p
p(1|1) =
2
1 + 2(G2 − 1) + 2G2 T2 (1 − rE )(G1 − 1) 

(67)

where
2
erf(x) = √
π

Zx

2

e−t dt.

(68)

0

8.4

Eve's information

Hereafter we will use the concepts of the quantum von Neumann entropy and conditional entropy.
For quantum system X with the density matrix ρ̂X the entropy is defined as
Hρ̂X (X) = tr [ρ̂X log ρ̂X ] ,

15

(69)

where log ≡ log2 . For the pair of quantum systems X and Y , with the states of X-system and the
joint system described by the density matrices ρ̂X and ρ̂XY , respectively, the conditional entropy can be
written as
Hρ̂XY (Y |X) = Hρ̂XY (XY ) − Hρ̂X (X).
(70)
Let us estimate Eve's information about the raw key (per 1 bit) after post-selection but before the
error correction stage
I(A, E) = Hρ̂fA (A) − Hρ̂fAE (A|E) = 1 − Hρ̂fAE (A|E).

(71)

Conditional entropy Hρ̂fAE (A|E) is determined by the final density matrix of AE-system which given
Eq. (61) and the fact that
pα (0|0) + pα (1|0) = p−α (0|1) + p−α (1|1),
(72)
can be written as
ρ̂fAE = trB ρ̂fABE =
with
ρ̂fAE [α] =

Z

d2 αQX [α]ρ̂fAE [α]

(73)

√
√
√
√
1
1
|0i h0|A ⊗ | rE αi h rE α|E + |1i h1|A ⊗ |− rE αi h− rE α|E ,
2
2
[pα (0|0) + pα (1|0)]P√T1 γ,G1 (α)
QX [α] =
.
p(X)

(74)

To find the lower bound of Eve's entropy (and therefore estimate the maximum of her information
about the key) we consider a situation where Eve has some auxiliary register of variable α (RE ) and
introduce the joint AERE state:
Z
X
√
√
1
f
(75)
ρ̂AERE =
d2 αQX [α]
|aiha|A ⊗ |(−1)a rE αih(−1)a rE α|E ⊗ |reg(α)ihreg(α)|RE .
2
a=0,1
Here the register's states satisfy hreg(α)|reg(α0 )i = δ (2) (α − α0 ). We note that first, by tracing out the
register we recover the original state of AE-system
trRE ρ̂fAERE = ρ̂fAE ,

(76)

and second, the monotonicity of conditional entropy implies
Hρ̂fAE (A|E) ≥ Hρ̂fAER (A|ERE ) = Hρ̂fAER (AERE ) − Hρ̂fER (ERE ).
E

E

(77)

E

The latter inequality simply states that after discarding the register, Eve can only lose information about
the sent bit. To this end, Hρ̂fAER (A|ERE ) is the lower bound of Hρ̂fAE (A|E).
E

Matrix ρ̂fAERE can be rewritten as
XZ
(α)
(α)
(α)
f
ρ̂AERE =
d2 α QX [α]λi |ψi ihψi | ⊗ |reg(α)ihreg(α)|RE ,

(78)

i
(α)

where λi

(α)

and |ψi i are the eigenvalues and eigenstates of ρ̂fAE [α]. We thus yield
XZ
(α)
(α)
Hρ̂fAER (AERE ) = −
d2 αQX [α]λi log(QX [α]λi ) + C
E

i

=−

XZ
Zi

=−

(α)

(α)

d2 αQX [α]λi (log(QX [α]) + log(λi )) + C
Z

2

d αQX [α] log(QX [α]) −

(79)
2

d αQX [α]

X

(α)
λi

(α)
log(λi )

+C

i

Z
=−

d2 αQX [α] log(QX [α]) +

Z

d2 αQX [α]Hρ̂fAE [α] (AE) + C,

where C is an additional correcting term, which we do not need to calculate explicitly. In the same way
we obtain
Z
Z
Hρ̂fER (ERE ) = − d2 αQX [α] log(QX [α]) + d2 αQX [α]Hρ̂fE [α] (E) + C.
(80)
E

16

Combining the two expressions we obtain
Hρ̂fAE (A|E) ≥ Hρ̂fAER (A|ERE ) = Hρ̂fAER (AERE ) − Hρ̂fER (ERE )
E
E
E
Z
2
= d αQX [α](Hρ̂fAE [α] (AE) − Hρ̂fE [α] (E))
Z
= d2 αQX [α]Hρ̂fAE [α] (A|E)


Z
√
√
1 − |h rE α| − rE αi|
2
= 1 − d αQX [α]h
2
!
Z
2
1 + e−2 rE |α|
2
.
= 1 − d α QX [α] h
2

(81)

h(p) = −p log(p) − (1 − p) log(1 − p)

(82)

where
is the binary entropy. Now, we can use the Jensen's inequality
hh(x)i ≤ h(hxi) =⇒ 1 − hh(x)i ≥ 1 − h(hxi),
where hxi ≡

R

d2 α QX [α] x:
2

1 + he−2 rE |α| i
2

Hρ̂fAE (A|E) ≥ 1 − h
2

where he−2 rE |α| i =

he

−2 rE |α|2

(83)

R

!
(84)

2

d2 α QX [α] e−2 rE |α| . We find

−

2rE G1 T1 |γ|2
1+2rE 1

(

p

√
h
i
(1−rE )G2 T2 G1 T1 γ
2(1 + 2rE 1 ) Θ −
1+2rE 1

1
e
1 − erf p
i=
p(X)[1 + 2rE 1 ]
2
22 + 1 + 2(1 − rE )G2 T2 1 + 2rE (22 + 1)1
√
i
h
p
!)
(1−rE )G2 T2 G1 T1 γ
2(1
+
2r

)
Θ
+
E
1
1+2rE 1
1
− erf p
,
2
22 + 1 + 2(1 − rE )G2 T2 1 + 2rE (22 + 1)1

!
(85)

where 1,2 ≡ G1,2 − 1.
By substituting Eq. (85) into Eq. (84) and using Eq. (71) we obtain the upper bound for Eve's information.

8.5

Bob's error rate

Let us estimate Bob's error rate. Bob's information per 1 bit about the key after post-selection but
before error correction is given by
I(A, B) = Hρ̂fA (A) − Hρ̂fAB (A|B) = 1 − Hρ̂fAB (A|B)
should ideally be equal to 1.
Hρ̂fAB (A|B):

(86)

Bob's error rate is therefore determined by the conditional entropy
Hρ̂fAB (A|B) = Hρ̂fAB (AB) − Hρ̂fB (B).

(87)



X p(b|a)
p(b|a)
log
,
Hρ̂fAB (AB) = −
2p(X)
2p(X)

(88)



X p(b|a = 0) + p(b|a = 1)
p(b|a = 0) + p(b|a = 1)
Hρ̂fB (B) = −
log
,
2p(X)
2p(X)

(89)

It follows from Eq. (61) that

a,b=0,1

b=0,1

and the probabilities p(b|a) and p(X) are given by Eqs. (64-67) and (60). Notice, that post-selection is
symmetric
p(0|0) + p(1|0) = p(0|1) + p(1|1) = p(X).
(90)

17

100

DAB = 1000 km, d = 10 km, T = 0.63
DAE = 50 km
DAE = 250 km

2

10
10

100

DAE = 20 km
DAE = 80 km
DAE = 200 km

2

DAE = 500 km
DAE = 980 km

10

2

10

4

10

4

6

10

6

10

6

8

10

8

10

8

Lf/L
10

DAE = 500 km
DAE = 990 km

Lf/L

10

4

10

DAB = 1000 km, d = 20 km, T = 0.40

10

0.00

0.01

0.02

rE

0.03

0.04

0.05

DAB = 1000 km, d = 30 km, T = 0.25
DAE = 30 km
DAE = 90 km
DAE = 300 km
DAE = 480 km
DAE = 930 km

Lf/L

10

100

DAE = 10 km

10

10

0.00

0.01

0.02

rE

0.03

0.04

0.05

10

10

0.00

0.01

0.02

rE

0.03

0.04

Figure 6: Lf /L as function of rE for different values of distance d between two neighbouring amplifiers:
(a) d = 10 km; (b) d = 20 km; (c) d = 30 km; DAB = 1000 km is fixed. The optimal parameters:
γ ∼ θ ∼ 10 for rE ∼ 0.01, and γ ∼ θ ∼ 104 for rE = 0.00. We see that the final rate depends on Eve's
position in the line: the closer she is to Bob (small DAE ), the more information she knows about the bit
sequence, due to the correlations imposed by the amplifiers.
Then


Hρ̂fAB (A|B) = h

p(0|0)
p(X)


.

(91)

 ̃ B) = 1, but
After the error correction procedure, Bob's information about the key becomes I(A,
Eve's information increases and one can estimate it as
 ̃ E) = I(A, E) + Hρ̂f (A|B) ≤ 1 − min Hρ̂f (A|E) + Hρ̂f (A|B).
I(A,
AB
AE
AB

9

(92)

Key rate

Now, we can estimate the length Lf of the final key after post-selection, error correction and privacy
amplification:




 ̃ E) = p(X)L * min Hρ̂f (A|E) − Hρ̂f (A|B) ,
Lf = p(X)L * 1 − I(A,
(93)
AE
AB
where L is the length of the random bit string, originally generated by Alice. If L is understood as the
number of bits generated in a unit of time, then Eq. (93) reflects the final key generation rate. This
equation in its explicit form, which is too cumbersome to be written here, includes two parameters – the
amplitude of signal γ and the measurement parameter Θ – which Alice and Bob can vary depending on
rE to ensure the best rate (e.g., by numerically maximizing the function in Eq. (93)). Furthermore, the
equation also includes the distance d between two neighboring amplifiers and the distances DAB and
DAE between the participants of the action – these are parameters which we consider fixed.
Figure 6 plots Lf /L as function of rE for different values of distance d between two neighbouring
amplifiers. For every value of rE the parameters γ and Θ are such that they maximize Lf /L. Since
there are correlations imposed by the amplifiers, for Eve it is beneficial to intercept signal near Bob.
The secure and fast communication can be established if Lf /L & 10−6 (provided that the initial random
number generation rate L ∼ 1 Gbit/s), thus Alice and Bob can allow Eve to steal no more than few
percent.
Figure 7 shows Lf /L as function of rE for large DAB in the assumption that we can technically
measure rE with theoretically allowed precision. We see that no matter from what point in the line Eve
steals the signal, the precision detection of local losses allow for the secure communication over global
distances ≥ 20, 000 km.

References
[1] H. J. Kimble. The quantum internet. Nature, 453(7198):1023–1030, Jun 2008. doi:10.1038/
nature07127.
18

0.05

DAB = 10000 km, d = 50 km, G = 10, M = 200

DAB = 20000 km, d = 50 km, G = 10, M = 400

DAB = 40000 km, d = 50 km, G = 10, M = 800

1.0

1.0

1.0

0.6

50 km
1000 km
2500 km
5000 km
9000 km

0.4
0.2

DAE
DAE
DAE
DAE
DAE

0.8
0.6

=
=
=
=
=

50 km
1000 km
2500 km
5000 km
10000 km

2

4

rE, 10

6

5

8

10

0.6

0.4

0.4

0.2

0.2

=
=
=
=
=

50 km
5000 km
10000 km
20000 km
30000 km

0.0

0.0
0

DAE
DAE
DAE
DAE
DAE

0.8

Lf/L

Lf/L

0.8

=
=
=
=
=

Lf/L

DAE
DAE
DAE
DAE
DAE

0

2

4

rE, 10

6

5

8

10

0

2

4

rE, 10

6

5

8

Figure 7: Lf /L as function of rE for different values of distance DAB between Alice and Bob: (a)
DAB = 10, 000 km; (b) DAB = 20, 000 km; (c) DAB = 40, 000 km; d = 50 km is fixed. The scales of the
plot imply the theoretically allowed loss detection precision. The optimal parameters: γ ∼ θ ∼ 102 for
rE ∼ 10−5 , and γ ∼ θ ∼ 104 for rE = 0.
[2] Nicolas Sangouard, Christoph Simon, Hugues de Riedmatten, and Nicolas Gisin. Quantum repeaters
based on atomic ensembles and linear optics. Rev. Mod. Phys., 83(1):33–80, Mar 2011. doi:
10.1103/RevModPhys.83.33.
[3] Christoph Simon, Hugues de Riedmatten, Mikael Afzelius, Nicolas Sangouard, Hugo Zbinden, and
Nicolas Gisin. Quantum repeaters with photon pair sources and multimode memories. Phys. Rev.
Lett., 98(19):190503, May 2007. doi:10.1103/PhysRevLett.98.190503.
[4] L.-M. Duan, M. D. Lukin, J. I. Cirac, and P. Zoller. Long-distance quantum communication with
atomic ensembles and linear optics. Nature, 414(6862):413–418, Nov 2001. doi:10.1038/35106500.
[5] H.-J. Briegel, W. Dür, J. I. Cirac, and P. Zoller. Quantum repeaters: The role of imperfect local
operations in quantum communication. Phys. Rev. Lett., 81(26):5932–5935, Dec 1998. doi:10.
1103/PhysRevLett.81.5932.
[6] Pieter Kok, Colin P. Williams, and Jonathan P. Dowling. Construction of a quantum repeater with
linear optics. Phys. Rev. A, 68(2):022301, Aug 2003. doi:10.1103/PhysRevA.68.022301.
[7] L. Childress, J. M. Taylor, A. S. Sørensen, and M. D. Lukin. Fault-tolerant quantum communication
based on solid-state photon emitters. Phys. Rev. Lett., 96(7):070504, Feb 2006. doi:10.1103/
PhysRevLett.96.070504.
[8] P. van Loock, T. D. Ladd, K. Sanaka, F. Yamaguchi, Kae Nemoto, W. J. Munro, and Y. Yamamoto.
Hybrid quantum repeater using bright coherent light. Phys. Rev. Lett., 96(24):240501, Jun 2006.
doi:10.1103/PhysRevLett.96.240501.
[9] Tie-Jun Wang, Si-Yu Song, and Gui Lu Long. Quantum repeater based on spatial entanglement
of photons and quantum-dot spins in optical microcavities. Phys. Rev. A, 85(6):062311, Jun 2012.
doi:10.1103/PhysRevA.85.062311.
[10] Nicolas Sangouard, Romain Dubessy, and Christoph Simon. Quantum repeaters based on single
trapped ions. Phys. Rev. A, 79(4):042340, Apr 2009. doi:10.1103/PhysRevA.79.042340.
[11] Koji Azuma, Hitoshi Takeda, Masato Koashi, and Nobuyuki Imoto. Quantum repeaters and computation by a single module: Remote nondestructive parity measurement. Phys. Rev. A, 85(6):062309,
Jun 2012. doi:10.1103/PhysRevA.85.062309.
[12] M. Zwerger, W. Dür, and H. J. Briegel. Measurement-based quantum repeaters. Phys. Rev. A,
85(6):062326, Jun 2012. doi:10.1103/PhysRevA.85.062326.
[13] W. J. Munro, K. A. Harrison, A. M. Stephens, S. J. Devitt, and Kae Nemoto. From quantum
multiplexing to high-performance quantum networking. Nature Photonics, 4(11):792–796, Nov 2010.
doi:10.1038/nphoton.2010.213.
19

10

[14] Liang Jiang, J. M. Taylor, Kae Nemoto, W. J. Munro, Rodney Van Meter, and M. D. Lukin.
Quantum repeater with encoding. Phys. Rev. A, 79(3):032325, Mar 2009. doi:10.1103/PhysRevA.
79.032325.
[15] W. J. Munro, A. M. Stephens, S. J. Devitt, K. A. Harrison, and Kae Nemoto. Quantum communication without the necessity of quantum memories. Nature Photonics, 6(11):777–781, Nov 2012.
doi:10.1038/nphoton.2012.243.
[16] Andrzej Grudka, Karol Horodecki, Michal Horodecki, Pawel Horodecki, Marcin Pawlowski, and
Ravishankar Ramanathan. Free randomness amplification using bipartite chain correlations. Phys.
Rev. A, 90(3):032322, Sep 2014. doi:10.1103/PhysRevA.90.032322.
[17] G. B. Lesovik, I. A. Sadovskyy, M. V. Suslov, A. V. Lebedev, and V. M. Vinokur. Arrow of
time and its reversal on the ibm quantum computer. Scientific Reports, 9(1):4396, Mar 2019.
doi:10.1038/s41598-019-40765-6.
[18] N. S. Kirsanov, A. V. Lebedev, M. V. Suslov, V. M. Vinokur, G. Blatter, and G. B. Lesovik. Entropy
dynamics in the system of interacting qubits. Journal of Russian Laser Research, 39(2):120–127,
Mar 2018. doi:10.1007/s10946-018-9698-0.
[19] G. B. Lesovik, A. V. Lebedev, I. A. Sadovskyy, M. V. Suslov, and V. M. Vinokur. H-theorem in
quantum physics. Scientific Reports, 6(1):32815, Sep 2016. doi:10.1038/srep32815.
[20] Evgenii Mikhailovich Lifshitz and Lev Petrovich Pitaevskii. Physical kinetics. Course of theoretical
physics. Pergamon, Oxford, 1981. Translated from the Russian by J B Sykes and R N Franklin.
URL: https://cds.cern.ch/record/99987.
[21] W. Vogel, D.G. Welsch, and S. Wallentowitz. Quantum Optics: An Introduction. Wiley, 2001. URL:
https://books.google.ru/books?id=5jFHAQAAIAAJ.
[22] Pavel Sekatski, Bruno Sanguinetti, Enrico Pomarico, Nicolas Gisin, and Christoph Simon. Cloning
entangled photons to scales one can see. Phys. Rev. A, 82(5):053814, Nov 2010. doi:10.1103/
physreva.82.053814.
[23] Bruno Sanguinetti, Enrico Pomarico, Pavel Sekatski, Hugo Zbinden, and Nicolas Gisin. Quantum cloning for absolute radiometry. Phys. Rev. Lett., 105(8):080503, Aug 2010. doi:10.1103/
PhysRevLett.105.080503.
[24] D.J.C. MacKay, D.J.C.M. Kay, and Cambridge University Press. Information Theory, Inference
and Learning Algorithms. Cambridge University Press, 2003. URL: https://books.google.bi/
books?id=AKuMj4PN_EMC.
[25] Charles H. Bennett, Gilles Brassard, and Jean-Marc Robert. Privacy amplification by public discussion. SIAM J. Comput., 17(2):210–229, Apr 1988. doi:10.1137/0217014.
[26] Charles H Bennett, Gilles Brassard, Claude Crépeau, and Ueli M Maurer. Generalized privacy
amplification. IEEE Transactions on Information Theory, 41(6):1915–1923, 1995.
[27] Gilles Brassard and Louis Salvail. Secret-key reconciliation by public discussion. In Workshop on
the Theory and Application of Cryptographic Techniques on Advances in Cryptology, EUROCRYPT
'93, page 410–423, Berlin, Heidelberg, 1994. Springer-Verlag.
[28] J Lawrence Carter and Mark N Wegman. Universal classes of hash functions. Journal of computer
and system sciences, 18(2):143–154, 1979.
[29] Hugo Krawczyk. Lfsr-based hashing and authentication. In Annual International Cryptology Conference, pages 129–139. Springer, 1994.

20

