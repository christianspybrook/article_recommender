l imit laws for large k th nearest neighbor balls arxiv210500038v1 mathpr 30 apr 2021 a p reprint nicolas chenavier universit du littoral cte dopale 50 rue f buisson 62228 calais nicolaschenavierunivlittoralfr norbert henze institute of stochastics karlsruhe institute of technology kit englerstr 2 d76133 karlsruhe norberthenzekitedu moritz otto institute for mathematical stochastics otto von guericke university magdeburg universittsplatz 2 d39106 magdeburg moritzottoovgude may 4 2021 a bstract let x1 x2 xn be a sequence of independent random points in rd with common lebesgue density f under some conditions on f we obtain a poisson limit theorem as n for the number of large probability kthnearest neighbor balls of x1 xn our result generalizes theorem 22 of 10 which refers to the special case k 1 our proof is completely different since it employs the chenstein method instead of the method of moments moreover we obtain a rate of convergence for the poisson approximation 1 introduction and main results the starting point of this paper is the following result see 10 let x x1 xn be a sequence of independent and identically distributed iid random points in rd that are defined on a common probability space a p we assume that the distribution of x which is denoted by is absolutely continuous with respect to lebesgue measure  and we denote the density of by f writing k k for the euclidean norm in rd and putting xn x1 xn let rin minj6ijn kxi xj k be the distance from xi to its nearest neighbor in the set xn xi moreover let 1 a denote the indicator function of a set a and write bx r y rd kx yk r for the closed ball centered at x with radius r finally let  t log n o 1 bxi rin cn denote the number of exceedances of probability volumes of nearest neighbor balls that are larger than the threshold t log nn the main result of 10 is theorem 22 of that paper which states that under a weak condition on the density f for each fixed t r we have cn poexpt as n where denotes convergence in distribution and po is the poisson distribution with parameter 0 since the maximum probability content of these nearest balls denoted by pn is at most t log nn if and only if cn 0 we immediately obtain a gumbel limit limn pnpn log n t exp expt for pn msc 2010 subject classifications primary 60f05 secondary 60d05 key words and phrases binomial point process large kthnearest neighbor balls chenstein method poisson convergence gumbel distribution limit laws for large kthnearest neighbor balls to state a sufficient condition on f that guarantees 1 let supp x rd bx r 0 for each r 0 denote the support of theorem 22 of 10 requires that there are 0 1 cmax and 0 such that for any r s 0 and any x z supp with kx zk maxr s and bx r bz s one has  bx r bz s  bz s and bz 2s cmax bz s these conditions hold if suppf is a compact set k say and there are f f 0 such that f f x f x k thus the density f of x is bounded and bounded away from zero the purpose of this paper is to generalize 1 to kthnearest neighbors and to derive a rate of convergence for the poisson approximation of the number of exceedances before stating our main results we give some more notation for fixed k n 1 we denote by rink the euclidean distance of xi to its kthnearest neighbor among xn xi and we write bxi rink for the kthnearest neighbor ball centered at xi with radius rink for fixed t r put vnk vnk t and let cnk t log n k 1 log log n logk 1 1 bxi rink vnk denote the number of exceedances of probability contents of kthnearest neighbor balls over the threshold vnk defined in 3 the threshold vnk is in some sense universal in dealing with the number of exceedances of probability contents of kthnearest neighbor balls to this end suppose that in much more generality than considered so far x x1 x2 are iid random elements taking values in a separable metric space s we retain the notations for the distribution of x and bx r y s x y r for the closed ball with radius r centered at x s regarding the distribution we assume that y s x y r 0 x s r 0 as a consequence the distances xi xj where j 1 n i are different with probability one for each i 1 n thus for fixed k n 1 there is almost surely a unique kthnearest neighbor of xi and we also retain the notations rink for the distance of xi to its kthnearest neighbor among xn xi and bxi rink for the ball centered at xi with radius rink notice that the condition 5 excludes discrete metric spaces see eg section 4 of 17 but not function spaces like eg the space c0 1 of continuous functions on 0 1 with the supremum metric and with wiener measure in what follows for sequences an n0 and bn n0 of real numbers write an obn if an cbn n 1 for some positive constant c theorem 11 if x1 x2 are iid random elements of a metric space s and if 5 holds then the sequence cnk satisfies log log n ecnk e o log n in particular the mean number of exceedances cnk converges to et as n goes to infinity by markovs inequality this result implies the tightness of the sequence cnk n1 thus at least a subsequence converges in distribution the next result states convergence of cnk to a poisson distribution if s rd k k and 2 holds to this end let dt v y z be the total variation between two integervalued random variables y and z ie dt v y z 2 sup py a pz a limit laws for large kthnearest neighbor balls theorem 12 let z be a poisson random variable with parameter et if x x1 x2 are iid in rd with density f and if the distribution of x has compact support 0 1d and satisfies 2 then as n log log n dt v cnk z o log n theorem 12 is not only a generalization of theorem 22 of 10 over all k 1 it also provides a rate of convergence for the poisson approximation of cnk our theorem is stated in the particular case that the support of is 0 1d but we think that it can be extended to any measure whose support is a general convex body for the sake of readibility of the manuscript we did not deal with such a generalization remark 13 the study of extremes of kthnearest neighbor balls is classical in stochastic geometry and it has various applications see eg 16 in section 4 in 15 bounds for the total variation distance of the process of poisson points with large kthnearest neighbor ball with respect to the intensity measure and a poisson process were obtained parallel to our work these results have been extended by bobrowski et al to the kantorovichrubinstein distance and generalized to the binomial process in section 62 of a paper which has just been submitted 5 while the results in 5 and 15 rely on palm couplings of a thinned poissonbinomial process and employ distances of point processes we derive a bound on the total variation distance of the number of large kthnearestneighbor balls and a poissondistributed random variable our approach permits to build arguments on classical poisson approximation theory 2 and an asymptotic independence property stated in lemma 22 below and it thus results in a considerably shorter and less technical proof now let pnk max1in bxi rink be the maximum probability content of the kthnearest neighbor balls since cnk 0 if and only if pnk vnk we obtain the following corollary corollary 14 under the conditions of theorem 12 we have lim p npnk log n k 1 log log n logk 1 t gt t r where gt exp expt is the distribution function of the gumbel distribution remark 15 if in the euclidean case the density f is continuous then bxi rink is approximately equal to f xi d rink  where d d2 1 d2 is the volume of the unit ball in rd under additional smoothness assumptions on f and 2 11 12 proved that lim p max f xi d min rink  kxi kkd vnk gt i1n where k is the support of here the distance kxi kk of xi to the boundary of k is important to overcome edge effects these effects dominate the asymptotic behavior of the maximum of the kthnearest neighbor distances if k d see 8 9 in fact 11 proved convergence of the factorial moments of enk 1 f xi d min rink  kxi kkd vnk to the corresponding factorial moments of a random variable with the poisson distribution poet and thus by the enk po et however our proof of theorem 12 is completely method of moments more than 6 namely c different thereof since it is based on the chenstein method and provides a rate of convergence 2 proofs 21 proof of theorem 11 proof by symmetry we have e cnk  n p bx1 r1nk vnk  n e p bx1 r1nk vnk x1 for a fixed x s let hx r p x x r r 0 limit laws for large kthnearest neighbor balls be the distribution function of x x due to the condition 5 the function hx is continuous and by the probability integral transform see eg 4 p 8 the random variable hx x x bx x x is uniformly distributed in the unit interval 0 1 put uj hx x xj1 j 1 n 1 then u1 un1 are iid random variables with a uniform distribution in 0 1 hence conditionally on x1 x the random variable bx1 r1nk has the same distribution as ukn1 where u1n1 un1n1 are the order statistics of u1 un1 and this distribution does not depend on x now because of a wellknown relation between the distribution of order statistics from the uniform distribution on 0 1 and the binomial distribution see eg 1 p 16 we have x n 1 sj 1 sn1j pukn1 s and thus x n 1 j vnk 1 vnk n1j e cnk n here the summand for j k 1 equals y ni n 1 k1 vnk 1 vnk nk nvnk k1 1 vnk nk k 1 using taylor expansions 3 yields nvnk log n o log log n and log n k 1 exp t k 1 log log n o 1 vnk straigthforward computations now give n 1 k1 log log n vnk 1 vnk nk et o log n regarding the remaining summands on the right hand side of 7 it is readily seen that x n 1 j n 1 k1 n1j vnk 1 vnk o n 1 vnk nvnk k 1 nk with the convention that the sum equals 0 if k 1 from the above computations and from 3 it follows that this sum equals o 1 log n which concludes the proof of theorem 11 remark 21 in the proof given above we conditioned on the realizations x of x1 since the distribution of hx x x bx x x does not depend on x we obtain as a byproduct that p bx1 r1nk vnk n1 j vnk 1 vnk n1j if x1 x2 xn are independent and x2 xn are iid according to here x1 may have an arbitrary distribution and an bn means that an bn 1 as n 22 proof of theorem 12 the main idea to derive theorem 12 is to discretize supp 0 1d into finitely many small sets and then to employ the chenstein method to apply this method we will have to check an asymptotic independence property and a local property which ensures that with high probability two exceedances cannot appear in the same neighborhood we introduce these properties below and recall a result due to arratia et al 2 on the chenstein method limit laws for large kthnearest neighbor balls the asymptotic independence property fix 0 writing for the floor function we partition 0 1d into a set vn of nnd subcubes ie subsets that are cubes of equal size that can only have boundary points in common where nn n logn1 the subcubes are indexed by the set 1 nn d j j1 jd jm 1 nn for m 1 d with a slight abuse of notation we identify a cube with its index let xn j 6 en jvn be the event that each of the subcubes contains at least one of the points of xn the event en is extensively used in stochastic geometry to derive central limit theorems or to deal with extremes 3 6 7 and it will play a crucial role throughout the rest of the paper the following lemma which captures the idea of asymptotic independence is at the heart of our development lemma 22 for each 0 we have p enc on as n proof by subadditivity and independence it follows that p xn j p enc jvn p x1 6 j jvn 1 j jvn expnj jvn here the r last inequality holds since log1 x x for each x 0 1 since f f 0 on k we have j j f d f j whence writing m for the cardinality of a finite set m exp nf j p enc jvn  vn exp f log n1 since vn nlog n1 it follows that n p enc 0 as n the local property we now define a metric d on vn by putting dj j max1sd js js for any two different subcubes j and j and dj j 0 j vn let sj r j vn dj j r be the ball of subcubes of radius r centered at j for any j vn put mj max bxi rink inxi j with the convention mj 0 if xn j conditionally on the event en and provided that dj j 2k 1 the random variables mj and mj are independent lemma 22 is referred to as the asymptotic independence property conditionally on the event en which occurs with high probability the extremes mj and mj attained on two subcubes which are sufficiently distant from each other are independent the following lemma claims that with high probability two exceedances cannot occur in the same neighborhood lemma 23 with the notation a b mina b for a b r let rn sup p xi xi sj 2k bxi rink bxi ri nk vnk jvn i6i n then rn on1 log n2d as n here with asslight of notation we have identified the family of subcubes sj 2k j vn dj j 2k  abuse with the set j j vn and dj j 2k we prepare the proof of lemma 23 with the following result that gives the volume of two ddimensional balls limit laws for large kthnearest neighbor balls lemma 24 if x b0 2 then d1 arccoskxk2 kxkd1 p b0 1 bx 1 2 d 1 1 kxk2 proof we calculate the volume of b0 1 bx 1 as the sum of the volumes of the following two congruent sets the first one say b is given by the set of all points in b0 1 bx 1 that are closer top 0 than to x and for the second one we change the roles of 0 and x the set b is the union of a cone c with radius 1 kxk22 height kxk2 and apex at the origin and a set d b0 1 s where s is a simplicial cone with external angle arccoskxk2 from elementary geometry we obtain that the volumes of c and d are given by kxkd1 p arccoskxk2 1 kxk22  d d 1 this finishes the proof of the lemma proof of lemma 23 for z 0 1d let rnk z infr 0 bz r vnk writing ya for the number of points of a finite set y of random points in rd that fall into a borel set a we have bz rnk z vnk xn bz rnk z k 1 in the following we assume that rnk xi rnk xi which is at the cost of a factor 2 and distinguish the two cases xi bxi rnk xi and xi sj 2k bxi rnk xi this distinction of cases gives p xi xi sj 2k bxi rink bxi ri nk vnk  2p xi xi sj 2k rnk xi rnk xi bxi rink bxi ri nk vnk  2p xi sj 2k xi bxi rnk xi rnk xi rnk xi bxi rink bxi ri nk vnk  2p xi sj 2k xi sj 2k bxi rnk xi rnk xi rnk xi bxi rink bxi ri nk vnk we bound the summands 8 and 9 separately since xi and xi are independent 8 takes the form 1rnk y rnk x pxn xi xi xby rnk y k 1 sj2k bxrnk x xn xi xi ybx rnk x k 1 dy dx for y bx rnk x the probability in the integrand figuring above is bounded from above by pxn xi xi by rnk y k 1 xn xi xi bx rnk x k 2  pxn xi xi by rnk y k 1 xn xi xi bx rnk x by rnk y k 2 since the random vector xn xi xi by rnk y xn xi xi bx rnk x by rnk y is negatively quadrant dependent see 13 section 31 equation 11 has the upper bound pxn xi xi by rnk y k 1  pxn xi xi bx rnk x by rnk y k 2  pxn xi xi by rnk y k 1  pxn xi xi bx rnk x by rnk x k 2 where the last inequality holds since rnk y rnk x analogously to remark 21 the first probability is k1 n2 j vnk 1 vnk n2j pxn xi xi by rnk y k 1 limit laws for large kthnearest neighbor balls the latter probability in 12 is given by x n 2 n2l  bx rnk x by rnk x 1 bx rnk x by rnk x in a next step we estimate bx rnk x by rnk x since f x f 0 x 0 1d and by the homogeneity of ddimensional lebesgue measure we obtain  bx rnk x by rnk x f bx rnk x by rnk x  f rnk xd b0 1 brnk x1 y x 1  f rnk xd b0 1 brnk x1 y x 1 d for y bx rnk x lemma 24 yields  bx rnk x by rnk x d1 2 arccoskx yk2rnk x kx ykd1  f rnk x d 1 1 kx yk2rnk x 2drnk x since inf s0 s1 1 2 arccoss 0 there is c0 0 such that  bx rnk x by rnk x c0 kx ykrnk xd1 x sj 2k y bx rnk x equation 13 and the bound f x f x 0 1 give 1rnk y rnk xp xn xi xi bx rnk x by rnk x k 1 dy bxrnk x n2l 1 c0 kx ykrnk xd1 c0 kx ykrnk xd1 bxrnk x we now introduce spherical coordinates and obtain n2l x n 2 z rnk x td1 dt 1 c0 trnk xd1 f dd c0 trnk xd1 x n 2 z rnk x  f dd c0 trnk xd1 exp n 2 l log1 c0 trnk xd1 td1 dt x n 2 z rnk x  f dd c0 trnk xd1 exp c0 n 2 ltrnk xd1 td1 dt here the last line follows from the inequality log s s 1 s 0 next we apply the change of variables t c0 n 2 l1 rnk x1d s ie s c0 n 2 ltrnk xd1 which shows that the last upper bound takes the form z c0 n2lrnk xd x n 2 d1d f dd cd sld1 es ds we now use the bounds f d rnk xd vnk n2  nl l and the fact that the integral figuring in 14 converges as n hence the expression in 14 is bounded from above by c1 n1 log n1d where c1 is some positive constant consequently 8 is bounded from above by c1 n1 log n1d sj 2k sup pxn xi xi by rnk y k 1 ysj2k  c2 n3 log n2d for some c2 0 limit laws for large kthnearest neighbor balls by analogy with the reasoning above 9 is given by the integral 1rnk y rnk x p xn xi xi xby rnk y k 1 sj2k sj2kbxrnk x  pxn xi xi bx rnk x by rnk y k 1 dy dx if y  bx rnk x and rnk x rnk y we have the lower bound bx rnk x by rnk y bx rnk x since f d rnk xd vnk we find a constant c3 0 such that bx rnk x by rnk y c3 vnk whence p xn xi xi bx rnk x by rnk y k 1 x n 2 n2l c3 vnk 1 c3 vnk c3k1 k 1 log n exp n log1 c3 vnk as n since log s s 1 for s 0 16 is bounded from above by c4 nc3 sj 2k2 pxn xi xi by rnk y k 1 sup ysj2k  c5 4k 12d log n22 n3c3 where c4 and c5 are positive constants summing over all i 6 i n it follows from 15 and 17 that rn on1 log n2d as n which finishes the proof of lemma 23 a poisson approximation result based on the chenstein method in this paragraph we recall a poisson approximation result due to arratia et al 2 which is based on the chenstein method to this end we consider a finite or countable collection y i of 0 1valued random variables and we let p py 1 0 p py 1 y 1 moreover suppose that for each i there is a set b i that contains the set b is regarded as a neighborhood of that consists of the set of indices such that y and y are not independent finally put x x x x p b3 p p b 2 e ey p y 6 b b1 i b i 6b theorem 25 theorem 1 of 2 let w y and assume ew 0 then dt v w po 2b1 b2 b3 proof of theorem 12 recall vnk from 3 and cnk from 4 put bnk 1 mj vnk jvn the following lemma claims that the number cnk of exceedances is close to the number of subcubes for which there bnk and that c bnk can be approximated by a poisson random variable exists at least one exceedance ie c lemma 26 we have bnk o log n1d a pcnk 6 c bnk poec bnk o log n1d b dt v c limit laws for large kthnearest neighbor balls bnk et o c ec log log n log n proof assertion a is a direct consequence of lemma 23 and of the inequalities bnk p j vn i l st xi xl j bxi rink bxl rlnk vnk pcnk 6 c x x p xi xl j bxi rink bxl rlnk vnk jvn i6ln  rn log n1 to prove b we apply theorem 25 to the collection y i mj jvn recall that conditionally on the event en the random variables mj and mj are independent provided that dj j 2k 1 with a slight abuse of notation we omit to condition on en since this event occurs with probability tending to 1 as n lemma 22 at a rate which is at least polynomial the first two terms in 18 are x x pjj pj pj b2 b1 jvn j6j sj2k jvn j sj2k where pj pmj vnk pjj pmj vnk mj vnk the term b3 figuring in 18 equals 0 since conditionally on en the random variable mj is independent of the field mj j 6 sj 2k thus according to theorem 25 we have bnk poec bnk 2b1 b2 dt v c fist we deal with b1 as for the first assertion notice that for each j vn using symmetry we obtain pj p xi j bxi rink vnk  n p x1 j bx1 r1nk vnk  n pbx r1nk vnk x1 xf x dx  nf j pbx r1nk vnk x1 x e1 r1nk vnk  nf jpbx e1 is independent of x2 xn and has a uniform distribution over j invoking remark 21 the probability where x figuring in the last line is asymptotically equal to et n as n since j o log n1 n we thus have pj c log n1 where c is a constant that does not depend on j since vn log n 1 and sj 2k 4k 1 summing over j j gives x x log n1 2 log n1 b1 c 2 jvn j sj2k to deal with b2 notice that for each j j vn and j sj 2k we have pjj p xi j xi sj 2k bxi rink bxi ri nk vnk i6i n i6i n xi xi sj 2k bxi rink bxi ri nk vnk limit laws for large kthnearest neighbor balls using subadditivity and taking the supremum we obtain x x sup b2 p xi xi sj 2k bxi rink bxi ri nk vnk jvn j sj2k jvn i6i n  4k 1d rn log n1  which concludes the proof of b according to lemma 23 the last term equals o log n to prove c observe that bnk et ec bnk ecnk ecnk et bnk we further have by theorem 11 the last summand is o logloglogn n since cnk c bnk ecnk ecnk c bnk 1 mj vnk 1 bxi rink vnk jvn jvn 1 xi j11bxi rink vnk 1 1 mj vnk x x p xi xi j bxi rink bxi ri nk vnk jvn i6i n  vn rn  this concludes the proof of lemma 26 and thus of according to lemma 23 the last term equals o log n theorem 12 3 concluding remarks when dealing with limit laws for large kthnearest neighbor distances of a sequence of iid random points in rd with density f which take values in a bounded region k the modification of the kthnearest neighbor distances made in 6 by introducing the boundary distances kxi kk and the condition that f is bounded away from zero which have been adopted in 11 and 12 seem to be crucial since boundary effects play a decisive role 8 9 regarding kthnearest neighbor balls with large probability volume there is no need to introduce kxi kk it is an open problem however whether theorem 12 continues to hold for densities that are not bounded away from zero a second open problem refers to theorem 11 which states convergence of expectations of cnk in a setting beyond the finitedimensional case since cnk is nonnegative the sequence cnk k is tight by markovs inequality can one find conditions on the underlying distribution that ensure convergence in distribution to some random element of the metric space references 1 ahsanullah m nevzzorov vb and shakil m 2013 an introduction to order statistics atlantis press amsterdam paris beijing 2 arratia r goldstein l and gordon l 1990 poisson approximation and the chenstein method statist sci 5 403434 3 avram f and bertsimas d 1993 on central limit theorem in geometrical probability ann appl probab 3410331046 1993 4 biau g and devroye l 2015 lectures on the nearest neighbor method springer new york 5 bobrowski o schulte m and yogeshwaran d 2021 poisson process approximation under stabilization and palm coupling available at httpsarxivorgabs210413261 limit laws for large kthnearest neighbor balls 6 bonnet g and chenavier n 2020 the maximal degree in a poissondelaunay graph bernoulli 26 948979 7 chenavier n and robert c y 2018 cluster size distributions of extreme values for the poissonvoronoi tessellation ann appl probab 286 32913323 8 dette h and henze n 1989 the limit distributionof the largest nearestneighbour link in the unit dcube j appl probab 266780 9 dette h and henze n 1990 some peculiar boundary phenomena for extremes of rth nearest neighbor links statist prob lett 10381390 10 gyrfi l henze n and walk h 2019 the limit distribution of the maximum probability nearest neighbor ball j appl probab 56 574589 11 henze n 1982 the limit distribution for maxima of weighted rthnearestneighbour distances j appl probab 19344354 12 henze n 1983 ein asymptotischer satz ber den maximalen minimalabstand von unabhngigen zufallsvektoren mit anwendung auf einen anpassungstest im rp und auf der kugel an asymptotic theorem on the maximum minimum distance of independent random vectors with application to a goodnessoffit test in rp and on the sphere metrika 30245259 in german 13 joagdev k and proschan f 1983 negative association of random variables with applications ann stat 11286295 14 last g and penrose m d 2017 lectures on the poisson process cambridge university press ims textbook 15 otto m 2020 poisson approximation of poissondriven point processes and extreme values in stochastic geometry available at httpsarxivorgpdf200510116pdf 16 penrose m d 1997 the longest edge of the random minimal spanning tree ann appl probab 72 340361 17 zubkov a n and orlov o p 2018 limit distributions of extremal distances to the nearest neighbor discrete math appl 28189199 