realistic simulations of spin squeezing and cooperative coupling effects in large ensembles of interacting twolevel systems julian huber1 ana maria rey2 3 and peter rabl1 arxiv210500004v1 quantph 30 apr 2021 vienna center for quantum science and technology atominstitut tu wien 1040 vienna austria jila national institute of standards and technology and university of colorado 440 ucb boulder colorado 80309 usa center for theory of quantum matter university of colorado boulder co 80309 usa dated may 4 2021 we describe an efficient numerical method for simulating the dynamics of interacting spin ensembles in the presence of dephasing and decay the method builds on the discrete truncated wigner approximation for isolated systems which combines the meanfield dynamics of a spin ensemble with a monte carlo sampling of discrete initial spin values to account for quantum correlations here we show how this approach can be generalized for dissipative spin systems by replacing the deterministic meanfield evolution by a stochastic process which describes the decay of coherences and populations while preserving the length of each spin we demonstrate the application of this technique for simulating nonclassical spinsqueezing effects or the dynamics and steady states of cavity qed models with hundred thousand interacting twolevel systems and without relying on any symmetries this opens up the possibility to perform accurate realscale simulations of a diverse range of experiments in quantum optics or with solidstate spin ensembles under realistic laboratory conditions introduction modeling and understanding the behavior of large ensembles of interacting spins is of importance for many areas of physics apart from more traditional fields such as magnetism in solids this includes as well many recent experiments with cold atoms 19 trapped ions 10 16 rydberg atoms 1723 polar molecules 24 magnetic atoms 2528 or hybrid quantum systems 2935 in such settings an accurate control over a large number of effective spin systems and their coupling to other bosonic degrees of freedom can now be achieved and used for quantum sensing and other quantum technology applications however due to the exponential growth of the hilbert space with increasing number of spins exact numerical simulations of such systems are typically restricted to only a few tens of spins which makes a direct theoretical modeling and benchmarking of such experiments impossible numerical simulations become even more challenging when realistic decoherence processes are taken into account and the dynamics of the full system density operator must be evaluated in certain specific situations the exponential scaling in numerical simulations can be avoided and the simulation of moderately large spin systems is still possible for example in one dimensional lattices timedependent density matrix renormalization group tdmrg techniques can be used to substantially reduce the computational complexity this permits the simulation of the coherent 3638 and dissipative dynamics 3942 of rather large spin chains and with additional effort extensions to twodimensional lattices are possible 4346 another important case are systems with a permutational symmetry for example a cloud of atoms that couple collectively to a single cavity mode but also decay individually with the same rate in this situation the permutation symmetry can be exploited to perform numerical simu lations that scale only polynomially with the number of twolevel systems 4752 when combined with monte carlo wavefunction techniques the simulation of cavity qed systems with hundreds of atoms 49 or bare ensembles of about 105 twolevel systems 51 become possible however this approach is very restricted and cannot be applied to systems with shortrange interactions or in general to describe realistic experiments with inhomogeneous frequencies or spatially varying fields to model such generic experimental situations it is necessary to identify approximate numerical techniques that take all relevant coherent and incoherent processes accurately into account but are still efficient to implement in this paper we describe such a general scheme for simulating the dynamics of interacting spin ensembles and cavity qed setups in the presence of dephasing and decay the method builds on the discrete truncated wigner approximation dtwa introduced in ref 53 where the coherent evolution of interacting spins is approximated by an average over a set of classical trajectories by taking the exact amount of quantum noise in the initial distribution of those trajectories into account this technique goes considerably beyond meanfield and provides very accurate predictions for spinsqueezing effects 54 55 or for the numerical simulation of quench dynamics 56 57 of systems with hundreds or thousands of spins however the dtwa as well as closely related continuous twa techniques 58 are only applicable for coherent systems a truncated wigner method for open quantum spin systems twoqs has recently been introduced in ref 59 and used to study nonequilibrium phase transitions 60 but this techniques is in general only applicable for large collective spins thus with these existing methods an accurate simulation of real experiments with dissipation and decoherence is still not possible to overcome this problem we present the dissipative discrete truncated wigner approximation ddtwa an extension of the dtwa for open quantum systems which takes decay and different types of dephasing processes fully into account this can be achieved by replacing the meanfield dynamics of the classical spin variables by a set of stochastic trajectories these stochastic equations describe the decay of coherences and populations but also include the correct amount of added noise in order to preserves the quantum fluctuations of each individual spin which is the essential ingredient for the accuracy of the dtwa further the stochastic dynamics of the spins can be readily combined with other phase space techniques for continuous variable degrees of freedom 58 therefore the method can be immediately adapted for the simulation of ensemble cavity qed settings that include the coupling to lossy photonic modes at the same time the actual numerical simulations are both straightforward to implement and efficient such that they can be readily applied for modelling realistic experiments with thousands or even millions of twolevel systems the remainder of paper is structured as follows in sec ii we first briefly summarize the dtwa technique for simulating the coherent dynamics of interacting spin ensembles which we then generalize in sec iii to take dephasing and decay processes into account in sec iv we illustrate and benchmark the method in terms of a few basic examples for which exact solutions for comparison still exist finally in sec v we demonstrate the application of this technique for simulating superradiant decay processes in interacting and inhomogeneous cavity qed systems for which exact simulation methods are no longer available a summary of our findings is given in sec vi the discrete truncated wigner approximation we are interested in the time evolution of interacting spin ensembles and cavity qed setups with n fl 1 effective s 12 systems for concreteness we will first focus on pure spin systems described by a hamiltonian of the form 1 ics of interacting spin systems the basic idea behind this method is to approximate the exact dynamics of the spin ensemble by a set of n classical spin trajectories si t which evolve according to the meanfield equations of motion however the initial values for these trajectories are randomly drawn from a probability distribution that accounts for the correct quantum mechanical uncertainties of the initial spin state this leads to a significant improvement compared to meanfield theory the actual numerical simulation is performed by implementing the following steps see fig 1a 1 draw a set of n classical spin variables si sxi syi szi according to the discrete wigner distribution wd si 61 for example for a single spin pointing down i we have 62 wd si sz 1 sxi 1 sxi 1  syi 1 syi 1 this means that the initial spin vectors are randomly drawn from one of the four spin configurations sxi syi szi 1 1 1 which occur with the same probability of 14 all other states on the bloch sphere can be sampled using the same configurations followed by an appropriate rotation 62 2 evolve the classical spins according to the meanfield equations of motion which for the hamiltonian given in eq 1 read dsi  ieff si  ieff jij sj 3 repeat steps 1 and 2 for nt fl 1 times expectation values of symmetricallyordered spin observables are then calculated from the average over all trajectories as 1 x 1x t  i i jij j 2 i1 hik it i6j here x y z t where the k are the usual pauli  and jij are the local field and the spinoperators and spin interaction matrix respectively later below we will also consider additional couplings of the spin ensemble to a common bosonic mode as encountered in cavity qed even without the bosonic mode the spins evolving under the action of h will in general get entangled over time and exact numerical simulations of the full quantum state of the system are only possible for a few tens of spins in ref 53 the dtwa was introduced as an approximate numerical method to simulate the coherent dynam 1 x sk t nt n1 in and hik j sym it 1 x sk tsjn t nt n1 in where the sin t denote the classical spin vectors along the nth trajectory for example one readily verifies that by averaging over the four configurations of eq 3 all expectation values of the state  i are reproduced correctly dtwa random configuration deterministic evolution here the first correction to the hamiltonian evolution accounts for pure dephasing where for the case of uncorrelated dephasing of each spin with rate we obtain  x z z ldeph  2 i1 i i observables ddtwa random configuration stochastic evolution in the other limit of interest where the noise is fully correlated across the ensemble we can use instead ldeph c  2sz sz sz sz where sz 12 i zi the last term in eq 7 is given by observables fig 1 illustration of a the dtwa algorithm 53 for coherent spin systems and b the ddtwa algorithm introduced in this work for open quantum spin systems see text for more details by evaluating only the classical equations of motion the dtwa scales approximately linearly with n and therefore the dynamics of thousands of spins can be simulated at the same time the quantum mechanical uncertainties of the initial state are fully included by averaging over a distribution of initial spin vectors and in general hik j i 6 hik ihj i importantly since the meanfield equations of motion in eq 4 preserve the length of each individual spin si2 t 3 its magnitude is equal to the exact quantum mechanical value along each individual trajectory this means that compared to meanfield theory the effects of spinspin interactions which scale as si tsj t are much more accurately taken into account in many situations of interest for example in spinsqueezing experiments with trapped ions or cold atoms this feature leads to very precise predictions a more detailed discussion of the dtwa and many explicit examples can found in refs 5357 finally let us remark that instead of sampling from a discrete distribution analogous simulations can be performed by sampling the initial spin components from a gaussian distribution 58 which leads to different levels of accuracies for different quantities and configurations 63 while we focus here exclusively on the dtwa all results below can be also applied to such continuous twa simulations iii stochastic simulation of open spin ensembles in real experiments the spins or atoms are never completely isolated and will spontaneously decay or undergo dephasing due to residual interactions with the environment such an open system scenario can be modeled by a master equation for the system density operator  ih ldeph ldecay ldecay 2i i i i i i 10 2 i1 and describes the uncorrelated decay of each twolevel system with rate naively one could simply account for these decoherence processes by evaluating the meanfield dynamics for h k i using the master equation in eq 7 and by including the additional terms in the meanfield equations of motion in eq 4 this approach is still exact for noninteracting spins and would also in general correctly capture the decay of coherences of the transverse spin components hix i and hiy i however in this case the spin length si t is no longer conserved along a trajectory as a consequence also the effect of spinspin interactions is reduced and the accuracy of the dtwa simulation degrades considerably therefore in order to avoid this degradation not only damping terms but also an appropriate amount of fluctuations must be included in the dynamics dephasing let us first focus on pure dephasing in this situation we can make use of the fact that the incoherent dynamics generated by ldeph in eq 7 is nothing else but the limiting case of a coherent evolution of the spins under the rapidly fluctuating hamiltonian hfluc t i tiz 2 i1 here the i t are classical noise processes with zero mean and we can set hi tj t0 i ij to model individual dephasing or i t t for collective noise the evolution under this hamiltonian introduces an additional term in the meanfield dynamics dsi  i tez si deph ie a rotation around the zaxis with a fluctuating frequency white noise limit if the noise is uncorrelated over the typical timescales of the spin dynamics which is also assumed in the derivation of the master equation in eq 7 we can take the whitenoise limit hi ti t0 i 2 tt0 and interpret eq 12 as a stratonovich stochastic differential equation for numerical simulations it is more convenient to convert eq 12 into an ito differential equation where the added noise in each time step is independent of si t using the usual rules of stochastic calculus 64 we then obtain the following stochastic increments for the spin variables dsxi deph sxi dt 2 syi dwi dsi deph si dt 2 si dwi dszi deph 0 where the dwi dwi t are realvalued and independent wiener increments for the time step t t dt these increments satisfy hdwi i 0 and hdwi dwj i ij dt for individual dephasing and again we can simply set dwi dw to describe spatially correlated noise in summary we end up with a ddtwa algorithm as illustrated in fig 1b in this algorithm the sampling of the initial spin values si t 0 is implemented as before but the deterministic meanfield equations of motion for the dynamics are replaced by the following set of stochastic differential equations  i si dt dsi dsi eff deph where the dephasinginduced contribution is defined in eqs 1315 this set of equations can be efficiently simulated numerically with the eulermaruyama method 64 we see that eq 16 still describes the same coherent dynamics for hsi it but also accounts for the loss of coherences importantly this loss is accompanied by an appropriate amount of noise which ensures that 65 hdsi2 i 0 therefore although coherences decay over time the length of each spin and as a consequence also the magnitude of the spinspin interactions are preserved on average in the examples discussed in sec iv below we find that this property results in an excellent agreement between these approximate stochastic simulations and the exact results obtained for a large variety of models and parameter regimes colored noise compared to the original master equation an important benefit of the derivation presented above is that it can be readily generalized to colored noise with a finite correlation time for example let us consider the evolution of the spins in the presence of noisy fields with a correlation function of the form hi tj t0 i ij 2 ett c we see that in the limit c 0 we recover the correlated noise from above with 2 c while for c we obtain the case of static noise with hi tj t0 i ij 2 in general the random noises i can be obtained by simulating an ornsteinuhlenbeck process 64 66 di i dt di where di are wiener increments with hdi i 0 and hdi dj i ij dt in our numerical simulations we can then account for the effect of colored noise by simulating the coherent dynamics in eq 12 but assuming noisy fields i t that are calculated according to eq 19 note that compared to the markovian case this only increases the number of simulated equations by n or even just by one in the case of collective noise however for very short correlation times c also the integration time steps must be reduced and it becomes much more efficient to use the markovian dephasing dynamics described by eqs 1315 decay in the previous derivation we made use of the fact that dephasing can be described by classical noise this is not the case for decay processes where the system couples to a quantum environment represented by noise operators with nonvanishing commutation relations this difference between dephasing and decay processes also appears in the schwingerboson representation of collective spin systems where in the latter case the mapping to a fokkerplanck equation requires additional approximations 59 in stochastic simulations of the full quantum mechanical wavefunction decay is usually modelled by introducing random quantum jumps 67 after which the system is projected into the state of the spin pointing down i within the truncated wigner function formalism this would corresponds to a random projection into one of the four configurations listed in eq 3 however in this approach the system evolution between the jumps is described by a nonhermitian hamiltonian which again reduces the spin length si and degrades the accuracy of the dtwa to circumvent these problems we propose here to simulate the decay dynamics of dissipative spin systems by a continuous stochastic process with the following increments for the classical spin trajectories  ieff si dt dsi dsi decay where dsxi decay sxi dt syi dwi dsyi decay syi dt sxi dwi dszi decay szi 1dt szi 1dwi 23 let us emphasize that these equations are not derived from an underlying systembath hamiltonian but rather constructed in order to satisfy two crucial properties first the deterministic terms in these equations reproduce the correct decay dynamics for the average spin components  xy hiz i hiz i 1 24 h i 2 i second the additional noise terms in eqs 2123 reintroduce spin fluctuations to preserve the length of each spin si on average however in contrast to the classical noise process we now obtain 65 hdsi2 i 1 hszi 2 i dt hixy i and this requirement can only be fulfilled up to a certain level of approximation the reason is that for the decay process the deterministic change of the zcomponent dszi 2 2szi sz 1dt is positive for sz 0 this cannot be compensated by a positive diffusion term in this sense eqs 2123 represent a diffusion process which reproduces the exact singlespin dynamics while conserving the length of each spin as good as possible in the actual numerical simulations we find that under most conditions of interest in particular for small decay rates the condition hdsi2 i 0 is satisfied and that the average spin length remains very close to its initial value specifically in all the investigated examples reported below there was only little change of hs 2 i and therefore no noticeable degradation of the accuracy of the predicted results has been observed neither in the transient dynamics nor in the steady state while this cannot be guaranteed in general the conservation of the spin lengths can easily be verified for a particular application in this case eqs 2123 represent a faithful stochastic approximation of a spin decay process which is fully compatible with the dtwa a 10 b 10 fig 2 time evolution of the squeezing parameter 2 for an ensemble of n 64 spins arranged on a 3d cubic lattice with unit spacing for these simulations we assumed  0 and an individual dephasing of each spin with a rate a j 00025 and b j 0025 for a better comparison the curves for different are p plotted in terms of the rescaled time unit j 1 where j ij jij n the solid lines show the exact results 68 for different powerlaw interactions as defined in eq 27 the crosses show the corresponding values obtained with the ddtwa for nt 10000 trajectories can also simulate the steady states of the ensemble and investigate for example nonequilibrium phase transitions in drivendissipative spin systems as a second setup we consider an ensemble of twolevel atoms coupled to a common optical mode this setting illustrates how the ddtwa can be combined with other phase space methods for continuous variable systems and shows that the relevant interplay between collective interactions and individual dephasing is accurately captured by these stochastic simulations interacting spin ensembles we first study the dynamics of an interacting spin ensemble under the influence of local dephasing and spontenous emission as described by eqs 7 more specifically we assume that the coherent evolution of the spins can be modeled by the transverse ising hamiltonian x x 1x jij iz jz 2 i i i6j where the spinspin interactions examples and benchmarking in this section we demonstrate the application of the ddtwa for two paradigmatic settings in quantum optics which can also be used to benchmark the results against exact numerical simulations in certain limiting cases the first example is an ensemble of spin s 12 systems with spatially varying interactions for this system it is already known that the dtwa provides accurate results in the isolated case 53 and we show that adding dephasing or decay does not affect the accuracy of the method in the case of decaying spins we jij n ri rj decay algebraically with the normalized distance between the spins ri rj such a scenario appears for example in trapped ion systems where 0 3 10 12 while for an ensemble of rydberg atoms with vanderwaals interactions we obtain 6 17 18 21 by adding the stochastic terms for local dephasing and spontaneous emission to the meanfield equations we arrive at the following set of stochastic differential equa a 20 b 4 a 10 b 10 fig 3 plot of the time evolution of a the magnetization hsz i and b the squeezing parameter 2 of a driven spin ensemble with different driving strengths and individual dephasing with rate j 02 initially all the spins are polarized along the negative zaxis in both plots n 40 and alltoall interactions 0 are assumed the solid lines are obtained from an exact integration of the master equation exploiting permutational invariance while the crosses are obtained from a ddtwa simulation with nt 10000 trajectories fig 4 time evolution of the squeezing parameter 2 for an ensemble of n 64 spins arranged on a cubic lattice with unit spacing for these simulations we assumed 0 and individual spontaneous emission of each spin with a rate a j 00025 and b j 0025 for a better comparison the curves for different are p plotted in terms of the rescaled time unit j 1 where j ij jij n the solid lines show the exact results 68 for different powerlaw interactions as defined in eq 27 the crosses show the corresponding values obtained by the ddtwa method for nt 10000 trajectories tions dsxi 2jij syi szj dt dsxi deph dsxi decay j6i dsyi 2jij sxi szj dt szi dt dsyi deph dsyi decay29 j6i dszi syi dt dszi decay which we will now study in different limits of interest dephasing for the following results we assume that theq spins are initially aligned along the xdirection i ii where i i i 2 in fig 2 we use the ddtwa to evaluate first of all the dynamics of an interacting spin ensemble in the absence of the driving field  0 in this example we have assumed that the n 64 spins are arranged on a cubic lattice in three dimensions with unit spacing and different values of the powerlaw exponent are considered the central quantity of interest in these plots is the spinsqueezing parameter 69  2 mins 2 hsi  sx sy sz is the collective spin operator with here s p k  n is the procomponents sk 21 i and s s  onto an axis n parametrized by an angle jection of s  in the plane orthogonal to the mean spin vector hsi as usual o ho i hoi denotes the variance of an operator o achieving a spin squeezing parameter of 2 1 is relevant for metrological applications but it also implies that the spins are entangled 70 therefore such spinsqueezing effects cannot be described by meanfield theory in the absence of the driving field the zcomponents of all the spins are conserved and the system dynamics can still be evaluated exactly 68 this allows us to directly compare the approximate stochastic simulations with the corresponding exact results in fig 2a we find that for a very small dephasing rate of j 00025 the squeezing parameter 2 calculated with the ddtwa is accurate up to the level of a few percent which is consistent with dtwa results for isolated systems as shown in fig 2b for a slightly stronger rate of j 0025 the accuracy of the ddtwa improves even further this can be attributed to the overall reduction of quantum correlations which are only approximately take into account in the coherent dynamics in a next step we extend our analysis to finite driving strengths 6 0 in this case there are no analytic solutions available and exact numerical simulations are restricted to small spin systems n 20 however in the limit of alltoall interactions ie 0 simulations with a large number of spins n 100 can still be done by exploiting the permutational symmetry of the master equation 49 50 in fig 3 we use this symmetry to compare the ddtwa simulations of the driven ising model with 0 to the corresponding exact numerical results again we find that for all the considered driving strengths the ddtwa provides very accurate predictions for the mean spin components as well as for the achievable level of quantum correlations signified by the squeezing parameter decay let us now continue with a similar study of the transverse ising model for 0 but including a finite rate of decay 0 in fig 4 we plot the spinsqueezing dynamics for differ the driven dicke model 160 fig 5 steady state of the transverse ising model given in eq 26 with 0 and for a spin decay rate of j 02 the two plots show a the average values of the spin components hsxyz i and b their fluctuations sk 2 hsk2 i hsk i2 as a function of the driving strength and for n 64 the solid lines show the results from the exact simulation while the crosses were obtained from a ddtwa simulation by evolving nt 2000 trajectories for a time t ent powerlaw interactions in the absence of the driving field 0 and two different values of similar to the case of dephasing we find excellent agreement between the ddtwa simulations and the exact solutions 68 which shows that for such shorttime dynamical simulations both types of decoherence processes can be accurately taken into account let us now include a finite driving strength 6 0 while under the influence of pure dephasing the spin ensemble would then simply evolve into an infinite temperature state this is not the case for driven spin systems in the presence of decay as we illustrate in the following the ddtwa can also be used to simulate such nontrivial steady states of driven spin ensembles in order to benchmark these simulations we focus again on the case 0 where exact numerical calculations are still possible in fig 5 we evaluate the steady states of the dissipative transverse ising model for varying driving strengths for all parameters we find excellent agreement between the ddtwa simulations and the exact results both for the mean values of the collective observables hsk i as well as for the variances sk 2 the sharp peak in the spin fluctuations at a critical driving strength of c j indicates a nonequilibrium phase transition in the steady state of the spin ensemble 71 which shows that the ddtwa is well suited to study such phenomena in summary these examples clearly demonstrate the high level of accuracy that can be achieved with the ddtwa when simulating interacting spin systems with local dephasing and decay and equivalently accurate results are obtained for spatially correlated dephasing small deviations from the exact predictions are mainly due to inaccuracies in the coherent dynamics which takes spinspin correlations only approximately into account therefore we find that in most situations the accuracy of the ddtwa improves in the presence of decay and dephasing where such correlations are reduced apart from being able to simulate large ensembles of spins the ddtwa can be readily combined with conventional phase space methods for continuous degrees of freedom this is relevant for a large range of cavity qed models where many twolevel systems are coupled to a common photonic mode as an illustrative example we consider here the driven dicke model with hamiltonian s a s a sx where s sx isy and a a is a bosonic annihilation creation operator to model a realistic scenario we include the dephasing of the twolevel systems as well as the decay of the photonic mode with a rate 2 the whole system is then described by the master equation  ih ldeph 2aa a a a a to apply the ddtwa in such a mixed setting it is natural to represent also the bosonic mode in terms of its wigner function n d2 e tr ea a t w t 2 in this case the moments of w t correspond to the symmetricallyordered expectation values of mode operators 67 72 ha k a isym t dn k w t in the common situation where the photonic mode is initially prepared in the vacuum state or in a coherent state with amplitude 0 the corresponding wigner function w t 0 2 0 2 is positive and can be interpreted as a probability distribution for the classical amplitudes in this case we can also sample the time evolution of w t by a set of stochastic trajectories n t and evaluate expectation values as ha k a isym t 1 x  tk n t nt n1 n in the absence of the twolevel systems these trajectories obey 67 72 dloss dt 2dw1 idw2 and describe the loss of energy as well as the associated amount of quantum noise given a stochastic description for each of the individual subsystems we can now simulate the dynamics of the a 1 005g 010g 025g do not include a decay of the spins the coupling to the lossy photonic mode still relaxes the combined system see fig 6a therefore also this setup allows us to investigate the properties of the nontrivial steady states of this system for example in fig 6b and c we plot the stationary value of the photon number and the twophoton correlation function 005g 010g 025g 01g g 2 0 01g ha a aai ha ai2 001g 005g 010g fig 6 simulation of the driven dicke model as described in eq 33 for n 10 and 05g a time evolution of hsy i for 2g and different dephasing rates q where the spins are initially prepared in the state 0 i i ii b steady state cavity occupation number ha ai and c steady state correlation function g 2 0 as a function of the driving strength and for different dephasing rates d evolution of an initial fully polarized spin in the presence of individual  or collective c  dephasing with the same rate for this plot g in all the plots the solid lines represent the results obtained from an exact simulations of the master equation exploiting permutational invariance while the crosses are obtained by the ddtwa method by simulating nt 2500 trajectories in d the dashed line shows the prediction from meanfield theory whole setup by imposing a joint twa ie by treating the coupling between the photonic mode and the spins on a meanfield level as a result we obtain the following set of stochastic differential equations dsxi imszi dt dsxi deph dsi reszi dt szi dt dsyi deph dszi resyi imsxi dt syi dt g x x d i si isyi dt dloss 4n i which are integrated for a set of nt fl 1 initial values si 0 and 0 randomly drawn from the wigner distributions of the individual subsystems in fig 6 we use this combined twa approach to simulate the dynamics of the driven dicke model first of all for n 10 spins where the results can still be compared with an exact simulation of the master equation from this comparison we find an excellent agreement between the stochastic simulations and the exact results both for the cavity and the spin observables although here we in particular this correlation function shows a qualitative change from a coherent state where g 2 0 1 to a thermallike state with g 2 0 2 this crossover as a function of the driving strength depends explicitly on the spin dephasing rate as another illustrative example we compare in fig 6d the time evolution of the driven dicke model for the two limiting cases of individual dephasing and collective dephasing with the same rate c  for this plot we have assumed a moderate driving and coupling strength such that the dissipative cavity acts mainly as a collective decay channel for the spins for collective dephasing where the system dynamics remains constrained to the maximal angular momentum subspace the system then quickly relaxes to a stationary state with only a small spin population in contrast for individual dephasing the spin population increases with a rate for longer times this can be understood from the fact that the local dephasing processes drive the spins into orthogonal subspaces with a smaller total angular momentum quantum number within these subspaces there exist many subradiant states sub i which are decoupled from the cavity mode ie s sub i 0 but still have a finite spin population that remains trapped in fig 6d we also show the prediction for hsz it obtained from meanfield theory while meanfield theory still predicts very accurately the initial oscillations and the overall increase of the populations the solution exhibits large weaklydamped oscillations that are a clear artefact of this approximation note that the meanfield contribution to dsi deph is the same for local and collective dephasing thus a meanfield simulation cannot distinguish between spatially correlated and uncorrelated noise a difference that is manifested only in the stochastic noise terms in summary the simulation of this driven dicke model demonstrates the applicability of the ddtwa for simulating cavity qed systems with large ensembles of twolevel systems in particular the example presented in fig 6d shows that this method captures very accurately both the collective coupling to the maximal angular momentum states as well as the physics associated with subradiant states largescale simulations in the previous section we have focused on examples and parameter regimes where a comparison with other exact methods was still possible however the main advantage of the ddtwa is that it can be easily scaled up and applied in many experimentally relevant situations where exact methods are no longer available to illustrate this point we consider in this section the superradiant decay of a large ensemble of interacting twolevel atoms inside a lossy cavity an old question in connection to superradiance is how dipoledipole interactions in dense atomic ensembles affect the decay process by inducing transitions out of the fully symmetric subspace 73 in real experiments similar effects can also arise from local dephasing and a relevant followup question is if interaction effects can actually be distinguished from fluctuating or static frequency inhomogeneities as we show in the following the ddtwa can be used to answer these and related questions through direct numerical simulations to do so we consider the same master equation as in sec iv b  ih ldeph 2aa a a a a but with a hamiltonian of the form  x xx x x x i z  45 s a s a jij i j 2 i here the first and the second term represent the collective atomcavity coupling and the shortrange spinspin interactions with jij  jx ri rj 3 respectively the last term accounts for an inhomogeneous broadening of the atomic transition frequency where the i are randomly drawn from a gaussian distribution with variance  2 and zero mean the model defined in eq 44 and eq 45 can now be used to investigate for example how superradiant decay is influenced by i shortrange interactions ii markovian dephasing and iii static inhomogeneous broadening to do so we consider in fig 7 a system of n 105 atoms arranged on a cubic lattice and initially prepared in the excited state we then use the ddtwa method to simulate the consecutive decay dynamics under the influence of those three processes for these simulations we have assumed 3 but all interactions with jij jx 001 have been set to zero for the frequency distribution we have chosen a variance of 2 22 such that the inhomogeneous broadening and the markovian dephasing lead to a loss of coherence over a similar timescale the plots in fig 7 show that while all three mechanisms lead to a strong inhibition of the decay the actual decay dynamics of the atomic population and the emitted photons is both qualitatively and quantitatively very different b 1 dephasing x10 4 interactions bare fig 7 superradiant decay of an ensemble of n 473 103823 twolevel systems that are initially prepared in the excited state and couple to a lossy cavity mode with g in a we show the decay of the total spin population and in b the photon number ha ai iph t which is proportional to the emitted field intensity in both plots we compare the evolution of the bare noninteracting ensemble blue line with dynamics in the presence of additional ising interactions ix jx with jx g 0025 and 3 purple line the other two cases show the dynamics of an noninteracting ensemble but in the presence of local markovian dephasing with a rate g 05 red line and for an inhomogeneously broadened ensemble yellow line in the latter case the spin frequencies i have been randomly draw from a normal distribution with zero mean and a variance of 2 22 to obtain this data nt 64 trajectories were simulated while a more detailed investigation of this system is beyond the scope of this work these basic results already show how the ddtwa can be used to simulate interesting dynamical effects in largescale spin systems under experimentally realistic conditions note that for the plots in fig 7 we have simulated about n 105 atoms coupled to a cavity mode which itself becomes populated with many thousands of photons these simulations can be performed on a regular pc in about a day of computation time and with some additional programming efforts and the use of a supercomputer the simulation of millions of spins becomes possible such system sizes are far beyond the typical atom numbers of about n 150 49 that can be treated in exact simulations of similar models by exploiting permutation symmetry and using quantum trajectories moreover both the shortrange interactions as well as the inhomogeneous frequency distribution break the permutational invariance of the system such that the current type of simulations are simply not accessible with such exact numerical techniques at the same time since during the whole evolution hix i hiy i 0 neither the initial decay nor the effect of transverse spinspin interactions would be captured by a simulation of the meanfield equations of motion only higherorder approximation schemes based on a cumulant expansion of correlation functions which can account for such effects already scale as n 2 and are thus no longer applicable for the considered system sizes note that cumulant expansion techniques also often exhibit numerical instabilities which do not occur in the ddtwa approach conclusion in summary we have presented a simple and efficient numerical algorithm for simulating large spin ensembles and cavityqed systems in the presence of realistic decoherence processes using the dtwa for coherent systems as a starting point we have shown that both dephasing and decay can be included in these simulations in terms of a stochastic evolution of the classical spin variables thereby it is possible to account for damping and loss of coherence while still preserving the total length of each classical spin on average this last feature ensures that the magnitude of spinspin interactions is not reduced and that the accuracy of the dtwa is not degraded we have demonstrated the application of this method for various show cases where a direct benchmarking with exact simulations is still possible however due to the 1 j esteve c gross a weller s giovanazzi and m k oberthaler squeezing and entanglement in a bose einstein condensate nature london 455 1216 2008 2 j appel p j windpassinger d oblak u b hoff n kjaergaard and e s polzik mesoscopic atomic entanglement for precision measurements beyond the standard quantum limit pnas 106 10960 2009 3 m f riedel p bhi y li t w hnsch a sinatra and p treutlein atomchipbased generation of entanglement for quantum metrology nature london 464 1170 2010 4 m h schleiersmith i d leroux and v vuletic states of an ensemble of twolevel atoms with reduced quantum uncertainty phys rev lett 104 073604 2010 5 o hosten n j engelsen r krishnakumar and m a kasevich measurement noise 100 times lower than the quantum projection limit using entangled atoms nature london 529 505 2016 6 k c cox g p greve j m weiner and j k thompson deterministic squeezed states with collective measurements and feedback phys rev lett 116 093602 2016 7 l pezze a smerzi m k oberthaler r schmied and p treutlein quantum metrology with nonclassical states of atomic ensembles rev mod phys 90 035005 2018 8 e pedrozopenafiel s colombo c shu a f adiyatullin z li e mendez b braverman a kawasaki d akamatsu y xiao and v vuletic entanglementenhanced optical atomic clock nature london 588 414 2020 9 s s szigeti o hosten and s a haine improving coldatom sensors with quantum entanglement prospects and challenges appl phys lett 118 140501 2021 linear scaling of the simulation time with the number of spins the same results can be readily obtained for systems with many thousands or even millions of spins which we have illustrated for the example of superradiant decay in such situations there are no exact numerical methods but the ddtwa still allows us to make accurate predictions about fluctuations correlations and spinsqueezing effects as relevant for many cavity qed and spin ensemble experiments note added during completion of the manuscript we became aware of a related work investigating the dtwa in open systems 74 acknowledgments this work was supported through a doc fellowship jh from the austrian academy of sciences aw and by the austrian science fund fwf through grant no p32299 phoned am acknowledges funding from nsf jilapfc phy1734006 nsf qlci2016244 and from the doeqsa grant 10 j w britton b c sawyer a c keith cc j wang j k freericks h uys m j biercuk and j j bollinger engineered twodimensional ising interactions in a trappedion quantum simulator with hundreds of spins nature london 484 489 2012 11 r islam c senko w c campbell s korenblit j smith a lee e e edwards cc j wang j k freericks and c monroe emergence and frustration of magnetism with variablerange interactions in a quantum simulator science 340 583 2013 12 p richerme zx gong a lee c senko j smith m fossfeig s michalakis a v gorshkov and c r monroe nonlocal propagation of correlations in quantum systems with longrange interactions nature london 511 198 2014 13 j g bohnet b c sawyer j w britton m l wall a m rey m fossfeig and j j bollinger quantum spin dynamics and entanglement generation with hundreds of trapped ions science 352 1297 2016 14 j zhang g pagano p w hess a kyprianidis p becker h kaplan a v gorshkov z x gong and c r monroe observation of a manybody dynamical phase transition with a 53qubit quantum simulator nature london 551 601 2017 15 n friis o marty c maier c hempel m holzpfel p jurcevic m b plenio m huber c roos r blatt and b lanyon observation of entangled states of a fully controlled 20qubit system phys rev x 8 021012 2018 16 c d bruzewicz j chiaverini r mcconnell and j m sage trappedion quantum computing progress and challenges appl phys rev 6 021314 2019 17 h labuhn d barredo s ravets s de lsleuc t macri t lahaye and a browaeys tunable two dimensional arrays of single rydberg atoms for realizing quantum ising models nature london 534 667 2016 h bernien s schwartz a keesling h levine a omran h pichler s choi a s zibrov m endres m greiner v vuletic and m d lukin probing manybody dynamics on a 51atom quantum simulator nature london 551 579 2017 e guardadosanchez p t brown d mitra t devakul d a huse p schauss and w s bakr probing the quench dynamics of antiferromagnetic correlations in a 2d quantum ising spin system phys rev x 8 021069 2018 i s madjarov j p covey a l shaw j choi a kalea cooper h pichler v schkolnik j r williams and m endres highfidelity entanglement and detection of alkalineearth rydberg atoms nature phys 16 857 2020 a browaeys and t lahaye manybody physics with individually controlled rydberg atoms nature phys 16 132 2020 p scholl m schuler h j williams a a eberharter d barredo kn schymik v lienhard lp henry t c lang t lahaye a m luchli and a browaeys programmable quantum simulation of 2d antiferromagnets with hundreds of rydberg atoms arxiv201212268 2020 s ebadi t t wang h levine a keesling g semeghini a omran d bluvstein r samajdar h pichler w w ho s choi s sachdev m greiner v vuletic and m d lukin quantum phases of matter on a 256atom programmable quantum simulator arxiv201212281 2020 j l bohn a m rey and j ye cold molecules progress in quantum engineering of chemistry and quantum matter science 357 1002 2017 s lepoutre j schachenmayer l gabardos b zhu b naylor e marechal o gorceix a m rey l vernac and b laburthetolra outofequilibrium quantum magnetism and thermalization in a spin3 manybody dipolar lattice system nat commun 10 1714 2019 a patscheider b zhu l chomaz d petter s baier am rey f ferlaino and m j mark controlling dipolar exchange interactions in a dense threedimensional array of largespin fermions phys rev research 2 023050 2020 a de paz a sharma a chotia e marchal j h huckans p pedri l santos o gorceix l vernac and b laburthetolra nonequilibrium quantum magnetism in a dipolar lattice gas phys rev lett 111 185305 2013 n q burdick y tang and b l lev longlived spin orbitcoupled degenerate dipolar fermi gas phys rev x 6 031022 2016 d i schuster a p sears e ginossar l dicarlo l frunzio j j l morton h wu g a d briggs b b buckley d d awschalom and r j schoelkopf highcooperativity coupling of electronspin ensembles to superconducting cavities phys rev lett 105 140501 2010 y kubo f r ong p bertet d vion v jacques d zheng a dreau jf roch a auffeves f jelezko j wrachtrup m f barthe p bergonzo and d esteve strong coupling of a spin ensemble to a superconducting resonator phys rev lett 105 140502 2010 31 r amsss ch koller t nbauer s putz s rotter k sandner s schneider m schrambck g steinhauser h ritsch j schmiedmayer and j majer cavity qed with magnetically coupled collective spin states phys rev lett 107 060502 2011 32 s probst h rotzinger s wnsch p jung m jerger m siegel a v ustinov and p a bushev anisotropic rareearth spin ensemble strongly coupled to a superconducting resonator phys rev lett 110 157001 2013 33 zl xiang s ashhab j q you and f nori hybrid quantum circuits superconducting circuits interacting with other quantum systems rev mod phys 85 623 2013 34 g kurizki p bertet y kubo k mlmer d petrosyan p rabl and j schmiedmayer quantum technologies with hybrid systems pnas 112 3866 2015 35 a angerer k streltsov t astner s putz h sumiya s onoda j isoya w j munro k nemoto and j schmiedmayer and j majer superradiant hybrid quantum devices nature phys 14 1168 2018 36 g vidal efficient simulation of onedimensional quantum manybody systems phys rev lett 93 040502 2004 37 s r white and a e feiguin realtime evolution using the density matrix renormalization group phys rev lett 93 076401 2004 38 a j daley c kollath u schollwck and g vidal time dependent densitymatrix renormalizationgroup using adaptive effective hilbert spaces j stat mech theory exp p04005 2004 39 f verstraete j j garciaripoll and j i cirac matrix product density operators simulation of finitetemperature and dissipative systems phys rev lett 93 207204 2004 40 r orus and g vidal infinite timeevolving block decimation algorithm beyond unitary evolution phys rev b 78 155117 2008 41 e mascarenhas h flayac and v savona matrixproductoperator approach to the nonequilibrium steady state of drivendissipative quantum arrays phys rev a 92 022116 2015 42 j cui j i cirac and m c bauls variational matrix product operators for the steady state of dissipative quantum systems phys rev lett 114 220601 2015 43 a kshetrimayum h weimer and r orus a simple tensor network algorithm for twodimensional steady states nat commun 8 1291 2017 44 d kilda a biella m schiro r fazio and j keeling on the stability of the infinite projected entangled pair operator ansatz for drivendissipative 2d lattices arxiv201203095 2020 45 c mc keever and m h szymanska dynamics of twodimensional open quantum lattice models with tensor networks arxiv201212233 2020 46 m yang and s r white timedependent variational principle with ancillary krylov subspace phys rev b 102 094315 2020 47 b a chase and j m geremia collective processes of an ensemble of spin12 particles phys rev a 78 052101 2008 48 m xu d a tieri and m j holland simulating open quantum systems by applying su4 to quantum master equations phys rev a 87 062101 2013 49 p kirton and j keeling suppressing and restoring the dicke superradiance transition by dephasing and decay phys rev lett 118 123602 2017 50 n shammah s ahmed n lambert s de liberato and f nori open quantum systems with local and collective incoherent processes efficient numerical simulations using permutational invariance phys rev a 98 063815 2018 51 y zhang yx zhang and k mlmer montecarlo simulations of superradiant lasing new j phys 20 112001 2018 52 a shankar j t reilly s b jger and m j holland subradianttosubradiant phase transition in the bad cavity laser arxiv210307402 2021 53 j schachenmayer a pikovsky and a m rey manybody quantum spin dynamics with monte carlo trajectories on a discrete phase space phys rev x 5 011022 2015 54 b zhu a m rey and j schachenmayer a generalized phase space approach for solving quantum spin dynamics new j phys 21 082001 2019 55 m a perlin c qu and a m rey spin squeezing with shortrange spinexchange interactions phys rev lett 125 223401 2020 56 s czischek m grttner m oberthaler m kastner and t gasenzer quenches near criticality of the quantum ising chain power and limitations of the discrete truncated wigner approximation quantum sci technol 4 014006 2018 57 r khasseh a russomanno m schmitt m heyl and r fazio discrete truncated wigner approach to dynamical phase transitions in ising models after a quantum quench phys rev b 102 014303 2020 58 a polkovnikov phase space representation of quantum dynamics annals of phys 325 1790 2010 59 j huber p kirton and p rabl phasespace methods for simulating the dissipative manybody dynamics of collective spin system scipost phys 10 045 2021 60 j huber p kirton and p rabl nonequilibrium magnetic phases in spin lattices with gain and loss phys rev a 102 012219 2020 61 w k wootters a wignerfunction formulation of finitestate quantum mechanics annals of physics 176 1 1987 62 a pieiro orioli a safavinaini m l wall and a m rey nonequilibrium dynamics of spinboson models from phase space methods phys rev a 96 033607 2017 63 b sundar k c wang and k r a hazzard analysis of continuous and discrete wigner approximations for spin dynamics phys rev a 99 043627 2019 64 c gardiner stochastic methods springer berlin 2009 65 for a stochastic variable x with increment dx adt bdw one can write dx2 x dx2 x2 and apply the ito rules hdw i 0 and hdw 2 i dt in order to obtain hdx2 i 2ax b2 dt 66 g e uhlenbeck and l s ornstein on the theory of brownian motion phys rev 36 823 1930 67 c w gardiner and p zoller quantum noise springer 2000 68 m fossfeig k r a hazzard j j bollinger and a m rey nonequilibrium dynamics of arbitraryrange ising models with decoherence an exact analytic solution phys rev a 87 042101 2013 69 d j wineland j j bollinger w m itano f l moore and d j heinzen spin squeezing and reduced quantum noise in spectroscopy phys rev a 46 r6797 1992 70 a srensen lm duan j i cirac and p zoller manyparticle entanglement with boseeinstein condensates nature london 409 63 2001 71 s morrison and a s parkins dynamical quantum phase transitions in the dissipative lipkinmeshkovglick model with proposed realization in optical cavity qed phys rev lett 100 040403 2008 72 d f walls and g j milburn quantum optics springer 1994 73 m gross and s haroche superradiance an essay on the theory of collective spontaneous emission phys rep 93 301 1982 74 v p singh and h weimer drivendissipative criticality within the discrete truncated wigner approximation in preparation 