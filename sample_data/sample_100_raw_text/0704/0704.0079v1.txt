arXiv:0704.0079v1 [math.OA] 2 Apr 2007

Operator Algebras Associated with Unitary
Commutation Relations
Stephen C. Power†
Lancaster University
Department of Mathematics and Statistics
Lancaster, United Kingdom LA1 4YF
E-mail: s.power@lancaster.ac.uk

Baruch Solel‡
Technion
Department of Mathematics
Haifa 32000, Israel
E-mail: mabaruch@techunix.technion.ac.il

June 15, 2013

∗

2000 Mathematics Subject Classification. 47L55, 47L30, 47L75, 46L05.
SCP is supported by EPSRC grant EP/E002625/1
‡
BS is supported by the Fund for the Promotion of Research at the Technion and by
EPSRC grant EP/E002625/1
†

1

Abstract
We define nonselfadjoint operator algebras with generators
Le1 , . . . , Len , Lf1 , . . . , Lfm subject to the unitary commutation relations of the form
X
Le i Lf j =
ui,j,k,l Lfl Lek
k,l

where u = (ui,j,k,l ) is an nm × nm unitary matrix. These algebras,
which generalise the analytic Toeplitz algebras of rank 2 graphs with
a single vertex, are classified up to isometric isomorphism in terms of
the matrix u.

1

Introduction

The unilateral shift on complex separable Hilbert space generates two fundamental operator algebras, namely the norm closed (unital) algebra and the
weak operator topology closed algebra. The former is naturally isomorphic to
the disc algebra of holomorphic functions on the unit disc, continuous to the
boundary, while the latter is isomorphic to H ∞ . The freely noncommuting
multivariable generalisations of these algebras arise from the freely noncommuting shiftsPLe1 , . . . , Len given by the left creation operators on the Fock
n ⊗k
space Fn = ∞
k=0 ⊕(C ) . Here the generated operator algebras, denoted
An and Ln for the norm and weak topologies, are known as the noncommutative disc algebra and the freesemigroup algebra. They have been studied
extensively with respect to operator algebra structure, representation theory
and the multivariable operator theory of row contractions. See for example
[2], [9].
Higher rank generalisations of these algebras arise when one considers
several families of freely noncommuting generators between which there are
commutation relations. In the present paper we consider a very general form
of such relations, namely
X
Lei Lfj =
ui,j,k,lLfl Lek
k,l

where Le1 , . . . , Len and Lf1 , . . . , Lfm are freely noncommuting and u = (ui,j,k,l)
is an nm × nm unitary matrix. The associated operator algebras are denoted
Au and Lu and we classify them up to various forms of isomorphism in terms
2

of the unitary matrices u. Such unitary relations arose originally in the context of the general dilation theorem proven in Solel ([12], [13]) for two row
contractions [T1 * * * Tn ] and [S1 * * * Sm ] satisfying the unitary commutation
relations.
For n = m = 1, we have u = [α] with |α| = 1 and Au is the subalgebra of
the rotation C*-algebra for the relations uv = αvu. When u is a permutation
unitary matrix arising from a permutation θ in Snm then the relations are
those associated with a single vertex rank 2 graph in the sense of Kumjian
and Pask, and the algebras in this case have been considered in Kribs and
Power [5] and Power [10]. In particular, in [10] it was shown that there are 9
operator algebras Aθ arising from the 24 permutations in case n = m = 2. In
contrast, we see below in Section 6 that for general 2 by 2 unitaries u there
are uncountably many isomorphism classes of the unitary relation algebras
Au expressed in terms of a nine fold real parametrisation of isomorphism
types.
The algebras Aθ are easily defined; they are determined by the left regular
representation of the semigroup F+
θ whose generators are e1 , . . . , en , f1 , . . . , fm
subject to the relations ei fj = fl ek where θ(i, j) = (k, l). On the other hand
the unitary relation algebras
Au are generated by creation operators on a
P
2
Z+ -graded Fock space k,l ⊕(Cn )⊗k ⊗ (Cm )⊗l with relations arising from the
identification u : Cn ⊗ Cm → Cm ⊗ Cn . In particular, Au is a representation
of the non-selfadjoint tensor algebra of a rank 2 correspondence (or a product
system over N2 ) in the sense of [13]. See also [3]
In the main results, summarised partly in Theorem 5.10, we see that if
Au and Av are isomorphic then the two families of generators have matching cardinalities. Furthermore, if n 6= m then the algebras are isomorphic if
and only if the unitaries u, v in Mnm (C) are unitary equivalent by a unitary
A ⊗ B in Mn (C) ⊗ Mm (C). As in [10] we term this product unitary equivalence (with respect to the fixed tensor product decomposition). The case
n = m admits an extra possibility, in view of the possibility of generator
exchanging isomorphisms, namely that u, ṽ are product unitary equivalent,
where ṽi,j,k,l = v̄l,k,j,i.
The theorem is proven as follows. After some preliminaries we identify, in
Section 3, the character space M(Au ) and the set of w*-continuous characters on Lu . These are subsets of the closed unit ball product Bn × Bm which
are associated with a variety Vu in Cn × Cm determined by u. We then define
the core Ω0u , a closed subset of the realised character space Ωu = M(Au ), and
we identify this intrinsically (algebraically) in terms of representations of Au
3

into T2 , the algebra of upper triangular matrices in M2 (C). The importance
of the core is that we are able to show that the interior is a minimal automorphism invariant subset on which automorphisms act transitively. This allows
us to infer the existence of graded isomorphisms from general isomorphisms.
To construct automorphisms we first review, in Section 4, Voiculescu's construction of a unitary action of the Lie group U(1, n) on the Cuntz algebra On
and the operator algebras An and Ln . This provides, in particular, unitary
automorphisms Θα , for α ∈ Bn , which act transitively on the interior ball,
Bn , of the character space of An . For these explicit unitary automorphisms
of the ei -generated copy of An in Au , we establish unitary commutation relations for the tuples Θα (Le1 ), . . . , Θα (Len ) and Lf1 , . . . , Lfm , when (α, 0) is
a point in the core. This enables us to define natural unitary automorphisms
of Au itself, and in Theorem 4.8 the relative interior of the core is identified as an automorphism invariant set in the Gelfand space Ωu . In Section
5 we determine the graded and bigraded isomorphisms in terms of product
unitary equivalence. To do this we observe that such isomorphisms induce
an origin preserving biholomorphic map between the cores Ω0u and Ω0v and
that these maps, by a generalised Schwarz's Lemma, are implemented by a
product unitary. We then prove the main classification theorem.
In Section 6 we analyse in detail the case n = m = 2 and consider the
special case of permutation unitaries.
Finally, in Section 7 we show that the algebra Au is contained in a tensor
algebra T+ (X), associated with a correspondence X as in [7]. Moreover, at
least when n 6= m, every automorphism of Au extends to an automorphism
of T+ (X). The advantage of the tensor algebra is that its representation
theory is known ([7]) while this is not the case yet for the algebra Au .

2

Preliminaries

Fix two finite dimensional Hilbert spaces E = Cn and F = Cm and a
unitary mn × mn matrix u. The rows and columns of u are indexed by
{1, . . . , n} ×{1, . . . , m} (u = (u(i,j),(k,l))) and when we write u as an mn×mn
matrix we assume that {1, . . . , n} × {1, . . . , m} is ordered lexicographically
(so that, for example, the second row is the row indexed by (1, 2)). We also
fix orthonormal bases {ei } and {fj } for E and F respectively and the matrix

4

u is used to identify E ⊗ F with F ⊗ E through the equation
X
u(i,j),(k,l)fl ⊗ ek .
ei ⊗ fj =

(1)

k,l

Equivalently, we write
fl ⊗ ek =

X
i,j

ū(i,j),(k,l)ei ⊗ fj .

(2)

For every k, l ∈ N, we write X(k, l) for E ⊗k ⊗ F ⊗l . Using succesive applications of (1), wePcan identifyP
X(k, l) with E ⊗k1 ⊗ F ⊗l1 ⊗ E ⊗k2 ⊗ * * * ⊗ F ⊗lr
whenever k = ki and l = lj .
Let F (n, m, u) be the Fock space given by the Hilbert space direct sum
X
X
E ⊗k ⊗ F ⊗l ,
X(k, l) =
k,l

k,l

and, for e ∈ E and f ∈ F , write Le and Lf for the "shift" operators
Le ei1 ⊗ei2 ⊗* * *⊗eik ⊗fj1 ⊗fj2 ⊗* * *⊗fjl = e⊗ei1 ⊗ei2 ⊗* * *⊗eik ⊗fj1 ⊗fj2 ⊗* * *⊗fjl
and
Lf ei1 ⊗ei2 ⊗* * *⊗eik ⊗fj1 ⊗fj2 ⊗* * *⊗fjl = f ⊗ei1 ⊗ei2 ⊗* * *⊗eik ⊗fj1 ⊗fj2 ⊗* * *⊗fjl
where, in the last equation, we use (1) to identify the resulting vector as a
vector of E ⊗k ⊗ F ⊗(l+1) .
The unital semigroup generated by {I, Le , Lf : e ∈ E, f ∈ F } is
+
denoted F+
u and the algebra it generates denoted C[Fu ]. The norm closure
of C[F+
u ] will be written Au and its closure in the weak* operator topology
will be written Lu . In particular, the algebras Lθ and Aθ studied in [10] are
the algebras Lu and Au for u which is a permutation matrix.
The results of Section 2 in [5] hold here too with minor changes. Every
A ∈ Lu is the limit (in the strong operator topology) of its Cesaro sums
Σp (A) =

k
(1 − )Φk (A)
p
k≤p

X

P
where Φk (A) lies in Lu and is "supported" onP l ⊕E ⊗l ⊗ F ⊗(k−l) . In fact,
let Qk be the projection of F (n, m, u) onto l ⊕E ⊗l ⊗ F ⊗(k−l) , form the
5

P∞ ikt
one-parameter unitary group {Ut } defined by Ut :=
k=0 e Qk and set
∗
γt = AdUt . Then {γt }t∈R is a w -continuous action of R on L(F (n, m, u))
that normalizes both Au and Lu and
Z 2π
1
Φk (a) =
e−ikt γt (a)dt
2π 0
for all a ∈ L(F (n, m, u)). Then Φk leaves Lu invariant.
We can define the algebra Ru generated by the right shifts Re and Rf
defined by
Re ei1 ⊗ei2 ⊗* * *⊗eik ⊗fj1 ⊗fj2 ⊗* * *⊗fjl = ei1 ⊗ei2 ⊗* * *⊗eik ⊗fj1 ⊗fj2 ⊗* * *⊗fjl ⊗e
and
Rf ei1 ⊗ei2 ⊗* * *⊗eik ⊗fj1 ⊗fj2 ⊗* * *⊗fil = ei1 ⊗ei2 ⊗* * *⊗eik ⊗fj1 ⊗fj2 ⊗* * *⊗fil ⊗f.
The techniques of the proof of Proposition 2.3 of [5] can be applied here to
show that the commutant of Ru is Lu . Also, mapping ei1 ⊗ ei2 ⊗ * * * ⊗ eik ⊗
fj1 ⊗ fj2 ⊗ * * * ⊗ fjl to fjl ⊗ fjl−1 ⊗ * * * ⊗ fj1 ⊗ eik ⊗ eik−1 ⊗ * * * ⊗ ei1 , we get a
unitary operator
W : F (n, m, u) → F (n, m, u∗)
implementing a unitary equivalence of Lu and Ru∗ . In fact, it is easy to
check that Rei W = W Lei and Rfj W = W Lfj for every i, j. To see that the
∗
commutation relation in the
, apply W to (2) to get (in
P range is given by uP
the range of W ) ek ⊗ fl = i,j ū(i,j),(k,l)fj ⊗ ei = i,j (u∗ )(k,l),(i,j) fj ⊗ ei which
is equation (1) with u∗ instead of u.
As in [5], we conclude that (Lu )′ = Ru and (Lu )′′ = Lu .

3

The character space and its core

In the following proposition we describe the structure of the character spaces
M(Lu ) and M(Au ) (equipped with the weak∗ topology). Similar results
were obtained in [5] for algebras defined for higher rank graphs and in [2] for
analytic Toeplitz algebras. (See also [10].)
It will be convenient to write
X
u(i,j),(k,l)zk wl }
(3)
Vu = {(z, w) ∈ Cn × Cm : zi wj =
k,l

6

and
Ωu = Vu ∩ (Bn × Bm )

(4)

where Bn is the open unit ball of C . We refer to Vu as the variety associated
with u.
n

Proposition 3.1 (1) The linear multiplicative functionals on C[F+
u ] are in
one-to-one correspondence with points (z, w) in Vu .
(2) M(Au ) is homeomorphic to Ωu .
(3) For (z, w) ∈ Ωu , write α(z,w) for the corresponding character of Au .
Then α(z,w) extends to a w ∗ -continuous character on Lu if and only if
(z, w) ∈ Bn × Bm .
Proof.
Part (1) follows immediately from (1). Fix α ∈ M(Au ) and
write zi = α(Lei ), 1 ≤ i ≤ n, and wi = α(Lfj ), 1 ≤ j ≤ m. From the
multiplicativity and linearity
Pof α and (1),
P it follows that (z, w) ∈ Vu . Since
α is contractive and maps i ai Lei to i ai zi , it follows that kzk ≤ 1 and
similarly kwk ≤ 1. Thus (z, w) ∈ Ωu .
For the other direction, fix first (z, w) ∈ Ωu with kzk < 1 and kwk < 1.
It follows from the definition of Ωu and from (1) that (z, w) defines a linear
and multiplicative map α on the algebra C[F+
u ] such that Lei is mapped into
zi and α(Lfj ) = wj . Abusing notation slightly, we write α(x) for α(Lx ) for
every x ∈ E ⊗k ⊗ F ⊗l . Also, for i = (i1 , . . . , ik ) and j = (j1 , . . . , jl ), we write
ei fj for ei1 ⊗ * * * ⊗ eik ⊗ fj1 ⊗ * * * ⊗ fjl . These elements form an orthonormal
basis for E ⊗k ⊗ F ⊗l and we now set
XX
wα =
α(ei fj )ei fj ∈ F (X).
i,j

k,l

k!
terms ei1 ⊗ * * * ⊗ eik
If pi ≥ 0 and p1 + . . . + pn = k then there are p1 !***p
n!
P P
p1 p2
pk
2
withPα(ei1 ⊗ * * * ⊗ eik ) = z1 z2 * * * zk . It follows that
k
i |α(ei )| =
P
2
2
k
i=(i1 ,...,ik ) |α(ei1 )| * * * |α(eik )| . Thus
X
|α(ei fj )|2 = (1 − kzk2 )−1 (1 − kwk2)−1 < ∞
kwα k2 =
i,j,k,l

Note that, for every x ∈ E ⊗k ⊗ F ⊗l ,
hx, wα i = α(x).
7

Thus, for e ∈ E, hx, L∗e wα i = hLe x, wα i = α(e ⊗ x) = α(e)α(x) = hα(e)wα , xi
and, similarly hx,P
L∗f wα i = hα(f )wα, xi for f ∈ F . Thus hwα , L∗e wα i =
α(e)α(wα) = α(e) P|α(eifj )|2 = α(e)kwα k2 . Similarly, hwα , L∗f wα i =
α(f )α(wα) = α(f ) |α(ei fj )|2 = α(f )kwα k2 for f ∈ F . Thus if we write
να = wα /kwα k then
α(x) = hLx να , να i

for every x ∈ E ⊗k ⊗ F ⊗l (for every k, l). This shows that α is contractive
and is w ∗ -continuous. We can, therefore, extend it to an element of M(Lu ),
also denoted α.
The analysis above shows that the image of the map α 7→ (z, w) ∈ Ωu
defined above (on M(Au )) contains Vu ∩(Bn ×Bm ). Since M(Au ) is compact
and the map is w ∗ -continuous, its image contains (and, thus, is equal to) Ωu .
This completes the proof of (2). To complete the proof of (3), we need
to show that, if (z, w) ∈ Ωu and the corresponding character extends to a
w ∗ -continuous character on Lu , then kzk < 1 and kwk < 1.
For this, write L for the w ∗ -closed subalgebra of Lu generated by {Le :
e ∈ E} ∪ {I}. Let P be the projection of F (E, F, u) onto F (E) = C ⊕
E ⊕ (E ⊗ E) ⊕ * * *. Then P LP = P Lu P and the map T 7→ P T P , is a
w ∗ -continuous isomorphism of L onto P Lu P . The latter algebra is unitarily
equivalent to the algebra Ln studied in [2]. A w ∗ -continuous character of Lu
gives rise, therefore, to a w ∗ -continuous character on Ln . It follows from [2,
Theorem 2.3] that z ∈ Bn . Similarly, one shows that w ∈ Bm . 
To state the next result, we first write u(i,j) for the n × m matrix whose
k, l-entry is u(i,j),(k,l). Thus, the (i, j) row of u provides the n rows of u(i,j) .
We then compute
X
XX
X
u(i,j),(k,l)zk wl =
(
u(i,j),(k,l)wl )zk =
(u(i,j) w)k zk = hu(i,j)w, z̄i.
k,l

k

l

k

(5)
Write Ei,j for the n × m matrix whose i, j-entry is 1 and all other entries are
0 (so that hEi,j w, z̄i = zi wj ) and write C(i,j) for the matrix u(i,j) − Ei,j . Then
the computation above yields the following.
Lemma 3.2 With C(i,j) defined as above, we have
Vu = {(z, w) ∈ Cn × Cm :

hC(i,j)w, z̄i = 0, for all i, j}.

8

Definition 3.3 The core of Ωu is the subset given by
Ω0u := {(z, w) ∈ Bn × Bm :

t
C(i,j) w = 0, C(i,j)
z=0

for all i, j}.

Fix (z, w) ∈ Ω0u . We have u(i,j) w = Ei,j w for all i, j. Thus, for every k,
X
u(i,j),(k,l)wl = δi,k wj
(6)
l

(where
δi,k is 1 if i = k and 0 otherwise) and, for a1 , a2 , . . . , an , in C we have
P
(i)
u
be the vector in Cmn defined
k,l (i,j),(k,l) ak wl = ai wj . Hence, if we let w̃
(i)

by w̃(k,l) = δk,i wl , we get uw̃ (i) = w̃ (i) . Similarly, for z, we have
X

u(i,j),(k,l)zk = δj,l zi

(7)

k

P
and for scalars b1 , . . . , bm we have k,l u(i,j),(k,l)bl zk = bj zi . Thus, writing z̃(j)
for the vector defined by (z̃(j) )(k,l) = δl,j zk , we have uz̃(j) = z̃(j) . The vector
w̃ (i) in Cnm = Cn ⊗ Cm is also expressible as δi ⊗ w where {δ1 , . . . , δn } is
the standard basis of Cn , and, similarly, z̃(j) = z ⊗ δj . We therefore obtain
Lemma 3.4 which will be useful in Section 6.
We note also the following companion formula. Suppose (z, w) ∈ Ω0u .
Then, as we noted above, uz̃(j) = z̃(j) and, thus, u∗ z̃(j) = z̃(j) . Writing this
explicitly, we have, for all i, j, l,
X
u(k,l),(i,j)z ̄k = δj,l z ̄i .
(8)
k

.
Lemma 3.4 Let (z, w) be a vector in the core Ω0u . Then
span{z̃(j) , w̃ (i) : 1 ≤ i ≤ n, 1 ≤ j ≤ m} ⊆ Ker(u − I).
In particular,
(i) If the core contains a vector (z, w) with z 6= 0, then dim(Ker(u − I)) ≥
m.
(ii) If the core contains a vector (z, w) with w 6= 0 then dim(Ker(u − I)) ≥
n.
9

(iii) If the core contains a vector (z, w) with z 6= 0 and w 6= 0, then
dim(Ker(u − I)) ≥ m + n − 1.
We now characterise the core in an algebraic manner in terms of representations into the algebra T2 of upper triangular 2 × 2 matrices. We remark
that nest representations such as these have proven useful in the algebraic
structure theory of nonself-adjoint algebra [?], [11].
Let ρ : C[F+
u ] → T2 with


ρ1,1 (T ) ρ1,2 (T )
ρ(T ) =
0
ρ2,1 (T )
Then ρ1,1 and ρ2,2 are characters and ρ1,2 is a linear functional that satisfies
ρ1,2 (T S) = ρ1,1 (T )ρ1,2 (S) + ρ1,2 (T )ρ2,2 (S)

(9)

for T, S ∈ C[F+
u ].
We now restrict to the case where ρ1,1 = ρ2,2 . By Proposition 3.1(1),
both are associated with a point (z, w) in Vu . It follows from (9) that ρ1,2
is determined by its values on Lei and Lfj . Setting λi = ρ1,2 (Lei ) and μj =
ρ1,2 (Lfj ), we associate with each homomorphism ρ (as discussed above) a
quadruple (z, w, λ, μ) where (z, w) ∈ Vu and, for every i, j,
X
u(i,j),(k,l)(wl λk + μl zk ).
(10)
zi μj + λi wj =
k,l

(The last equation follows from (1)). Using (5) we can write the last equation
as
hu(i,j)w, λ̄i + hu(i,j)μ, z̄i = zi μj + λi wj = hEi,j w, λ̄i + hEi,j μ, z̄i.
That is,

t
hC(i,j) w, λ̄i + hμ, C(i,j)
zi = 0.

(11)

The following lemma now follows from the definition of the core.
Lemma 3.5 A point (z, w) ∈ Ωu lies in the core Ω0u if and only if every
(λ, μ) ∈ Cn × Cm defines a homomorphism ρ : C[F+
u ] → T2 such that


zi λi
ρ(Lei ) =
0 zi
and
ρ(Lfj ) =



for all i, j.
10

wj μj
0 wj



Automorphisms of Ln and Lu

4

We first derive the unitary automorphisms of Ln and An associated with
U(1, n). These were obtained by Voiculescu [14] in the setting of the CuntzToeplitz algebra. However the automorphisms restrict to an action of U(1, n)
on the free semigroup algebra. The result is rather fundamental, being a
higher dimensional version of the familiar Möbius automorphism group on
H ∞ . For the reader's convenience we provide complete proofs. See also the
discussion in Davidson and Pitts [2], and in [1], [10].
Lemma 4.1 Let α ∈ Bn and write
(i) x0 = (1 − kαk2 )−1/2 ,
(ii) η = x0 α, and
(iii) X1 = (ICn + ηη ∗ )1/2 .
Then
(1) kηk2 = |x0 |2 − 1,
(2) X1 η = x0 η, and
(3) X12 = I + ηη ∗ .
In particular, the matrix X =


1 0
,
0 −I



x0 η ∗
η X1



satisfies X ∗ JX = J, where J =

Proof.
Part (1) is an easy computation and part (3) follows from the
definition of X1 . For (2), note that X12 η = (I + ηη ∗)η = η + kηk2 η = x20 η
and, for every ζ ∈ η ⊥ , X1 ζ = ζ. Suppose X1 η = aη + ζ (ζ ∈ η ⊥ ). Then
x20 η = X12 η = a2 η + ζ and it follows that a = x0 (as X1 ≥ 0) and ζ = 0. 
The lemma exhibits specific matrices (X1 is nonnegative) in U(1, n) associated with points in the open ball. One can similarly check (see [2] or [10] for

11

example) that the general form of a matrix Z in U(1, n) is Z =



z0 η1∗
η2 Z1



where
kη1 k2 = kη2 k2 = |z0 |2 − 1,
Z1 η1 = z ̄0 η2 , Z1∗ η2 = z0 η1 ,
Z1∗ Z1 = In + η1 η1∗ , Z1 Z1∗ = In + η2 η2∗ .
It is these equations that are equivalent to the single matrix equation Z ∗ JZ =
J.
It is well known that the map θX defined on Bn by
θX (λ) =

X1 λ + η
, λ ∈ Bn .
x0 + hλ, ηi

is an automorphism of Bn with inverse θX −1 . See Lemma 4.9 of [2] and Lemma
8.1 of [10] for example. We make use of this in the proof of Voiculescu's
theorem below.
Let L1 , . . . , LP
n be the generators of the norm closed algebra An and for ζ ∈
n
C write Lζ =
ζi Li . Recall that the character space M(An ) is naturally
identifiable with the closed ball B̄n , with λ in this ball providing a character
φλ for which φλ (Li ) = λi . The proof is a reduced version of that given above
for M(Aθ ).
Theorem 4.2 Let α ∈ Bn and let X1 , x0 , η and X be associated with α as
in Lemma 4.1. Then
(i) there is an automorphism ΘX of Ln such that
Θα (Lζ ) = (x0 I + Lη )−1 (LX1 ζ + hζ, η̄iI),

(12)

−1
(ii) the inverse automorphism ΘX
is ΘX −1 , and X −1 is the matrix in
U(1, n) associated with −α,
(iii) there is a unitary UX on Fn such that for a ∈ An ,

UX aξ0 = Θα (a)(x0 I + Lη )−1 ξ0
and ΘX (a) = UX aUX∗ .
Proof.
Let Fn be the Fock space for Ln , In = IFn , and let L̃ =
[In L1 * * * Ln ] viewed as an operator from (C ⊕ Cn ) ⊗ Fn = Fn ⊕ (Cn ⊗ Fn )
to Fn . Then
L̃(J ⊗ I)L̃∗ = In − L̃L̃∗ = In − (L1 L∗1 + . . . Ln L∗n ) = P0
12

where P0 is the vacuum vector projection from Fn to C. Also, since XJX =
J, we have
L̃(J ⊗ I)L̃∗ = L̃(X ⊗ In )(J ⊗ I)(X ⊗ In )L̃∗ = [Y0 Y1 ](J ⊗ I)[Y0 Y1 ]∗
where
[Y0 Y1 ] = [In L]
Thus Y0 Y0∗ − Y1 Y1∗ = P0 . Also



x0 ⊗ In η ∗ ⊗ In
η ⊗ In X1 ⊗ In



.

Y0 = x0 ⊗ In + L(η ⊗ In ) = x0 In + Lη ,
Y1 = η ∗ ⊗ In + L(X1 ⊗ In ) = η ∗ ⊗ In + [LX1 e1 . . . LX1 en ]

where, here, e1 , . . . , en is the standard basis for Cn .
The operator V = Y0−1 Y1 is a row isometry [V1 * * * Vn ], from Cn ⊗ Fn to
Fn with defect 1. To see this we compute
I − V V ∗ = I − Y0−1 Y1 Y1∗ Y0∗−1 = I − Y0−1 (−P0 + Y0 Y0∗ )Y0∗−1
′

′

= I + Y0−1 P0 Y0∗−1 − I = ξ0 ξ0∗ .
Here
′

ξ0 =

Y0−1 ξ0

−1

= (x0 In + Lη ) ξ0 =

x−1
0 (

∞
X

j
(x−1
0 Lη ) ξ0 )

j=0

and so
kξ0′ k = |x0 |−2

X
j

|x0 |−2j kηk2j =

x20

1
= 1.
− kηk2

Considering the path t → tα for 0 ≤ t ≤ 1 and the corresponding path of
partial isometries V it follows from the stability of Fredholm index that the
index of V and L coincide and so in fact V is a row isometry. Thus V1 , . . . , Vn
are isometries with orthogonal ranges.
We now have a contractive algebra homomorphism An → L(Fn ) determined by the correspondence Lei → Vi , i = 1, . . . , n. In fact it is an algebra
endomorphism Θ : An → An . Indeed, for ξ = (ξ1 , . . . , ξn ) we have
X
X
Θ(Lξ ) =
ξ i Vi =
ζi Y0−1 Y1 (ei ⊗ In )
=

X

ζi (x0 In + Lη )−1 (η ∗ ⊗ In + [LX1 e1 . . . LX1 en ])[In * * * In ]t
13

= (x0 In + Lη )−1 (hζ, ηiIn + LX1 ζ ).
Thus far we have followed Voiculescu's proof [14]. The following argument
shows that Θ is an automorphism and is an alternative to the calculation
suggested in [14]. The calculation shows that
φλ ◦ ΘX = φθX (λ).
We have
φλ ◦ ΘX (Lζ ) = φλ ((x0 In + Lη )−1 (hζ, ηiIn + LX1 ζ ))
= (x0 + hλ, ηi)−1(hζ, ηi + hX1 ζ, λi) = φμ (Lζ )

where
μ=

X1∗ λ + η
X1 λ + η
=
= θX (λ).
x0 + hλ, ηi
x0 + hλ, ηi

Write ΘX for the contractive endomorphism Θ of An as constructed
above. It follows that the composition Φ = ΘX −1 ◦ ΘX is a contractive
endomorphism which, by the remarks preceding the statement of the theorem, induces the identity map on the character space, so that φλ = φλ ◦ Φ−1
for all λ ∈ Bn . Such a map must be the identity. Indeed, suppose that we
have the Fourier series representation Φ−1 (Le1 ) = a1 Le1 + . . . + an Len + X
where X is a series with terms of total degree greater than one. It follows
that
lim t−1 φ(t,0,...,0) (Φ−1 (Le1 )) = a1
t→0

while
lim t−1 φ(t,0,...,0) (Le1 ) = 1.
t→0

Since the induced map is the identity, we have a1 = 1 and ak = 0 for k ≥ 2.
In this way we see that the image of each Li has the form Li +Ti where Ti has
only terms of total degree greater than one. Since Li ξ0 is orthogonal to Ti ξ0
and Φ−1 (Li ) is a contraction, we have 1 ≥ kΦ−1 (Li )ξ0 k2 = kLi ξ0 + Ti ξ0 k2 =
kLi ξ0 k2 + kTi ξ0 k2 = 1 + kTi ξ0 k2 . Thus Ti ξ0 = 0 and, consequently, Ti = 0
and so the composition Φ is the identity map.
Finally, we show that Θα is unitarily implemented. Define UX on An ξ0
by UX aξ0 = ΘX (a)ξ0′ = ΘX (a)(x0 I + Lη )−1 ξ0 for a ∈ A. Since ΘX is an
automorphism, (UX a)bξ0 = UX abξ0 = ΘX (a)ΘX (b)ξ0′ = ΘX (a)UX bξ0 , for
a, b ∈ An , and it follows that UX a = ΘX (a)UX , as linear transformations on
the dense space An ξ0 .
14

Now, V = [V1 , . . . , Vn ] is a row isometry with defect space spanned by ξ0′ .
The map UX maps ξi = Li ξ0 to ΘX (Li )ξ0′ = Vi ξ0′ and, if w = w(e1 , . . . , en ) is
a word in e1 , . . . , en , then
UX ξw = UX w(L1 , . . . , Ln )ξ0 = ΘX (w(L1 , . . . , Ln ))ξ0′ = w(V1 , . . . , Vn )ξ0′ .
Since V is a row isometry and ξ0′ is a unit wandering vector for V , it follows
that {w(V1, . . . , Vn )ξ0′ } is an orthonormal set. Thus, UX is an isometry. Since
the range of UX contains UX An ξ0 = ΘX (An )ξ0′ = An (x0 I + Lη )−1 ξ0 = An ξ0
we see that UX is unitary. 
Remark 4.3 With the same calculations as in the proof above and slightly
more notation, one can show that each invertible matrix Z ∈ U(1, n) defines
an automorphism ΘZ and that Z → ΘZ is an action of U(1, n) on An and,
in particular, ΘZ ΘX = ΘZX . Moreover, Z → UZ is a unitary representation
of U(1, n) implementing
this as the following calculation indicates.


∗
w0 ω
be the matrix in U(1, n) associated with β ∈ Bn
Let W =
ω W1
as in Lemma 4.1. Then
UX UW aξ0 = UX (Θβ (a)(w0 + Lω )−1 ξ0 )
= Θα (Θβ (a)(w0 + Lω )−1 )(x0 In + Lη )−1 ξ0
= Θα (Θβ (a))Θα ((w0 + Lω )−1 )(x0 In + Lη )−1 ξ0
= ΘXW (a)Θα ((w0 + Lω )−1 )(x0 In + Lη )−1 ξ0
= ΘXW (a)[w0 In + (x0 In + Lη )−1 (LX1 ω + hω, ηiIn )]−1 (x0 In + Lη )−1 ξ0
= ΘXW (a)[w0 x0 In + w0 Lη + LX1 ω + hω, ηiIn)]−1 ξ0
= ΘXW (a)[(w0 x0 In + hω, ηi)In + Lω0 η+X1 ω ]−1 ξ0 .

One readily checks that this is the same as UXW (a)ξ0

It is evident from the last theorem and its proof that the unitary automorphisms of An and Ln act transitively on the open subset Bn associated
with the weak star continuous characters. We shall show that a version of
this holds for the unitary relation algebras with respect to the open core of
the character space. As a first step to constructing automorphisms of Au we
obtain unitary commutation relations for the n-tuples [Θ(Le1 ), . . . , Θ(Len )]
and [Lf1 , . . . , Lfm ] for certain automorphisms Θ of the copy of An in Au .
15

Lemma 4.4 Suppose (z, w) ∈ Ω0u ∩(Bn ×Bm ). Write α for z̄ and let Θ := Θα
be as in (12). Then, for every 1 ≤ i ≤ n and 1 ≤ j ≤ m,
X
Θ(Lei )Lfj =
u(i,j),(k,l)Lfl Θ(Lek ).
(13)
k,l

Proof.
Write Y for ηη ∗ and β for (x0 + 1)−1 . Since X12 = I + ηη ∗ ,
X1 = I + βηη ∗ = I + βY and Y = (Yi,j ) where Yi,j = ηi η̄j = x20 z̄i zj . We now
compute
X
X
(X1 ei )fj = ei fj +
βYt,i et fj = ei fj +
βYt,i u(t,j),(k,l)fl ek
t

=

X

=

X

u(i,j),(k,l)fl ek +

k,l

t,k,l

X

βx20 z̄t zi u(t,j),(k,l) fl ek

t,k,l

u(i,j),(k,l)fl ek + βx20 zi

k,l

X

z̄t u(t,j),(k,l) fl ek .

t,k,l

Using the core equation (8), the last expression is equal to
X
X
u(i,j),(k,l)fl ek + βx20 zi
δj,l z̄k fl ek
k,l

=

k,l

X

u(i,j),(k,l)fl ek + βx20 zi

=

k,l

z̄k fj ek

k

k,l

X

X

X
u(i,j),(k,l)fl ek + βx20
(δj,l zi )z̄k fl ek .
k,l

Using the core equation (7), this is equal to
XX
X
(
u(i,j),(t,l) zt )z̄k fl ek
u(i,j),(k,l)fl ek + βx20
t

k,l

k,l

=

X

u(i,j),(k,l)fl ek + βx20

X

u(i,j),(k,l)fl ek + β

k,l

=

u(i,j),(k,l)zk z̄t fl et

k,l,t

k,l

=

X

X

X

u(i,j),(k,l)Yt,k fl et

k,l,t

u(i,j),(k,l)fl ek + β

X
k,l

k,l

16

u(i,j),(k,l)fl Y ek

=

X

u(i,j),(k,l)fl X1 ek .

k,l

Thus
LX1 ei Lfj =

X

u(i,j),(k,l)Lfl LX1 ek .

(14)

k,l

P
P
z̄
e
f
=
Next,
we
compute
i
i
j
i,k,l u(i,j),(k,l) z̄i fl ek . Using (8), this is equal
i
P
P
to k,l δj,l z̄k fl ek = k z̄k fj ek . Thus
X

z̄i ei fj =

i

X

z̄i fj ei

(15)

i

and, hence, Lη commutes with Lfj . It follows that
Lfj (x0 I − Lη )−1 = (x0 I − Lη )−1 Lfj .
We have, using (14) and (16),
(x0 I − Lη )−1 LX1 ei Lfj =
=

X
k,l

X
k,l

u(i,j),(k,l)(x0 I − Lη )−1 Lfl LX1 ek

u(i,j),(k,l)Lfl (x0 I − Lη )−1 LX1 ek .

Also, applying (7) and (16), we get
(x0 I − Lη )−1 hei , ηiLfj = zi Lfj (x0 I − Lη )−1
=

X
l

=

X
k,l

δj,l zi Lfl (x0 I − Lη )−1

u(i,j),(k,l)zk Lfl (x0 I − Lη )−1 .

Subtracting the last two equations, we get (13). 
Corollary 4.5 In the notation of Lemma 4.4, for every i, j,
X
u(i,l),(k,j)Θ(Lek )L∗fl .
L∗fj Θ(Lei ) =
k,l

17

(16)

P
Proof. It follows from (13) that Θ(Lei )Lfl = k,t u(i,l),(k,t) Lft Θ(Lek ) for
every i, l. Thus, for i, j, l,
X
L∗fj Θ(Lei )Lfl L∗fl =
u(i,l),(k,t) L∗fj Lft Θ(Lek )L∗fl
k,t

=

X

u(i,l),(k,t) δj,t Θ(Lek )L∗fl =

k,t

X

u(i,l),(k,j)Θ(Lek )L∗fl .

k

Summing over l, we get
L∗fj Θ(Lei )(

X

Lfl L∗fl ) =

l

X

u(i,l),(k,j)Θ(Lek )L∗fl .

k,l

Now, l Lfl L∗fl = I − P where P is the projection onto the subspace C ⊕
E ⊕ (E ⊗ E) ⊕ . . .. Note that P is left invariant under the operators in
the algebra generated by {Lei : 1 ≤ i ≤ n}Pand, in particular, by Θ(Lei ).
∗
Thus L∗fj Θ(Lei )P = L∗fj P Θ(Lei )P = 0 =
k,l u(i,l),(k,j) Θ(Lek )Lfl P . This
completes the proof of the corollary. 
P

Proposition 4.6 Suppose (z, w) ∈ Ω0u ∩ (Bn × Bm ). Then there is a automorphism Θ̃z of Au that is unitarily implemented and such that, for every
X ∈ Au ,
α(0,w) (Θ̃−1
(17)
z (X)) = α(z,w) (X)
where α(z,w) is the character associated with (z, w) by Proposition 3.1.
Proof.
Let U be the unitary operator implementing Θ. We can view
F (n, m, u) as the sum
X
F ⊗k ⊗ F (E)
F (n, m, u) =
k

where F (E) = C ⊕ E ⊕ (E ⊗ E) ⊕ * * *. We now let V be the unitary operator
whose restriction to F ⊗k ⊗ F (E) is Ik ⊗ U (where Ik is the identity operator
on F ⊗k ). It is easy to check that, for every fj ,
V Lfj V ∗ = Lfj .
Now, fix i. We shall show, by induction, that, for every k and every ξ ∈
F ⊗k ⊗ F (E),
(Ik ⊗ U)Lei ξ = Θ(Lei )(Ik ⊗ U)ξ.
(18)
18

For k = 0 this is just the fact that U implements Θ. Suppose we know this
for k and fix fj ∈ F . Then, for ξ ∈ F ⊗k ⊗ F (E) we have,
X
(Ik+1 ⊗ U)Lei Lfj ξ =
u(i,j),(k,l)(Ik+1 ⊗ U)Lfl Lek ξ
k,l

=

X
k,l

u(i,j),(k,l)Lfl (Ik ⊗ U)Lek ξ.

P
Applying the induction hypothesis, this is equal to k,l u(i,j),(k,l)Lfl Θ(Lek )(Ik ⊗
U)ξ. Using (13), this is Θ(Lei )Lfj (Ik ⊗ U)ξ = Θ(Lei )(Ik ⊗ U)Lfj ξ. Since
F ⊗(k+1) ⊗ F (E) is spanned by elements of the form Lfj ξ (as above) the
equality follows. From the relations of Lemma 4.4 it follows that the map
Θ̃z : X → V XV ∗ defines a unitary endomorphism of Au . Since Θ is an
automorphism of An it follows that Θ̃z gives the desired automorphism. 

Clearly, in Proposition 4.6, we can interchange z and w to get the following, where Θz,w = Θ̃z Θ̃w .

Proposition 4.7 Suppose (z, w) ∈ Ω0u ∩ (Bn × Bm ). Then there is a unitary
automorphism Θz,w of Lu which is a homeomorphism with respect to the
w ∗ -topologies and which restricts to an automorphism of Au . Moreover, for
every X ∈ Lu ,
α(0,0) (Θ−1
(19)
z,w (X)) = α(z,w) (X)
where α(z,w) is the character associated with (z, w) as in Proposition 3.1.
An automorphism Ψ of Au , defines a map on the character space of Au ,
namely φ 7→ φ ◦ Ψ−1. Thus using Proposition 3.1 we have a homeomorphism
θΨ of Ωu . Also, since Ωu ∩ (Bn × Bm ) is the interior of Ωu , θΨ maps Ωu ∩
(Bn × Bm ) onto itself.
Similarly, if Ψ is an automorphism of Lu which is a homeomorphism with
respect to the w ∗ -topologies, then θΨ is a homeomorphism of Ωu ∩ (Bn × Bm ).
In the following theorem we identify the relative interior of the core as the
orbit of (0, 0) under the group of maps θΨ associated with automorphisms Ψ.
Theorem 4.8 For (z, w) ∈ Bn × Bm the following conditions are equivalent.
(1) (z, w) ∈ Ω0u .

19

(2) There exists a completely isometric automorphism Ψ of Lu that is a
homeomorphism with respect to the w ∗ -topologies and restricts to an
automorphism of Au , such that θΨ (0, 0) = (z, w).
(3) There exists an algebraic automorphism Ψ of Au such that θΨ (0, 0) =
(z, w).
Proof. The proof that (1) implies (2) follows from Proposition 4.7. Clearly
(2) implies (3). It is left to show that (3) implies (1).
Given a point (z, w) ∈ Ωu , we saw in Lemma 3.5 that, for every (λ, μ)
satisfying (11) there is a homomorphism ρz,w,λ,μ : C[F+
u ] → T2 . For (z, w) =
(0, 0) equation (11) holds for every pair (λ, μ). Since ρ0,0,λ,μ vanishes off a
finite dimensional subspace, it is a bounded homomorphism. In fact, for
every (λ, μ), kρ0,0,λ,μ k ≤ 1 + kλk + kμk.
Given Ψ and (z, w) as in (3), for every (λ, μ) ∈ Cn × Cm , ρ0,0,λ,μ ◦ Ψ−1
is a homomorphism on C[F+
u ] and, thus, it is of the form ρz,w,λ′ ,μ′ for some
′
′
(unique) (λ , μ ) satisfying (11). Write ψ(λ, μ) = (λ′ , μ′ ) and note that this
defines a continuous map. To prove the continuity, suppose (λn , μn ) → (λ, μ)
and write ρn for ρ0,0,λn ,μn and ρ for ρ0,0,λ,μ . Then (using the estimate on the
norm of ρ0,0,λ,μ ) there is some M such that kρn k ≤ M for all n and kρk ≤ M.
For every Y ∈ C[F+
u ], ρn (Y ) → ρ(Y ). Now fix X ∈ Au and ǫ > 0. There is
some Y ∈ C[F+
]
such
that kX − Y k ≤ ǫ and there is some N such that for
u
n ≥ N kρn (Y ) − ρ(Y )k ≤ ǫ. Thus, for such n, kρn (X) − ρ(X)k ≤ (2M + 1)ǫ.
Setting X = Ψ(Lei ), we get λ′n → λ′ and similarly for μ′ .
If (z, w) is not in Ω0u , then the set of all (λ, μ) satisfying (11) is a subspace
of Cn × Cm of dimension strictly smaller than n + m and, as is shown above,
it contains the continuous image (under the injective map ψ) of Cn × Cm .
This is impossible. 

5

Isomorphic algebras

In this section we shall find conditions for algebras Au and Av to be (isometrically) isomorphic. The characterisation also applies to the weak star closed
algebras Lu .
We start by considering a special type of isomorphism. We shall now
assume that the set {n, m} for both algebras is the same. In fact, by interchanging E and F , we can assume that the corresponding dimensions are the
20

same and the algebras are defined on F (n, m, u) and F (n, m, v) respectively.
This assumption will be in place in the discussion below up to the end of
Lemma 5.5.
The algebra Au carries a natural Z2+ -grading, with the (k, l) labeled subspace being spanned by products of the form Lei1 Lei2 . . . Leik Lfi1 Lfi2 . . . Lfil .
Also, the total length of such operators provides a natural Z+ -grading. Note
that an algebra isomorphism Ψ : Au → Av which respects the Z+ -grading is
determined by a linear map between the spans of the generators
Le1 , . . . , Len , Lf1 , . . . , Lfm . Here we use the same notation for the generators
of Au and Av . Such an isomorphism will be called graded.
We now consider two types of graded isomorphisms, namely, either bigraded, as in the following definition, or, in case n = m, bigraded after
relabeling generators.
Definition 5.1 (i) An isomorphism Ψ : Au → Av is said to be bigraded
isomorphism if there are unitary matrices A (n × n) and B (m × m)
such that
X
X
ai,j Lej , Ψ(Lfk ) =
bk,l Lfl .
Ψ(Lei ) =
j

l

(ii) If m = n and Ψ is a graded isomorphism such that
X
X
Ψ(Lei ) =
ai,j Lfj , Ψ(Lfk ) =
bk,l Lel
j

l

for n × n unitary matrices A and B then we say that Ψ is a graded
exchange isomorphism.
We write ΨA,B for the bigraded isomorphism (as in (i)) and Ψ̃A,B for the
graded exchange isomorphism.
P
P
Abusing notation, we write Ψ(ei ) = j ai,j ej instead of Ψ(Lei ) = j ai,j Lej
for a bigraded isomorphism (and similarly for the other expressions).
For unitary permutation matrices the following lemma was proved in [10,
Theorem 5.1(iii)].
Lemma 5.2

(i) If ΨA,B is a bigraded isomorphism then
(A ⊗ B)v = u(A ⊗ B)

(20)

where A ⊗ B is the mn × mn matrix whose (i, j), (k, l) entry is ai,k bj,l .
21

(ii) If m = n and Ψ̃A,B is a graded exchange isomorphism then
(A ⊗ B)ṽ = u(A ⊗ B)

(21)

where ṽ(i,j),(k,l) = v̄(l,k),(j,i).
Proof. Assume Ψ = ΨA,B is a bigraded isomorphism. For i, j,
X
X
X
Ψ(ei ⊗ fj ) = (
ai,k ek ) ⊗ (
bj,l fl ) =
(A ⊗ B)(i,j),(k,l)ek ⊗ fl =
k

X

l

k,l

(A ⊗ B)(i,j),(k,l) v(k,l),(r,t) ft ⊗ er =

k,l,r,t

X
r,t

((A ⊗ B)v)(i,j),(r,t) ft ⊗ er .

On the other hand,
X
X
u(i,j),(k,l)bl,t ak,r ft ⊗ er =
u(i,j),(k,l)fl ⊗ ek ) =
Ψ(ei ⊗ fj ) = Ψ(
k,l,t,r

k,l

X
t,r

(u(A ⊗ B))(i,j),(r,t) ft ⊗ er .

This proves equation (20). A similar argument can be used to verify equation
(21). 
Definition 5.3 If u, v are mn×mn unitary matrices and there exist unitary
matrices A and B satisfying (20), we say that u and v are product unitary
equivalent.
Now suppose that A and B are unitary matrices satisfying (20). The
same computation as in Lemma 5.2 shows that WA,B : E ⊗u F → E ⊗v F
defined by
X
WA,B (ei ⊗ fj ) =
(A ⊗ B)(i,j),(k,l) ek ⊗ fl
k,l

is a well defined unitary operator. Here the notation E ⊗u F indicates that
this is E ⊗ F as a subspace of F (n, m, u). Similarly, one defines a unitary
operator, also denoted WA,B , from E ⊗k ⊗ F ⊗l in F (n, m, u) to E ⊗k ⊗ F ⊗l in
F (n, m, v) by
WA,B (ei1 ⊗ * * * ⊗ eik ⊗ fj1 ⊗ * * * ⊗ fjl ) =
X
ai1 ,r1 * * * aik ,rk bj1 ,t1 * * * bjl ,tl er1 ⊗ * * * ⊗ erk ⊗ ft1 ⊗ * * * ⊗ ftl .
This gives a well defined unitary operator

WA,B : F (n, m, u) → F (n, m, v).
22

P
P
Lemma 5.4 For every i, j, write Aei =
k ai,k ek and Bfj =
l bj,l fl .
Then, for g1 , g2, . . . , gr in {e1 , . . . , en , f1 , . . . , fm },
WA,B (g1 ⊗ g2 ⊗ * * * ⊗ gr ) = Cg1 ⊗ Cg2 ⊗ * * * ⊗ Cgr

(22)

where Cgi = Agi if gi ∈ {e1 , . . . , en } and Cgi = Bgi if gi ∈ {f1 , . . . , fm }.
Proof. If the gi 's are ordered such that the first ones are from E and the
following vectors are from F , then the result is clear from the definition of
WA,B . Since we can get any other arrangement by starting with one of this
kind and interchanging pairs gl , gl+1 successively (with gl ∈ {e1 , . . . , en } and
gl+1 ∈ {f1 , . . . , fm }), it is enough to show that that if (22) holds for a given
arrangement of e's and f 's and we apply such an interchange, then it still
holds. So, we assume gl = ek , gl+1 = fs and we write g ′ = g1 ⊗ * * * ⊗ gl−1 ,
g ′′ = gl+2 ⊗ * * * ⊗ gr , Cg ′ = Cg1 ⊗ * * * ⊗ Cgl−1 and Cg ′′ = Cgl+2 ⊗ * * * ⊗ Cgr
and compute
WA,B (g ′ ⊗ fs ⊗ ek ⊗ g ′′ ) = WA,B (

X
i,j

ū(i,j),(k,s)g ′ ⊗ ei ⊗ fj ⊗ g ′′ ).

Using our assumption, this is equal to
X
X
X
ū(i,j),(k,s)Cg ′ ⊗ (
ai,t et ) ⊗ (
bj,q fq ) ⊗ Cg ′′ =
t

i,j

X

i,j,t,q

X

i,j,t,q,d,p

q

ū(i,j),(k,s)ai,t bj,q Cg ′ ⊗ et ⊗ fq ⊗ Cg ′′ =

ū(i,j),(k,s)ai,t bj,q v(t,q),(d,p) Cg ′ ⊗ fp ⊗ ed ⊗ Cg ′′ =

X

(u∗ )(k,s),(i,j)(A ⊗ B)(i,j),(t,q) v(t,q),(d,p) Cg ′ ⊗ fp ⊗ ed ⊗ Cg ′′ =
X
X
ak,d bs,p Cg ′ ⊗ fp ⊗ ed ⊗ Cg ′′ =
(A ⊗ B)(k,s),(d,p)Cg ′ ⊗ fp ⊗ ed ⊗ Cg ′′ =
d,p

d,p

′

completing the proof. 

Cg ⊗ Bfs ⊗ Aek ⊗ Cg ′′

The following lemma was proved in [10, Section 7] and it shows that the
necessary conditions of Lemma 5.2 are also sufficient conditions on A ⊗ B for
the existence of a unitarily implemented isomorphism ΨA,B .
23

Lemma 5.5 For unitary matrices A, B satisfying (20) and X ∈ Au , the
map
∗
X 7→ WA,B XWA,B
is the bigraded isomorphism ΨA,B : Au → Av . Moreover ΨA,B extends to
a unitary isomorphism Lu → Lv , and similar statements holds for graded
exchange isomorphisms (when m = n).
Proof. It will suffice to show the equality
ΨA,B (X)WA,B = WA,B X
for X = Lei and for X = Lfj . Let X = Lfj and apply both sides of the
equation to ei1 ⊗ * * * ⊗ eik ⊗ fj1 ⊗ * * * ⊗ fjl . Using Lemma 5.4, we get
ΨA,B (Lfj )WA,B (ei1 ⊗ * * * ⊗ eik ⊗ fj1 ⊗ * * * ⊗ fjl )
=

X
r

bj,r Lfr (Aei1 ⊗ * * * ⊗ Aeik ⊗ Bfj1 ⊗ * * * ⊗ Bfjl )

= Bfj ⊗ Aei1 ⊗ * * * ⊗ Aeik ⊗ Bfj1 ⊗ * * * ⊗ Bfjl
= WA,B (fj ⊗ ei1 ⊗ * * * ⊗ eik ⊗ fj1 ⊗ * * * ⊗ fjl )
= WA,B Lfj (ei1 ⊗ * * * ⊗ eik ⊗ fj1 ⊗ * * * ⊗ fjl ).
This proves the equality for X = Lfj . The proof for X = Lei is similar. 
At this point we drop our assumption that the set {n, m} is the same for
both algebras and write {n′ , m′ } for the dimensions associated with Av . We
shall see in Proposition 5.8 (and Remark 5.11(i)) that, if the algebras are
isomorphic, then necessarily {n, m} = {n′ , m′ }.
Given an isomorphism Ψ : Au → Av we get a homeomorphism θΨ : Ωu →
Ωv (as in the discussion preceeding Theorem 4.8). The arguments used in
the proof of Theorem 4.8 to show that part (3) implies part (1) apply also
to isomorphisms and thus, θΨ (0, 0) ∈ Ω0v .
Proposition 5.6 Let Ψ : Au → Av be an (algebraic) isomorphism. Then
θΨ (Ω0u ) = Ω0v and θΨ (Ω0u ∩ (Bn × Bm )) = Ω0v ∩ (Bn × Bm ).

24

Proof. Fix (z, w) in Ω0u and use Theorem 4.8 to get an automorphism Φ
of Au such that θΦ (0, 0) = (z, w). But then θΨ◦Φ (0, 0) = θΨ (z, w) and, as we
noted above, this implies that θΨ (z, w) ∈ Ω0v . It follows that θΨ (Ω0u ) ⊆ Ω0v
and, applying this to Ψ−1 , the lemma follows. 
Lemma 5.7 The map θΨ is a biholomorphic map.
Proof. The coordinate functions for θΨ are (z, w) 7→ α(z,w) (Ψ−1 (ei )) (and
(z, w) 7→ α(z,w)(Ψ−1 (fj ))) where α(z,w) is the character associated with (z, w)
by Proposition 3.1. For every Y ∈ C[F+
v ], α(z,w) (Y ) is a polynomial in (z, w)
(for (z, w) ∈ Ωv ) and, therefore, an analytic function. Each X ∈ Av is a norm
limit of elements in C[F+
v ] and, thus, α(z,w) (X) is an analytic function being
a uniform limit of analytic functions on compact subsets of Ωv . Hence, for
every (z, w) ∈ Ωv , there is a power series that converges in some, non empty,
circular, neighborhood C of (z, w) that represents α(z,w) (X) on C∩Ωv . Taking
for X the operators Ψ−1 (ei ) and Ψ−1 (fj ), we see that θ is analytic. The same
arguments apply to θ−1 . 
The facts in the following proposition obtained in [10] in the case of
permutation matrices.
Proposition 5.8 Let Ψ : Au → Av be an algebraic isomorphism and let
θΨ : Ωu → Ωv be the associated map between the character spaces. Suppose
θΨ (0, 0) = (0, 0). Then we have the following.
(1) {n, m} = {n′ , m′ } and we shall assume that n = n′ and m = m′
(interchanging E and F and changing u to u∗ if necessary).
(2) There are unitary matrices U (n×n) and V (m×m) such that θΨ (z, w) =
(Uz, V w) for (z, w) ∈ Ωu . (If n = m it is also possible that θΨ (z, w) =
(V w, Uz).)
(3) If Ψ is an isometric isomorphism, then Ψ is a bigraded isomorphism.
(Or, if m = n, it may be a graded exchange isomorphism).
Proof. The proof of Proposition 6.3 in [10] giving (1) and (2) in the
permutation case is based essentially on Schwarz's lemma for holomorphic
map from the unit disc. It applies without change to the case of unitary
matrices.
25

For (3) we may assume m = m′ and n = n′ . From (2) we have for each
Φ(Lei ) = LU ei + X where X is a sum of higher order terms. Since Φ(Lei ) is a
contraction and LU ei is an isometry it follows, as in the proof of Voiculescu's
theorem, that X = 0. Similarly, Φ(Lfj ) = LV fj and it follows that Φ is
bigraded. 
Since every graded isomorphism Ψ satisfies θΨ (0, 0) = (0, 0), we conclude
the following.
Corollary 5.9 Every graded isometric isomorphism is bigraded if n 6= m
and otherwise is either bigraded or is a graded exchange isomorphism.
Theorem 5.10 The following statements are equivalent for unitary matrices
u, v in Mn (C) ⊗ Mm (C).
(i) There is an isometric isomorphism Ψ : Au → Av .
(ii) There is a graded isometric isomorphism from Ψ : Au → Av .
(iii) The matrices u, v are product unitary equivalent or (in case n = m)
the matrices u, ṽ are product unitary equivalent, where ṽ(i,j),(k,l) = v̄(l,k),(j,i) .
(iv) There is an isometric w*-continuous isomorphism Γ : Lu → Lv .
Proof. Given Ψ in (i), let (z, w) = θΨ (0, 0). By Proposition 5.6 (z, w) lies in
the interior of Ω0v . By Theorem 4.8 there is a completely isometric automorphism Φ of Av such that θΦ (0, 0) = (z, w) and, therefore, θΦ−1 ◦Ψ (0, 0) = (0, 0).
By Proposition 5.8, Φ−1 ◦ Ψ is a graded isometric isomorphism and (ii) holds.
Lemma 5.2 shows that (ii) implies (iii) and Lemma 5.5 that (iii) implies (i).
Finally, (iii) implies (iv) follows from Lemma 5.5, and (iv) implies (ii) is
entirely similar to (i) implies (ii). 
Remark 5.11 The argument at the beginning of the proof of Theorem 5.10
shows that, whenever Au and Av are isomorphic, we have {n, m} = {n′ , m′ }.
Theorem 5.12 For n 6= m the isometric automorphisms of Au are of the
form ΨA,B Θz,w where (z, w) ∈ Ω0u and (A ⊗ B)u = u(A ⊗ B). In case n = m
the isometric automorphisms include, in addition, those of the form Ψ̃A,B Θz,w
where (A ⊗ B)ũ = u(A ⊗ B).

26

6
6.1

Special cases
The case n = m = 2

Even in the low dimensions n = m = 2 there are many isomorphism classes
and special cases. Note that the product unitary equivalence class orbit O(u)
of the 4 × 4 unitary matrix u takes the form
O(u) = {(A ⊗ B)u(A ⊗ B)∗ : A, B ∈ SU2 (C)},
and so the product unitary equivalence classes are parametrised by the set of
orbits, U4 (C)/Ad(SU2 (C) × SU2 (C)). This set admits a 10-fold parametrisation, since, as is easily checked, U4 (C) and SU2 (C)×SU2 (C) are real algebraic
varieties of dimension 16 and 6 respectively. It follows that the isometric isomorphism types of the algebras Au admit a 10 fold real parametrisation, with
coincidences only for pairs O(u), O(v) with u = ṽ
We now look at some special cases in more detail. Let d = dimKer(u−I).
Case I: d = 0
For every (z, w) ∈ B2 × B2 , we have (z, w) ∈ Ωu if and only if the vector
(z1 w1 , z1 w2 , z2 w1 , z2 w2 )t lies in Ker(u − I). Thus, in case I, Ωu is as small as
possible and is equal to
Ωmin := (B2 × {0}) ∪ ({0} × B2 ).
It follows from Lemma 3.4 that, in this case,
Ω0u = {(0, 0)}.
By Proposition 5.8 every isometric automorphism of Au is graded and the
isometric automorphisms of Au are given by pairs (A, B) of unitary matrices
such that A ⊗ B either commutes with u or intertwines u and ũ.
Case II: d = 1
When d = 1 it still follows from Lemma 3.4 that
Ω0u = {(0, 0)}
but now it is possible for Ωu to be larger than Ωmin . In fact, if the non zero
vector (a, b, c, d)t spanning Ker(u − I) satisfies ad 6= bc then Ωu = Ωmin but
27




a b
if ad = bc then the matrix
is of rank one and can be written as
c d
(z1 , z2 )t (w1 , w2). Thus, (z, w) ∈ Vu and Ωu contains some (z, w) with non
zero z and w.
Since Ω0u = {(0, 0)}, it is still true that isometric isomorphisms and automorphisms of these algebras are graded.
Case III: d = 2
When d = 2 it is possible that Ω0u will contain non zero vectors (z, w) but, as
Lemma 3.4 shows, it does not contain a vector with both z 6= 0 and w 6= 0.
All other possibilities may occur. For example write u1 , u2 and u3 for the
three diagonal matrices:
u1 = diag(1, −1, −1, 1), u2 = diag(1, −1, 1, −1)
and
u3 = diag(1, 1, −1, −1).

Using the definition of the core, we easily see that
Ω0u1 = {(0, 0)}, Ω0u2 = {(0, 0, w1, 0) : |w1 | ≤ 1}
and
Ω0u3 = {(z1 , 0, 0, 0) : |z1 | ≤ 1}.

Thus, the only isometric automorphisms of Au1 are graded, the isometric automorphisms of Au2 are formed by composing graded automorphisms
with automorphisms of the type described in Proposition 4.7 (with z = (0, 0)
and w = (w1 , 0)). Similarly, for the automorphisms of Au3 , we use Proposition 4.6.
Case IV: d = 3
In this case we are able to obtain an explicit 2-fold parametrization of the
isomorphism types of the algebra Au .
Every 4 × 4 unitary matrix u with dim(Ker(u − I)) = 3 is determined by
a unit eigenvector x and its (different from 1) eigenvalue. So that ux = λx,
kxk = 1, |λ| = 1 and λ 6= 1. Suppose u and v are product unitary equivalent;
that is
(A ⊗ B)u = v(A ⊗ B)
for unitary matrices A, B, and write x, λ for the unit eigenvector and eigenvalue of u. (Of course, x is determined only up to a multiple by a scalar
28

of absolute value 1). Then y = (A ⊗ B)x is a unit eigenvector of v with
eigenvalue λ. For unit vectors x, y (in C4 ) we write x ∼ y if there are unitary
(2 × 2) matrices A, B with y = (A ⊗ B)x. For the statement of the next
lemma recall that the entries of the vectors x and y in C4 are indexed by
{(i, j) : 1 ≤ i, j ≤ 2}.
Lemma 6.1 For a vector x = {x(i,j) } in C4 , write c(x) for the 2 × 2 matrix


x(1,1) x(1,2)
c(x) =
.
x(2,1) x(2,2)
Then x ∼ y if and only if there are unitary matrices A, B such that c(x) =
Ac(y)B. (In this case, we shall write c(x) ∼ c(y).)
Proof. Suppose y = (A⊗B)xP
for some unitary matricesP
A = (ai,j ) and B =
(bi,j ). Then c(y)i,j = y(i,j) = (A ⊗ B)(i,j),(k,l)x(k,l) = k,l ai,k bj,l c(x)k,l =
(Ac(x)B)i,j . 
 and diagonalizing |c(x)| =
 polar decomposition c(x)
 = U|c(x)|
Using the
a
0
a 0
= c(y) where y = (a, 0, 0, d)
V ∗ , we find that c(x) ∼
V
0 d
0 d
and a, d ≥ 0. Then a, d (the eigenvalues of |c(x)|) are uniquely determined
once we choose them√such that a ≤ d and, if kxk = 1, then a2 + d2 = 1
to
(so that 0 ≤ a ≤ 1/ 2 and a determines d). In this way, we associate
√
each unitary matrix u as above a pair (a, λ) with 0 ≤ a ≤ 1/ 2, λ 6= 1
and |λ| = 1. Using Lemma 6.1 and the discussion preceeding it, we have the
following.
Corollary 6.2 For every 4 × 4 unitary matrix u with dim(Ker(u −√I)) = 3,
there are numbers λ (with |λ| = 1 and λ 6= 1) and a (0 ≤ a ≤ 1/ 2) such
that u and v are product unitary equivalent if and only if they have the same
a, λ.
Proof. Let u and v be unitary matrices with dim(Ker(u − I)) = 3 and let
(a, λ), (b, μ) be the pairs associated to u and v (respectively) as above. Also
write x for the unit eigenvector of u associated to the eigenvalue λ and let y
be the unit eigenvector of v associated to μ.
Suppose u and v are product unitarily equivalent. Then they are unitary
equivalent and, thus, λ = μ. Write (A⊗B)u = v(A⊗B) for unitary matrices
29

A, B. As we saw above, y can be chosen to be (A ⊗ B)x so that x ∼ y and,
by Lemma 6.1, c(x) ∼ c(y). It follows that a = b.
Conversely, assume that a = b and λ = μ. Then c(x) ∼ c(y) and, thus,
x ∼ y so we can write y = (A ⊗ B)x for some unitary matrices A, B. Writing
v ′ = (A ⊗ B)u(A ⊗ B)∗ , we find that y is the unit eigenvector of v ′ associated
to λ. Thus v = v ′ , completing the proof. 
For every a, λ as in Corollary 6.2 we let u(a, λ) be the following 4 × 4
matrix.
(λ − 1)a2 + 1

0
u(a, λ) = 

0
(λ − 1)a(1 − a2 )1/2


0
1
0
0


0 (λ − 1)a(1 − a2 )1/2

0
0
.

1
0
2
0
λ + (1 − λ)a

It is a straightforward computation to verify that dim(Ker(u − I)) = 3 and
that λ is an eigenvalue of u(a, λ) with eigenvector (a, 0, 0, (1 − a2 )1/2 )t . Thus
the pair associated to u(a, λ) is a, λ and we have
Corollary 6.3 Every matrix u with dim(Ker(u − I)) = 3 is product
√ unitary
equivalent to a unique matrix of the form u(a, λ) (with 0 ≤ a ≤ 1/ 2, |λ| = 1
and λ 6= 1).
Using the definition of the core, we immediately get the following.
Proposition 6.4 If a = 0, |λ| = 1, λ 6= 1, then Ωu(0,λ) is the union
{(z1 , z2 , w1 , 0) : z ∈ B2 ; |w1| ≤ 1} ∪ {(z1 , 0, w1, w2 ) : w ∈ B2 ; |z1 | ≤ 1},
and
Ω0u(0,λ) = {(z1 , 0, w1 , 0) : |z1 | ≤ 1; |w1| ≤ 1}.
If a 6= 0 then
Ωu(a,λ) = {(z1 , z2 , w1 , w2) : az1 w1 + (1 − a2 )1/2 z2 w2 = 0, (z, w) ∈ B2 × B2 }
and
Ω0u(a,λ) = {(0, 0)}.

30

Proof. The space Ωu(a,λ) consists of points (z, w) for which
(z1 w1 , z1 w2 , z2 w1 , z2 w2 )t = u(a, λ)(z1 w1 , z1 w2 , z2 w1 , z2 w2 )t ,
that is, for which
((λ − 1)a2 + 1)z1 w1 + (λ − 1)a(1 − a2 )1/2 z2 w2 = z1 w1 ,

(λ − 1)a(1 − a2 )1/2 z1 w1 + (λ + (λ − 1)a2 )z2 w2 = z2 w2 .

If a = 0 this implies z2 w2 = 0, while if a 6= 0 then (z1 w1 , 0, 0, z2w2 ) is a fixed
vector for u(a, λ) and so for some scalar μ (z1 w1 , z2 w2 ) = μ((1 − a2 )1/2 , −a).
The descriptions of Ωu(a,λ) follows.
From the definition of the core and the fact that here C12 = C21 = 0 and


(λ − 1)
0
,
C11 =
0
(λ − 1)a(1 − a2 )1/2


(λ − 1)a(1 − a2 )1/2
0
,
C22 =
0
(λ − 1) + (λ − 1)a2

we see that for a = 0 we have w2 = z2 = 0 while for a 6= 0, z1 = z2 = w1 =
w2 = 0. 
Recall that, for a 4 × 4 unitary matrix v we defined the matrix ṽ by
ṽ(i,j),(k,l) = v̄(l,k),(j,i) and showed (Corollary 5.10) that Au and Av are isometrically isomorphic if and only if either u and v or u and ṽ are product unitary
equivalent.
^
Now, it is easy to check that u(a,
λ) = u(a, λ̄) and so, using Proposition 3.3 and previous results, we obtain the following.
√
Theorem 6.5 Let 0 ≤ a, b ≤ 1/ 2, |λ| = |μ| = 1, λ, μ 6= 1. Then

(1) Au(a,λ) and Au(b,μ) are isometrically isomorphic if and only if a = b and
λ equals either μ or μ̄.
(2) When a 6= 0 the isometric automorphisms of Au(0,λ) are all bigraded
(3) If a = 0 then there are isometric isomorphisms that are not graded

Case V: d = 4
This is the case where u = I. We have Ωu = Ω0u = Bn × Bm and the isometric
automorphisms are obtained by composing graded automorphisms and the
automorphisms described by Proposition 4.6, Proposition 4.7.
31

6.2

Permutation unitary relation algebras

With more structure assumed for a class of unitaries u it may be possible to
derive an appropriately more definitive classification of the algebras Au . We
indicate this now for the class of permutation unitaries. A fuller discussion
is in [10].
Let θ ∈ S4 , viewed as a permutation of the product set {1, 2} × {1, 2} =
{11, 12, 21, 22}. Associate with θ the matrix uθ = u(i,j),(k,l) where u(i,j),(k,l) =
1 if (k, l) = θ(i, j) and is zero otherwise. If τ ∈ S4 is product conjugate to θ in
the sense that τ = σθσ −1 with σ in S2 × S2 , then it follows that uτ and uθ are
product unitarily equivalent. Thus we need only consider product conjugacy
classes. It turns out that these classes are the same as the product unitary
equivalence classes of the matrices uθ .
It can be helpful to view a permutation θ in Snm as a permutation of the
entries of an n × m rectangular array, since product conjugacy corresponds
to conjugation through row permutations and column permutations. Considering this for n = m = 2 one can verify firstly that there are at most
9 isomorphism types for the algebras At heta corresponding to the following
permutations:
θ1 = id, θ2 = (11, 12), θ3 = (11, 22),
−1
θ4a = (11, 22, 12), θ4b = θ4a
= (11, 12, 22), θ5 = ((11, 12), (21, 22)),

θ6 = ((11, 22), (12, 21)), θ7 = (11, 12, 22, 21), θ8 = (11, 12, 21, 22).
The Gelfand spaces of the algebras Aθ (and Lθ ) distinguish all of these algebras except for the pairs {θ4a , θ4b } and {θ7 , θ8 }. However, one can verify
in both cases that neither the pair u, v nor the pair u, ṽ are product unitary
equivalent. Theorem 5.10 now applies to yield the following result from [10].
Theorem 6.6 For n = m = 2 there are 9 isometric isomorphism classes for
the algebras Aθ and for the algebras Lθ .
To a higher rank graph (Λ, d) in the sense of Kumjian and Pask [6] one can
associate nonself-adjoint Toeplitz algebra AΛ , LΛ , as in Kribs and Power [5].
In the single vertex rank 2 case it is easy to see that AΛ is equal to the algebra
Au for some permutation matrix u = θ in Snm . Thus Theorem 5.10 classifies
these algebras in terms of product unitary equivalence restricted to Snm as
stated formally in the next theorem. In the rank 2 case this is a significant
improvement on the results in [10] which, although covering general rank,
32

were restricted to the case of trivial core for the character space. With θ̃ the
permutation for the permutation matrix ũθ (which corresponds to generator
exchange) we have:
Theorem 6.7 Let Λ1 and Λ2 be single vertex 2-graphs with relations determined by the permutations θ1 and θ2 . Then the rank 2 graph algebras
AΛ1 , AΛ2 are isometrically isomorphic if and only if the pair θ1 , θ2 or the
pair θ1 , θ̃2 are product unitary equivalent
It is natural to expect that as in the (2, 2) case product unitary equivalence will correspond to product conjugacy.

7

Au as a subalgebra of a tensor algebra

Let En be the Toeplitz extension of the Cuntz algebra On and write H for
the Fock space associated with E (that is, H = C ⊕ E ⊕ (E ⊗ E) ⊕ * * *).
Note that En acts naturally on H ( by the "shift" or "creation" operators
Li = Lei , 1 ≤ i ≤ n). In fact, Le1 , . . . , Len generate En as a C ∗ -algebra.
Consider also the space F (F )⊗H = H⊕(F ⊗H)⊕((F ⊗F )⊗H)⊕* * *. This
space is isomorphic to F (E, F, u) and we write w : F (F ) ⊗ H → F (E, F, u)
for the isomorphism. It will be convenient to write wk for the restriction of
w to the summand F ⊗k ⊗ H (which is an isomorphism onto its image). Note
that, for a fixed k, {wk∗ Lei wk : 1 ≤ i ≤ n } is a set of n isometries with
orthogonal ranges. Thus it defines a representation ρk of En on F ⊗k ⊗H (with
ρk (Lei ) = wk∗ Lei wk ). (Note that we are using Lei for the creation operators
both on H and on F (E, F, u). P
This should cause no confusion). We also
write ρ∞ for the representation k ⊕ρk of En on F (F ) ⊗ H (where ρ0 is the
representation of En on H).
Let X be the column space Cm (En ). This is a C ∗ -module over En . As a
vector space it is the direct sum of m copies of En . The right module action
of En on X isPgiven by (ai ) * b = (ai b) and the En -valued inner product is
h(ai ), (bi )i = i a∗i bi . For every 1 ≤ i ≤ n, we write S̃i for the operator in
L(X) defined by
X
S̃i (aj )m
=
(
u(i,j),(k,l)Lek aj )m
j=1
l=1 .
j,k

33

Note that
h(

X

u(i,j),(k,l)Lek aj )m
l=1 , (

j,k

X
j ′ ,k ′

X

u(i,j ′ ),(k′ ,l) Lek′ bj ′ )m
l=1 i =

ū(i,j),(k,l)a∗j L∗ek Lek′ bj ′ u(i,j ′ ),(k′ ,l) =

j,j ′ ,k,k ′,l

X

(uu∗)(i,j ′ ),(i,j) a∗j bj ′ =

X

a∗j bj

j

j,j ′

= h(aj ), (bj ′ )i.

Thus S̃i is an isometry. A similar computation shows that these isometries
have orthogonal ranges and, thus, this family defines a ∗ -homomorphism
φ : En → L(X), with φ(Lei ) = S̃i , 1 ≤ i ≤ n, making X a C ∗ -correspondence
over En (in the sense of [8] and [7]). Once we have a correspondence we can
form X ⊗X and, more generally, X ⊗k . Recall that to define X ⊗X one defines
the sesquilinear form hx⊗y, x′ ⊗y ′ i = hy, φ(hx, x′i)y ′i on the algebraic tensor
product and then lets X ⊗ X be the Hausdorff completion. The right action
of En on X ⊗ X is (x ⊗ y) * a = x ⊗ (y * a) and the left action is given by the
map φ2 .
φ2 (a)(x ⊗ y) = φ(a)x ⊗ y.
The definition of X ⊗k is similar (and the left action map is denoted φk )
For k = 0 weP
set X ⊗0 = En and φ0 is defined by left multiplication . Also
write φ∞ for k ⊕φk , the left action of En on F (X).
One can then define the Hilbert space X ⊗k ⊗En H by defining the sesquilinear form hx⊗h, y ⊗ki = hh, hx, yiki (x, y ∈ X ⊗k ) and applying the Hausdorff
completion.
Now define the map
v : X ⊗En H → F ⊗ H
by setting
v((ai ) ⊗ h) =

X
i

fi ⊗ ai h.

It is straightforward to check that this map is a well defined Hilbert space
isomorphism. By induction, we also define maps vk : X ⊗k ⊗En H → F ⊗k ⊗ H
by
X
vk+1 ((aj ) ⊗ z) =
fj ⊗ vk ((φk (aj ) ⊗ IH )z)
(23)
j

34

for z ∈ X ⊗k ⊗En H and v0 is the identity map from En ⊗En H (which is
isomorphic to H) and F ⊗0 ⊗ H = H. Assume that vk is a Hilbert space
isomorphism of X ⊗k ⊗En H onto F ⊗k ⊗ H and compute, for (aj ), (bj ) ∈ X
and z, z ′ ∈ X ⊗k ⊗ H,
X
hvk+1 ((aj )⊗z), vk+1 ((bj )⊗z)i =
hfj ⊗vk ((φk (aj )⊗IH )z), fj ′ ⊗vk ((φk (bj ′ )⊗IH )z ′ )i =
j,j ′

X
j

hvk ((φk (aj ) ⊗ IH )z), vk ((φk (bj ) ⊗ IH )z ′ )i =
X
hz, (φk (a∗j bj ) ⊗ IH )z ′ )i =
j

h(aj ) ⊗ z, (bj ) ⊗ z ′ i.
Thus, by induction, each map vk is a Hilbert space isomorphism and, summing up, we get a Hilbert space isomorphism
X
⊕vk : F (X) ⊗En H → F (F ) ⊗ H.
v∞ :=
k

Lemma 7.1 v∞ is a Hilbert space isomorphism and intertwines the actions
of En . That is,
v∞ ◦ (φ∞ (a) ⊗ IH ) = ρ∞ (a) ◦ v∞
for a ∈ En .
Proof. We show that, for every p ≥ 0 and a ∈ En , we have
vp ◦ (φp (a) ⊗ IH ) = ρp (a) ◦ vp .

(24)

The proof will proceed by induction on p. For p = 0 this is clear so we now
assume that it holds for p. For 1 ≤ i ≤ n, (aj ) ∈ X and z ∈P
X ⊗p ⊗H, we have
vp+1 ((φp+1(Lei ) ⊗ IH )((aj ) ⊗ z)) = vp+1 (φ(Lei )(aj ) ⊗ z) = l,k,j u(i,j),(k,l)fl ⊗
vp ((φp (Lek aj ) ⊗ IH )z). Using the induction hypothesis, this is equal to
X
X
u(i,j),(k,l)fl ⊗ ρp (Lek )ρp (aj )vp z =
u(i,j),(k,l)fl ⊗ wp∗ Lek wp ρp (aj )vp z =
l,k,j

l,k,j

∗
w∞

X
l,k,j

∗
u(i,j),(k,l)fl ⊗ ek ρp (aj )vp z = w∞

35

X
j

ei ⊗ fj ⊗ ρp (aj )vp z =

∗
ρp+1 (Lei )wp+1

X
j

fj ⊗ ρp (aj )vp z.

P
∗
Using the induction hypothesis again, we get ρp+1 (Lei )wp+1
j fj ⊗vp ((φp (aj )⊗
IH )z) = ρp+1 (Lei )vp+1 ((aj )⊗z). This proves (24) for p+1 and the generators
∗
of En . Since both ρp+1 and vp+1 (φp+1 (*)⊗IH )vp+1
are ∗ -homomorphisms, (24)
holds for p + 1 and every a ∈ En , completing the induction step. Thus, (24)
holds for every p and this implies the statement of the lemma. 
Write δl for the vector (aj ) in X such that al = I and aj = 0 if l 6= j.
The tensor algebra T+ (X) is generated by the operators Tδl (where Tδl is the
creation operator on F (X) associated with δl ) and the C ∗ -algebra φ∞ (En ).
The latter algebra is generated (as a C ∗ -algebra) by the operators φ∞ (Li )
where {Li } is the set of generators of En .
We have
Lemma 7.2 For every 1 ≤ i ≤ n and 1 ≤ j ≤ m and k ≥ 0,
(i) w ◦ vk ◦ (φ∞ (Li ) ⊗ IH ) = Lei ◦ w ◦ vk .
(ii) w ◦ vk+1 ◦ (Tδj ⊗ IH ) = Lfj ◦ w ◦ vk .
Proof. Part (i) follows from (24) and part (ii) from (23) (with δj in place
of (aj )). 
Recalling that w ◦ v∞ is a unitary operator mapping F (X) ⊗ H onto
F (E, F, u), we get
Theorem 7.3 (1) The algebra Au is unitarily isomorphic to the (norm
closed) subalgebra of the tensor algebra T+ (X) that is generated by
{φ∞ (Li ), Tδj : 1 ≤ i ≤ n, 1 ≤ j ≤ m}.
(2) The (norm closed) subalgebra of B(F (E, F, u)) that is generated by
{Lei , L∗ei , Lfj : 1 ≤ i ≤ n, 1 ≤ j ≤ m } is unitarily isomorphic to the
tensor algebra T+ (X) (and contains Au ).
(2) The (norm closed) subalgebra of B(F (E, F, u)) that is generated by
{Lei , L∗fj , Lfj : 1 ≤ i ≤ n, 1 ≤ j ≤ m } is unitarily isomorphic to a
tensor algebra T+ (Y ) (and contains Au ).

36

Proof.
Parts (1) and (2) follow from Lemma 7.2. For part (3), note
that one can interchange the roles of E and F . More precisely, one defines
the C ∗ -module Y over EmPto be Y = Cn (Em ) and the left action of Em on
Y by φY (Lfl )(bk )nk=1 = ( j,k ū(i,j),(k,l)Lfj bk )ni=1 . This makes Y into a C ∗ correspondence over Em and the rest of the proof proceeds along similar lines
as above. 
Suppose m = 1. Then X is the correspondence
associated with the
Pn
automorphism α of En given by mapping Ti to j=1 ui,j Tj (note that u, in
this case, is an n × n matrix). The tensor algebra T+ (X) is the analytic
crossed product En ×α Z+ and Au is unitarily isomorphic to the subalgebra
of this analytic crossed product that can be written An ×α Z+ . One can also
embed Au in T+ (Y ) (as in Corollary 7.3(3)). Here Em is simply
the (classical)
P
Toeplitz algebra T and Y = Cn (T ) with φY (Tz )(bk )k = ( k ūi,k Tz bk )i (where
Tz is the generator of T ).
Remark 7.4 Since the automorphisms Θz,w and ΨA,B of Au are both unitarily implemented, they can be extended to T+ (X). It is easy to check that
they map T+ (X) into itself and, thus, are automorphisms of T+ (X). Hence,
at least when n 6= m, every automorphism of Au can be extended to an automorphism of the tensor algebra T+ (X) that contains it (see Theorem 5.12).

References
[1] K.R. Davidson, Free Semigroup Algebras : a survey. Systems, approximation, singular integral operators, and related topics (Bordeaux, 2000),
209–240, Oper. Theory Adv. Appl. 129, Birkhauser, Basel, 2001.
[2] K.R. Davidson and D.R. Pitts, The algebraic structure of noncommutative analytic Toeplitz algebras, Math. Ann. 311 (1998), 275-303.
[3] N. Fowler, Discrete product systems of Hilbert bimodules, Pacific J.
Math. 204 (2002), 335-375.
[4] E. Katsoulis, D.W. Kribs, Isomorphisms of algebras associated with directed graphs, Math. Ann., 330 (2004), 709-728.
[5] D.W. Kribs and S.C. Power, The H ∞ algebras of higher rank graphs,
Math. Proc. of the Royal Irish Acad., 106 (2006), 199-218.
37

[6] A. Kumjian and D. Pask, Higher rank graph C* -algebras, New York J.
Math. 6 (2000), 1–20.
[7] P. Muhly and B. Solel, Tensor algebras over C ∗ -correspondences (Representations, dilations, and C ∗ -envelopes), J. Functional Anal. 158
(1998), 389–457.
[8] M. Pimsner, A class of C ∗ -algebras generalizing both Cuntz-Krieger
algebras and crossed products by Z, in Free Probability Theory, D.
Voiculescu, Ed., Fields Institute Communications 12, 189-212, Amer.
Math. Soc., Providence, 1997.
[9] G. Popescu, Von Neumann inequality for (B(H)n )1 , Math. Scand.68
(1991), 292-304.
[10] S.C. Power, Classifying higher rank analytic Toeplitz algebras, preprint
2006, preprint Archive no., math.OA/0604630.
[11] B. Solel, You can see the arrows in a quiver algebra, J. Australian Math.
Soc., 77 (2004), 111-122.
[12] B. Solel, Regular dilations of representations of product systems, preprint
Archive no., math.OA/0504129.
[13] B. Solel, Representations of product systems over semigroups and dilations of commuting CP maps, J. Funct. Anal.235 (2006), 593-618.
[14] D. Voiculescu, Symmetries of some reduced free product C ∗ -algebras,
Lect. Notes Math. 1132, 556-588, Springer-Verlag, New York 1985.

38

