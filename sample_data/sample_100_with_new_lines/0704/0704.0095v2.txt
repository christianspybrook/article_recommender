arxiv07040095v2 mathgr 10 apr 2012
geometry of locally compact groups of
polynomial growth and shape of large balls
emmanuel breuillard
abstract we show that any locally compact group g with polynomial growth
is weakly commensurable to some simply connected solvable lie group s the
lie shadow of g we then study the shape of large balls and show generalizing work of p pansu that after a suitable renormalization they converge to
a limiting compact set which is isometric to the unit ball for a leftinvariant
subfinsler metric on the socalled graded nilshadow of s as byproducts we
obtain asymptotics for the volume of large balls we prove that balls are folner
and hence that the ergodic theorem holds for all ball averages along the way
we also answer negatively a question of burago and margulis 7 on asymptotic
word metrics and recover some results of stoll 33 of the rationality of growth
series of heisenberg groups
contents
1 introduction
2 quasinorms and the geometry of nilpotent lie groups
3 the nilshadow
4 periodic metrics
5 reduction to the nilpotent case
6 the nilpotent case
7 locally compact g and proofs of the main results
8 coarsely geodesic distances and speed of convergence
9 appendix the heisenberg groups
references
1 introduction
11 groups with polynomial growth let g be a locally compact group with
left haar measure volg  we will assume that g is generated by a compact symmetric subset  classically g is said to have polynomial growth if there exist
c  0 and k  0 such that for any integer n  1
volg n   c  nk 
date april 2012
emmanuel breuillard
where n        is the nfold product set another choice for  would only
change the constant c but not the polynomial nature of the bound one of the
consequences of the analysis carried out in this paper is the following theorem
theorem 11 volume asymptotics let g be a locally compact group with polynomial growth and  a compact symmetric generating subset of g then there
exists c  0 and an integer dg  0 depending on g only such that the
following holds
volg n 
lim
ndg
this extends the main result of pansu 27 the integer dg coincides with
the exponent of growth of a naturally associated graded nilpotent lie group the
asymptotic cone of g and is given by the bassguivarch formula 4 below
the constant c will be interpreted as the volume of the unit ball of a subriemannian finsler metric on this nilpotent lie group theorem 11 is a byproduct of our study of the asymptotic behavior of periodic pseudodistances on g
that is pseudodistances that are invariant under a cocompact subgroup of g and
satisfy a weak kind of the existence of geodesics axiom see definition 41
our first task is to get a better understanding of the structure of locally compact
groups of polynomial growth guivarch 21 proved that locally compact groups
of polynomial growth are amenable and unimodular and that every compactly
generated1 closed subgroup also has polynomial growth
guivarch 21 and jenkins 15 also characterized connected lie groups with
polynomial growth a connected lie group has polynomial growth if and only if
it is of type r that is if for all x  lies adx has only purely imaginary
eigenvalues such groups are solvablebycompact and any connected nilpotent
lie group is of type r
it is much more difficult to characterize discrete groups with polynomial growth
and this was done in a celebrated paper of gromov 17 proving that they are
virtually nilpotent losert 24 generalized gromovs method of proof and showed
that it applied with little modification to arbitrary locally compact groups with
polynomial growth in particular he showed that they contain a normal compact
subgroup modulo which the quotient is a not necessarily connected lie group
we will prove the following refinement
theorem 12 lie shadow let g be a locally compact group of polynomial
growth then there exists a connected and simply connected solvable lie group s
of type r which is weakly commensurable to g we call such a lie group a lie
shadow of g
two locally compact groups are said to be weakly commensurable if up to
moding out by a compact kernel they have a common closed cocompact subgroup
more precisely we will show that for some normal compact subgroup k gk has
1in fact it follows from the gromovlosert structure theory that every closed subgroup is
compactly generated
asymptotic shape of balls in groups with polynomial growth
a cocompact subgroup hk which can be embedded as a closed and cocompact
subgroup of a connected and simply connected solvable lie group s of type r
we must be aware that being weakly commensurable is not an equivalence
relation among locally compact groups unlike among finitely generated groups
additionally the lie shadow s is not unique up to isomorphism eg z3 is a
cocompact lattice in both r3 and the universal cover of the group of motions of
the plane
we cannot replace the word solvable by the word nilpotent in the above theorem we refer the reader to example 79 for an example of a connected solvable
lie group of type r without compact normal subgroups which admits no cocompact nilpotent subgroup in fact this is typical for lie groups of type r so
in the general locally compact case or just the lie case groups of polynomial
growth can be genuinely not nilpotent unlike what happens in the discrete case
there are important differences between the discrete case and the general case
for example we will show that no rate of convergence can be expected in theorem
11 when g is solvable not nilpotent while some polynomial rate always holds in
the nilpotent discrete case 9
theorem 12 will enable us to reduce most geometric questions about locally
compact groups of polynomial growth and in particular the proof of theorem
11 to the connected lie group case observe also that theorem 12 subsumes
gromovs theorem on polynomial growth because it is not hard to see that a
cocompact lattice in a solvable lie group of polynomial growth must be virtually
nilpotent see remark 78 of course in the proof we make use of gromovs
theorem in its generalized form for locally compact groups due to losert the rest
of the proof combines ideas of y guivarch d mostow and a crucial embedding
theorem of hc wang it is given in paragraph 71 and is largely independent of
the rest of the paper
12 asymptotic shapes the main part of the paper is devoted to the asymptotic behavior of periodic pseudodistances on g we refer the reader to definition
41 for the precise definition of this term suffices it to say now that it is a class of
pseudodistances which contains both leftinvariant word metrics on g and geodesic
metrics on g that are leftinvariant under cocompact subgroup of g
theorem 12 enables us to assume that g is a cocompact subgroup of a simply
connected solvable lie group s and rather than looking at pseudodistances on g
we will look at pseudodistances on s that are leftinvariant under a cocompact
subgroup h more precisely a direct consequence of theorem 12 is the following
proposition 13 let g be a locally compact group with polynomial growth and 
a periodic metric on g then g  is 1 cquasiisometric to s s  for some
finite c  0 where s is a connected and simply connected solvable lie group of
type r and s some periodic metric on s
recall that two metric spaces x dx  and y dy  are called 1 cquasiisometric
if there exists a map   x  y such that any y  y is at distance at most c
from some element in the image of  and if dy x x   dx x x   c for
all x x  x
emmanuel breuillard
in the case when s is rd and h is zd  it is a simple exercise to show that any
periodic pseudodistance is asymptotic to a norm on rd  ie e x kxk  1 as
x   where kxk  lim n1 e nx is a well defined norm on rd  burago in 6
showed a much finer result namely that if  is coarsely geodesic then e xkxk
is bounded when x ranges over rd  when s is a nilpotent lie group and h a lattice
in s then pansu proved in his thesis 27 that a similar result holds namely that
e x x  1 for some unique only after a choice of a oneparameter group of
dilations homogeneous quasinorm x on the nilpotent lie group however we
show in section 8 that it is not true in general that e x  x stays bounded
even for finitely generated nilpotent groups thus answering a question of burago
see also gromov 20 our main purpose here will be to extend pansus result
to solvable lie groups of polynomial growth
as was first noticed by guivarch in his thesis 21 when dealing with geometric
properties of solvable lie groups it is useful to consider the socalled nilshadow of
the group a construction first introduced by auslander and green in 2 according to this construction it is possible to modify the lie product on s in a natural
way by so to speak removing the semisimple part of the action on the nilradical
in order to turn s into a nilpotent lie group its nilshadow sn  the two lie
groups have the same underlying manifold which is diffeomorphic to rn  only a
different lie product they also share the same haar measure this semisimple
part is a commutative relatively compact subgroup t s of automorphisms of s
image of s under a homomorphism t  s  auts the new product g  h is
defined as follows by twisting the old one g  h by means of t s
g  h  g  t g 1 h
the two groups s and sn are easily seen to be quasiisometric and this is why any
locally compact group of polynomial growth g is quasiisometric to some nilpotent
lie group in particular their asymptotic cones are bilipschitz the asymptotic
cone of a nilpotent lie group is a certain associated graded nilpotent lie group
endowed with a left invariant geodesic distance or carnot group the graded
group associated to sn will be called the graded nilshadow of s section 3 will be
devoted to the construction and basic properties of the nilshadow and its graded
group
in this paper we are dealing with a finer relation than quasiisometry we will
be interested in when do two left invariant or periodic distances are asymptotic2
 1 when g   in particular for every locally
in the sense that dd21 eg
compact group g with polynomial growth we will identify its asymptotic cone
up to isometry and not only up to quasiisometry or bilipschitz equivalence see
corollary 19 below one of our main results is the following
2yet a finer equivalence relation is 1 cquasiisometry ie being at bounded distance in
gromovhausdorff metric classifying periodic metrics up to this kind of equivalence is much
harder
asymptotic shape of balls in groups with polynomial growth
theorem 14 main theorem let s be a simply connected solvable lie group
with polynomial growth let x y be periodic pseudodistance on s which is invariant under a cocompact subgroup h of s see def 41 on the manifold s
one can put a new lie group structure which turns s into a stratified nilpotent lie
group the graded nilshadow of s and a subfinsler metric d x y on s which is
leftinvariant for this new group structure such that
e g
d e g
as g   in s moreover every automorphism in t h is an isometry of d 
the reader who wishes to see a simple illustration of this theorem can go directly
to subsection 81 where we have treated in detail a specific example of periodic
metric on the universal cover of the groups of motions of the plane
the new stratified nilpotent lie group structure on s given by the graded
nilshadow comes with a oneparameter family of socalled homogeneous dilations
t t0  it also comes with an extra group of automorphisms namely the image
of h under the homomorphism t  this yields automorphisms of s for both the
original group structure on s and the new graded nilshadow group structure
moreover the dilations t t0 are automorphisms of the graded nilshadow and
they commute with t h
a subfinsler metric is a geodesic distance which is defined exactly as subriemannian or carnotcaratheodory metrics on carnot groups are defined see eg
25 except that the norm used to compute the length of horizontal paths is not
necessarily a euclidean norm we refer the reader to section 21 for a precise
definition
in theorem 14 the subfinsler metric d is left invariant for the new lie structure on s and it is also invariant under all automorphisms in t h these form
a relatively compact commutative group of automorphisms moreover it satisfies
the following pleasing scaling law
d t x t y  td x y t  0
the proof of theorem 14 splits in two important steps the first is a reduction
to the nilpotent case and is performed in section 5 using a double averaging
of the pseudodistance  over both k  t h and sh we construct an associated pseudodistance which is periodic for the nilshadow structure on s ie
leftinvariant by a cocompact subgroup for this structure and we prove that it
is asymptotic to the original  this reduces the problem to nilpotent lie groups
the key to this reduction is the following crucial observation that unipotent automorphisms of s induce only a sublinear distortion forcing the metric  to be
asymptotically invariant under t h the second step of the proof assumes that
s is nilpotent this part is dealt with in section 6 and is essentially a reformulation of the arguments used by pansu in 27
emmanuel breuillard
incidently we stress the fact that the generality in which section 6 is treated
ie for general coarsely geodesic and even asymptotically geodesic periodic metrics is necessary to prove even the most basic case ie word metrics of theorem
14 for nonnilpotent solvable groups so even if we were only interested in the
asymptotics of left invariant word metrics on a solvable lie group of polynomial
growth s we would still need to understand the asymptotics of arbitrary coarsely
geodesic left invariant distances and not only word metrics on nilpotent lie
groups this is because the new pseudodistance obtained by averaging see 30
is no longer a word metric
the subfinsler metric d e x in the above theorem is induced by a certain
t hinvariant norm on the first stratum m1 of the graded nilshadow which
is t hinvariant complementary subspace of the commutator subalgebra of the
nilshadow this norm can be described rather explicitly as follows
recall that we have3 a canonical map 1  s  m1  which is a group homomorphism for both the nilshadow and graded nilshadow structures then
1 h
 h  hf 
cvxhull
v  m1  kvk  1 
e h
f s
where the right hand side is the intersection over all compact subsets f of s of
the closed convex hull of the points 1 he h for h  hf 
figure 1 gives an illustration of the limit shape corresponding to the word
metric on the 3dimensional discrete heisenberg group with standard generators
we explain in the appendix how one can compute explicitly the geodesics of the
limit metric and the limit shape in this example
when s itself is nilpotent to begin with and  is in restriction to h the
word metric associated to a symmetric compact generating set  of h namely
 e h  infn  n h  n  the above norm takes the following simple form
v  m1  kvk  1  cvxhull 1    
for instance in the special case when h is a torsionfree finitely generated nilpotent group with generating set  and s is its malcev closure the unit ball
v  m1  kvk  1 is a polyhedron in m1  this was pansus description in
however when s is not nilpotent and is equipped with a word metric  on
a cocompact subgroup then the determination of the limit shape ie the determination of the limit norm k  k on the abelianized nilshadow is much more
difficult clearly k  k is kinvariant and it is a simple observation that the unit
ball for k  k is always contained in the convex hull of the korbit of 1 
3the subspace m can be identified with the abelianized nilshadow or abelianized graded
nilshadow by first identifying the nilshadow with its lie algebra via the exponential map and
then projecting modulo the commutator subalgebra the map does not depend on the choice
involved in the construction of the nilshadow see also remark 37
asymptotic shape of balls in groups with polynomial growth
nevertheless the unit ball is typically smaller than that unless  was kinvariant
to begin with
in general it would be interesting to determine whether there exists a simple
description of the limit shape of an arbitrary word metric on a solvable lie group
with polynomial growth we refer the reader to section 8 and paragraph 82 for an
example of a class of word metrics on the universal cover of the group of motions
of the plane for which we were able to compute the limit shape
another byproduct of theorem 14 is the following result
corollary 15 asymptotic shape let s be a simply connected solvable lie
group with polynomial growth and h a cocompact subgroup let  be an hperiodic pseudodistance on s then in the hausdorff metric
lim  1 b t  c
where c is a t hinvariant compact neighborhood of the identity in s b t is
the ball of radius t in s and t t0 is a oneparameter group of dilations on s
equipped with the graded nilshadow structure moreover c  g  s d e g  1
is the unit ball of the limit subfinsler metric from theorem 14
proof by theorem 14 for every   0 we have bd tt  b t  bd tt
if t is large enough since  1 bd t  c for all t  0 we are done
combining this with theorem 12 we also get the following corollary of which
theorem 11 is only a special case with  the word metric associated to the generating set 
corollary 16 volume asymptotics suppose that g is a locally compact group
with polynomial growth and  is a periodic pseudodistance on g let b t be
the ball of radius t in g ie b t  x  g e x  t then there exists a
constant c  0 such that the following limit exists
volg b t
tdg
lim
here dg is the integer dsn  the socalled homogeneous dimension of the
nilshadow sn of a lie shadow s of g obtained by theorem 12 and is given by
the bassguivarch formula
dsn  
dimc k sn 
c k s
where
n k is the descending central series of sn 
the limit c is equal to the volume vols c of the limit shape c from corollary
15 once we make the right choice of haar measure on a lie shadow s of g let
us explain this choice recall that according to theorem 12 gk admits a cocompact subgroup hk which embeds cocompactly in s starting with a haar
measure volg on g we get a haar measure on gk after fixing the haar measure
of k to be of total mass 1 and we may then choose a haar measure on hk so
that the compact quotient gh has volume 1 finally we choose the haar measure
emmanuel breuillard
figure 1 the asymptotic shape of large balls in the cayley graph
of the heisenberg group hz  hx yx x y  y x y  1i
viewed in exponential coordinates
on s so that the other compact quotient shk has volume 1 this gives the
desired haar measure vols such that c  vols c
note that haar measure on s is also invariant under the group of automorphisms t s and is thus left invariant for the nilshadow structure on s it is also
left invariant for the graded nilshadow structure in both exponential coordinates
of the first kind on sn  and of the second kind as in lemma 310 haar measure
is just lebesgue measure
in the case of the discrete heisenberg group of dimension 3 equipped with the
word metric given by the standard generators it is possible to compute the constant c and the volume of the limit shape as shown in figure 1 in this case the
volume is 31
72 see the appendix the 5dimensional heisenberg group can also be
worked out and the volume of its limit shape associated to the word metric given
log 2
2009
 32805
 the fact that this number is
by standard generators is equal to 21870
transcendental
implies
that
the
growth
series
this
group ie the formal power
series n0 b nz is not algebraic in the sense that it is not a solution of a
polynomial equation with rational functions in cz as coefficients see 33 prop
asymptotic shape of balls in groups with polynomial growth
33 this was observed by stoll in 33 by more direct combinatorial means
stoll also shows there the interesting fact that the growth series can be rational
for some other choices of generating sets in the 5dimensional heisenberg group
so rationality of the growth series depends on the generating set
another interesting feature is asymptotic invariance
corollary 17 asymptotic invariance let s be a simply connected solvable
lie group with polynomial growth and  a periodic pseudodistance on s let  be
the new lie product on s given by the nilshadow group structure or the graded
nilshadow group structure then e g  xe x  1 as x   for every
g  s
this follows immediately from theorem 14 when  is the graded nilshadow
product and from theorem 62 below in the case  is the nilshadow group structure
it is worth observing that we may not in general replace  by the ordinary
product on s indeed let for instance s  r  r2 be the universal cover of the
group of motions of the euclidean plane then s like its nilshadow r3  admits
a lattice   z3  the quotient s is diffeomorphic to the 3torus r3 z3 and
it is easy to find riemannian metrics on this torus so that their lift to r3 is not
invariant under rotation around the zaxis hence this metric viewed on the lie
group s will not be asymptotically invariant under left translation by elements of
s nevertheless if the metric is leftinvariant and not just periodic then we have
the following corollary of the proof of theorem 14
corollary 18 leftinvariant pseudodistances are asymptotic to subfinsler metrics let s be a simply connected solvable lie group of polynomial growth and 
be a periodic pseudodistance on s which is invariant under all lefttranslations by
elements of s eg a leftinvariant coarsely geodesic metric on s then there
is a leftinvariant subfinsler metric d on s which is asymptotic to  in the sense
 1 as g  
that deg
we already mentioned above that determining the exact limit shape of a word
metric on s is a difficult task consequently so is the task of telling when two
distinct word metrics are asymptotic the above statement says that in any case
every word metric on s is asymptotic to some leftinvariant subfinsler metric so
the set of possible limit shapes is no richer for word metrics than for leftinvariant
subfinsler metrics
we note that in the case of nilpotent lie groups where k is trivial theorem
14 shows that every periodic metric is asymptotic to a leftinvariant metric it is
still an open problem to determine whether every coarsely geodesic periodic metric
is at a bounded distance from a leftinvariant metric this is buragos theorem in
rn  more about it below
theorems 12 and 14 allow us to describe the asymptotic cone of g  for any
periodic pseudodistance  on any locally compact group with polynomial growth
emmanuel breuillard
corollary 19 asymptotic cone let g be a locally compact group with polynomial growth and  a periodic pseudodistance on g then the sequence of pointed
metric spaces g n1  en1 converges in the gromovhausdorff topology the
limit is the metric space n d  e where n is a graded simply connected nilpotent lie group and d a left invariant subfinsler metric on n  moreover the lie
group n is up to isomorphism independent of  the space n d  is isometric
to the asymptotic cone associated to g  this asymptotic cone is independent
of the choice of ultrafilter used to define it
this corollary is a generalization of pansus theorem 10 in 27 we refer
the reader to the book 18 for the definitions of the asymptotic cone and the
gromovhausdorff convergence we discuss in section 8 the speed of convergence
in the gromovhausdorff metric in this theorem and its corollaries about volume
growth in particular there is a major difference between the discrete nilpotent case
and the solvable non nilpotent case in the former one can find a polynomial rate
of convergence 9 while in the latter no such rate exist in general see theorem
13 folner sets and ergodic theory a consequence of corollary 16 is that
sequences of balls with radius going to infinity are folner sequences namely
corollary 110 let g be a locally compact group with polynomial growth and
 a periodic pseudodistance on g let b t be the ball of radius t in g then
b tt0 form a folner family of subsets of g namely for any compact set f
in g we have  denotes the symmetric difference
volg f b tb t
volg b t
lim
proof indeed f b tb t  b t  cb t for some c  depending on f 
hence 5 follows from 3
this settles the socalled localization problem of greenleaf for locally compact
groups of polynomial growth see 16 ie determining whether the powers of
a compact generating set n n form a folner sequence at the same time it
implies that the ergodic theorem for gactions holds along any sequence of balls
with radius going to infinity
theorem 111 ergodic theorem let be given a locally compact group g with
polynomial growth together with a measurable gspace x endowed with a ginvariant ergodic probability measure m let  be a periodic pseudodistance on
g and b t the ball of radius t in g then for any p 1  p   and any
function f  lp x m we have
f dm
f gxdg 
lim
t volg b t b t
for malmost every x  x and also in lp x m
asymptotic shape of balls in groups with polynomial growth
in fact corollary 110 above was the missing block in the proof of the ergodic
theorem on groups of polynomial growth so far and to my knowledge corollary
110 and theorem 111 were known only along some subsequence of balls b tn n
chosen so that 5 holds see for instance 10 or 34 this issue was drawn to
my attention by a nevo and was my initial motivation for the present work we
refer the reader to the a nevos survey paper 26 section 5
it later turned out that the mere fact that balls are folner in a given polynomial
growth locally compact group can also be derived from the fact these groups are
doubling metric spaces which is an easier result than the precise asymptotics
voln   c ndg proved in this paper and only requires lower and upper bounds
of the form c1 ndg  voln   c2 ndg  this was observed by r tessera
35 who rediscovered a cute argument of colding and minicozzi 11 lemma 33
showing that the volume of spheres n1  n is at most some on  times the
volume of the ball n  where   0 is a positive constant depending only on the
doubling constant the word metric induced by  in g
in 9 we give a better upper bound which depends only on the nilpotency class
and not on the doubling constant for the volume of spheres in the case of finitely
generated nilpotent groups this is done by showing the following error term in
the asymptotics of the volume of balls we have voln   c ndg  ondgr 
where r  0 depends only on the nilpotency class r of g we refer the reader to
section 8 and to the preprint 9 for more information on this we only note here
that although the above coldingminicozzitessera upper bound on the volume of
spheres holds generally for all locally compact groups g with polynomial growth
unless g is nilpotent there is no error term in general in the asymptotics of the
volume of balls an example with arbitrarily small speed is given in 81
14 a conjecture of burago and margulis in 7 d burago and g margulis
conjectured that any two word metrics on a finitely generated group which are
asymptotic in the sense that 12 e
e tends to 1 at infinity must be at a bounded
distance from one another in the sense that 1 e   2 e   o1 this
holds for abelian groups an analogous result was proved by abels and margulis
for word metrics on reductive groups 1 s krat 23 established this property
for word metrics on the heisenberg group h3 z however using theorem 14
which in this particular case of finitely generated nilpotent groups is just pansus
theorem 27 we will show in section 83 that there are counterexamples and
exhibit two word metrics on h3 z  z which are asymptotic and yet are not at
a bounded distance for more on this counterexample and how to adequately
modify the conjecture of burago and margulis we refer the interested reader to
15 organization of the paper sections 24 are devoted to preliminaries in
section 2 we present the basic nilpotent theory as can be found in guivarchs
thesis 21 in particular a full proof of the bassguivarch formula is given in
section 3 we recall the construction of the nilshadow of a solvable lie group
emmanuel breuillard
in section 4 we set up the axioms and basic properties of the pseudodistance
functions that are studied in this paper
sections 57 contain the core of the proof of the main theorems in section 5 we
assume that g is a simply connected solvable lie group and reduce the problem to
the nilpotent case in section 6 we assume that g is a simply connected nilpotent
lie group and prove theorem 14 in this case following the strategy used by pansu
in 27 in section 7 we prove theorem 12 for general locally compact groups
and reduce the proof of the results of the introduction to the lie case
in the last section we make further comments about the speed of convergence
in particular we give examples answering negatively the aforementioned question
of burago and margulis
the appendix is devoted to the discrete heisenberg groups of dimension 3 and
5 we compute their limit balls explain figure 1 and recover the main result of
stoll 33
the reader who is mainly interested in the nilpotent group case can read directly
section 6 while keeping an eye on sections 2 and 4 for background notations and
elementary facts
finally let us mention that the results and methods of this paper were largely
inspired by the works of y guivarch 21 and p pansu 27
16 nota bene a version of this article circulated since 2007 the present version contains essentially the same material only the exposition has been improved
and several somewhat sketchy arguments have been replaced by full fledged proofs
in particular in sections 3 and 7 this delay is due to the fact that i was planning for a long time to improve section 6 and show an error term in the volume
asymptotics of balls in nilpotent groups e le donne and i recently managed to
achieve this and it has now become an independent joint paper 9
2 quasinorms and the geometry of nilpotent lie groups
in this section we review the necessary background material on nilpotent lie
groups in paragraph 24 we give some crucial properties of homogeneous quasi
norms and reproduce some lemmas originally due to y guivarch which will be
used in the sequel meanwhile we prove the bassguivarch formula for the degree of polynomial growth of nilpotent lie groups following guivarchs original
argument
21 carnotcaratheodory metrics let g be a connected lie group with lie
algebra g and let m1 be a vector subspace of g we denote by kk a norm on m1 
we now recall the definition of a leftinvariant carnotcarathodory metric also
called subfinsler metric on g let x y  g we consider all possible piecewise
smooth paths   0 1  g going from 0  x to 1  y let   u be the
tangent vector which is pulled back to the identity by a left translation ie
 u    u
asymptotic shape of balls in groups with polynomial growth
where   u  g and the notation u    u means the image of   u under
the differential at the identity of the left translation by the group element u
we say that the path  is horizontal if the vector   u belongs to m1 for all
u  0 1 we denote by h the set of piecewise smooth horizontal paths the
carnotcarathodory metric associated to the norm kk is defined by
z 1
  u du   h 0  x 1  y
dx y  inf
where the infimum is taken over all piecewise smooth paths   0 1  n with
0  x 1  y that are horizontal in the sense that   u  m1 for all u if
k  k is a euclidean norm the metric dx y is also called subriemannian in this
paper however the norm k  k will typically not be euclidean it can be polyhedral
like in the case of word metrics on finitely generated nilpotent groups and dx y
will only be subfinsler if m1  g and kk is a euclidean resp arbitrary norm
on g then d is simply the usual leftinvariant riemannian resp finsler metric
associated to kk 
chows theorem eg see 19 or 25 tells us that dx y is finite for all x and
y in g if and only if the vector subspace m1  together with all brackets of elements
of m1  generates the full lie algebra g if this condition is satisfied then d is a
distance on g which induces the original topology of g
in this paper we will only be concerned with carnotcaratheodory metrics on
a simply connected nilpotent lie group n  in the sequel whenever we speak of a
carnotcarathodory metric on n we mean one that is associated to a norm kk
on a subspace m1 such that n  m1  n n where n  lien  it is easy to check
that any such m1 generates the lie algebra n
remark 21 let us observe here that for such a metric d on n we have the
following description of the unit ball for kk
1 x
 x  n e
v  m1  kvk  1 
de x
where 1 is the linear projection from n identified with n via exp to m1 with
kernel n n indeed 1 gives rise to a homomorphism from n to the vector space
m1  and if u is a horizontal path from e to x then applying 1 to 6 we
1 u    u hence 1 x  0   udu hence k1 xk  de x with
get du
equality if x  m1 
22 dilations on a nilpotent lie group and the associated graded group
we now focus on the case of simply connected nilpotent lie groups let n be
such a group with lie algebra n and nilpotency class r for background about
analysis on such groups we refer the reader to the book 12 the exponential
map is a diffeomorphism between n and n  most of the time if x  n we will
abuse notation and denote the group element expx simply by x we denote
by c p np the central descending series for n ie c p1 n  n c p n with
c 0 n  n and c r n  0
emmanuel breuillard
let mp p1 be a collection of vector subspaces of n such that for each p  1
c p1 n  c p n  mp 
then n  p1 mp and in this decomposition any element x in n or n by abuse
of notation will be written in the form
p x
where p x is the linear projection onto mp 
to such a decomposition is associated a oneparameter group of dilations t t0 
these are the linear endomorphisms of n defined by
t x  tp x
for any x  mp and for every p conversely the oneparameter group t t0
determines the mp p1 s since they appear as eigenspaces of each t  t 6 1 the
dilations t do not preserve a priori the lie bracket on n this is the case if and
only if
mp  mq   mpq
for every p and q where mp  mq  is the subspace spanned by all commutators of
elements of mp with elements of mq  if 8 holds we say that the mp p1 form a
stratification of the lie algebra n and that n is a stratified or homogeneous lie
algebra it is an exercise to check that 8 is equivalent to require m1  mp   mp1
for all p
if 8 does not hold we can however consider a new lie algebra structure on
the real vector space n by defining the new lie bracket as x y  pq x y
if x  mp and y  mq  this new lie algebra n is stratified and has the same
underlying vector space as n we denote by n the associated simply connected
lie group moreover the t t0 form a oneparameter group of automorphisms of
n  in fact the original lie bracket x y on n can be deformed continuously to
x y through a continuous family of lie algebra structures by setting
x yt   1 t x t y
and letting t   note that conversely if the t s are automorphisms of n
then x y  pq x y for all x  mp and y  mq  and n  n 
the graded lie algebra associated to n is by definition
grn 
c p nc p1 n
endowed with the lie bracket induced from that of n the quotient map mp 
c p nc p1 n gives rise to a linear isomorphism between n and grn which is
a lie algebra isomorphism between the new lie algebra structure n and grn
hence stratified lie algebra structures induced by a choice of supplementary subspaces mp p1 as in 7 are all isomorphic to grn
asymptotic shape of balls in groups with polynomial growth
on n the leftinvariant subfinsler metrics d associated to a choice of norm
on m1 are of special interest the oneparameter group of dilations t t is an
automorphism of n and that
d t x t y  td x y
for any x y  n  the metric space n  d  is called a carnot group
if on the other hand the simply connected nilpotent lie group n is not stratified
then the group of dilations t t associated to a choice of supplementary vector
subspaces mi s as in 7 will not consist of automorphisms of n and the relation
10 will not hold
note also that if we are given two different choices of supplementary subspaces
mi s and mi s as in 7 then the leftinvariant carnotcaratheodory metrics on
the corresponding stratified lie groups are isometric if and only if m1  kk and
m1  kk  are isometric a linear isomorphism from m1 to m1 that sends kk to
kk extends to an isometry of the two carnot groups
23 the campbellhausdorff formula the exponential map exp  n  n
is a diffeomorphism in the sequel we will often abuse notation and identify n
and n without further notice in particular for two elements x and y of n or
n equivalently xy will denote their product in n  while x  y denotes the sum
in n let t t be a oneparameter group of dilations associated to a choice of
supplementary subspaces mi s as in 7 we denote the corresponding stratified
lie algebra by n as above and the lie group by n  the product on n is
denoted by x  y on n the dilations t t are automorphisms
the campbellhausdorff formula see 12 allows to give a more precise form of
the product in n let ei 1id be a basis of n adapted to the decomposition into
mi s that is mi  spanej  ej  mi  let x  x1 e1    xd ed the corresponding
decomposition of an element x  n then define the degree di  degei  to be the
largest j such that ei  c j1 n if   1   d   nd is a multiindex then let
d  dege1 1    deged d 
the campbellhausdorff formula yields
xyi  xi  yi 
c x y 
where c are real constants and the sum is over all multiindices  and  such
that d  d  degei  d  1 and d  1
from 9 it is easy to give the form of the associated stratified lie group law
x  yi  xi  yi 
c x y 
where the sum is restricted to those s and s such that d  d  degei 
d  1 and d  1
24 homogeneous quasinorms and guivarchs theorem on polynomial
growth let n be a finite dimensional real nilpotent lie algebra and consider a
decomposition
n  m1    mr
emmanuel breuillard
by supplementary vector subspaces as in 7 let t t0 be the one parameter
group of dilations associated to this decomposition that is t x  ti x if x  mi 
we now introduce the following definition
definition 22 homogeneous quasinorm a continuous function     n  r
is called a homogeneous quasinorm associated to the dilations t t  if it satisfies
the following properties
i x  0  x  0
ii t x  tx for all t  0
example 23 1 quasinorms of supremum type ie x  maxp kp xk1p
where kkp are ordinary norms on the vector space mp and p is the projection on
mp as above
2 x  d e x where d is a carnotcarathodory metric on a stratified
nilpotent lie group as the relation 10 shows
clearly a quasinorm is determined by its sphere of radius 1 and two quasinorms which are homogeneous with respect to the same group of dilations are
always equivalent in the sense that
  2  c 1
c 1
for some constant c  0 indeed by continuity   2 admits a maximum on the
sphere x1  1 if the two quasinorms are homogeneous with respect to
two distinct semigroups of dilations then the inequalities 13 continue to hold
outside a neighborhood of 0 but may fail near 0
homogeneous quasinorms satisfy the following properties
proposition 24 let    be a homogeneous quasinorm on n then there are
constants c c1  c2  0 such that
a xi   c  xdegei  if x  x1 e1    xn en in an adapted basis ei i 
b x1   c  x
c x  y  c  x  y
d xy  c1 x  y  c2 
properties a b and c are straightforward from the fact that x  maxp kp xk1p
is a homogeneous quasinorm and from 13 property d justifies the term quasinorm and follows from lemma 25 below it can be a problem that the constant
c1 in d may not be equal to 1 in fact this is why we use the word quasinorm
instead of just norm because we do not require the triangle inequality axiom to
hold however the following lemma of guivarch is often a good enough remedy
to this situation let kkp be an arbitrary norm on the vector space mp 
lemma 25 guivarch 21 lemme ii1 let   0 up to rescaling each kkp
into a proportional norm p kkp p  0 if necessary the quasinorm x 
satisfies
maxp kp xk1p
xy  x  y  
asymptotic shape of balls in groups with polynomial growth
for all x y  n  if n is stratified with respect to t t we can take   0
this lemma is crucial also for computing the coarse asymptotics of volume
growth for the readers convenience we reproduce here guivarchs argument
which is based on the campbellhausdorff formula 11
proof we fix 1  1 and we are going to give a condition on the i s so that 14
holds the i s will be taken to be smaller and smaller as i increases we set
x  maxp kp xk1p
and let x  maxp kp p xk1p
for any rtuple of i s
we want that for any index p  r
p kp xykp  x  y  p
by 11 we have p xy  p x  p y  pp x y where pp is a polynomial map
into mp depending only on the i x and i y with i  p  1 such that
kpp x ykp  cp 
mp1 xl mp1 ym
lm1lmp
where mk x  maxik ki xki and cp  0 is a constant depending on pp and
on the norms kki s since   0 when expanding the right hand side of 15 all
terms of the form xl ym
 with l  m  p appear with some positive coefficient
say lm  the terms x and yp appear with coefficient 1 and cause no trouble
since we always have p kp xkp  xp and p kp ykp  yp  therefore for
15 to hold it is sufficient that
p cp mp1 xl mp1 ym  lm xl ym
for all remaining l and m however clearly mk x  k  x where k 
maxik 1i   1 hence a sufficient condition for 15 to hold is
cp pp1
where   min lm  since p1 depends only on the first p  1 values of the i s it
is obvious that such a set of conditions can be fulfilled by a suitable rtuple  
remark 26 the constant c2 in property d above can be taken to be 0 when n
is stratified with respect to the mi s ie the t s are automorphisms as is easily
seen after changing x and y into their image under t  and conversely if c2  0
for some t homogeneous quasinorm on n then n admits a stratification indeed
from 11 and 12 we see that if the t s are not automorphisms then one can
find x y  n such that when t is small enough t xy  t xt y  ctr1r
for some c  0 however combining properties c and property d with c2  0
above we must have t xy  t xt y  ot near t  0 a contradiction
guivarchs lemma enables us to show
theorem 27 guivarch ibid let  be a compact neighborhood of the identity
in a simply connected nilpotent lie group n and  x y  infn  1 x1 y  n 
emmanuel breuillard
then for any homogeneous quasinorm    on n there is a constant c  0 such
that
x   e x  cx  c
proof since any two homogeneous quasinorms wrt the same oneparameter
group of dilations are equivalent it is enough to do the proof for one of them
so we consider the quasinorm obtained in lemma 25 with the extra property
14 the lower bound in 16 is a direct consequence of 14 and one can take
there c to be maxx x     for the upper bound it suffices to show
that there is c  n such that for all n  n if x  n then x  cn  to
achieve this we proceed by induction of the nilpotency length of n the result
is clear when n is abelian otherwise by induction we obtain c0  n such that
x  1    c0 n  z where i   and z  c r1 n  whenever x  n hence
z  x  c0 n  max i1   c0  n  c1 n for some other constant c1  n so we
have reduced the problem to x  z  mr  c r1 n  which is central in n we
have z  z1n where z1   zn  c1  since  is a neighborhood of the identity
in n the set u of all products of at most dimmr  simple commutators of length
r of elements in  is a neighborhood of the identity in c r1 n  eg see 19
p113 it follows that there is a constant c2  n such that z1 is in u c2  hence the
product of at most c2 dimmr  simple commutators then we are done because z
itself will be equal to the same product of commutators where each letter xi  
is replaced by xni  this last fact follows from the following lemma
lemma 28 let g be a nilpotent group of nilpotency class r and n1   nr be
positive integers then for any x1   xr  g
xn1 1  xn2 2   xnr r   x1  x2   xr n1 nr
to prove the lemma it suffices to use induction and the following obvious fact
if x y commutes to x and y then xn  y  x yn 
finally we obtain
corollary 29 let  be a compact neighborhood of the identity in n then there
are positive constants c1 and c2 such that for all n  n
c1 nd  voln n   c2 nd
where d is given by the bassguivarch formula
i  dim mi
proof by theorem 27 it is enough to estimate the volume of the quasinorm
balls by homogeneity of the quasinorm we have voln x x  t  td voln x x 
remark 210 the use of malcevs embedding theorem allows as guivarch observed to deduce immediately that the analogous result holds for virtually nilpotent
finitely generated groups this fact that was also proven independently by h bass
asymptotic shape of balls in groups with polynomial growth
3 by a direct combinatorial argument see also tits appendix to gromovs paper 17 in fact guivarchs theorem 27 seems to have been rediscovered several
times in the past 40 years including by pansu in his thesis 27 the latest example
of that being 22
3 the nilshadow
the goal of this section is to introduce the nilshadow of a simply connected
solvable lie group g we will assume that g has polynomial growth although
this last assumption is not necessary for almost everything we do in this section
the only statement which will be used afterwards in the paper in section 5 is
lemma 312 below the reader familiar with the nilshadow can jump directly to
the statement of this lemma and skip the forthcoming discussion
31 construction of the nilshadow the nilshadow of g is a simply connected
nilpotent lie group gn  which is associated to g in a natural way this notion
was first introduced by auslander and green in 2 in their study of flows on
solvmanifolds they defined it as the unipotent radical of a semisimple splitting
of g however we are going to follow a different approach for its construction by
working first at the lie algebra level we refer the reader to the book 13 where
this approach is taken up
let g be a solvable real lie algebra and n the nilradical of g we have g g  n
if x  g we write adx  ads x  adn x the jordan decomposition of adx in
glg since adx  derg the space of derivations of g and derg is the lie
algebra of the algebraic group autg the jordan components ads x and adn x
also belong to derg moreover for each x  g ads x sends g into n because
so does adx and ads x is a polynomial in adx let h be a cartan subalgebra
of g namely a nilpotent selfnormalizing subalgebra recall that the image of
a cartan subalgebra by a surjective lie algebra homomorphism is again a cartan subalgebra now since gn is abelian it follows that h maps onto gn ie
h  n  g moreover ads xh  0 if x  h because h is nilpotent
now pick any real vector subspace v of h in direct sum with n then the
following two conditions hold
i v  n  g 
ii ads xy  0 for all x y  v
from i and ii it follows easily that ads x commutes with ady ads y and
adn y for all x y in v we have
lemma 31 the map v  derg defined by x 7 ads x is a lie algebra
homomorphism
proof first let us check that this map is linear let x y  v by the above
ads y and ads x commute with each other hence their sum is semisimple and
commute with adn x  adn y from the uniqueness of the jordan decomposition
emmanuel breuillard
it remains to check that adn x  adn y is nilpotent if x y in v to see this apply
the following obvious remark twice to a  adn x and v  adn first and then to
a  adn y and v  spanadn x adadyn x n  1  let v be a nilpotent
subspace of glg and a  glg nilpotent ie v n  0 and am  0 for some
n m  n and assume a v   v then a  v nm  0
the fact that this map is a lie algebra homomorphism follows easily from the
fact that all ads x x  v commute with one another and with g g  n
we define a new lie bracket on g by setting
x yn  x y  ads xv y  ads yv x
where xv is the linear projection of x on v according to the direct sum vn  g the
jacobi identity is checked by a straightforward computation where the following
fact is needed ads ads xy  0 for all x y  g this holds because as we just
saw ads xg  n for all x  g and ads a  0 if a  n
definition 32 let gn be the vector space g endowed with the new lie algebra
structure  n given by 18 the nilshadow gn of g is defined to be the simply
connected lie group with lie algebra gn 
it is easy to check that gn is a nilpotent lie algebra to see this note first that
gn  gn n  n and if x  gn and y  n then x yn  adn xv   adxn y
however adn xv   adxn  is a nilpotent endomorphism of n as follows from the
same remark used in the proof of lemma 31 hence gn is a nilpotent
the nilshadow lie product on gn will be denoted by  in order to distinguish
it from the original lie product on g in the sequel we will often identify g resp
gn  with its lie algebra g resp gn  via their respective exponential map since
the underlying space of gn was g itself this gives an identification although not
a group isomorphism between g and gn  then the nilshadow lie product can
be expressed in terms of the original product as follows
g  h  g  t g 1 h
here t is the lie group homomorphism g  autg induced by the above
choice of supplementary subspace v as follows
t ea eb   expeads av  b a b  g
in other words t is the unique lie group homomorphism whose differential
at the identity is the lie algebra homomorphism de t  g  derg given by
de t ab  ads av b that is the composition of the map v  derg from
lemma 31 with the linear projection g  gn  v
it is easy to check that this definition of the new product is compatible with
the definition of the new lie bracket
it can also be checked that two choices of supplementary spaces v as above yield
isomorphic lie structures see 13 chap iii hence by abuse of language we
asymptotic shape of balls in groups with polynomial growth
speak of the nilshadow of g when we mean the lie structure on g induced by a
choice of v as above
the following example shows several of the features of a typical solvable lie
group of polynomial growth
example 33 nilshadow of a semidirect product let g  r  rn where
t  gln r is some one parameter subgroup given by t  expta  kt ut where
a is some matrix in mn r and a  as  au is its jordan decomposition giving
rise to kt  exptas  and ut  exptau  the group g is diffeomorphic to rn1 
hence simply connected if all eigenvalues of as are purely imaginary then g has
polynomial growth however g is not nilpotent unless as  0 so let us assume
that neither as nor au is zero then the nilshadow gn is the semidirect product
r u rn where ut is the unipotent part of t 
it is easy to compute the homogeneous dimension of g or gn  in terms of the
dimension of the jordan blocs of au  if nk is the number of jordan blocks of au
of size k then
x kk  1
dg  1 
32 basic properties of the nilshadow we now list in the form of a few
lemmas some basic properties of the nilshadow
lemma 34 the image of t  g  autg is abelian and relatively compact
moreover t t gh  t h for any g h  g
proof since g has polynomial growth it is of type r by guivarchs theorem
hence all ads x have purely imaginary eigenvalues it follows that k is compact
since t factors through the nilradical its image is abelian the last equality
follows from 19 and the fact that x y  g ads ads xy  0
lemma 35 t g also belongs to autgn  and t is a group homomorphism
gn  autgn 
proof the first assertion follows from 19 and the fact that de t is a derivation
of gn as one can check from 18 and the fact that x y  g ads ads xy  0
the second assertion then follows from lemma 34
we denote by k the closure of t g in autg  autg
lemma 36 kaction on gn  k preserves v and acts trivially on it it also
preserves the ideals n and the central descending series c i gn i of gn 
proof it suffices to check that ads v preserves n and c i gn  it preserves n
because adx preserves n for all x  g it preserves c i gn  because it acts as a
derivation of gn as we have already checked in the proof of lemma 35
remark 37 welldefinedness of 1  it is also easy to check from the definition
of the nilshadow bracket that the commutator subalgebra gn  gn  and in fact each
term of the central descending series c i gn  is an ideal in g and does not depend
on the choice of supplementary subspace v used to defined the nilshadow bracket
emmanuel breuillard
in particular the projection map 1  gn  gn gn  gn  is a well defined linear
map on g  gn ie independently of the choice involved in the construction of
the nilshadow lie bracket
lemma 38 exponential map the respective exponential maps exp  g  g
and expn  gn  gn coincide on n and on v
proof since the two lie products coincide on n  expn so do their exponential
map for the second assertion note that t etv v  v for every v  v because
ads xy  0 for all x y   it follows that etv t is a oneparameter subgroup
for both lie structures hence it is equal to expn tvt 
remark 39 surjectivity of the exponential map the exponential map is not
e of the group e
always a diffeomorphism as the example of the universal cover e
of motions of the plane shows indeed any 1parameter subgroup of e is either a
translation subgroup or a rotation subgroup but the rotation subgroup is compact
hence a torus so its lift will contain the discrete center of e hence will miss
every lift of a non trivial translation in fact it is easy to see that if g is the lie
algebra of a solvable nonnilpotent lie group of polynomial growth then g maps
surjectively on the lie algebra of e hence for a simply connected solvable and
nonnilpotent lie group of polynomial growth the exponential map is never onto
nevertheless its image is easily seen to be dense
however exponential coordinates of the second kind behave nicely note that
gn  gn   n
lemma 310 exponential coordinates of the second kind let c i gn i0
be the central descending series of gn with c 1 gn   gn  gn  and pick linear
subspaces mi in gn such that c i gn   mi  c i1 gn  for i  2 let l be a
supplementary subspace of c 1 gn  in n define exponential coordinates of the
second kind by setting
mr    m2  l  v  g
r   1  v 7 expn r       expn 1   expn v
this map is a diffeomorphism moreover expn r       expn 1   expn v 
er    e1  ev for all choices of v  v and i  mi 
proof by lemma 38 the exponential maps of g and gn coincide on n and on v
moreover g  h  g  h whenever g belongs to the nilradical expn of g hence
expn r   expn 1 expn v  expn r   expn 1 expn v  er e1 ev 
the restriction of the map to n is a diffeomorphism onto expn because this map
and its inverse are explicit polynomial maps the i s are coordinates of the second
kind see the book 12 now the map n  v  g sending n v to en  ev is a
diffeomorphism because g is simply connected and hence the quotient group
g expn isomorphic to a vector space and hence to expv
lemma 311 biinvariant riemannian metric there exists a riemannian
metric on g which is left invariant under both lie structures
asymptotic shape of balls in groups with polynomial growth
proof indeed it suffices to pick a scalar product on g which is invariant under the
compact subgroup k  t g  autg
we identify k  t g g  g with its image in autg under the canonical
isomorphism between autg and autg recall that according to lemma 36
the central descending series of gn is invariant under ads x for all x  v and
consists of ideals of g the same holds for n it follows that these linear subspaces
also invariant under k however since k is compact its action on g is completely
reducible therefore we have proved
lemma 312 kinvariant stratification of the nilshadow let g be the lie algebra
of a simply connected lie group g with polynomial growth let gn be the nilshadow
lie algebra obtained from a splitting g  n  v as above ie n is the nilradical and
v satisfies ads xy  0 for every x y  v let k  t g g  g  autg
where t is defined by 19 then there is a choice of linear subspaces mi s and l
such that
gn  mr     m2  l  v
where each term is kinvariant m1  l  v and the central descending series of
gn satisfies c i gn   mi  c i1 gn  moreover the action on k can be read off
on the exponential coordinates of second kind in this decomposition namely
 ker     ke0   ekr     ek0 
k er    e0
 expn kr     expn k0 
4 periodic metrics
in this section unless otherwise stated g will denote an arbitrary locally compact group
41 definitions by a pseudodistance or metric on a topological space x we
mean a function   x  x  r satisfying x y  y x and x z 
x y  y z for any triplet of points of x however x y may be equal to 0
even if x 6 y
we will require our pseudodistances to be locally bounded meaning that the
image under  of any compact subset of g  g is a bounded subset of r  to
avoid irrelevant cases for instance   0 we will also assume that  is proper ie
the map y 7 e y is a proper map namely the preimage of a bounded set is
bounded we do not ask that the map be continuous when  is locally bounded
then it is proper if and only if y 7 x y is proper for any x  g
a pseudodistance  on g is said to be asymptotically geodesic if for every   0
there exists s  0 such that for any x y  g one can find a sequence of points
x1  x x2   xn  y in g such that
xi  xi1   1  x y
and xi  xi1   s for all i  1  n  1
emmanuel breuillard
we will consider exclusively pseudodistances on a group g that are invariant
under left translations by all elements of a fixed closed and cocompact subgroup
h of g meaning that for all x y  g and all h  h hx hy  x y
combining all previous axioms we set the following definition
definition 41 let g be a locally compact group a pseudodistance  on g will
be said to be a periodic metric or hperiodic metric if it satisfies the following
properties
i  is invariant under left translations by a closed cocompact subgroup h
ii  is locally bounded and proper
iii  is asymptotically geodesic
remark 42 the assumption that  is symmetric ie x y  y x is here
only for the sake of simplicity and most of what is proven in this paper can be
done without this hypothesis
42 basic properties let  be a periodic metric on g and h some cocompact
subgroup of g the following properties are straighforward
1  is at a bounded distance from its restriction to h this means that if f
is a bounded fundamental domain for h in g and for an arbitrary x  g if hx
denotes the element of h such that x  hx f then x y  hx  hy   c for
some constant c  0
2 t  0 there exists a compact subset kt of g such that x y  g x y 
t  x1 y  kt  and conversely if k is a compact subset of g tk  0 st
x1 y  k  x y  tk
3 if x y  s the xi s in 21 can be chosen in such a way that s 
xi  xi1   2s one can take a suitable subset of the original xi s
4 the restriction of  to h  h is a periodic pseudodistance on h this
means that the xi s in 21 can be chosen in h
5 conversely given a periodic pseudodistance h on h it is possible to extend
it to a periodic pseudodistance on g by setting x y  h hx  hy  where x 
hx f for some bounded fundamental domain f for h in g
43 examples let us give a few examples of periodic pseudodistances
1 let  be a finitely generated torsion free nilpotent group which is embedded
as a cocompact discrete subgroup of a simply connected nilpotent lie group n 
given a finite symmetric generating set s of  we can consider the corresponding
word metric ds on  which gives rise to a periodic metric on n given by x y 
ds x  y  where x  x f and y  y f if f is some fixed fundamental domain for
 in n
2 another example given in 27 is as follows let n be a nilmanifold with
universal cover n and fundamental group  let g be a riemannian metric on
n it can be lifted to the universal cover and thus gives rise to a riemannian
metric e
g on n  this metric is invariant proper and locally bounded since  is
cocompact in n it is easy to check that it is also asymptotically geodesic hence
periodic
asymptotic shape of balls in groups with polynomial growth
3 any word metric on g that is if  is a compact symmetric generating
subset of g let  x  infn  1 x  n  then define x y   x1 y
clearly  is a pseudodistance although not a distance and it is ginvariant on the
left it is also proper locally bounded and asymptotically geodesic hence periodic
4 if g is a connected lie group any left invariant riemannian metric on g
here again h  g and we obtain a periodic distance similarly any left invariant
carnotcarathodory metric on g will do
remark 43 berestovskis theorem according to a result of berestovski 5
every leftinvariant geodesic distance on a connected lie group is a subfinsler
metric as defined in paragraph 21
44 coarse equivalence between invariant pseudodistances the following
proposition is basic
proposition 44 let 1 and 2 be two periodic pseudodistances on g then there
is a constant c  0 such that for all x y  g
2 x y  c  1 x y  c2 x y  c
proof clearly it suffices to prove the upper bound let s  0 be the number corresponding to the choice   1 in 21 for 2  from 42 2 there exists a compact
subset ks in g such that 2 x y  2s  x1 y  k2s  and there is a constant
t  tk2s   0 such that x1 y  k2s  1 x y  t let c  max2ts t and
let x y  g if 2 x y  s then 1 x y  t so the right hand side of 22 holds
if 2 x y  s then from 21 and 42 3 we get a sequence of xi s in g from x
to y such that s  2 xi  xi1   2s and n
xi  xi1   22 x y it follows
1 2p
that 1 xi  xi1   t for all i hence 1 x y 
1 xi  xi1   n t  2s t2 x y
and the right hand side of 22 holds 
in the particular case when g  n is a simply connected nilpotent lie group
the distance to the origin x 7 e x is also coarsely equivalent to any homogeneous quasinorm on n we have
proposition 45 suppose n is a simply connected nilpotent lie group let 1 be
a periodic pseudodistance on n and    be a homogeneous quasinorm then there
exists c  0 such that for all x  n
1 1
x y  c  1 x y  cx1 y  c
moreover if 2 is a periodic pseudodistance on the stratified nilpotent group n
associated to n then again there is a constant c  0 such that
2 e x  c  1 e x  c2 e x  c
the proposition follows at once from guivarchs theorem see corollary 27
above the equivalence of homogeneous quasinorms and the fact that leftinvariant
carnotcaratheodory metrics on n are homogeneous quasi norms however
since the group structures on n and n differ 24 cannot in general be replaced
by the stronger relation 22 as simple examples show
emmanuel breuillard
the next proposition is of fundamental importance for the study of metrics on
lie groups of polynomial growth
proposition 46 let g be a simply connected solvable lie group of polynomial
growth and gn its nilshadow let  and n be arbitrary periodic pseudodistances
on g and gn respectively then there is a constant c  0 such that for all
x y  g
n x y  c  x y  cn x y  c
proof according to proposition 44 it is enough to show 25 for some choice of
periodic metrics on g and gn  but in lemma 311 we constructed a riemannian
metric on g which is left invariant for both g and gn  we are done
45 right invariance under a compact subgroup here we verify that given
a compact subgroup of g any periodic metric is at bounded distance from another
periodic metric which is invariant on the right by this compact subgroup let k
be a compact subgroup of g and  a periodic pseudodistance on g we average 
with the help of the normalized haar measure on k to get
xk1  yk2 dk1 dk2
 x y 
then the following holds
lemma 47 there is a constant c0  0 depending only on  and k such that
for all k1  k2  k and all x y  g
xk1  yk2   x y  c0
proof from 42 2 t  tk  0 st x  g x xk  t applying the
triangle inequality we are done
hence we obtain
proposition 48 the pseudodistance k is periodic and lies at a bounded distance from  in particular as x tends to infinity in g the following limit holds
k e x
x e x
lim
proof from lemma 47 and 42 3 it is easy to check that k must be asymptotically geodesic and periodic integrating 27 we get that k is at a bounded
distance from  and 28 is obvious
if k is normal in g we thus obtain a periodic metric k on gk such that
k px py is at a bounded distance from x y where p is the quotient map
g  gk
asymptotic shape of balls in groups with polynomial growth
5 reduction to the nilpotent case
in this section g denotes a simply connected solvable lie group of polynomial
growth we are going to reduce the proof of the theorems of the introduction
to the case of a nilpotent g this is performed by showing that any periodic
pseudodistance  on g is asymptotic to some associated periodic pseudodistance
n on the nilshadow gn  we state this in proposition 51 below
the key step in the proof is proposition 52 below which shows the asymptotic
invariance of  under the semisimple part of g the crucial fact there is that the
displacement of a distant point under a fixed unipotent automorphism is negligible
compared to the distance from the identity see lemmas 54 55 so that the
action of the semisimple part of large elements can be simply approximated by
their action by left translation
51 asymptotic invariance under a compact group of automorphisms
of g the main result of this section is the following let g be a connected and
simply connected solvable lie group with polynomial growth and gn its nilshadow
see section 3
proposition 51 let h be a closed cocompact subgroup of g and  an hperiodic pseudodistance see definition 41 on g there exist a closed subset hk
containing h which is a cocompact subgroup for both g and gn  and an hk periodic for both lie structures pseudodistance k such that
lim
k e x
e x
the closed subgroup hk will be taken to be the closure of the group generated
by all elements of the form kh where h belongs to h and k belongs to the
closure k in the group autg of the image of h under the homomorphism
t  g  autg introduced in section 3 it is easy to check from the definition
of the nilshadow product 1 that this is indeed a subgroup in both g and its
nilshadow gn 
the new pseudodistance k is defined as follows using a double averaging
procedure
k x y 
hhk
gkx gkydkdg
here the measure  is the normalized haar measure on the coset space hhk
and dk is the normalized haar measure on the compact group k recall that
all closed subgroups of s are unimodular since they have polynomial growth by
21lemme i3 hence the existence of invariant measures on the coset spaces
an essential part of the proof of proposition 51 is enclosed in the following
statement
emmanuel breuillard
proposition 52 let  be a periodic pseudodistance on g which is invariant
under a cocompact subgroup h then  is asymptotically invariant under the
action of k  t h h  h  autg namely uniformly for all k  k
lim
e kx
e x
the proof of proposition 52 splits into two steps first we show that it is
enough to prove 31 for a dense subset of ks this is a consequence of the following
continuity statement
lemma 53 let   0 then there is a neighborhood u of the identity in k such
that for all k  u
x kx
limx
e x
then we show that the action of t g can be approximated by the conjugation
by g essentially because the unipotent part of this conjugation does not move x
very much when x is far this is the content of the following lemma
lemma 54 let  be a periodic pseudodistance on g which is invariant under
a cocompact subgroup h then for any   0 and any compact subset f in h
there is s0  0 such that
e t hx  e hx  e x
for any h  f and as soon as e x  s0 
proof of proposition 52 modulo lemmas 53 and 54 as  is assumed to
be hinvariant for every h  h we have e h1 xe x  1 the proof of
the proposition then follows immediately from the combination of the last two
lemmas
52 proof of lemmas 53 and 54 we choose kinvariant subspaces mi s
and l of the nilshadow gn of g as in lemma 312 from section 3 in particular
gn  mr      m2  l  v
where each term is kinvariant n  gn  gn   l and c i gn   mi  c i1 gn 
moreover t x  ti x if x  mi here m1  l  v
we also set vx  maxi ki ki i if x  expn r       expn 0  and di  i if
i  0 and d0  1 and we let x  maxi kxi k1di if x  xr      x1  x0 in the
above direct sum decomposition
note that    is a t homogeneous quasinorm moreover it is straightforward
to verify using the campbellhausdorff formula 12 and proposition 24 that
vx  cx  c for some constant c  0 in particular i xdi remains bounded
as x becomes large
proof of lemma 53 combining propositions 45 and 46 there is a constant
c  0 such that for all x y  g x y  cx1  y  c therefore we have
asymptotic shape of balls in groups with polynomial growth
reduced to prove the statement for    instead of  namely it is enough to show
that x1  kx becomes negligible compared to x as x goes to infinity and k
tends to 1
it follows from the campbellbakerhausdorff formula 11 and 12 that if
x y  gn and x y are ot then  1 x  y   1 x   1 y  ot1r  and
similarly  1 x1      xm    1 x1        1 xm   om t1r  for m elements
xi with xi   ot hence when writing x  expn r     expn 0  and setting
t  x we thus obtain that the following quantity
 1 x1  kx 
expn tdi i  
expn tdri kri 
0ir
0ir
is a ot1r  indeed recall from lemma 312 that kx  expn kr    
expn k0  as x gets larger each tdi i remains in a compact subset of mi 
therefore as k tends to the identity in k each tdi ki  becomes uniformly close
to tdi i independently of the choice of x  gn as long as t  x is large the
result follows 
proof of lemma 54 recall that hx  h  t hx for all x h  g see 1
by the triangle inequality it is enough to bound y h  y where y  t hx
from propositions 45 and 46  is comparable up to multiplicative and additive
constants to the homogeneous quasinorm    hence the lemma follows from the
following
lemma 55 let n be a simply connected nilpotent lie group and let    be a
homogeneous quasi norm on n associated to some 1parameter group of dilations
t t  for any   0 and any compact subset f of n there is a constant s2  0
such that
x1 gx  x
for all g  f and as soon as x  s2 
proof recall as in the proof of the last lemma that for any c1  0 there is
a c2  0 such that if t  1 and x y  n are such that x y  c1 t then
 1 xy   1 x   1 y  c2 t1r  in particular if we set t  x then
 1 x1 gx   1 x1   1 g   1 x  c2 t1r
on the other hand as g remains in the compact set f  1 g tends uniformly to
the identity when t  x goes to infinity and  1 x remains in a compact set
by continuity we see that  1 x1   1 g   1 x becomes arbitrarily small as t
increases we are done
emmanuel breuillard
53 proof of proposition 51 first we prove the following continuity statement
lemma 56 let  be a periodic pseudodistance on g and   0 then there
exists a neighborhood of the identity u in g and s3  0 such that
e gx
e x
as soon g  u and e x  s3 
proof let n be a left invariant riemannian metric on the nilshadow gn 
e x  e gx  x gx  x g  x  g  x gx
however a b  cn a b  c for some c  0 by proposition 46 moreover by
1 we have gx  g  t gx hence
e x  e gx  cn x g  x  cn x t gx  2c
to complete the proof we apply lemmas 55 and 53 to the right hand side above
we proceed with the proof of proposition 51 let l be the set of all g  g
such that e gxe x tends to 1 as x tends to infinity in g clearly l is a
subgroup of g lemma 56 shows that l is closed the hinvariance of  insures
that l contains h moreover proposition 52 implies that l is invariant under k
consequently l contains hk  the closed subgroup generated by all kh k  k
h  h this together with proposition 52 grants pointwise convergence of the
integrand in 29 convergence of the integral follows by applying lebesgues
dominated convergence theorem
the fact that k is invariant under left multiplication by h and invariant under
precomposition by automorphisms from k insures that k is invariant under left multiplication by any element h  h where  is the multiplication in the
nilshadow gn  moreover we check that t g  k if g  hk  hence hk is a
subgroup of gn  it is clearly cocompact in gn too if f is compact and hf  g
then h  fk  g where fk is the union of all kf  k  k
clearly k is proper and locally bounded so in order to finish the proof we
need only to check that k is asymptotically geodesic by hinvariance of k and
since h is cocompact in g it is enough to exhibit ap
pseudogeodesic between e
and a point x  h let x  z1    zn with zi  h and
e zi   1    e x
fix a compact fundamental domain f for h in hk so that integration in 29
over hhk is replaced by integration over f then for some constant cf  0 we
have g gz  e gz  cf for g  f and z  h moreover it follows from
proposition 52 lemma 56 and the fact that hk  l that
e gkz  1    e z
for all g  f k  k and as soon as z  g is large enough fix s large enough
so that cf  s and so that 32 holds when e z  s as already observed in
the discussion following definition 41 property 42 3 we may take the zi s so
asymptotic shape of balls in groups with polynomial growth
that 2s  e zi   s then ncf  ns  3e x finally we get for   1 and
x large enough
k e zi   cf n  1  2 e x
 cf n  1  3 k e x
 1  10  k e x
where we have used the convergence k   1 that we just proved 
6 the nilpotent case
in this section we prove theorem 14 and its corollaries stated in the introduction for a simply connected nilpotent lie group we essentially follow pansus
argument from 27 although our approach differs somewhat in its presentation
throughout the section the nilpotent lie group will be denoted by n and its lie
algebra by n
let m1 be any vector subspace of n such that n  m1  n n let 1 the
associated linear projection of n onto m1  let h be a closed cocompact subgroup
of n  to every hperiodic pseudodistance  on n we associate a norm kk0 on
m1 which is the norm whose unit ball is defined to be the closed convex hull of all
elements 1 he h for all h  he in other words
1 h
 h  he
e  x  m1  kxk0  1  cvxhull
e h
the set e is clearly a convex subset of m1 which is symmetric around 0 since 
is symmetric to check that e is indeed the unit ball of a norm on m1 it remains
to see that e is bounded and that 0 lies in its interior the first fact follows
immediately from 23 and example 23 if 0 does not lie in the interior of e
then e must be contained in a proper subspace of m1  contradicting the fact that
h is cocompact in n 
taking large powers hn  we see that we can replace the set h  e in the above
definition by any neighborhood of infinity in h similarly it is easy to see that
the following holds
proposition 61 for s  0 let es be t
the closed convex hull of all 1 xe x
with x  n and e x  s then e  s0 es 
proof since  is t
hperiodic we have e hn   ne h for all n  n and h  h
this shows e  s0 es  the opposite inclusion follows easily from the fact that
 is at a bounded distance from its restriction to h ie from 42 1
we now choose a set of supplementary subspaces mi  starting with m1 as in
paragraph 22 this defines a new lie product  on n so that n  n  is
stratified we can then consider the left invariant carnotcarathodory metric
associated to the norm kk0 as defined in paragraph 21 on the stratified nilpotent
lie group n  in this section we will prove theorem 14 for nilpotent groups in
the following form
emmanuel breuillard
theorem 62 let  be a periodic pseudodistance on n and d the carnotcarathodory metric defined above then as x tends to infinity in n
e x
lim
d e x
note that d is leftinvariant for the n lie product but not the original lie
product on n 
before going further let us draw some simple consequences
1 in theorem 62 we may replace d e x by de x where d is the left
invariant carnotcaratheodory metric on n rather than n  defined by the
norm kk0 as opposed to d which is left invariant hence  d and d are
asymptotic this follows from the combination of theorem 62 and remark 21
2 observe that the choice of m1 was arbitrary hence two carnotcarathodory
metrics corresponding to two different choices of a supplementary subspace m1
with the same induced norm on nn n are asymptotically equivalent ie their
ratio tends to 1 and in fact isometric see remark 21 conversely if two
carnotcarathodory metrics are associated to the same supplementary subspace
m1 and are asymptotically equivalent they must be equal this shows that the
set of all possible norms on the quotient vector space nn n is in bijection with
the set of all classes of asymptotic equivalence of carnotcarathodory metrics on
3 as another consequence we see that if a locally bounded proper and asymptotically geodesic leftinvariant pseudodistance on n is also homogeneous with
respect to the 1parameter group t t ie e t x  te x then it has to be
of the form x y  d e x1 y where d is a carnotcarathodory metric on
61 volume asymptotics theorem 62 also yields a formula for the asymptotic
volume of balls of large radius let us fix a haar measure on n for example
lebesgue measure on n gives rise to a haar measure on n under exp since d
is homogeneous it is straightforward to compute the volume of a d ball
volx  n d e x  t  tdn  volx  n d e x  1
where dn   i1 dimc i n is the homogeneous dimension of n for a pseudodistance  as in the statement of theorem 62 we can define the asymptotic volume of  to be the volume of the unit ball for the associated carnotcarathodory
metric d 
asv ol  volx  n d e x  1
then we obtain as an immediate corollary of theorem 62
corollary 63 let  be periodic pseudodistance on n then
volx  n e x  t  asv ol  0
lim
t tdn 
finally if  is an arbitrary finitely generated nilpotent group we need to take
care of the torsion elements they form a normal finite subgroup t and applying
theorem 62 to t  we obtain
asymptotic shape of balls in groups with polynomial growth
corollary 64 let s be a finite symmetric generating set of  and s n the ball
of radius n is the word metric s associated to s then
lim
ndn 
s n  t 
asv ols 
voln
where n is the malcev closure of   t  the torsion free quotient of  and ds
is the word pseudodistance associated to s the projection of s in 
moreover it is possible to be a bit more precise about asv ols  in fact
the norm kk0 on m1 used to define the limit carnotcarathodory distance d
associated to s is a simple polyhedral norm defined by
kxk0  1  cvxhull 1 s s  s
more generally the following holds let h be any closed cocompact subgroup
of n choose a haar measure on h so that voln nh  1 theorem 62 yields
corollary 65 let  be a compact symmetric ie   1  neighborhood of
the identity which generates h let kk0 be the norm on m1 whose unit ball is
cvxhull1  and let d be the corresponding carnotcarathodory metric on
n  then we have the following limit in the hausdorff topology
lim  1 n   g  n d e g  1
and
volh n 
 voln g  n d e g  1
ndn 
lim
62 outline of the proof we first devise some standard lemmas about piecewise approximations of horizontal paths lemmas 66 67 610 then it is shown
lemma 611 that the original product on n and the product in the associated
graded lie group are asymptotic to each other namely if t t is a 1parameter
group of dilations of n then after renormalization by  1  the product of ot
elements lying in some bounded subset of n is very close to the renormalized
product of the same elements in the graded lie group n  this is why all complications due to the fact that n may not be a priori graded and the t s may
not be automorphisms disappear when looking at the large scale geometry of the
group finally we observe lemma 613 as follows from the very definition of
the unit ball e for the limit norm kk0  that any vector in the boundary of e
can be approximated after renormalizing by  1 by some element x  n lying in
a fixed annulus s1    e x  s1   this enables us to assert that any
quasi geodesic gives rise after renormalization to a d geodesic this gives the
lower bound in theorem 62 and viceversa that any d geodesic can be approximated uniformly by some renormalized quasi geodesic this gives the upper
bound in theorem 62
emmanuel breuillard
63 preliminary lemmas
lemma 66 let g be a lie group and let kke be a euclidean norm on the lie
algebra of g and de   the associated left invariant riemannian metric on g
let k be a compact subset of g then there is a constant c0  c0 de  k  0
such that whenever de e u  1 and x y  k
de xu yu  de x y  c0 de x yde e u
proof the proof reduces to the case when u and x1 y are in a small neighborhood
of e then the inequality boils down to the following kx y ke  c kxke ky ke for
some c  0 and every x y in lieg
lemma 67 let g be a lie group let kk be some norm on the lie algebra of
g and let de   be a left invariant riemannian metric on g then for every
l  0 there is a constant c  cde  kk  l  0 with the following property
assume 1  2  0 1  g are two piecewise smooth paths in the lie group g
with 1 0  2 0  e let i  lieg be the tangent vector pulled back at the
identity by a left translation of g assume that supt01 k1 tk  l and that
r1 
0 k1 t  2 tk dt   then
de 1 1 2 1  c
proof the function f t  de 1 t 2 t is piecewise smooth for small dt we
may write using lemma 66
f t  dt  f t  de 1 t1 tdt 1 t2 tdt  de 1 t2 tdt 2 t2 tdt  f t  odt
 1 t  2 t e dt  c0 f t 2 tdt e  odt
 tdt  c0 lf tdt  odt
where t  k1 t  2 tke  in other words
f  t  t  c0 lf t
since f 0  0 gronwalls lemma implies that f 1  ec0 l 0 sec0 ls ds  c
from now on we will take g to be the stratified nilpotent lie group n  and
de   will denote a left invariant riemannian metric on n while d   is a left
invariant carnotcaratheodory finsler metric on n associated to some norm kk
on m1 
remark 68 there is c0  0 such that c1
0 de e x  d e x  c0 de e x in a
neighborhood of e hence in the situation of the lemma we get d 1 1 2 1 
c1  r for some other constant c1  c1 l d  de 
lemma 69 let n  n and dn x y be the function in n defined in the
following way
z 1
  u du   hp ln   0  x 1  y
dn x y  inf
asymptotic shape of balls in groups with polynomial growth
where hp ln  is the set of horizontal paths  which are piecewise linear with at
most n possible values for    then we have dn  d uniformly on compact
subsets of n 
proof note that it follows from chows theorem eg see 25 or 19 that there
exists k0  n such that a  supd ex1 dk0 e x   moreover since piecewise linear paths are dense in l1  it follows for example from lemma 67 that for
each fixed x dn e x  d e x we need to show that dn e x  d e x uniformly in x satisfying d e x  1 by contradiction suppose there is a sequence
xn n such that d e xn   1 and dn e xn   1  0 for some 0  0 we may
assume that xn n converges to say x let yn  x1  xn and tn  d e yn  then
dk0 e yn   tn dk0 e  1 yn   atn  thus dn e xn   dn e x  dn e yn  
dn e x  atn as soon as n  k0  as n tends to  we get a contradiction
this lemma prompts the following notation for   0 we let n  n be the
first integer such that 1  dn e x  1   for all x with d e x  1 then we
have
lemma 610 for every x  n with d e x  1 and all   0 there exists a
path   0 1  n in hp ln  with unit speed ie k  k  1 such that 0  e
and d x 1  c2  and   has at most one discontinuity on any subinterval of
0 1 of length r n 
proof we know that there is a path in hp ln  connecting e to x with length
l  1   reparametrizing the path so that it has unit speed we get a path
0  0 l  n in hp ln  with d x 0 1  d 0 l 0 1   the derivative 0 is constant on at most n different intervals say ui  ui1  let us remove
all such intervals of length  r n by merging them to an adjacent interval
and let us change the value of 0 on these intervals to the value on the adjacent interval it doesnt matter if we choose the interval on the left or on the
right we obtain a new path   0 1  n in hp ln  with unit speed and
such that   has at most one discontinuity on any subinterval of 0 1 of length
r n  moreover 0 k  t  0 tk dt  r  by lemma 67 and remark 63 we
have d 1 0 1  c1  hence
d 1 x  d x 0 1  d 0 1 1  c1  1
lemma 611 piecewise horizontal approximation of paths let x  y denote the
product inside the stratified lie group n and x  y the ordinary product in n 
let n  n and t  n then for any compact subset k of n  and any x1   xn
elements of k we have
de  1 x1    xn   1 x1    xn   c1
and
de  1 x1    xn   1 1 x1     1 xn   c2
emmanuel breuillard
where c1  c2 depend on k and de only
proof let kk be a norm on the lie algebra of n for k  1  n let zk 
x1    xk1 and yk  xk1    xn  since all xi s belong to k it follows from 24
that as soon as t  n all  1 zk  and  1 yk  for k  1  n remain in a bounded set
depending only on k comparing 12 and 11 we see that whenever y  o1
and  1 x  o1 we have
on the other hand from 12 it is easy to verify that right multiplication by a
bounded element is lipschitz for kk and the lipschitz constant is locally bounded
it follows that there is a constant c1  0 depending only on k and kk such
that for all k  n
 1 xy   1 x  y  o
 1 zk  xk   yk    1 zk  xk  yk   c1  1 zk  xk    1 zk  xk 
applying n times the relation 35 with x  x1    xk1 and y  xk  we finally
obtain
 1 x1    xn    1 x1    xn   o 2   o 
where o depends only on k on the other hand using 11 it is another simple
verification to check that if x y lie in a bounded set then c12 de x y  kx  yk
 c2 de x y for some constant c2  0 the first inequality follows
for the second inequality we apply lemma 67 to the paths 1 and 2 starting
1 xk 
at e and with derivative equal on  nk  k1
for 2 
n  to n 1t xk  for 1 and to n
we get
de  1 x1    xn   1 1 x1     1 xn   o 
remark 612 from remark 63 we see that if we replace de by d in the above
lemma we get the same result with 1t replaced by t r 
lemma 613 approximation in the abelianized group recall that kk0 is the
norm on m1 defined in 33 for any   0 there exists s0  0 such that for every
s  s0 and every v  m1 such that kvk0  1 there exists h  h such that
1  s  e h  1  s
and
1 h
e h
proof let   0 be fixed considering a finite net in e we see that there exists
a finite symmetric subset g1   gp  of he such that if we consider the closed
convex hull of f  fi  1 gi e gi i  1  p and kk the associated norm
on m1  then kk0  kk  1  2 kk0  up to shrinking f if necessary we may
assume that kfi k  1 for all is we may also assume that the fi s generate m1 as
asymptotic shape of balls in groups with polynomial growth
a vector space the sphere x kxk  1 is a symmetric polyhedron in m1 and to
each of its facets corresponds d  dimm1  vertices lying in f and forming a vector
basis of m1  let f1   fd  say be such vertices for a given facet if x  m1 is of the
form x  di1 i fi with i  0 for 1  i  d then we see that kxk  di1 i 
because the convex hull of f1   fd is precisely that facet hence lies on the sphere
x kxk  1
now let v  m1  kvk0  1 and let s  0 the half line tv t  0 hits the
sphere x kxk  1 in one point this point belongs to some facet and there
are d linearly independent elements of f say f1   fd  the vertices of that facet
such that this point belongs to the convex hull of f1   fd  the point sv then lies
in the convex cone generated by 1 g1   1 gd  moreover there is a constant
c  0 c  d2 max1ip e gi  such that
sv 
ni 1 gi 
for some nonnegative integers n1   nd depending on s  0 hence
ni e gi  
1 x
ni 1 gi 
 ksvk  c 
 1  2 
 1  3
where the last inequality holds as soon as s  c 
now let h  g1n1    gdnd  h we have 1 h  di1 ni 1 gi 
e h  k1 hk0  s  c  s1  
moreover
e h 
ni e gi   s1  3
changing  into say 5 and for say   12  we get the desired result with s0  
 max1ip e gi  
64 proof of theorem 62 we need to show that as x   in n
e x
e x
 lim
1  lim
d e x
d e x
first note that it is enough to prove the bounds for x  h this follows from
42 1
let us begin with the lower bound we fix   0 and s  s as in the definition
of an asymptotically geodesic metric see 21 we know by 42 3 and 4 that
as soon
x  s we may find x1   xn in h with s  e xi   2s such that
q as e p
x  xi and
e xi   1  e x let t  d e x then n  1
s e x
hence n  s t where c is a constant depending only on  see 23 we may
emmanuel breuillard
then apply lemma 611 and the remark following it to get as t  n as soon as
s  c
d  1 x  1 1 x1     1 xn   c1 t r
but for each i we have k1 xi k0  e xi  by definition of the norm hence
t  d e x 
k1 xi k0  d x 1 x1     1 xn   1  e x  c1 t1 r
since  was arbitrary letting t   we obtain
lim
e x
d e x
we now turn to the upper bound let t  d e x and   0 according to
lemma 610 there is a horizontal piecewise linear path uu01 with unit
speed such that d  1 x 1  c2  and no interval of length  n  contains
more than one change of direction let s0  be given by lemma 613 and assume
t  s0 r n r  we split 0 1 into n subintervals of length u1   un such that
  is constant equal to yi on the ith subinterval and s0 r   tui  2s0 r  we
have 1  u1 y1    un yn  lemma 613 yields points xi  h such that
yi 
1 xi 
tui
and e xi   1  r tui  1  r tui  note that tui  s0 r  let  be the
piecewise linear path 0 1  n with the same discontinuities as  and where the
value yi is replaced by 1tuxi i   then according to lemma 67 d 1 1  c
since e xi   4s0 r  for each i we may apply lemma 611 and the remark
following it and see that if y  x1    xn 
d 1  1 y  c1 t r
hence d  1 x  1 y  c2 cc1 t r and e y 
e xi   1r t
while x y  c  td e  1 x1 y  c   tcd  1 x  1 y  o 1 hence
e x  t  o t
remark 614 in the last argument we used the fact that  1 xu   1 x  u 
 if  1 x and  1 u are bounded in order to get for y  xu
d e  1 u  d  1 x  1 xu  d  1 xu  1 x  u
 d  1 x  1 y  o1
asymptotic shape of balls in groups with polynomial growth
7 locally compact g and proofs of the main results
in this section we prove theorem 12 and complete the proof of theorem 14
and its corollaries we begin with the latter
proof of theorem 14 it is the combination of proposition 51 which reduces the
problem to nilpotent lie groups and theorem 62 which treats the nilpotent case
it only remains to justify the last assertion that d is invariant under t h
since k  t h stabilizes m1 see lemma 312 for the definition of m1  and acts
by automorphisms of the nilpotent nilshadow structure lemma 35 given any
k  k the metric d kx ky is nothing else but the left invariant subfinsler
metric on the nilshadow associated to the norm kkvk for v  m1 if k  k denotes
the norm associated to d 
however d is asymptotically invariant under k because of proposition 51
namely d e kxd e x tends to 1 as x tends to infinity finally d e v 
kvk and d e kv  kkvk for all v  m1  two asymptotic norms on a vector
space are always equal it follows that the norms k  k and kkk on m1 coincide
hence d e kx  d e kx for all x  s as claimed
proof of corollary 18 first some initial remark see also remark 21 if d is
a leftinvariant subfinlser metric on a simply connected nilpotent lie group n
induced by a norm k  k on a supplementary subspace m1 of the commutator
subalgebra then it follows from the very definition of subfinsler metrics see
paragraph 21 that 1 is 1lipschitz between the lie group and the abelianization
of it endowed with the norm kk namely k1 xk  de x with equality if x  m1 
from this and considering the definition of the limit norm in 33 we conclude
that k  k coincides with the limit norm of d in particular theorem 62 implies
that d is asymptotic to the left invariant subfinsler metric d induced by the
same norm k  k on the graded lie group n  
we can now prove corollary 18 by the above remark the limit metric d
on the graded nilshadow of s is asymptotic to the subfinsler metric d induced
by the same norm k  k on the same kinvariant supplementary subspace m1
of the commutator subalgebra of the nilshadow and which is left invariant for
the nilshadow structure on s however it follows from theorem 14 that d
and the norm k  k are kinvariant this implies that d is also leftinvariant
with respect to the original lie group structure of s indeed by 1 we can
write dgx gy  dg  t gx g  t gy  dt gx t gy  dx y where 
denotes this time the nilshadow product structure we are done
proof of corollary 17 this follows immediately from theorem 14 when  denotes the graded nilshadow product if  denotes the nilshadow group structure
then it follows from theorem 62 and the remark we just made in the proof of
corollary 18 see also remark 21
71 proof of theorem 12 let g be a locally compact group of polynomial
growth we will show that g has a compact normal subgroup k such that gk
emmanuel breuillard
contains a closed cocompact subgroup which can be realized as a closed cocompact subgroup of a connected and simply connected solvable lie group of type
r ie of polynomial growth the proof will follow in several steps
a first we show that up to moding out by a normal compact subgroup we may
assume that g is a lie group whose connected component of the identity has no
compact normal subgroup indeed it follows from loserts refinement of gromovs
theorem 24 theorem 2 that there exists a normal compact subgroup k of g
such that gk is a lie group so we may now assume that g is a lie group not
necessarily connected of polynomial growth the connected component g0 of g
is a connected lie group of polynomial growth recall the following classical fact
lemma 71 every connected lie group has a unique maximal compact normal
subgroup by uniqueness it must be a characteristic lie subgroup
proof clearly if k1 and k2 are compact normal subgroups then k1 k2 is again
a compact normal subgroup considering gk where k is a compact normal
subgroup of maximal dimension we may assume that g has no compact normal
subgroup of positive dimension but every finite normal subgroup of a connected
group is central hence the closed group generated by all finite normal subgroups is
contained in the center of g the center is an abelian lie subgroup ie isomorphic
to a product of a vector space rn  a torus rm zm  a free abelian group zk and a
finite abelian group in such a group there clearly is a unique maximal compact
subgroup namely the product of the finite group and the torus it is also normal
and maximal in g
the maximal compact normal subgroup of g0 is a characteristic lie subgroup
of of g0  it is therefore normal in g and we may mod out by it we therefore have
shown that every locally compact compactly generated group with polynomial
growth admits a quotient by a compact normal subgroup which is a lie group g
whose connected component of the identity g0 has polynomial growth and contains no compact normal subgroup we will now show that a certain cocompact
subgroup of g has the embedding property of theorem 12
b second we show that up to passing to a cocompact subgroup we may
assume that the connected component g0 is solvable for this purpose let q be
the solvable radical of g0  namely the maximal connected normal lie subgroup
of g0  note that it is a characteristic subgroup of g0 and therefore normal in g
moreover g0 q is a semisimple lie group since g0 has polynomial growth it
follows that g0 q must be compact consider the action of g by conjugation on
g0 q namely the map   g  autg0 q since g0 q is compact semisimple
its group of automorphisms is also a compact lie group in particular the kernel
ker  is a cocompact subgroup of g
the connected component of the identity of autg0 q is itself semisimple and
hence has finite center however the image of the connected component ker 0
of ker  in g0 q modulo q is central therefore it must be trivial we have
shown that ker 0 is contained in q and hence is solvable moreover ker 0
asymptotic shape of balls in groups with polynomial growth
has no compact normal subgroup because otherwise its maximal normal compact
subgroup being characteristic in ker 0  would be normal in g note that ker 0
is normal in g
changing g into the cocompact subgroup ker  we can therefore assume that
g0 is solvable of polynomial growth and has no non trivial compact normal subgroup the group gg0 is discrete finitely generated and has polynomial growth
by gromovs theorem it must be virtually nilpotent in particular virtually polycyclic
c we finally prove the following proposition
proposition 72 let g be a lie group such that its connected component of the
identity g0 is solvable admits no compact normal subgroup and with gg0 virtually polycyclic then g has a closed cocompact subgroup which can be embedded
as a closed cocompact subgroup of a connected and simply connected solvable lie
group
the proof of this proposition is mainly an application of a theorem of hc
wang which is a vast generalization of malcevs embedding theorem for torsion
free finitely generated nilpotent groups wangs theorem 36 states that any sgroup can be embedded as a closed cocompact subgroup of a simply connected real
linear solvable lie group with only finitely many connected components wang
defines a sgroup to be any real lie group g which admits a normal subgroup
a such that ga is finitely generated abelian and a is a torsionfree nilpotent
lie group whose connected components group is finitely generated in particular
any sgroup has a finite index hence cocompact subgroup which embeds as a
cocompact subgroup in a connected and simply connected solvable lie group
in order to prove proposition 72 it therefore suffices to establish that g has a
cocompact sgroup
we first recall the following simple fact
lemma 73 every closed subgroup f of a connected solvable lie group s is
topologically finitely generated
proof we argue by induction on the dimension of s clearly there is an epimorphism   s  r by induction hypothesis f  ker  is topologically finitely
generated the image of f is a subgroup of r however every subgroup of r
contains either one or two elements whose subgroup they generate has the same
closure as the original subgroup we are done
next we show the existence of a nilradical
lemma 74 let g be as in proposition 72 then g has a unique maximal
normal nilpotent subgroup gn 
proof the subgroup generated by any two normal nilpotent subgroups of any
given group is itself nilpotent fittings lemma see eg 30528 let gn be
the closure of the subgroup generated by all nilpotent subgroups of g we need
to show that gn is nilpotent for this it is clearly enough to prove that it is
emmanuel breuillard
topologically finitely generated because any finitely generated subgroup of gn is
nilpotent by the remark we just made since gg0 is virtually polycyclic every
subgroup of it is finitely generated 2942 hence it is enough to prove that
gn  g0 is topologically finitely generated this follows from lemma 73
incidently we observe that the connected component of the identity gn 0
coincides with the nilradical n of g0 it is the maximal normal nilpotent connected
subgroup of g0 
we now claim the following
lemma 75 the quotient group ggn is virtually abelian
the proof of this lemma is inspired by the proof of the fact due to malcev
that polycyclic groups have a finite index subgroup with nilpotent commutator
subgroup eg see 30 1516
proof we will show that g has a finite index normal subgroup whose commutator
subgroup is nilpotent this clearly implies the lemma for this nilpotent subgroup
will be normal hence contained in gn 
first we observe that the group g admits a finite normal series gm  gm1 
    g1  g where each gi is a closed normal subgroup of g such that gi gi1
is either finite or isomorphic to either zn  rn or rn zn  this see it pick one of the
gi s to be the connected component g0 and then treat gg0 and g0 separately
the first follows from the definition of a polycyclic group gg0 has a normal
polycyclic subgroup of finite index while for g0  observe that its nilradical n is
a connected and simply connected nilpotent lie group and it admits such a series
of characteristic subgroups pick the central descending series and g0 n is an
abelian connected lie group hence isomorphic to the direct product of a torus
rn zn and a vector group rn  the torus part is characteristic in g0 n  hence its
preimage in g0 is normal in g
the group g acts by conjugation on each partial quotient qi  gi gi1  this
yields a map g  autqi  now note that in order to prove our lemma it is
enough to show that for each i there is a finite index subgroup of g whose commutator subgroup maps to a nilpotent subgroup of autqi  indeed taking the
intersection of those finite index subgroup we get a finite index normal subgroups
whose commutator subgroup acts nilpotently on each qi  hence is itself nilpotent
high enough commutators will all vanish
now autqi  is either finite if qi is finite or isomorphic to gln z in case
qi is either zn or rn zn  or to gln r when qi  rn  the image of g in
autqi  is a solvable subgroup however every solvable subgroup of gln r
contains a finite index subgroup whose commutator subgroup is unipotent hence
nilpotent this follows from kolchins theorem for example that a connected
solvable algebraic subgroup of gln c is triangularizable we are done
in the sequel we assume that gg0 is torsionfree polycyclic it is legitimate
to do so in the proof of proposition 72 because every virtually polycyclic group
has a torsionfree polycyclic subgroup of finite index see eg 29lemma 46
we now claim the following
asymptotic shape of balls in groups with polynomial growth
lemma 76 gn is torsionfree
proof since gg0 is torsionfree it is enough to prove that gn  g0 is torsionfree however the set of torsion elements in gn forms a subgroup of gn if x y are
torsion then xy is too because hx yi is nilpotent clearly it is a characteristic
subgroup of gn  hence its intersection with g0 is normal in g0  taking the
closure we obtain a nilpotent closed normal subgroup t of g0 which contains a
dense set of torsion elements recall that g0 has no normal compact subgroup
from this it quickly follows that t is trivial because first it must be discrete the
connected component t0 is compact and normal in g0  hence finitely generated
by lemma 73 hence made of torsion elements but a finitely generated torsion
nilpotent group is finite again since g0 has no compact normal subgroup t must
be trivial and gn is torsionfree
now observe that the group of connected components of gn  namely gn gn 0
is finitely generated indeed since gg0 is finitely generated as any polycyclic
group it is enough to prove that g0  gn gn 0 is finitely generated but this
follows from the fact that g0  gn is topologically finitely generated lemma 73
now we are almost done note that g is topologically finitely generated lemma
73 therefore so is ggn  by lemma 75 ggn is virtually abelian hence has
a finite index normal subgroup isomorphic to zn  rm  it follows that ggn
has a cocompact subgroup isomorphic to a free abelian group znm  hence after
changing g by a cocompact subgroup we get that g is an extension of gn a
torsionfree nilpotent lie group with finitely generated group of connected components by a finitely generated free abelian group hence it is an sgroup in the
terminology of wang 36 we apply wangs theorem and this ends the proof of
proposition 72
d we can now conclude the proof of theorem 12 by a and b g has
a quotient by a compact group which admits a cocompact subgroup satisfying
the assumptions of proposition 72 hence to conclude the proof it only remains
to verify that the simply connected solvable lie group in which a cocompact
subgroup of gk embeds has polynomial growth ie is of type r but this
follows from the following lemma see 21thm i2
lemma 77 let g be a locally compact group then g has polynomial growth if
and only if some resp any cocompact subgroup of it has polynomial growth
proof first one checks that g is compactly generated if and only if some resp
any cocompact subgroup is this is by the same argument which shows that
finite index subgroups of a finitely generated group are finitely generated in
particular if  is a compact symmetric generating set of g and h is a cocompact
subgroup then there is n0  n such that n0 h  g then h  3n0 generates
if g has polynomial growth and h is any compactly generated closed subgroup
then h has polynomial growth indeed see 21thm i2 if h denotes a compact generating set for h and k a compact neighborhood of the identity in g
emmanuel breuillard
then
volg kvolh nh   volh kk 1  hvolg nh k
this inequality
follows by integrating over a left haar measure of g the function
x  n 1k h1 xdh where dh is a left haar measure on h this integral
equals the left handside of the above displayed equation while it is pointwise
bounded by volh xk 1  h inside hk and by zero outside hk
in the other direction if h has polynomial growth then g also has because
one can write n  nh k for some compact generating set h of h and some
compact neighborhood k of the identity in g see proposition 44 then the
result follows from the following inequality
volh h volg nh k  volh n1
h volg h k
which itself is a direct consequence of the fact that the function
11 k h1 xdh
where dh is a left haar measure on h satisfies g xdx  volh n1
h volg h k
on the one hand and is bounded below by volh h  for every x  h k on the
other hand
note that the above proof would be slightly easier if we already knew that both
g and h were unimodular in which case gh has an invariant measure but
we know this only a posteriori because the polynomial growth condition implies
unimodularity 21
similar considerations show that g has polynomial growth if and only if gk
has polynomial growth given any normal compact subgroup k eg see 21
we end this paragraph with a remark and an example which we mentioned in
the introduction
remark 78 discrete subgroups are virtually nilpotent suppose  is a discrete
subgroup of a connected solvable lie group of type r ie of polynomial growth
then  is virtually nilpotent indeed a similar argument as in lemma 73 shows
that every subgroup of  is finitely generated it follows that  is polycyclic however wolf 37 proved that polycyclic groups with polynomial growth are virtually
nilpotent
example 79 a group with no nilpotent cocompact subgroup let g be the
connected solvable lie group g  r  r2  r2  where r acts as a dense oneparameter subgroup of so2 r  so2 r then g is of type r it has no
compact subgroup and it has no nilpotent cocompact subgroup indeed suppose h
is a closed cocompact nilpotent subgroup then it has a nontrivial center hence
there is a non identity element whose centralizer is cocompact in g however a
simple examination of the possible centralizers of elements of g shows that none
of them is cocompact
asymptotic shape of balls in groups with polynomial growth
72 proof of corollary 16 and theorem 11 let g be an arbitrary locally
compact group of polynomial growth and  a periodic pseudodistance on g
claim 1 corollary 16 holds for a cocompact subgroup h of g if and only
if it holds for g by lemma 77 the groups g and h are unimodular and hence
gh bears a ginvariant radon measure volgh  which is finite since h is cocompact now let f be a bounded borel fundamental domain for h inside g and
let  be the periodic pseudodistance on g induced by the restriction of  to h that
is x y  hx  hy  where hx is the unique element of h such that x  hx f by
42 1 and 4  and  are at a bounded distance from each other in particular
b r  c  b r  b r  c hence if the limit 3 holds for  it also holds for
 with the same limit however b r  x  g e hx   r  bh rf where
h is the restriction of  to h hence volg b r  volh bh r  volgh f 
by 42 4 h is a periodic pseudodistance on h so the result holds for h h 
if and only if it holds for g  conversely if 0 is a periodic pseudodistance
on h then 0 x y  0 hx  hy  is a periodic pseudodistance on g hence again
volg b0 r  volh b0 r  volg f  and the result will hold for h 0  if and
only if it holds for g 0 
claim 2 if corollary 16 holds for gk where k is some compact normal
subgroup then it holds for g as well indeed if  is a periodic pseudodistance on
g then the kaverage k  as defined in 26 is at a bounded distance from g
according to lemma 47 now k induces a periodic pseudodistance k on gk
and bk r  bk rk hence volg bk r  volgk bk r  volk k and
if the limit 3 holds for k  it also holds for k  hence for  too
thus the discussion above combined with theorem 12 reduces corollary 16 to
the case when g is simply connected and solvable which was treated in section 5
and 6
73 proof of proposition 13 and corollary 19
proof of proposition 13 we say that two metric spaces x dx  and y dy  are
at a bounded distance if they are 1 cquasiisometric for some finite c this is
an equivalence relation now if  is hperiodic with h cocompact then g 
is at a bounded distance from h h hence we may assume that h  g ie
that  is left invariant on g
now theorem 12 gives the existence of a normal compact subgroup k a cocompact subgroup h containing k and a simply connected solvable lie group s
such that hk is isomorphic to a cocompact subgroup of s
lemma 47 shows that g  is at a bounded distance from g k  where k
is defined as in 26 now k induces a left invariant periodic metric on gk
and gk k  is clearly at a bounded distance from g k  now by 42 its
restriction to hk is at a bounded distance and is left invariant now we set
s s1  s2   k h1  h2  where given a bounded fundamental domain f for the
emmanuel breuillard
left action of hk on s hi is the unique element of hk such that si  hi f 
clearly then s s  is at a bounded distance from hk k  we are done 
we note that our construction of s here depends on the stabilizer of  in g
certainly not every choice of lie shadow can be used for all periodic metrics think
that r3 is a lie shadow of the universal cover of the group of motions of the plane
perhaps a single one can be chosen for all but we have not checked that
proof of corollary 19 proposition 13 reduces the proof to a periodic metric 
on a simply connected solvable lie group s let d the subfinsler metric on s
left invariant for the graded nilshadow group structure sn  as given by theorem
14 let t t is the group of dilations in the graded nilshadow sn of s as defined
in section 3 by definition of the pointed gromovhausdorff topology see 18
it is enough to prove the
claim the following quantity
 s1  s2   d  1 s1   1 s2 
converges to zero as n tends to  uniformly for all s1  s2 in a ball of radius on
for the metric 
now this follows in three steps first  is at a bounded distance from its
restriction to the cocompact stabilizer h of  cf 42 1 42 4 then
for h1  h2  h we can write h1  h2   e h1
1 h2  however proposition 51
implies the existence of another periodic distance k on s which is invariant
under left translations by elements of h for both the original lie structure and
tends to 1 as x tends to
the nilshadow lie structure on s such that ex
k ex
 hence k e h1
1 h2   k h1  h2   k e h1 h2  where  is the nilshadow
product on s hence  n h1  h2   n k e h1 h2  tends to zero uniformly as h1
and h2 vary in a ball of radius on for 
finally theorem 62 implies that  n1 k e h1
1 h2   n d e h1 h2  tends to
zero and the claim follows as one verifies from the campbell hausdorff formula
by comparing 11 and 12 as we did in 35 that
d  1 h1   1 h2   d e  1 h1
1 h2 
converges to zero
the fact that the graded nilpotent lie group does not depend up to isomorphism on the periodic metric  but only on the locally compact group g follows from pansus theorem 28 that if two carnot groups ie a graded simply
connected nilpotent lie group endowed with leftinvariant subriemannian metric
induced by a norm on a supplementary subspace to the commutator subalgebra
are bilipschitz the underlying lie groups must be isomorphic this deep fact
relies on pansus generalized rademacher theorem see 28 indeed two different periodic metrics 1 and 2 on g are quasiisometric see proposition 44
and hence their asymptotic cones are bilipschitz and bilipschitz to any carnot
group metric on the same graded group by 13
asymptotic shape of balls in groups with polynomial growth
8 coarsely geodesic distances and speed of convergence
under no further assumption on the periodic pseudodistance  the speed of
convergence in the volume asymptotics can be made arbitrarily small this is
easily seen if we consider examples of the following type define x y  x  y 
x  y on r where   0 1 it is periodic and volb t  t  t  ot 
however many natural examples of periodic metrics such as word metrics or
riemannian metrics are in fact coarsely geodesic a pseudodistance on g is said
to be coarsely geodesic if there is a constant c  0 such that any two points can
be connected by a ccoarse geodesic that is for any x y  g there is a map
g  0 t  g with t  x y g0  x and gt  y such that
gu gv  u  v  c
for all u v  0 t
this is a stronger requirement than to say that  is asymptotically geodesic
see 21 this notion is invariant under coarse isometry in the case when g
is abelian d burago 6 proved the beautiful fact that any coarsely geodesic
periodic metric on g is at a bounded distance from its asymptotic norm in
particular volg b t  c  td  otd1  in this case in the remarkable paper 32
m stoll proved that such an error term in otd1  holds for any finitely generated
2step nilpotent group whether otd1  is the right error term for any finitely
generated nilpotent group remains an open question
the example below shows on the contrary that in an arbitrary lie group of
polynomial growth no universal error term can be expected
theorem 81 let n  0 be an arbitrary sequence of positive numbers tending
to 0 then there exists a group g of polynomial growth of degree 3 and a compact
generating set  in g and c  0 such that
volg n 
 1  n
c  n3
holds for infinitely many n although
volg n 
cn3
 1 as n  
the example we give below is a semidirect product of z by r2 and the metric
is a word metric however many similar examples can be constructed as soon as
the map t  g  k defined in paragraph 51 in not onto for example one can
consider left invariant riemannian metrics on g  r  r2  r2  where r acts
by via a dense oneparameter subgroup of the 2torus s 1  s 1  incidently this
group g is known as the mautner group and is an example of a wild group in
representation theory
81 an example with arbitrarily small speed in this paragraph we describe
the example of theorem 81 let g  z  r2 where the action of z is given by
the rotation r of angle    0 1 the group g is quasiisometric to r3
and hence of polynomial growth of order 3 and it is cocompact in the analogously
f  r  r2  its nilshadow is isomorphic to r3  the point is
defined lie group g
emmanuel breuillard
figure 2 the union of the two cones with basis the disc of radius
2 represents the limit shape of the balls n in the group z  r2 
where z acts by an irrational rotation with generating set  
1 0 0  0 x1  x2  41 x21  x22  1
that if  is a suitably chosen liouville number then the balls in g will not be
well approximated by the limit norm balls
elements of g are written k x where k  z and x  r2  let kxk2  41 x21  x22
be a euclidean norm on r2  and let  be the symmetric compact generating set
given by 1 0  0 x kxk  1 it induces a word metric  on g it follows
from theorem 14 and the definition of the asymptotic norm that  e k x is
asymptotic to the norm on r3 given by 0 e k x  k  kxk0 where kxk0 is
the rotation invariant norm on r2 defined by kxk20  41 x21  x22  the unit ball of
kk0 is the convex hull of the union of all images of the unit ball of kk under all
rotations rk  k  z
we are going to choose  as a suitable liouville number so that 36 holds let
n  4n 13 and choose  so that the following holds for infinitely many ns
dk z    2n
for
p all nki  z k  n this is easily seen to be possible if we choose  of the form
13 for some suitable lacunary increasing sequence of ni i 
note that since kxk0  kxk  we have   0  let sn be the piece of r2 defined
by sn    n  where  is the angle between the point x and the vertical axis
asymptotic shape of balls in groups with polynomial growth
re2  we claim that if x  sn  0 e k x  n and n satisfies 37 then
 kxk0
it follows easily from the claim that volg n   1  n   volg b0 n moreover
volg b0 n  c  n3  on2  where c  4
3 if volg is given by the lebesgue
measure
proof of claim here is the idea to prove the claim to find a short path between
the identity and a point on the vertical axis we have to rotate by a rk such that
k is close to 21  hence go up from 0 0 to k 0 first thus making the vertical
direction shorter however if 37 holds the vertical direction cannot be made as
short as it could after rotation by any of the rk with k  n
note that if 0 e k x  n then k  n and  e k x  kinfp krki  xi k
where the infimum is taken over all paths x1   xn such that x 
xi and all
rotations rki  with ki   n note that if n is small enough and 37 holds
then forpevery x  sn we have krk xk  1  n2  kxk0  on the other hand
kxk0  kxi k0 cosi  where i is the angle between xi and the x hence
krki  xi k
krki  xi k 
krki  xi k 
 e k x  k  1 
i n
i n
 1  n2 
kxi k0 cosi  
i n
 1 
kxi k0 cosi 
cosn 
i n
  kxk0
82 limit shape for more general word metrics on solvable lie groups
of polynomial growth the determination of the limit shape of the word metric
in paragraph 81 was possible due to the rather simple nature of the generating
set in general using the identity see 1
1      m  1  t 1 2       t m1      1 m 
it is easy to check that the unit ball of the limit norm k  k inducing the limit
subfinsler metric d on the nilshadow associated to a given word metric with
generating set  is contained in the korbit of the convex hull of the projection
of  to the abelianized nilshadow namely the convex hull of k  1 
in the example of paragraph 81 we even had equality between the two however this is not the case in general for example the limit shape is always kinvariant but clearly the limit shape associated to a generating set  coincides
with the one associated with a conjugate gg1 of it while the convex hull of the
respective korbits may not be the same
of course if the generating set  is kinvariant to begin with then n  n
and we are back in the nilpotent case where we know that the unit ball of the
limit norm is just the convex hull of the projection of the generating set to the
abelianization in general however it is a challenging problem to determine the
emmanuel breuillard
precise asymptotic shape of a word metric on a general solvable lie group with
polynomial growth and there seems to be no simple description analogous to what
we have in the nilpotent case
even in the above example g  z  r2  or in the universal cover of the group
of motions of the plane in which g embeds cocompactly it is not that simple
in general the shape is determined by solving an optimization problem in which
one has to find the path which maximizes the coordinates of the endpoint in
order to illustrate this we treat without proof the following simple example
suppose  is a symmetric compact neighborhood of the identity in g  z r2
of the form   0 0   1 1   1 1 1  where 0  1  r2  then the
limit shape of the word metric  associated to  is the solid body rotationally
symmetric around the vertical axis as in figure 2 made of two copies upper and
lower of a truncated cone with base a disc on 0 r2  of radius maxr0  r1  and
top resp bottom a disc on the plane 1 r2  resp 1 r2  of radius r2  where
the radii are given by
r0  maxkxk x  0  r1 
diam1 
where diam1  is the diameter of 1 and r2 is given by the integral
z 2
max 1  
r2 
where  1  is the orthogonal projection on the xaxis of image of 1  r2 by a
rotation of angle  around the origin it is indeed convex note that r2  r1 
for example if 1 is made of only one point then the limit shape is the same
as in the previous paragraph and as in figure 2 namely two copies of a cone
however if 1 is made of two points a b then the upper part of the limit shape
which is the
will be a truncated cone with an upper disc of radius r2  kabk
result of the computation of the above integral
let us briefly explain the formula 39 a path of length n reaching the highest
zcoordinate in g is a word of the form 1 1       1 n  with i  1  by
38 this word equals
ri1 i 
here i can take any value in 1  in order to maximize the norm of the second
coordinate or equivalently by rotation invariance its xcoordinate one has to
choose i  1 at each stage in such a way that the xcoordinate of ri1 i is
maximized formula 39 now follows from the fact that ri1 1in becomes
equidistributed in so2 r as n tends to infinity
in order to show that maxr0  r1  is the radius of the base disc and more
generally that the limit shape is no bigger than this double truncated cone one
needs to argue further by considering
all possible paths of the form 1  1      
n  n  where i  0 1 and
i is prescribed
asymptotic shape of balls in groups with polynomial growth
83 bounded distance versus asymptotic metrics in this paragraph we answer a question of d burago and g margulis see 7 based on the abelian case
and the reductive case abelsmargulis 1 burago and margulis had conjectured
that every two asymptotic word metrics should be at a bounded distance we give
below a counterexample to this we first give an example a of a nilpotent lie
group endowed with two left invariant subfinsler metrics d and d that are
asymptotic to each other ie d e xd e x  1 as x   but such that
d e x  d e x is not uniformly bounded then we exhibit b a word metric that is not at a bounded distance from any homogeneous quasinorm finally
these examples also yield c two word metrics 1 and 2 on the same finitely
generated nilpotent group which are asymptotic but not at a bounded distance
note that the group g with 0 and  from the last paragraph also provides
an example of asymptotic metrics which are not at a bounded distance but this
group was not discrete
a let n  r  h3 r where h3 is classical heisenberg group and  
z  h3 z a lattice in n  in the lie algebra n  rv  h3 we pick two different
supplementary subspaces of n n  rz ie m1  spanv x y  and m1 
spanv  z x y  where h3 is the lie algebra of h3 r spanned by x y and
z  x y  we consider the l1 norm on m1 resp m1  corresponding to the basis
v x y  resp v  z x y  both norms induce the same norm on nn n
they give rise to left invariant carnotcaratheodory finsler metrics on n  say
d resp d  we use the coordinates v x y z  expvv  xx  yy  zz
according to remark 2 after theorem 62 d and d are asymptotic let
us show that they are not at a bounded distance first observe that since v
is central d e v x y z  v  dh3 e x y z where dh3 is the carnotcaratheodory finsler metric on h3 r defined by the standard l1 norm on the
spanx y  similarly d e v x y z  v  dh3 e x y z  v if d and
d were at a bounded distance we would have a c  0 such that for all t  0
d e t 0 0 t  t  c
hence dh3 e 0 0 t  c which is a contradiction
b now let   1 0 0 11  1 0 0 11  0 1 0 01  0 0 1 01 
be a generating set for  and  the word metric associated to it let    be
a homogeneous quasinorm on n which is at a bounded distance from   ie
 e g  g is bounded then    is asymptotic to   hence is equal to the
carnotcaratheodory finsler metric d asymptotic to  and homogeneous with
respect to the same one parameter group of dilations t t0  let m1  v  n
t v  tv then d is induced by some norm kk0 on m1  whose unit ball is
given according to theorem 14 by the convex hull of the projections to m1 of the
generators in  there is a unique vector in m1 of the form v  z0 z its kk0 norm
is 1 and de 1 0 0 z0   1 however de v x y z  v  dh3 e x y z 
vz0  since  e n 0 0 n  n we get
de n 0 0 n   e n 0 0 n  dh3 e 0 0 n1  z0 
emmanuel breuillard
if this is bounded this forces z0  1 but we can repeat the same argument with
n 0 0 n which would force z0  1 a contradiction
c let now 2  1 0 0 01  0 1 0 01  0 0 1 01  and 2 the
associated word metric on  then again  and 2 are asymptotic by theorem
62 because the convex hull of their projection modulo the zcoordinate coincide
however 2 is a product metric namely we have 2 e v x y z  v 
e x y z where  is the word metric on the discrete heisenberg group h3 z
with standard generators 1 0 01  0 1 01  in particular
 e n 0 0 n  2 e n 0 0 n  e 0 0 n
which is unbounded
remark 82 an abnormal geodesic we refer the reader to 9 for more on
these examples in particular we show there that 1 and 2 above are not 1 cquasiisometric for any c  0 the key phenomenon behind this example is
the presence of an abnormal geodesic see 25 namely the oneparameter group
t 0 0 0t 
remark 83 speed of convergence in the nilpotent case the slow speed phenomenon in theorem 81 relied crucially on the presence of a nontrivial semisimple part in g  this doesnt occur in nilpotent groups in 9 we show that for
word metrics on finitely generated nilpotent groups the convergence in theorem
62 has a polynomial speed with an error term at least as good as od e x 3r 
where r is the nilpotency class we conjecture there that the optimal exponent is 21 
this involves refining quantitatively the estimates of the above proof of theorem
9 appendix the heisenberg groups
here we show how to compute the asymptotic shape of balls in the heisenberg
groups h3 z and h5 z and their volume thus giving another approach to the
main result of stoll 33 the leading term for the growth of h3 z is rational
for all generating sets prop 91 below whereas in h5 z with its standard
generating set it is transcendental this explains how our figure 1 was made
compare with the odd 22 fig 1
91 3dim heisenberg group let us first consider the heisenberg group
h3 z  ha ba a b  b a b  1i 
we see it as the lattice generated by a  expx and b  expy  in the real
heisenberg group h3 r with lie algebra h3 generated by x y and spanned by
x y z  x y  let  be the standard word metric on h3 z associated to
the generating set   a1  b1  according to theorem 14 the limit shape of
the nball n in h3 z coincides with the unit ball c3  g  h3 r d e g 
1 for the carnotcaratheodory metric d induced on h3 r by the l1 norm
kxx  yy k0  x  y on m1  spanx y   h3 
asymptotic shape of balls in groups with polynomial growth
computing this unit ball is a rather simple task exchanging the roles of x
and y  we see that c3 is invariant under the reflection z 7 z then clearly c3 is
of the form xx  yy  zz with x  y  1 and z  zx y changing x to
x and y to y we get the symmetries zx y  zx y  zx y  zy x
hence when determining zx y we may assume 0  y  x  1 x  y  1
the following well known observation is crucial for computing zx y if t is a
horizontal path in h3 r starting from id then t  expxtx yty ztz
where   t  xtx  yty and zt is the balayage area of the between the
path xsx  ysy 0st and the chord joining 0 to xtx  yty
therefore zx y is given by the solution to the dido isoperimetric problem
see 25 find a path in the x y plane between 0 and xx  yy of kk0 length 1
that maximizes the balayage area since kk0 is the l1 norm in the x y plane
as is wellknown see 8 such extremal curves are given by arcs of square with
sides parallel to the x y axes there is therefore a dichotomy the arc of square
has either 3 or 4 sides it may have 1 or 2 sides but these are included are limiting
cases of the previous ones
if there are 3 sides they have length l x and y  l with y  l  x hence
1  l  x  y  l and zx y  lx  21 xy therefore this occurs when y  3x  1
and we then have zx y  x1x
if there are 4 sides they have length l x  u y  l and u with l  y  x  u
hence 1  2l  2u  x  y and zx y  l  yx  u  xy
2  this occurs when
y  3x  1 and we then have zx y  1xy
hence if 0  y  x  1 and x  y  1
zx y  1y3x1
x1  x
1  x  y2 xy
 1y3x1
the unit ball c3 drawn in figure 1 is the solid body c3  xx  yy  zz with
x  y  1 and z  zx y
in the lebesgue measure dxdydz
a simple calculation shows that volc3   72
since h3 z is easily seen to have covolume 1 for this haar measure on h3 r
actually xx yy zz x  0 1 y  0 1 z  0 1 is a fundamental domain
it follows that
 volc3  
lim
we thus recover a wellknown result see 4 31 where even the full growth series
is computed and shown to be rational
one can also determine exactly which points of the sphere c3 are joined to id
by a unique geodesic horizontal path the reader will easily check that uniqueness
fails exactly at the points x y zx y with x  31 and y  0 or y  31 and
x  0 or else at the points x y z with x  y  1 and z  zx y
the above method also yields the following result
emmanuel breuillard
proposition 91 let  be any symmetric generating set for h3 z then the
leading coefficient in n  is rational ie
lim
is a rational number
proof we only sketch the proof here we can apply the method above and compute r as the volume of the unit ccball c of the limit ccmetric d defined in theorem 14 since we know what is the norm kk in the x yplane
m1  span hx y i that generates d it is the polygonal norm given by the convex hull of the points of  we can compute c explicitly we need to know
the solution to didos isoperimetric problem for kk in m1  and as is well known
see 8 it is given by polygonal lines from the dual polygon rotated by 90  since
the polygon defining kk is made of rational lines points in  have integer coordinates any vector with rational coordinates has rational kklength and the dual
polygon is also rational the equations defining zx y will therefore have only
rational coefficients and zx y will be piecewisely given by a rational quadratic
form in x and y where the pieces are rational triangles in the x yplane the
total volume of c will therefore be rational 
92 5dim heisenberg group the heisenberg group h5 z is the group generated by a1  b1  a2  b2 c with relations c  a1  b1   a2  b2  a1 and b1 commute with
a2 and b2 and c is central let   a1
i  bi  i  1 2 let us describe the limit
shape of   again we see h5 z as a lattice of covolume 1 in the group h5 r
with lie algebra h5 spanned by x1  y1 x2  y2 and z  xi  yi  by theorem 14
the limit shape is the unit ball c5 for the carnotcaratheodory metric on h5 r
induced by the l1 norm kx1 x1  y1 y1  x2 x2  y2 y2 k0  x1   y1   x2   y2 
since x1  y1 commute with x2  y2  in any piecewise linear horizontal path in
h5 r we can swap the pieces tangent to x1 or y1 with those tangent to x2 or
y2 without changing the end point of the path therefore if t  expx1 tx1 
y1 ty1  x2 tx2  y2 ty2  ztz is a horizontal path then zt  z1 t 
z2 t where zi t i  1 2 is the balayage area of the plane curve xi sxi 
yi syi 0st 
since just like for h3 z we know the curve maximizing this area we can
compute the unit ball c5 explicitly in exponential coordinates it will take the
form c5  expx1 x1  y1 y1  x2 x2  y2 y2  zz x1   y1   x2   y2   1 and
z  zx1  y1  x2  y2  then zx1  y1  x2  y2   sup0t1 zt x1  y1   z1t x2  y2 
where zt x y is the maximum balayage area of a path of length t between 0
and xx  yy it is easy to see that zt x y  t2 zxt yt where z is given by 40
hence zt is a piecewise quadratic function of t again zx1  y1  x2  y2  is invariant
under changing the signs of the xi yi s and swapping x and y or else swapping
1 and 2 we may thus assume that the xi yi s lie in d  0  yi  xi  1 and
x1 y1 x2 y2  1 and x2 y2  x1 y1  we may therefore determine explicitly
the supremum zx1  y1  x2  y2  which after some straightforward calculations takes
asymptotic shape of balls in groups with polynomial growth
on d the following form
zx1  y1  x2  y2   1a maxd1  d2   1b maxd1  c1   1c maxc1  c2 
1 y1
1  x1  y1  x2  y2 2  x2 y2 x
where d1  x12y1  x22 1  x1  y1  x2  c1  16
and d2 and c2 are obtained from d1 and c1 by swapping the indices 1 and 2 the
sets a b and c form the following partition of d  a  d  m  x1  y1 
b  d  x1  y1  m  x2  y2  and c  d  x2  y2  m where m 
1  x1  x2  y1  y2 2
since c5 has such an explicit form it is possible to compute its volume the fact
that zx1  y1  x2  y2  is piecewisely given by the maximum of two quadratic forms
makes the computation of the integral somewhat cumbersome but tractable our
equations coincide fortunately with those of stoll appendix of 33 where he
computed the main term of the asymptotics of n  by a different method stoll
did calculate that integral and obtained
log2
2009
 volc5  
21870
32805
which is transcendental it is also easy to see by this method that if we change
1 1 1
the generating set to 0  a1
1 b1 a2 b2  then we get a rational volume hence
the rationality of the growth series of h5 z depends on the choice of generating
set which is stolls theorem
one advantage of our method is that it can also apply to fancier generating
sets the case of heisenberg groups of higher dimension with the standard generating set is analogous the function zxi  yi  is again piecewisely defined as
the maximum
pof finitely many explicit quadratic forms on a linear partition of the
l1 unit ball
xi   yi   1
lim
acknowledgments i would like to thank amos nevo for his hospitality at the
technion of haifa in december 2005 where part of this work was conducted and
for triggering my interest in this problem by showing me the possible implications
of theorem 11 to ergodic theory my thanks are also due to v losert for
pointing out an inaccuracy in my first proof of theorem 12 and for his other
remarks on the manuscript finally i thank y de cornulier m duchin e le
donne y guivarch a mohammadi p pansu and r tessera for several useful
conversations
references
1 h abels and g margulis coarsely geodesic metrics on reductive groups in modern dynamical systems and applications pages 163183 cambridge univ press cambridge 2004
2 l auslander and l w green ginduced flows amer j math 88 1966 4360
3 h bass the degree of polynomial growth of finitely generated nilpotent groups proc london
math soc 3 25 1972 603614
4 m benson on the rational growth of virtually nilpotent groups in sm gersten stallings
eds combinatorial group theory and topology ann math studies vol 111 pup 1987
5 v n berestovski homogeneous manifolds with an intrinsic metric i sibirsk mat zh
2961729 1988
emmanuel breuillard
6 d yu burago periodic metrics in representation theory and dynamical systems 205
210 adv soviet math 9 amer math soc 1992
7 d yu burago ga margulis problem session in oberwolfach report geometric group
theory hyperbolic dynamics and symplectic geometry 2006
8 h busemann the isoperimetric problem in the minkowski plane ajm 69 1947 863871
9 e breuillard and e le donne on the rate of convergence to the asymptotic cone for
nilpotent groups and subfinsler geometry preprint 2012
10 a calderon a general ergodic theorem annals of math 57 1953 pp 182191
11 t h colding and w p minicozzi ii liouville theorems for harmonic sections and applications comm pure appl math 512113138 1998
12 l corwin and f p greenleaf representations of nilpotent lie groups and their applications
part i basic theory and examples cambridge univ press 1990 269pp
13 n dungey a f m ter elst and d w robinson analysis on lie groups with polynomial
growth progress in math 214 birkhauser 2003 312pp
14 w r emerson the pointwise ergodic theorem for amenable groups amer j math 96
1974 472487
15 j w jenkins a characterization of growth in locally compact groups bull amer math
soc 79 1973 103106
16 f p greenleaf invariant means on topological groups and their applications van nostrand
mathematical studies no 16 1969 113pp
17 m gromov groups of polynomial growth and expanding maps publications mathmatiques
de lihes no 53 1981 5373
18 m gromov metric structures for riemannian and nonriemannian spaces volume 152 of
progress in mathematics birkhuser boston inc boston ma 1999 based on the 1981
french original with appendices by m katz p pansu and s semmes
19 m gromov carnotcarathodory spaces seen from within in subriemannian geometry
edited by a bellaiche and jj risler 79323 birkauser 1996
20 m gromov asymptotic invariants of infinite groups in geometric group theory vol 2
sussex 1991 1295 london math soc lecture note ser 182 cup 1993
21 y guivarch croissance polynmiale et priodes des fonctions harmoniques bull sc math
france 101 1973 p 353379
22 r karidi geometry of balls in nilpotent lie groups duke math j 74 1994 no 2 301317
23 s a krat asymptotic properties of the heisenberg group zap nauchn sem speterburg
otdel mat inst steklov pomi 261geom i topol 4125154 268 1999
24 v losert on the structure of groups with polynomial growth math z 195 1987 no 1
109117
25 r montgomery a tour of subriemannian geometry ams book 2002
26 a nevo pointwise ergodic theorems for actions of connected lie groups handbook of dynamical systems eds b hasselblatt and a katok to appear
27 p pansu croissance des boules et des godsiques fermes dans les nilvarits ergodic
theory dynam systems 3 1983 no 3 415445
28 p pansu mtriques de carnotcarathodory et quasiisomtries des espaces symtriques de rang
un ann of math 2 129 1989 no 1 160
29 m s raghunathan discrete subgroups of lie groups springer verlag 1972
30 d robinson a course in the theory of groups springerverlag
31 m shapiro a geometric approach to almost convexity and growth of some nilpotent groups
math ann 285 601624 1989
32 m stoll on the asymptotic of the growth of 2step nilpotent groups j london math soc
2 58 1998 no 1 3848
33 m stoll rational and transcendental growth series for higher heisenberg groups invent
math 126 85109 1996
34 a tempelman ergodic theorems for group actions mathematics and its applications 78
kluwer academic publishers 1992
asymptotic shape of balls in groups with polynomial growth
35 r tessera volumes of spheres in doubling measures metric spaces and groups of polynomial
growth bull soc math france 13514764 2007
36 hc wang discrete subgroups of solvable lie groups annals of math 1956 64 119
37 j wolf growth of finitely generated solvable groups and curvature of riemanniann manifolds j differential geometry 2 1968 p 421446
email address emmanuelbreuillardmathupsudfr
universit parissud 11 laboratoire de mathmatiques 91405 orsay france
