draft version may 4 2021
typeset using latex twocolumn style in aastex63
fast particle acceleration in threedimensional relativistic reconnection
hao zhang1 lorenzo sironi2 and dimitrios giannios1
arxiv210500009v1 astrophhe 30 apr 2021
2 department
1 department of physics purdue university west lafayette in 47907 usa
of astronomy and columbia astrophysics laboratory columbia university new york ny 10027 usa
abstract
magnetic reconnection is invoked as one of the primary mechanisms to produce energetic particles we employ largescale threedimensional 3d particleincell simulations of reconnection in
magneticallydominated   10 pair plasmas to study the energization physics of highenergy particles we identify a novel acceleration mechanism that only operates in 3d for weak guide fields 3d
plasmoids  flux ropes extend along the z direction of the electric current for a length comparable to
their crosssectional radius unlike in 2d simulations where particles are buried in plasmoids in 3d
we find that a fraction of particles with   3 can escape from plasmoids by moving along z and so
they can experience the largescale fields in the upstream region these free particles preferentially
move in z along speiserlike orbits sampling both sides of the
 layer and are accelerated linearly in time
 their lorentz factor scales as   t in contrast to   t in 2d the energy gain rate approaches
 eerec c where erec  01b0 is the reconnection electric field and b0 the upstream magnetic field
the spectrum of free particles is hard dnfree d   15  contains  20 of the dissipated magnetic
energy independently of domain size and extends up to a cutoff energy scaling linearly with box size
our results demonstrate that relativistic reconnection in grb and agn jets may be a promising
mechanism for generating ultrahighenergy cosmic rays
keywords magnetic reconnection  radiation mechanisms nonthermal  gammaray burst general
 pulsars general  galaxies jets
1 introduction
highenergy emission from pulsar wind nebulae
pwne and the relativistic jets of active galactic nuclei
agns and gammaray bursts grbs raises a question about the origin of the emitting particles outflows
from these compact objects are believed to be dominated by poynting flux ie the magnetic energy density is greater than the plasma restmass energy density
in grb and agn jets magnetic field lines can reverse
on small scales as a result of the nonlinear stages of
magnetohydrodynamic mhd instabilities romanova
 lovelace 1992 begelman 1998 spruit et al 2001
lyutikov  blandford 2003 giannios  spruit 2006
bttcher 2019 alternatively the jet can carry current
sheets from its base like in pulsar winds lyubarsky 
kirk 2001 drenkhahn  spruit 2002 drenkhahn 2002
kirk  skjaeraasen 2003 giannios  uzdensky 2019
zhan2966purdueedu
lsironiastrocolumbiaedu
cerutti et al 2020 in both cases field reversals on
small scales are prone to magnetic reconnection driving
heating and particle acceleration
magnetic reconnection and in particular the relativistic regime where the magnetic energy dominates
over the plasma rest mass energy is now established as
an efficient mechanism of particle acceleration threedimensional particleincell pic simulations which offer a selfconsistent description of plasma kinetics have
shown that relativistic reconnection naturally produces
powerlaw spectra of accelerated particles zenitani 
hoshino 2008 kagan et al 2013 guo et al 2014 sironi
 spitkovsky 2014 werner  uzdensky 2017 guo et al
2020 the origin of the powerlaw particle spectrum in
twodimensional relativistic reconnection has been recently investigated by eg guo et al 2014 uzdensky 2020 yet basic questions such as how particles
are accelerated to high energies the time scale of acceleration and whether these processes proceed up to
larger fluid scales remain debated the answer to
these questions is critical when evaluating the potential
of relativistic reconnection for explaining highenergy as
trophysical phenomena in relativistic outflows eg the
emission of veryhighenergy photons or the acceleration of ultrahighenergy cosmic rays uhecrs for
instance giannios 2010 proposed that protons escaping the reconnection layer can undergo firstorder fermi
acceleration due to repeated deflections by the converging reconnection upstream flows and can reach energies
up to e  1020 ev in grb and powerful agn jets
in this context it is critical to determine from first
principles the acceleration rate of the highest energy
particles pic simulations of relativistic reconnection
showed that the reconnection layer fragments into a
chain of plasmoids  flux ropes eg sironi et al 2016
recent largescale 2d pic simulations by petropoulou 
sironi 2018 and hakobyan et al 2020 suggested that
the particles populating the highenergy spectral cutoff
reside in a strongly magnetized ring around the plasmoid core their acceleration is driven by the increase
in the local field strength coupled with the conservation
of the first adiabatic invariant they also found
that the
highenergy spectral cutoff grows in time as  t which
appears too slow to explain eg uhecr acceleration
these conclusions may change in a 3d geometry
which would account for the finite length of plasmoids
along the z direction of the electric current in 3d the
zinvariance postulated by 2d simulations can be broken by the oblique tearing instability eg daughton
et al 2011 and the drift kink instability eg zenitani  hoshino 2007 which may modify the 2d picture of particle energization while in 2d particles are
efficiently trapped within plasmoids 3d simulations of
nonrelativistic reconnection dahlin et al 2017 li et al
2019 have shown that selfgenerated turbulence and
chaotic magnetic fields allow highenergy particles to
access multiple acceleration sites within the reconnected
plasma resulting in faster acceleration rates than in 2d
in this work we perform 3d pic simulations of
relativistic reconnection in a magneticallydominated
electronpositron plasma with magnetization ie the
ratio of magnetic energy density to plasma rest mass energy density   10 our inflowoutflow boundary conditions allow to reliably study the statistical steady state
of the system beyond the initial transient we identify
and characterize a novel acceleration mechanism unique
to 3d we find that a fraction of particles with   3
can escape from plasmoids by moving along z and experience the largescale fields in the upstream region1
we point out that the mechanism discussed by li et al 2019 in
nonrelativistic reconnection relied on particles moving between
multiple acceleration sites in the reconnection downstream ie
in the postreconnection plasma
the momentum of these free particles is preferentially
oriented along z they undergo speiserlike deflections
by the converging upstream flows as envisioned by giannios 2010 see also de gouveia dal pino  lazarian
2005 and are accelerated linearly in time  their
lorentz factor scales as   t the energy gain rate approaches  eerec c where erec  01b0 is the reconnection electric field and b0 the upstream magnetic field
the spectrum of free particles is hard and can be modeled as a power law dnfree d   15  whose slope we
justify analytically  extending up to a cutoff energy
that scales linearly with box size we find that the free
particles account for  20 of the dissipated magnetic
energy independently of domain size yet their number
as compared to the particle count in the downstream
plasma decreases with increasing box size
the layout of this paper is as follows in section 2 we
describe the simulation setup we employ in section 3
we present our main results as regard to the particle energy and momentum spectrum the characterization of
particle orbits inside and outside the reconnection layer
and the dependence on the size of the computational domain in section 4 we draw our conclusions and discuss
implications for astrophysical systems we argue that
relativistic reconnection in grb and agn jets may be
a promising mechanism for generating uhecrs
2 simulation setup
we employ 3d pic simulations performed with the
tristanmp code buneman 1993 spitkovsky 2005
the magnetic field is initialized in harris sheet configuration with the field along x reversing at y  0 we
parameterize the field strength b0 by the magnetiza2
tion   bp
0 4n0 mc  c p   where c  eb0 mc
and p  4n0 e2 m are respectively the larmor frequency and the plasma frequency for the cold electronpositron plasma outside the layer with density n0 
the alfvn
p speed is related to the magnetization as
va c     1 we take   10 in addition to the
reversing field we initialize a uniform guide field along
z with strength bg  01 b0  we have also explored a
case with zero guide field and found similar results see
tab 1 we resolve the plasma skin depth cp with
25 cells and initialize an average of one particle in each
cell we have also tested a larger value of four particles
per cell finding no significant change in reconnection
rate maximum energy and particle spectra for more
details see tab 1 the numerical speed of light is 045
cellstimestep we employ periodic boundary conditions in z outflow boundary conditions in x while along
y two injectors continuously introduce fresh plasma and
magnetic flux into the domain for details see sironi
et al 2016 sironi  beloborodov 2020 as opposed to
the commonlyadopted tripleperiodic boundaries our
setup allows to evolve the system to arbitrarily long
times so we can study the statistical steady state for
several alfvnic crossing times
we trigger reconnection near the center of the simulation domain ie near x  y  0 but along the whole
z extent by removing the pressure of the hot particles
initialized in the current sheet as in sironi et al 2016
the characteristic xlength of this region is defined as
init  for our largest 3d simulation see below we
choose init  500cp  for smaller boxes we have
tested different values of init  finding no difference in
our main results see tab 1 for details
for our reference 3d simulation the box length in
x and z respectively lx and lz  is  4000 cells 
1600 cp  while the box extent along y increases over
time as the two injectors recede from the current sheet
we also present results from a set of boxes with fixed lx
but various lz from 1600 cp down to 12 cp  and two
sets of experiments with a fixed ratio lx lz lx lz  1
and lx lz  2 but different box sizes in the following unless otherwise indicated we employ our reference
box with lx  1560 cp and lz  1613 cp  and we
define l  1560 cp as our unit of length
we have also performed a 2d simulation with identical physical and numerical parameters as our reference
3d run aside from a choice of 16 particles per cell to
increase particle statistics to emphasize 3d effects
3 results
fig1 shows two snapshots of the 3d density structure
from our reference simulation 2  the top panel refers to
ctl  047 and shows the two reconnection fronts see
the two overdense regions at x  l4 propagating
away from the center at near the alfvn speed the
bottom panel of fig1 refers to a representative time
ctl  213 when the layer has achieved a statistical
steady state the layer is fragmented into flux ropes of
various sizes with comparable lengths in the z direction
as in the x  y plane the finite extent of plasmoids
along the z direction likely due to the relativistic driftkink instability zenitani  hoshino 2007 2008 plays a
fundamental role for the physics of highenergy particle
acceleration as we describe below
3d instabilities can also change the reconnection rate
as compared to 2d fig2 illustrates the temporal evolution of the reconnection rate rec  vin va for both 2d
blue and 3d red simulations where vin is the inflow
a movie showing the evolution of the density structure can be
found at httpsyoutubefmictkk1qnu
figure 1 two snapshots of density from our reference 3d
simulation we show the density structure at a relatively
early time top t  047 lc when reconnection fronts are
moving outwards and at a later time bottom t  213 lc
when the system has achieved a steady state the upstream
plasma flows into the layer along y while reconnection outflows move along x the electric current is along the z direction which is invariant in 2d simulations
speed and va  c for magneticallydominated plasmas
the initial growth of the boxaveraged reconnection rate
before ctl  08 is just due to the increase of the region where reconnection is active ie between the two
reconnection fronts when the two reconnection fronts
exit the computational domain the rate becomes quasisteady the reconnection rate in 3d rec  0075 is
slower than in 2d rec  012 in either case the rate
is in reasonable agreement with analytical expectations
lyubarsky 2005
the inflowing particles from the two sides of the layer
mix in the reconnection region which we shall also
call reconnected plasma or downstream region in
contrast the prereconnection flow shall be called up
from the upstream region m  m0  we expect that
our results will not change significantly as long as m0
is near 03 eg between 025 and 035
in the following of this section we first study the particle energy and momentum spectra in the 3d simulation and identify that high energy particles preferentially move along the zdirection section 31 then
we track particles and investigate in detail their acceleration mechanism section 32 finally we investigate
the dependence of our results on the domain size in order to show that the acceleration physics should operate
effectively out to larger scales section 33
figure 2 a comparison of the reconnection rate between
3d red and 2d blue simulations the reconnection rate is
calculated by averaging the plasma inflow velocity in units
of the speed of light in the region 003l  y  008l
stream to identify the region of reconnected plasma
we define a mixing factor m
m12
ntop
where ntop is the density of particles that started from
y  0 while n is the total density it follows that m  1
represents the downstream plasma where particles from
the two sides of the layer are well mixed whereas m  0
characterizes the upstream where no mixing has occurred we will use the mixing factor m to identify
whether a particle is located in the upstream or downstream region
using m as a criterion for separating upstream and
downstream regions we study where particles of different energies are located fig 3 shows histograms of
the particle lorentz factor  horizontal axis and mixing factor m vertical axis at time t  237lc for
3d left and 2d right simulations both histograms
suggest that most of the lowenergy particles   30
are located in the downstream region ie m near
unity in 2d all of the highenergy particles are also
located in wellmixed regions ie in the downstream
in agreement with earlier studies highenergy particles
in 2d are trapped within plasmoids sironi et al 2016
petropoulou  sironi 2018 hakobyan et al 2020 in
contrast a significant fraction of highenergy particles
  30 in the 3d simulation lie in lowmixing regions
ie in the upstream as we show below these are particles that have escaped from reconnection plasmoids
and are now being rapidly accelerated by the largescale
upstream fields in the following we will take a threshold of m0  03 horizontal red dotted line in the left
panel to separate the downstream region m  m0 
31 particle spectra
a nonthermal powerlaw spectrum extending to high
energies is a wellestablished outcome of relativistic reconnection eg sironi  spitkovsky 2014 fig 4
shows the positron momentum spectrum pz dndpz 
where pz  z is the dimensionless 4velocity along
z z is the particle zvelocity in units of the speed of
light the spectrum is obtained by averaging between
t  334lc and 356lc when the system is in steady
state the boxintegrated spectrum of positrons with
pz  0 blue indicated as pzbox in the legend can be
modeled for pz  3 as a power law pz dndpz  p1
the figure compares the momentum spectrum between positrons with pz  0 blue lines indicated as pz
in the legend and pz  0 green lines indicated as pz
in the legend and further distinguishes between spectra integrated in the whole box solid lines and only extracted from the reconnection downstream m  m0 
dashed lines we find that highenergy positrons with
pz  0 are mostly located within the downstream region compare green solid and dashed lines ie nonthermal positrons with pz  0 are trapped in plasmoids
in analogy to 2d results see petropoulou  sironi 2018
hakobyan et al 2020
in contrast a significant fraction of highenergy
positrons with pz  0 reside outside the reconnection
region compare blue solid and dashed lines and we
shall call them free the fraction of free positrons is
an increasing function of momentum and for pz  100
they are more numerous than the ones located in the
reconnection downstream the pz spectrum of free
positrons dotted blue line can be modeled as a hard
power law dnfree dpz  pz15  in appendix b we provide an analytical justification of the measured spectral
slope the cutoff in the spectrum of pz  0 positrons is
much higher than for pz  0 positrons suggesting that
figure 3 2d histograms of the particle lorentz factor  and the mixing factor m interpolated to the nearest cell at time
t  237lc for 3d left and 2d right the red dashed line in the left panel marks the threshold m0  03 that we employ
to distinguish upstream m  m0  from downstream m  m0 
101
pzbox
pzrr
pzfree
pzbox
pzrr
pz10
pzdndpz
102
103
104
105
102
103
106 104
107
105
100
100
101
102
101
103
102
103
figure 4 momentum spectrum pz dndpz of positrons
where pz  z is the dimensionless 4velocity along the
z direction we show spectra of positrons with pz  0 blue
indicated as pz in the legend and pz  0 green indicated
as pz in the legend spectra from the overall box are shown
as solid lines indicated with subscript box in the legend
whereas the dashed lines refer only to positrons belonging
to the downstream region as defined by the mixing condition m  m0 indicated with subscript rr in the legend
the spectrum of highenergy free positrons residing in the
upstream region with m  m0  which preferentially have
pz  0 is indicated by the dotted blue line the dotted
black line shows a powerlaw p1
z  in the inset we present
the boxintegrated positron spectra of kinetic energy grey
and momenta in different directions as indicated in the legend all spectra in the main plot and in the inset are timeaveraged between t  334lc and 356lc and normalized
to the total number of positrons in the box
free positrons can be accelerated to much larger energies
than trapped ones as we indeed demonstrate below3
the asymmetry between positrons with pz  0 vs pz 
0 is a unique feature of our 3d setup in a corresponding
2d simulation see appendix a pz and pz spectra
are nearly identical and nearly all highenergy particles
reside within the reconnection downstream as already
shown by fig 3 right panel
in the inset of fig 4 we present the boxintegrated
positron spectra of kinetic energy grey and momentum
in different directions as indicated in the legend in contrast to the pz spectrum there is no broken symmetry
between positive and negative directions in the px and
py spectra the inset shows that the peak of the energy
spectrum grey at   1  3 is dominated by motions
along the x direction of the reconnection outflows compare with the px spectrum red line in contrast the
highenergy cutoff of the positron energy spectrum at
  500 is dominated by the pz spectrum blue so
the most energetic positrons move mostly along the z
direction conversely the highest energy electrons along
z we also remark that the py spectrum orange
reaches rather high momenta albeit not as high as the
pz spectrum this is consistent with the trajectories
of highenergy positrons that we illustrate in sec 32
in summary the momentum spectra in fig 4 show
that most of the highest energy positrons are located
in the reconnection upstream and their momentum is
dominated by the z component which is aligned with
 rec  erec  
the largescale motional electric field e
rec b0  carried by the upstream converging flows if
 rec is the primary agent of acceleration we expect a
linear relation between the gain in lorentz factor 
and the displacement along the zaxis z of the form
the electron spectrum shows the opposite asymmetry electrons
with pz  0 mostly reside in plasmoids and their spectrum extends to lower momenta than for free electrons with pz  0
figure 5 2d histograms of the gain in positron lorentz factor  and displacement along the zaxis z in 3d left plot
and 2d right plot the positrons are selected at the end of the simulations ctl  348 and traced back to the first time
they are saved for the 2d case the particle displacement along the zaxis is calculated by time integration of the z velocity
the relation expected from eq 2 is marked with a dashed white line in the left panel the red and yellow lines in the left panel
represent the tracks in the   z plane of the two highenergy positrons shown in fig 6 in this case the differences  and
z are computed at each time with respect to the initial time when the particle lorentz factor first exceeded   3
eerec
rec p
mc2
in fig 5 we show the relation between  and z
for a sample of  2  106 positrons selected at the end
of the simulations t  348lc for 3d left and 2d
right each particle is traced back to the first time
its lorentz factor exceeded   3 and its overall 
and z are computed4 the plot only shows the quadrant with   0 and z  0 which includes most of
positrons and displays the strongest difference between
2d and 3d
for   100 2d and 3d results are similar there
appears a trend that particles gaining more energy also
display a larger z displacement but the spread is quite
large  may vary by two orders of magnitude for the
same z the similarity between 2d and 3d for  
100 suggests that most of these particles are accelerated
while trapped in plasmoids as found in 2d simulations
petropoulou  sironi 2018 hakobyan et al 2020
the most striking difference between 2d and 3d results is in the behavior of particles experiencing large
energy gains   100 in this range   100 and
z  04 l positrons from the 3d simulation follow
a linear relation   z indicating that they are all
accelerated by the same electric field such a branch is
absent in the corresponding 2d simulation for comparison in the left panel of fig 5 we plot with a dashed
white line the expectation of eq 2 for the measured
rec  0075 the agreement of the highenergy branch
in the 3d histogram with eq 2 confirms that particles
experiencing the largest energy gains are accelerated in
the upstream by the motional electric field erec 
we also point out the excess of positrons lying along
the extrapolation of the dashed white line to low 
in the left panel at 1    5 these positrons are
currently being injected into the acceleration process by
the reconnection electric field so they still obey eq 2
32 particle orbits
to investigate the acceleration mechanism of the highest energy particles we have studied the trajectory of
a large number of highenergy   200 positrons
we present in fig 6 two representative orbits5 their
  z tracks are shown in the left panel of fig 5 by
the two colored lines demonstrating that for   10
they follow a linear relation akin to eq 2
fig 6 shows the particle orbits projected on the x  y
left and y  z middle planes as well as the particle
lorentz factor as a function of lifetime t right panel
measured since a particle first crosses the threshold  
 rec 
3 the acceleration rate due to the electric field e
erec   rec b0  in the upstream flow can be written
in 3d z is directly recorded in 2d it is obtained by time
integration of the z velocity
eerec
z  z rec p 
movies showing the orbits of positron a and b can be found
online at httpsyoutubepjpyzw2vke0 and httpsyoutube
koycphi0wuw respectively
figure 6 trajectories of two representative positrons for each particle its trajectory in the x  y plane is shown in the left
panel and in the y  z plane in the middle panel the color of the line represents the particle energy from red to white as
the energy increases a white filled circle shows the position at a specific time t  228lc for particle a corresponding to a
time t  087lc in the particle life and t  280lc for particle b corresponding to t  103lc the background color
shows the plasma density at that same time in the x  y and y  z slices where the particle is located in the right panel we
show the particle lorentz factor as a function of its lifetime t since it first crossed a threshold   3 the maximum expected
acceleration rate corresponding to eq 4 is shown with a red dashed line
where z is some timeaveraged z velocity in units of
the speed of light the highest acceleration rate will be
achieved when z  1 leading to a maximal rate
max  rec p 
indicated by the dashed red line in fig 6 right we
refer to this as max  since it is the maximum acceleration rate that can be provided by the large scale electric
field even stronger electric fields may transiently appear within the reconnection region which explains why
some particles can temporarily experience an energization rate even larger than this value eg positron b
between t  0408lc
we find that both positron a and b are injected into
the acceleration process in the vicinity of an xpoint in
the midplane of the layer y  0 yet at later times
their histories diverge positron a is energized at nearly
the maximal rate max for most of its life compare blue
and dashed red lines in the right panel of fig 6 its orbit in the y  z plane displays a series of quasiperiodic
deflections between the two sides of the reconnection
layer as expected for speiser motion speiser 1965
yet while speiser orbits in reconnection with a weak
guide field are expected to get focused towards the midplane y  0 eg cerutti et al 2013 the trajectory
of positron a displays a yextent increasing over time
this is caused by interactions with plasmoids whose effect is not taken into account in standard speiser orbits
in fact at the time corresponding to the white circle
in fig 6 a2 the positron has just been deflected towards the upstream by the interaction with the plasmoid located at z  045l the positron lorentz factor at this time is   200 and its lamor radius is
rl  mc2 eb0  008l which is larger than the plas
moid transverse width it follows that the positron will
not be captured by the plasmoid but rather it is deflected away from the midplane which allows positron
a to keep gaining energy at nearly the maximal rate
while executing a speiserlike motion
the orbit of particle b is different and more typical
of the majority of highenergy positrons it is trapped
in a plasmoid in the interval 01lc  t  04lc
during this stage it moves back and forth in both xand zdirections while its lorentz factor stays roughly
constant at   20 the positron succeeds in escaping
the plasmoid at t  05lc after that it experiences
fast acceleration while being deflected in a speiserlike
fashion between the two converting upstream flows similarly to positron a by studying a sample of   30 particles temporarily trapped in a given plasmoid we have
found that the ones that manage to escape have typically larger z velocities and are preferentially located
in the plasmoid outskirts this is expected since such
particles by moving along z will be able to successfully
travel outside the plasmoid and thus experience efficient
acceleration by the upstream field clearly this cannot
happen in 2d where the z direction is invariant ie
plasmoids are infinitely long in z
motivated by the trajectory of particle b we now
employ a statistical approach to further investigate the
properties of accelerated particles and in particular ascertain at which energy they are most likely to escape
from plasmoids and start experiencing fast acceleration
by the upstream largescale fields this is shown in
fig 7 we first separate the positrons in six groups
based on the largest lorentz factor they attain in their
lifetime we shall call it end  given that it is typically
attained at the end of the particle life we only consider
30  48
48  75
75  119
119  189
189  300
 300
tot
end
101
102
101
102
101
102
figure 7 statistical assessment of the properties of accelerated positrons we first separate the positrons in six groups based
on the largest lorentz factor end they attain in their lifetime see legend in the left panel for each group we then compute
as described in the text the following quantities as a function of the particle lorentz factor  the median mixing factor m
left the median acceleration rate  middle distinguishing between particles in the downstream solid and in the upstream
dashed the fractional energy up tot gained while in the upstream right panel in the middle panel we also show as a
reference the maximum acceleration rate quantified by eq 3 horizontal dotted line
end  30 each group corresponds to a different color
in fig 7 each of the colored curves is obtained as follows for each particle in a given end group its history
is followed since its birth dividing it depending on the
instantaneous lorentz factor for each of the six end groups we employ ten bins logarithmically spaced
between   3 and   300 taking all the times when
a particle lies in a given bin we compute the median
mixing factor m median acceleration rate  and the
fractional energy up tot gained while in the upstream still while crossing the selected bin the
colored lines are then computed by taking the median
among particles belonging to the same end group
fig 7 left panel shows that at low energies   20
most of the particles reside in the downstream region
regardless of their end  in fact the mixing fraction is
m  08 as particles gain energy the median m of the
two groups with the largest end green and blue lines in
fig 7 starts to drop down to m  01 for the particles reaching the highest energies as also demonstrated
above particles of high energy   100 are preferentially located in the upstream the transition from
being trapped to breaking free appears at   3  30
the middle panel of fig 7 presents the acceleration
rate distinguishing between particles in the downstream
solid lines and in the upstream dashed lines the acceleration rate should be compared with the maximum
rate max in eq 4 which is indicated in the plot by
the horizontal dotted line we find that regardless of
end  downstream particles gain energy at a relatively
slow rate   01 p  particles residing in the upstream
with lorentz factors   30  the same threshold as
derived from m in the left panel  gain energy at a
faster rate that asymptotes to   02 p for the high
est energy upstream particles6 this rate approaches
 08 max  which implies that the highest energy particles move with an average z velocity z  08 see
eq 3 this is in agreement with the momentum spectra presented in sec 31 ie the highest energy particles
preferentially move in the z direction
the right panel of fig 7 shows the fraction
up tot of energy acquired in the upstream while
traversing a given bin regardless of the end group
we find that this is an increasing function of  reaching
 80 for the highest energy particles again the transition to the stage when acceleration is dominated by
the upstream motional field occurs at   30 the same
threshold already derived from the left and middle panels so we conclude that most particles ending up with
high energies escape from plasmoids at   3  30 at
which point their energization starts to be dominated
by the largescale upstream field
33 dependence on the domain size
in this subsection we investigate the dependence of
the properties of highenergy free particles on the size
of the computational domain in order to extrapolate
our conclusions to larger fluid scales free particles
are defined such that they reside in the upstream with
mixing parameter m  03 we also require that they
have   10 to exclude the cold upstream particles that
have yet to reach the reconnection region our results
are presented in fig 8 and tab 1
in the highest bin all the curves bend towards slower acceleration rates this can be simply understood as a selection bias
for a given end group particles in the highest bin are biased
towards having slower acceleration rates otherwise they would
move up in energy and be classified in the next end group
102
101
lx  lz
16k  08k
08k  04k
04k  02k
t lxc
101
102
number and
energy efficiency
number and
energy efficiency
cut  1
103
lxlz  1
lxlz  2
lx cp
101
102
103
lx  16k
lz cp
103
figure 8 dependence on the box size the unit of lx and lz is the plasma skin depth cp  a the energy cutoff cut
for free particles as a function of time for boxes with lx  2 lz see legend b number and energy efficiency for boxes with
different lx  at fixed aspect ratio lx lz  1 blue and lx lz  2 red empty circles show the number efficiency defined
as nfree nrr  where nfree and nrr are respectively the number of free particles and of particles in the reconnection region filled
circles show the energy efficiency efree err  c number empty grey circles and energy filled grey circles efficiency for boxes
with different lz  at fixed lx  1600cp  blue and red points are the same as in b
box size
16k  08k
08k  04k
04k  02k
16k  16k
08k  08k
04k  04k
16k  04k
init cp 
500
500
250
500
250
125
500
500
250
500
250
125
500
nfree nrr
00060008
0012
0015
0012
0016
0013
0008
0014
0014
0022
0023
0015
00090012
efree err
01310173
0161
0200
0149
0199
0166
0179
0188
0197
0224
0250
0201
01530199
the results in parentheses are from a simulation with the same
parameters but with four particles per cell
the results in parentheses are from a simulation with the same
parameters but with guide field bg  0
table 1 number and energy efficiency for the population
of highenergy free particles the number energy respectively efficiency is the ratio of the number energy of free
particles normalized to the number energy of particles in
the reconnection region the unit of length for the box size
leftmost column is the plasma skin depth cp 
in the left panel we show the cutoff lorentz factor cut
of free particles as a function of time horizontal axis
and box size different colors as indicated in the legend
the cutoff lorentz factor is obtained by calculating the
location of the peak of   13 dnfree d as described
in petropoulou  sironi 2018 this is generally a good
proxy for the location of the exponential cutoff of the
spectrum we find that cut  lx  the proportionality
constant is such that the larmor radius of particles with
lorentz factor cut is rl cut   02 lx  regardless of
lx  this is expected since particles accelerated near
the maximal rate in eq 4 over the typical advection
time  lx c will obtain a larmor radius rl  rec lx 
01lx  this can be phrased as a hillas criterion for
relativistic magnetic reconnection
we also calculate the energy efficiency efree err filled
circles where efree and err are respectively the energy
content of free particles and of particles in the reconnection region the number fraction nfree nrr open
circles is obtained in a similar way we examine their
dependence on the x length of the box in the middle
panel at fixed aspect ratio lx lz  blue for lx lz  1
and red for lx lz  2 and on the z length in the
right panel for fixed lx  1600cp grey points
as shown in fig 8b efree err is nearly independent
of lx  this demonstrates that regardless of the box
size free particles carry a constant fraction  20
of the postreconnection particle energy given that
cut  lx and that the spectrum of free particles is
hard dnfree d   15  this implies that their number
fraction needs to decrease with increasing box size as
indeed confirmed by fig 8b open circles
fig 8c shows that convergent 3d results are obtained
only if the box is sufficiently extended in the z direction
for our reference case with lx  1600cp  convergent
3d results are obtained for lz  400 cp  lx 4 this
may be due to the requirement that the z extent of
the largest plasmoids  01lx assuming spherical plasmoids be smaller than the box length along z ie z invariance should be broken even for the largest plasmoids
fig 8c also shows that the 2d limit is approached for
lz  20 cp  such that even small plasmoids do not fit
within the vertical extent of the box
4 summary and discussion
in this work we performed largescale 3d pic simulations of relativistic reconnection in a   10 electronpositron plasma we found that a fraction of particles
with   3 can break free from plasmoids by moving along z and then experience the largescale motional
electric field in the upstream region this process cannot be captured by 2d simulations which are invariant
along the z direction the free particles preferentially
move along z and are accelerated linearly in time   t
while undergoing speiserlike deflections by the converging upstream flows as already hypothesized by giannios
2010 their spectrum is hard and can be modeled as a
power law dnfree d   15  in appendix b we analytically justify the value of the powerlaw slope the
free particles account for  20 of the dissipated magnetic energy independently of domain size
the acceleration rate of the particles in this mechanism is closely connected to the reconnection speed its
accurate description therefore relies on the reconnection system having reached a statistical steady state
to this end our adopted boundary conditions are of
crucial importance by adopting continuous injection
of plasma and magnetic flux in the far upstream and
outflow boundaries in the reconnection exhaust direction the system can be followed for many alfvn crossing times after it has reached a statistical steady state
we find that the most energetic particles take a few
alfvn crossing times to reach their maximum energy
in contrast the more commonly adopted triple periodic
boundaries can only study reconnection transiently and
may not be able to capture this mechanism accurately
in addition periodic boundaries do not allow plasmoids
to escape so the largest plasmoids can grow up to a size
comparable to the system length this would artificially
enhance the rate at which highenergy free particles get
captured back by plasmoids
we find that the particle acceleration rate is
rec eb
where b is the magnetic field in the upstream and
rec z  006 as determined by our simulations as
far as we can infer from our simulations the maximum
energy achievable by this process is determined by either radiative losses or by the size of the reconnection
region if synchrotron cooling is the dominant energy
loss then the particles are accelerated until the energy
gain rate mc2 is balanced by the synchrotron loss rate
49e4 b 2  2 m2 c3  resulting in a maximum max 
9z rec m2 c4
max 
4e3 b
the corresponding synchrotron emission energy is
esyn  max
bemc  160z rec mev 10 mev for
electrons ie about one order of magnitude below the
wellknown burnoff limit de jager  harding 1992 we
remark that in this argument we have assumed that the
accelerated particles have large pitch angles ie the angle between the particle velocity and the magnetic field
as indeed observed in our simulations yet if this acceleration mechanism were to operate also in the limit of
strong guide fields the accelerated particles would likely
have small pitch angles which would comparatively reduce their synchrotron losses7
if radiative losses are negligible the maximum energy
is only limited by the size of the reconnecting system
for a given length of the reconnection layer lz in the
z direction the maximum lorentz factor a particle can
reach can be estimated as
max  lz erec bmc2 
the particle motion along the xdirection of reconnection outflows is unlikely to constrain the maximum energy since we have shown that the accelerated particles
mostly move along the z direction so their escape time
along x is likely longer than along z
although in this work we have only focused on
electronpositron plasmas our results may still be applicable to electronproton cases since high reconnection
is virtually identical in pair plasmas and electronproton
plasmas protons are much less affected by cooling as
compared to leptons and may escape from plasmoids
with higher efficiency therefore given that we have neglected cooling losses our results may be most applicable to protons in astrophysical systems where radiative
lepton losses are severe nevertheless in less extreme environments eg the emission zone of a blazar jet even
leptons should be able to able to escape small plasmoids
and participate in this acceleration process therefore
one may expect that both leptonic and hadronic signatures will be affected by the acceleration mechanism we
have discussed here
the sources and acceleration mechanism of uhecrs
with energies between  1018 and  1020 ev are still
under debate relativistic jets launched by grbs milgrom  usov 1995 waxman 1995 and agns halzen
 hooper 2002 have been proposed as sources of uhecrs magnetic reconnection taking place in the magnet7
on the other hand a strong guide field would also help in enforcing invariance along the z direction ie plasmoids are likely
to be very elongated in z so our proposed mechanism may turn
out to be less efficient
ically dominated plasma of these jets may be a promising
accelerator of uhecrs giannios 2010
the restframe magnetic field strength can be estimated by the poynting luminosity of the jet lp  the
bulk lorentz factor  and the distance r from the central engine see eg giannios 2010
c12 r
combining with eq 7 we can estimate the maximum
energy that a proton can be accelerated to
emax  rec lp c12 r1 le
where l is the length scale of the reconnection region
we also introduce a factor of  when we boost from the
jet frame to the observer frame
for longduration grbs the isotropic equivalent energy they release in gamma rays is around 1053 erg in
a duration of about 10 s this gives a lower limit for
their poynting luminosity of lp  1052 erg s1  since
the energy conversion efficiency to gamma rays needs to
be below unity the size of the reconnection region can
be estimated as l  r and  usually varies from
100 to 1000 in grb jets therefore the maximum energy that a particle can be accelerated to is emax 
2  1020 rec1 lp52 1
2 ev where rec1  rec 01
lp52  lp 1052 erg s1  and 2  102 
a powerful agn jet can reach a luminosity of
1048 erg s1  they usually have bulk lorentz factors of   3  30 using these values we estimate
that protons accelerated by reconnection in agn jets
can reach energies emax  6  1019 rec1 lp48 1
 05
where lp48  lp 10 erg s and 05   10
both jets are then capable of accelerating protons
or heavier nuclei in agn jets to 1018 ev and even
to the highest energies that have been observed so far
1020 ev though we do not consider constrains imposed
by cooling losses see eg giannios 2010 for further
discussion our analysis demonstrates that relativistic
reconnection is in principle a promising way to produce uhecrs
acknowledgments
hz and dg acknowledge support from the nasa
atp nnx17ag21g the nsf ast1910451 and the
nsf ast1816136 grants ls acknowledges support
from the sloan fellowship the cottrell scholars award
nasa atp nnx17ag21g and nsf phy1903412
the simulations have been performed at columbia habanero and terremoto with nersc cori and nasa
pleiades resources
appendix
a 2d particle spectra
in fig 4 we have shown the energy and momentum
spectra extracted from the 3d simulation for comparison in fig 9 we show the zmomentum spectrum from
the corresponding 2d run in agreement with earlier
2d studies the particle spectrum is nonthermal unlike the 3d case where the cutoff in the pz spectrum
is much larger than in the pz spectrum here the two
are roughly comparable though particles moving along
z extend to slightly larger energies and dominate in
number at high energies in addition as discussed in
the main text at   2 the spectra from the whole
box are coincident with corresponding spectra extracted
from the reconnection region alone
in the inset we compare energy spectra between 2d
and 3d simulations the 3d spectrum has a higher cutoff than the 2d one and it is dominated at high energies
by particles outside the reconnection region it indicates
once again that acceleration outside of plasmoids plays
an important role for the highest energy particles
b the powerlaw slope of free
particles
in the main body of the paper we have demonstrated
that the spectrum of free particles can be modeled as a
power law f  dnfree d   15 followed by a cutoff
which scales linearly with the system size in this appendix we aim at providing a theoretical framework to
interpret the value of the powerlaw slope8 in steady
state the distribution of free particles will follow
 q0   3
 tacc
tesc
where both the acceleration time tacc and the escape
time tesc generally depend on the particle lorentz factor in the equation above q0 quantifies the particle
injection rate which we have assumed to happen at a
we remark that as shown in our paper the acceleration mechanism of free particles is distinct from the one of particles accelerated in the reconnection layer whose spectral shape has been
discussed by eg guo et al 2014 uzdensky 2020
101
pzbox
pzrr
pzbox
pzrr
pz10
pzdndpz
102
103
104
101
107
1 05
101
102
103
102
103
figure 9 the main panel is as in fig 4 but for a 2d
simulation we display the positron timeaveraged between
t  334lc and 356lc spectra of the momentum along
z blue lines and z green lines solid lines refer to the
whole box while dashed lines to the particles in the downstream in the inset we show the particle energy spectrum
  1dnd from the whole simulation box in the 2d simulation red line and in the 3d simulation blue as well as
the spectrum of free particles from the 3d simulation green
the latter can be fit as a power law dnd    115  as
indicated by the dotted black line in the inset
101
dnfree d
dntrap d
20 25 30
t lc
100
0 0
101 1
dnfree d
dntrap d
fig 10 shows at different times the ratio of the number
of free particles to the number of trapped particles the
trapped particles at a given time are defined as the ones
that are currently trapped but were free at some point
in the previous  025lx c our results are not appreciably sensitive to this choice the plot shows that the
ratio is in steady state and in the range 30    30010
it can be fit as
tesc  tadv
3d whole box
3d free particles
2d whole box
105
erator so the escape time tesc from the acceleration region is for free particles the time spent in the upstream
before getting trapped9
in order to compute the escape time of free particles
we assume a steady state scenario the rate at which
free particles are trapped in plasmoids balances the rate
at which trapped particles advect out of the domain so
102
103
figure 10 the ratio of the number of free particles to
the number of trapped particles the trapped particles at a
given time are defined as the ones that are currently trapped
but were free at some point in the previous  025lx c
fixed energy of   3 in agreement with the results
obtained in the main body of the paper
for free particles the acceleration time can be calcu
lated as tacc    rec z p  where our results
yield rec z  006 free particles are accelerated while
residing in the upstream when they get captured and
trapped by plasmoids they effectively escape the accel
dnfree d
 0005 
dntrap d
we have computed the advection time tadv considering
the lifetime of particles that remain always trapped in
plasmoids we find that tadv  04lx c independently
of the lorentz factor in retrospect this is not surprising the massweighted bulk motions of relativistic
reconnection are transrelativistic with typical outflow
velocities of  06 c sironi  beloborodov 2020 on
average a trapped particle travels a distance  025lx
before advecting out of the system which indeed leads
to an advection time tadv  04lx c
it follows that the ratio of acceleration time to escape
time is energyindependent for 30    300 and equal
to tacc tesc  16 where we have used that lx cp 
1600 in our reference simulation this allows to compute
the solution of eq b1 as discussed by eg kirk et al
1998 the solution of eq b1 in the case that both
the acceleration time and the escape time scale linearly
with  is a power law
dnfree
  tacc tesc
which for our case yields dnfree d   16  in good
agreement with the spectrum measured directly from
our simulation
based on this model for the acceleration of free
particles one can address the question of what is
for simplicity we assume that no significant energization occurs
while trapped in plasmoids
10 this is the energy range between the injection lorentz factor at
  3  30 and the spectral cutoff at   300 see the inset of
fig 9
the powerlaw slope expected in the asymptotic and
astrophysicallyrelevant regime lx fl cp  let us
call s  d log nfree d log  the powerlaw slope of free
particles in the asymptotic limit lx fl cp  given
that s  tacc tesc should be independent of the box size
lx  this requires that tesc in eq b2 be independent
of lx  in turn given that tadv  lx c the ratio in
eq b3 should scale as  1lx  in other words for
dnfree d  cfree  s and dntrap d  ctrap  s1  we
require cfree ctrap  1lx 
let us now consider the specific case of s  1 and
assume that the spectrum of free particles extends from
minfree  3 up to cut  lx  while the spectrum of
trapped particles extends from minfree   up to the
same cut  lx  the ratio of number of free particles
nfree to number of trapped particles ntrap which we
called nrr for reconnection region in the main paper
is in the limit cut fl minfree  mintrap 
nfree
cfree
cut
mintrap log
ntrap
ctrap
minfree
which aside from logarithmic corrections scales as 
cfree ctrap  1lx  on the other hand the energy
fraction can be written as
cfree
cut
efree
etrap
ctrap logcut mintrap 
which aside from logarithmic corrections scales as 
cfree ctrap  cut  const in agreement with our results
in fig 8 there we called err the energy content of
trapped particles based on our model of acceleration
and requiring that the energy fraction of free particles
stays constant with box size we then expect that the
spectrum of free particles in the limit lx fl cp should
reach an asymptotic powerlaw slope s  1
references
begelman m c 1998 apj 493 291 doi 101086305119
bttcher m 2019 galaxies 7 20
doi 103390galaxies7010020
buneman o 1993 in computer space plasma physics
terra scientific tokyo 67
cerutti b philippov a a  dubus g 2020 aa
642 a204 doi 10105100046361202038618
cerutti b werner g r uzdensky d a  begelman
m c 2013 apj 770 147
doi 1010880004637x7702147
dahlin j t drake j f  swisdak m 2017 physics of
plasmas 24 092110 doi 10106314986211
daughton w roytershteyn v karimabadi h et al
2011 nature physics 7 539 doi 101038nphys1965
de gouveia dal pino e m  lazarian a 2005 aa
441 845 doi 1010510004636120042590
de jager o c  harding a k 1992 apj 396 161
doi 101086171706
drenkhahn g 2002 aa 387 714
doi 1010510004636120020390
drenkhahn g  spruit h c 2002 aa 391 1141
doi 1010510004636120020839
giannios d 2010 mnras 408 l46
doi 101111j17453933201000925x
giannios d  spruit h c 2006 aa 450 887
doi 1010510004636120054107
giannios d  uzdensky d a 2019 mnras 484 1378
doi 101093mnrasstz082
guo f li h daughton w  liu yh 2014 physical
review letters 113 155005
doi 101103physrevlett113155005
guo f li x daughton w et al 2020 arxiv eprints
arxiv200802743 httpsarxivorgabs200802743
hakobyan h petropoulou m spitkovsky a  sironi
l 2020 arxiv eprints arxiv200612530
httpsarxivorgabs200612530
halzen f  hooper d 2002 reports on progress in
physics 65 1025 doi 10108800344885657201
kagan d milosavljevi m  spitkovsky a 2013 apj
774 41 doi 1010880004637x774141
kirk j g rieger f m  mastichiadis a 1998 aa
333 452 httpsarxivorgabsastroph9801265
kirk j g  skjaeraasen o 2003 apj 591 366
doi 101086375215
li x guo f li h stanier a  kilian p 2019 apj
884 118 doi 10384715384357ab4268
lyubarsky y  kirk j g 2001 apj 547 437
doi 101086318354
lyubarsky y e 2005 mnras 358 113
doi 101111j13652966200508767x
lyutikov m  blandford r 2003
arxivastroph0312347
milgrom m  usov v 1995 apjl 449 l37
doi 101086309633
petropoulou m  sironi l 2018 mnras 481 5687
doi 101093mnrassty2702
romanova m m  lovelace r v e 1992 aa 262 26
sironi l  beloborodov a m 2020 apj 899 52
doi 10384715384357aba622
sironi l giannios d  petropoulou m 2016 mnras
462 48 doi 101093mnrasstw1620
sironi l  spitkovsky a 2014 apjl 783 l21
doi 101088204182057831l21
speiser t w 1965 j geophys res 70 4219
doi 101029jz070i017p04219
spitkovsky a 2005 in aip conf ser vol 801
astrophysical sources of high energy particles and
radiation ed t bulik b rudak  g madejski 345
spruit h c daigne f  drenkhahn g 2001 aa
369 694 doi 1010510004636120010131
uzdensky d a 2020 arxiv eprints arxiv200709533
httpsarxivorgabs200709533
waxman e 1995 phrvl 75 386
doi 101103physrevlett75386
werner g r  uzdensky d a 2017 apjl 843 l27
doi 10384720418213aa7892
zenitani s  hoshino m 2007 apj 670 702
doi 101086522226
 2008 apj 677 530 doi 101086528708
