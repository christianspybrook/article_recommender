arXiv:0704.0028v1 [math.CA] 2 Apr 2007

Pfaans, hafnians, and produ ts of real linear
fun tionals
Péter E. Frenkel

∗

Alfréd Rényi Institute of Mathemati s, Hungarian A ademy of S ien es
Reáltanoda ut a 13-15., 1053 Budapest, Hungary
E-mail: frenkelprenyi.hu

Abstra t

We prove pfaan and hafnian versions of Lieb's inequalities on
determinants and permanents of positive semi-denite matri es. We
use the hafnian inequality to improve the lower bound of Révész and
Sarantopoulos on the norm of a produ t of linear fun tionals on a
real Eu lidean spa e (this subje t is sometimes alled the `real linear
polarization onstant' problem).
Mathemati s Subje t Classi ation: 46C05, 15A15
Keywords: polarization onstant, real Eu lidean spa e, hafnian, pfaan,
positive semi-denite matrix

Old inequalities on determinants and permanents
Re all that the determinant and the permanent of an n×n matrix A = (ai,j )
are dened by

det A =

X

π∈Sn

π

(−1)

n
Y

ai,π(i) ,

per A =

n
X Y

ai,π(i) ,

π∈Sn i=1

i=1

where Sn is the symmetri group on n elements. Throughout this se tion,
we assume that A is a positive semi-denite Hermitian n × n matrix (we
write A ≥ 0). For su h A, Hadamard proved that

det A ≤
∗

n
Y

ai,i ,

i=1

Partially supported by OTKA grants T 046365 and K 61116.

1

with equality if and only if A has a zero row or is a diagonal matrix. Fis her
generalized this to
det A ≤ det A′ * det A′′
for

A=



A′ B
B ∗ A′′



(1)

≥ 0,

with equality if and only if det A′ * det A′′ * B = 0.
Con erning the permanent of a positive semi-denite matrix, Mar us
[Mar1, Mar2℄ proved that

per A ≥

n
Y

(2)

ai,i ,

i=1

with equality if and only if A has a zero row or is a diagonal matrix. Lieb
[L℄ generalized this to

per A ≥ per A′ * per A′′

(3)

for A as in (1), with equality if and only if A has a zero row or B = 0.
Moreover, he proved that in the polynomial P (λ) of degree n′ (=size of A′ )
dened by
 ′
 X
n′
λA B
P (λ) = per
ct λt ,
=
B ∗ A′′
t=0

all oe ients are real and non-negative. This is indeed a stronger theorem
sin e it implies
′

per A = P (1) =

n
X
t=0

ct ≥ cn′ = per A′ * per A′′ .

okovi¢ [D, Mi℄ gave a simple proof of Lieb's inequalities, and showed also
that if A′ and A′′ are positive denite then cn′ −t = 0 if and only if all
subpermanents of B of order t vanish. Lieb [L℄ also states an analogous (and
analogously provable) theorem for determinants: for A as in (1), let

λA′ B
D(λ) = det
B ∗ A′′


′



=

n
X

dt λt .

t=0

If det A′ * det A′′ = 0, then D(λ) = 0. If A′ and A′′ are positive denite, then
(−1)t dn′ −t is positive for t ≤ rk B and is zero for t > rk B .
2

1 New inequalities on pfaans and hafnians
For an n × n matrix A = (ai,j ) and subsets S , T of N := {1, . . . , n}, we write
AS,T := (ai,j )i∈S,j∈T . If |T | = 2t is even, we write

(−1)T := (−1)t+

P

j∈T

j

.

Re all that the pfaan of a 2n × 2n antisymmetri matrix Ã = (ai,j ) is
dened by

pf Ã =

1 X
(−1)π aπ(1),π(2) * * * aπ(2n−1),π(2n) .
n!2n
π∈S2n

For antisymmetri A and symmetri B , both of size n × n, we onsider the
polynomial

 ⌊n/2⌋
X
λA B
⌊n/2⌋
(−1)
pf
=
pt λt .
−B A
t=0

Let A and B be real n × n matri es with A antisymmetri
and B symmetri . If B is positive semi-denite, then (−1)t pt ≥ 0 for all t.
If B is positive denite, then pt = 0 if and only if all 2t × 2t subpfaans of
A vanish.
Theorem 1.1

Proof. If B = (bi,j ) is positive semi-denite, then there exist ve tors x1 ,

. . . , xn in a real Eu lidean spa e V su h that (xi , xj ) = bi,j . Re all that in
V
the exterior tensor algebra V a positive denite inner produ t (and the
orresponding Eu lidean norm) is dened by
^ ^ 
vi , wj := det((vi , wj )).
We have

(−1)t pt =

X X

(−1)S (−1)T pf AS,S * pf AT,T * det BN \S,N \T =

|S|=2t |T |=2t

2

=

X

(−1)S pf AS,S *

|S|=2t

^

i6∈S

xi

≥ 0.

Assume that B is positive denite. VThen the ve tors xi are linearly independent. It follows that the tensors i6∈S xi are also linearly independent as
S runs over the subsets of N . Thus pt = 0 if and only if pf AS,S = 0 for all
|S| = 2t.

3

Let A and B be real n × n matri es with A antisymmetri
and B symmetri . Let λ ≤ 0. If B is positive semi-denite, then
Theorem 1.2

⌊n/2⌋

(−1)

pf



λA B
−B A



≥ det B.

If B is positive denite, then equality o urs if and only if A is a diagonal
matrix or λ = 0.
Proof. The left hand side is
p0 + p1 λ + * * * + p⌊n/2⌋ λ⌊n/2⌋ .
The right hand side is p0 .



Re all that the hafnian of a 2n × 2n symmetri matrix Ã = (ai,j ) is
dened by
1 X
aπ(1),π(2) * * * aπ(2n−1),π(2n) .
haf Ã =
n!2n
π∈S2n

For symmetri A and B , both of size n × n, we onsider the polynomial

haf



λA B
B A



⌊n/2⌋

=

X

ht λt .

t=0

Let A and B be symmetri real n×n matri es. If B is positive
semi-denite, then ht ≥ 0 for all t. If B is positive denite, then ht = 0 if
and only if all 2t × 2t subhafnians of A vanish.
Theorem 1.3

Proof. If B = (bi,j ) is positive semi-denite, then there exist ve tors x1 , . . . ,

xn in a real Eu lidean spa e V su h that (xi , xj ) = bi,j . Re all [MN℄ that in
the symmetri tensor algebra SV a positive denite inner produ t (and the
orresponding Eu lidean norm) is dened by
Y Y 
vi ,
wj := per ((vi , wj )).
We have

ht =

X X

|S|=2t |T |=2t

haf AS,S * haf AT,T * per BN \S,N \T =
2

=

X

|S|=2t

4

haf AS,S *

Y

i6∈S

xi

≥ 0.

Assume that B is positive denite. Then the ve tors xi are linearly indepenQ
dent. It follows that the tensors i6∈S xi are also linearly independent as S
runs over the subsets of N . Thus ht = 0 if and only if haf AS,S = 0 for all
|S| = 2t.


Let A and B be symmetri real n × n matri es. Let λ ≥ 0.
If B is positive semi-denite, then

Theorem 1.4

haf



λA B
B A



≥ per B.

If B is positive denite, then equality o urs if and only if A is a diagonal
matrix or λ = 0.
Proof. The left hand side is
h0 + h1 λ + * * * + h⌊n/2⌋ λ⌊n/2⌋ .
The right hand side is h0 .



Setting A = B and λ = 1, and ombining with Mar us's inequality (2),
we arrive at ase p = 1 of

If A = (ai,j ) is a positive semi-denite symmetri real n×n
matrix, then the hafnianQ
of the 2pn × 2pn matrix onsisting of 2p × 2p blo ks
A is at least (2p − 1)!!n api,i , with equality if and only if A has a zero row
or is a diagonal matrix.

Conje ture 1.5

2 Produ ts of linear fun tionals

Let ξ1 , . . . , ξd denote independent random variables with standard Gaussian
distribution, i.e., with joint density fun tion (2π)−d/2 exp(−|ξ|2 /2), where
P 2
|ξ|2 =
ξk . We write Ef (ξ) for the expe tation of a fun tion f = f (ξ) =
f (ξ1 , . . . , ξd ). Re all that

Eξk2p = (2p − 1)!! = (2p − 1)(2p − 3) * * * 3 * 1
for k = 1, . . . , d (easy indu tive proof via integration by parts), and thus

E

d
Y

k=1

ξk2pk

=

d
Y

(2pk − 1)!!.

k=1

5

On Rd , we write (*, *) for the standard Eu lidean inner produ t. We re all
the well-known [S, Z℄
Wi k formula

((xi , xj )). Then

Let x1 , . . . , xn be ve tors in Rd with Gram matrix A =
E

n
Y
(xi , ξ) = haf A.

(4)

i=1

(For odd n, we dene haf A = 0.)

Proof. Both sides are multilinear in the xi , so we may assume that ea h xi

is an element of the standard orthonormal basis e1 , . . . , ed . If there is an ek
that o urs an odd number of times among the xi , then both sides are zero.
Q
If ea h ek o urs 2pk times, then the left hand side is E dk=1 ξk2pk , and the
Q
right hand side is dk=1 (2pk − 1)!!, whi h are equal.

The following theorems are easy orollaries of Theorem 1.4 together with
the Wi k formula (4) and Mar us's theorem (2).

If X1 , . . . , Xn are jointly normal random variables with zero
expe tation, then

2
2
2
2

Theorem 2.1

E X1 * * * Xn ≥ EX1 * * * EXn .

Equality holds if and only if they are independent or at least one of them is
almost surely zero.
Proof. The variables an be written as Xi = (xi , ξ) with ξ of standard normal

distribution and the xi onstant ve tors with a positive semi-denite Gram
matrix A = (ai,j ) = ((xi , xj )). Then

E

n
Y

Xi2

n
Y
= E (xi , ξ)2 =
i=1

i=1



n
Y
A A
ai,i =
= haf
≥ per A ≥
A A
i=1

=

n
Y

E(xi , ξ)2 =

n
Y

EXi2 ,

i=1

i=1

with equality if and only if A is a diagonal matrix or has a zero row, i.e., the
xi are pairwise orthogonal or at least one of them is zero.

6

The generalization of Theorem 2.1 to an arbitrary even exponent 2p is
equivalent to Conje ture 1.5.

For any x1 , . . . , xn ∈ Rd , |xi | = 1, the average of
on the unit sphere {|ξ| = 1} is at least
Theorem 2.2

Q

(xi , ξ)2

Γ(d/2)
(d − 2)!!
1
=
=
,
+ n)
(d + 2n − 2)!!
d(d + 2)(d + 4) . . . (d + 2n − 2)

2n Γ(d/2

with equality if and only if the ve tors xi are pairwise orthogonal.
Proof. The average on the unit sphere is the onstant in the theorem times

the expe tation w.r.t. the standard Gaussian measure (see e.g. [B1℄). By
Theorem 2.1, the latter expe tation is minimal if and only if the xi are

pairwise orthogonal, in whi h ase it is 1.
Theorem 2.3

For real linear fun tionals fi on a real Eu lidean spa e,
||f1 * * * fn || ≥ p

||f1 || * * * ||fn ||

n(n + 2)(n + 4) * * * (3n − 2)

.

Here || * || means supremum of the absolute value on the unit sphere.

Proof. We may assume that the spa e is Rd with d ≤ n, and the fun tionals

are given by fi (ξ) = (xi , ξ) with ||fi || = |xi | = 1. Then ||f1 * * * fn ||2 is at least
Q
Q
the average of fi2 (ξ) = (xi , ξ)2 on the unit sphere, whi h by Theorem 2.2

and d ≤ n is at least 1/(n(n + 2)(n + 4) * * * (3n − 2)).

It is an unsolved problem, raised by Benítez, Sarantopoulos and Tonge
[BST℄ (1998), whether Theorem 2.3 is true with nn under the square root
sign in the denominator on the right hand side. This is alled the `real linear
polarization onstant' problem. In the omplex ase, the armative answer
was proved by Arias-de-Reyna [A℄ in 1998, based on the omplex analog of
the Wi k formula [A, B2℄ and on Lieb's inequality (3). In the real ase, the
armative answer for n ≤ 5 was proved by Pappas and Révész [PR℄ in 2004.
For general n, the best result known before the present paper was that of
Révész and Sarantopoulos [RS℄ (2004), with (2n)n /4 under the square root
sign. See [Mat1, Mat2, MM, R℄ for a ounts on this and related questions.
7

Note that

n(n + 2)(n + 4) * * * (3n − 2) =

= exp (log n + log(n + 2) + log(n + 4) + * * * + log(3n − 2)) <
 Z 3n

1
< exp
log u * du =
2 n

= exp [u(log u − 1)]3n
n /2 = exp((3n log 3n − 3n − n log n + n)/2) =
√ !n
3 3
n(2 log n + 3 log 3 − 2)
=
n ,
= exp
2
e
√
and 3 3/e < 3 * 1.8/2.7 = 2, so Theorem 2.3 is an improvement. Note also
that the statement with nn would follow from Conje ture 1.5.

A knowledgements
I am grateful to Péter Major, Máté Matol si and Szilárd Révész for useful
dis ussions.

Referen es
[A℄ J. Arias-de-Reyna, Gaussian variables, polynomials and permanents, Lin.
Alg. Appl. 285 (1998), 107114.
[B1℄ A. Barvinok, Estimating L∞ norms by L2k norms for fun tions on orbits,
Found. Comput. Math. 2 (2002), 393412.
[B2℄ A. Barvinok, Integration and optimization of multivariate polynomials
by restri tion onto a random subspa e, arXiv preprint: math.OC/0502298
[BST℄ C. Benítez, Y. Sarantopoulos, A. Tonge, Lower bounds for norms of
produ ts of polynomials, Math. Pro . Camb. Phil. So . 124 (1998), 395408.
[D℄ D. . okovi¢, Simple proof of a theorem on permanents, Glasgow Math.
J. 10 (1969), 5254.
[L℄ E. H. Lieb, Proofs of some onje tures on permanents, J. Math. Me h.
16 (1966), 127134.
[Mar1℄ M. Mar us, The permanent analogue of the Hadamard determinant
theorem, Bull. Amer. Math. So . 69 (1963), 494496.
8

[Mar2℄ M. Mar us, The Hadamard theorem for permanents, Pro . Amer.
Math. So . 15 (1964), 967973.
[MN℄ M. Mar us, M. Newman, The permanent fun tion as an inner produ t,
Bull. Amer. Math. So . 67 (1961), 223224.
[Mat1℄ M. Matol si, A geometri estimate on the norm of produ t of fun tionals, Lin. Alg. Appl. 405 (2005), 304310.
[Mat2℄ M. Matol si, The linear polarization onstant of Rn , A ta Math.
Hungar. 108 (2005), no. 1-2, 129136.
[MM℄ M. Matol si, G. A. Muñoz, On the real linear polarization onstant
problem, Math. Inequal. Appl. 9 (2006), no. 3, 485494.
[Mi℄ H. Min , Permanents, En y lopedia of Mathemati s and its Appli ations, Addison-Wesley, 1978
[PR℄ A. Pappas, Sz. Révész, Linear polarization onstants..., J. Math. Anal.
Appl. 300 (2004), 129146.
[R℄ Sz. Gy. Révész, Inequalities for multivariate polynomials, arXiv preprint:
math.CA/0703387
[RS℄ Sz. Gy. Révész, Y. Sarantopoulos, Plank problems, polarization and
Chebyshev onstants, J. Korean Math. So . 41 (2004) 157174.
[S℄ B. Simon, The P(φ)2 Eu lidean (Quantum) Field Theory, Prin eton Series in Physi s, Prin eton University Press, 1974
[Z℄ A. Zvonkin, Matrix integrals and map enumeration: an a esible introdu tion, Combinatori s and physi s (Marseille, 1995), Math. Comput.
Modelling 26 (1997), 281304.

9

