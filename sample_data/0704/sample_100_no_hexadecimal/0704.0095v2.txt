arXiv:0704.0095v2 [math.GR] 10 Apr 2012

GEOMETRY OF LOCALLY COMPACT GROUPS OF
POLYNOMIAL GROWTH AND SHAPE OF LARGE BALLS.
EMMANUEL BREUILLARD
Abstract. We show that any locally compact group G with polynomial growth
is weakly commensurable to some simply connected solvable Lie group S, the
Lie shadow of G. We then study the shape of large balls and show, generalizing work of P. Pansu, that after a suitable renormalization, they converge to
a limiting compact set, which is isometric to the unit ball for a left-invariant
subFinsler metric on the so-called graded nilshadow of S. As by-products, we
obtain asymptotics for the volume of large balls, we prove that balls are Folner
and hence that the ergodic theorem holds for all ball averages. Along the way
we also answer negatively a question of Burago and Margulis [7] on asymptotic
word metrics and recover some results of Stoll [33] of the rationality of growth
series of Heisenberg groups.

Contents
1. Introduction
2. Quasi-norms and the geometry of nilpotent Lie groups
3. The nilshadow
4. Periodic metrics
5. Reduction to the nilpotent case
6. The nilpotent case
7. Locally compact G and proofs of the main results
8. Coarsely geodesic distances and speed of convergence
9. Appendix: the Heisenberg groups
References

1
12
19
23
27
31
39
47
52
55

1. Introduction
1.1. Groups with polynomial growth. Let G be a locally compact group with
left Haar measure volG . We will assume that G is generated by a compact symmetric subset Ω. Classically, G is said to have polynomial growth if there exist
C > 0 and k > 0 such that for any integer n ≥ 1
volG (Ωn ) ≤ C * nk ,
Date: April 2012.
1

2

EMMANUEL BREUILLARD

where Ωn = Ω* . . . * Ω is the n-fold product set. Another choice for Ω would only
change the constant C, but not the polynomial nature of the bound. One of the
consequences of the analysis carried out in this paper is the following theorem:
Theorem 1.1 (Volume asymptotics). Let G be a locally compact group with polynomial growth and Ω a compact symmetric generating subset of G. Then there
exists c(Ω) > 0 and an integer d(G) ≥ 0 depending on G only such that the
following holds:
volG (Ωn )
= c(Ω)
lim
n→+∞
nd(G)
This extends the main result of Pansu [27]. The integer d(G) coincides with
the exponent of growth of a naturally associated graded nilpotent Lie group, the
asymptotic cone of G, and is given by the Bass-Guivarc'h formula (4) below.
The constant c(Ω) will be interpreted as the volume of the unit ball of a subRiemannian Finsler metric on this nilpotent Lie group. Theorem 1.1 is a byproduct of our study of the asymptotic behavior of periodic pseudodistances on G,
that is pseudodistances that are invariant under a co-compact subgroup of G and
satisfy a weak kind of the existence of geodesics axiom (see Definition 4.1).
Our first task is to get a better understanding of the structure of locally compact
groups of polynomial growth. Guivarc'h [21] proved that locally compact groups
of polynomial growth are amenable and unimodular and that every compactly
generated1 closed subgroup also has polynomial growth.
Guivarc'h [21] and Jenkins [15] also characterized connected Lie groups with
polynomial growth: a connected Lie group has polynomial growth if and only if
it is of type (R), that is if for all x ∈ Lie(S), ad(x) has only purely imaginary
eigenvalues. Such groups are solvable-by-compact and any connected nilpotent
Lie group is of type (R).
It is much more difficult to characterize discrete groups with polynomial growth,
and this was done in a celebrated paper of Gromov [17], proving that they are
virtually nilpotent. Losert [24] generalized Gromov's method of proof and showed
that it applied with little modification to arbitrary locally compact groups with
polynomial growth. In particular he showed that they contain a normal compact
subgroup modulo which the quotient is a (not necessarily connected) Lie group.
We will prove the following refinement.
Theorem 1.2 (Lie shadow). Let G be a locally compact group of polynomial
growth. Then there exists a connected and simply connected solvable Lie group S
of type (R), which is weakly commensurable to G. We call such a Lie group a Lie
shadow of G.
Two locally compact groups are said to be weakly commensurable if, up to
moding out by a compact kernel, they have a common closed co-compact subgroup.
More precisely, we will show that, for some normal compact subgroup K, G/K has
1in fact it follows from the Gromov-Losert structure theory that every closed subgroup is

compactly generated.

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

3

a co-compact subgroup H/K which can be embedded as a closed and co-compact
subgroup of a connected and simply connected solvable Lie group S of type (R).
We must be aware that being weakly commensurable is not an equivalence
relation among locally compact groups (unlike among finitely generated groups).
Additionally, the Lie shadow S is not unique up to isomorphism (e.g. Z3 is a
co-compact lattice in both R3 and the universal cover of the group of motions of
the plane).
We cannot replace the word solvable by the word nilpotent in the above theorem. We refer the reader to Example 7.9 for an example of a connected solvable
Lie group of type (R) without compact normal subgroups, which admits no cocompact nilpotent subgroup. In fact this is typical for Lie groups of type (R). So
in the general locally compact case (or just the Lie case) groups of polynomial
growth can be genuinely not nilpotent, unlike what happens in the discrete case.
There are important differences between the discrete case and the general case.
For example, we will show that no rate of convergence can be expected in Theorem
1.1 when G is solvable not nilpotent, while some polynomial rate always holds in
the nilpotent discrete case [9].
Theorem 1.2 will enable us to reduce most geometric questions about locally
compact groups of polynomial growth, and in particular the proof of Theorem
1.1, to the connected Lie group case. Observe also that Theorem 1.2 subsumes
Gromov's theorem on polynomial growth, because it is not hard to see that a
co-compact lattice in a solvable Lie group of polynomial growth must be virtually
nilpotent (see Remark 7.8). Of course in the proof we make use of Gromov's
theorem, in its generalized form for locally compact groups due to Losert. The rest
of the proof combines ideas of Y. Guivarc'h, D. Mostow and a crucial embedding
theorem of H.C. Wang. It is given in Paragraph 7.1 and is largely independent of
the rest of the paper.
1.2. Asymptotic shapes. The main part of the paper is devoted to the asymptotic behavior of periodic pseudodistances on G. We refer the reader to Definition
4.1 for the precise definition of this term, suffices it to say now that it is a class of
pseudodistances which contains both left-invariant word metrics on G and geodesic
metrics on G that are left-invariant under co-compact subgroup of G.
Theorem 1.2 enables us to assume that G is a co-compact subgroup of a simply
connected solvable Lie group S, and rather than looking at pseudodistances on G,
we will look at pseudodistances on S that are left-invariant under a co-compact
subgroup H. More precisely a direct consequence of Theorem 1.2 is the following:
Proposition 1.3. Let G be a locally compact group with polynomial growth and ρ
a periodic metric on G. Then (G, ρ) is (1, C)-quasi-isometric to (S, ρS ) for some
finite C > 0, where S is a connected and simply connected solvable Lie group of
type (R) and ρS some periodic metric on S.
Recall that two metric spaces (X, dX ) and (Y, dY ) are called (1, C)-quasi-isometric
if there exists a map φ : X → Y such that any y ∈ Y is at distance at most C
from some element in the image of φ and if |dY (φ(x), φ(x′ )) − dX (x, x′ )| ≤ C for
all x, x′ ∈ X.

4

EMMANUEL BREUILLARD

In the case when S is Rd and H is Zd , it is a simple exercise to show that any
periodic pseudodistance is asymptotic to a norm on Rd , i.e. ρ(e, x)/ kxk → 1 as
x → ∞, where kxk = lim n1 ρ(e, nx) is a well defined norm on Rd . Burago in [6]
showed a much finer result, namely that if ρ is coarsely geodesic, then ρ(e, x)−kxk
is bounded when x ranges over Rd . When S is a nilpotent Lie group and H a lattice
in S, then Pansu proved in his thesis [27], that a similar result holds, namely that
ρ(e, x)/ |x| → 1 for some (unique only after a choice of a one-parameter group of
dilations) homogeneous quasi-norm |x| on the nilpotent Lie group. However, we
show in Section 8, that it is not true in general that ρ(e, x) − |x| stays bounded,
even for finitely generated nilpotent groups, thus answering a question of Burago
(see also Gromov [20]). Our main purpose here will be to extend Pansu's result
to solvable Lie groups of polynomial growth.
As was first noticed by Guivarc'h in his thesis [21], when dealing with geometric
properties of solvable Lie groups, it is useful to consider the so-called nilshadow of
the group, a construction first introduced by Auslander and Green in [2]. According to this construction, it is possible to modify the Lie product on S in a natural
way, by so to speak removing the semisimple part of the action on the nilradical,
in order to turn S into a nilpotent Lie group, its nilshadow SN . The two Lie
groups have the same underlying manifold, which is diffeomorphic to Rn , only a
different Lie product. They also share the same Haar measure. This "semisimple
part" is a commutative relatively compact subgroup T (S) of automorphisms of S,
image of S under a homomorphism T : S → Aut(S). The new product g ∗ h is
defined as follows by twisting the old one g * h by means of T (S),
(1)

g ∗ h := g * T (g −1 )h

The two groups S and SN are easily seen to be quasi-isometric, and this is why any
locally compact group of polynomial growth G is quasi-isometric to some nilpotent
Lie group. In particular, their asymptotic cones are bi-Lipschitz. The asymptotic
cone of a nilpotent Lie group is a certain associated graded nilpotent Lie group
endowed with a left invariant geodesic distance (or Carnot group). The graded
group associated to SN will be called the graded nilshadow of S. Section 3 will be
devoted to the construction and basic properties of the nilshadow and its graded
group.
In this paper, we are dealing with a finer relation than quasi-isometry. We will
be interested in when do two left invariant (or periodic) distances are asymptotic2
(e,g)
→ 1 when g → ∞). In particular, for every locally
(in the sense that dd21 (e,g)
compact group G with polynomial growth, we will identify its asymptotic cone
up to isometry and not only up to quasi-isometry or bi-Lipschitz equivalence (see
Corollary 1.9 below). One of our main results is the following:
2Yet a finer equivalence relation is (1, C)-quasi-isometry, i.e. being at bounded distance in
Gromov-Hausdorff metric; classifying periodic metrics up to this kind of equivalence is much
harder.

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

5

Theorem 1.4 (Main theorem). Let S be a simply connected solvable Lie group
with polynomial growth. Let ρ(x, y) be periodic pseudodistance on S which is invariant under a co-compact subgroup H of S (see Def. 4.1). On the manifold S,
one can put a new Lie group structure, which turns S into a stratified nilpotent Lie
group, the graded nilshadow of S, and a subFinsler metric d∞ (x, y) on S which is
left-invariant for this new group structure such that
ρ(e, g)
→1
d∞ (e, g)
as g → ∞ in S. Moreover every automorphism in T (H) is an isometry of d∞ .
The reader who wishes to see a simple illustration of this theorem can go directly
to subsection 8.1, where we have treated in detail a specific example of periodic
metric on the universal cover of the groups of motions of the plane.
The new stratified nilpotent Lie group structure on S given by the graded
nilshadow comes with a one-parameter family of so-called homogeneous dilations
{δt }t>0 . It also comes with an extra group of automorphisms, namely the image
of H under the homomorphism T . This yields automorphisms of S for both the
original group structure on S and the new graded nilshadow group structure.
Moreover the dilations {δt }t>0 are automorphisms of the graded nilshadow and
they commute with T (H).
A subFinsler metric is a geodesic distance which is defined exactly as subRiemannian (or Carnot-Caratheodory) metrics on Carnot groups are defined (see e.g.
[25]), except that the norm used to compute the length of horizontal paths is not
necessarily a Euclidean norm. We refer the reader to Section 2.1 for a precise
definition.
In Theorem 1.4 the subFinsler metric d∞ is left invariant for the new Lie structure on S and it is also invariant under all automorphisms in T (H) (these form
a relatively compact commutative group of automorphisms). Moreover it satisfies
the following pleasing scaling law:
d∞ (δt (x), δt (y)) = td∞ (x, y) ∀t > 0.

The proof of Theorem 1.4 splits in two important steps. The first is a reduction
to the nilpotent case and is performed in Section 5. Using a double averaging
of the pseudodistance ρ over both K := T (H) and S/H, we construct an associated pseudodistance, which is periodic for the nilshadow structure on S (i.e.
left-invariant by a co-compact subgroup for this structure), and we prove that it
is asymptotic to the original ρ. This reduces the problem to nilpotent Lie groups.
The key to this reduction is the following crucial observation: that unipotent automorphisms of S induce only a sublinear distortion, forcing the metric ρ to be
asymptotically invariant under T (H). The second step of the proof assumes that
S is nilpotent. This part is dealt with in Section 6 and is essentially a reformulation of the arguments used by Pansu in [27].

6

EMMANUEL BREUILLARD

Incidently, we stress the fact that the generality in which Section 6 is treated
(i.e. for general coarsely geodesic, and even asymptotically geodesic periodic metrics) is necessary to prove even the most basic case (i.e. word metrics) of Theorem
1.4 for non-nilpotent solvable groups. So even if we were only interested in the
asymptotics of left invariant word metrics on a solvable Lie group of polynomial
growth S, we would still need to understand the asymptotics of arbitrary coarsely
geodesic left invariant distances (and not only word metrics!) on nilpotent Lie
groups. This is because the new pseudodistance obtained by averaging, see (30),
is no longer a word metric.
The subFinsler metric d∞ (e, x) in the above theorem is induced by a certain
T (H)-invariant norm on the first stratum m1 of the graded nilshadow (which
is T (H)-invariant complementary subspace of the commutator subalgebra of the
nilshadow). This norm can be described rather explicitly as follows.
Recall that we have3 a canonical map π1 : S → m1 , which is a group homomorphism for both the nilshadow and graded nilshadow structures. Then:
ff

\
π1 (h)
, h ∈ H\F ,
CvxHull
{v ∈ m1 , kvk∞ ≤ 1} =
ρ(e, h)
F ⊂S

where the right hand side is the intersection over all compact subsets F of S of
the closed convex hull of the points π1 (h)/ρ(e, h) for h ∈ H\F .
Figure 1 gives an illustration of the limit shape corresponding to the word
metric on the 3-dimensional discrete Heisenberg group with standard generators.
We explain in the Appendix how one can compute explicitly the geodesics of the
limit metric and the limit shape in this example.
When S itself is nilpotent to begin with and ρ is (in restriction to H) the
word metric associated to a symmetric compact generating set Ω of H (namely
ρΩ (e, h) := inf{n ∈ N; h ∈ Ωn }), the above norm takes the following simple form:
(2)

{v ∈ m1 , kvk∞ ≤ 1} = CvxHull {π1 (ω), ω ∈ Ω}

For instance, in the special case when H is a torsion-free finitely generated nilpotent group with generating set Ω and S is its Malcev closure, the unit ball
{v ∈ m1 , kvk∞ ≤ 1} is a polyhedron in m1 . This was Pansu's description in
[27].
However when S is not nilpotent, and is equipped with a word metric ρΩ on
a co-compact subgroup, then the determination of the limit shape, i.e. the determination of the limit norm k * k∞ on the abelianized nilshadow, is much more
difficult. Clearly k * k∞ is K-invariant and it is a simple observation that the unit
ball for k * k∞ is always contained in the convex hull of the K-orbit of π1 (Ω).
3The subspace m can be identified with the abelianized nilshadow (or abelianized graded
1
nilshadow) by first identifying the nilshadow with its Lie algebra via the exponential map and
then projecting modulo the commutator subalgebra. The map does not depend on the choice
involved in the construction of the nilshadow. See also Remark 3.7.

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

7

Nevertheless the unit ball is typically smaller than that (unless Ω was K-invariant
to begin with).
In general it would be interesting to determine whether there exists a simple
description of the limit shape of an arbitrary word metric on a solvable Lie group
with polynomial growth. We refer the reader to Section 8 and Paragraph 8.2 for an
example of a class of word metrics on the universal cover of the group of motions
of the plane, for which we were able to compute the limit shape.
Another by-product of Theorem 1.4 is the following result.
Corollary 1.5 (Asymptotic shape). Let S be a simply connected solvable Lie
group with polynomial growth and H a co-compact subgroup. Let ρ be an Hperiodic pseudodistance on S. Then in the Hausdorff metric,
lim δ 1 (Bρ (t)) = C,

t→+∞

t

where C is a T (H)-invariant compact neighborhood of the identity in S, Bρ (t) is
the ρ-ball of radius t in S and {δt }t>0 is a one-parameter group of dilations on S
(equipped with the graded nilshadow structure). Moreover, C = {g ∈ S, d∞ (e, g) ≤ 1}
is the unit ball of the limit subFinsler metric from Theorem 1.4.
Proof. By Theorem 1.4, for every ε > 0 we have Bd∞ (t−εt) ⊂ Bρ (t) ⊂ Bd∞ (t+εt)

if t is large enough. Since δ 1 (Bd∞ (t)) = C, for all t > 0, we are done.
t

Combining this with Theorem 1.2, we also get the following corollary, of which
Theorem 1.1 is only a special case with ρ the word metric associated to the generating set Ω.
Corollary 1.6 (Volume asymptotics). Suppose that G is a locally compact group
with polynomial growth and ρ is a periodic pseudodistance on G. Let Bρ (t) be
the ρ-ball of radius t in G, i.e. Bρ (t) = {x ∈ G, ρ(e, x) ≤ t}, then there exists a
constant c(ρ) > 0 such that the following limit exists:
volG (Bρ (t))
= c(ρ)
t→+∞
td(G)

(3)

lim

Here d(G) is the integer d(SN ), the so-called homogeneous dimension of the
nilshadow SN of a Lie shadow S of G (obtained by Theorem 1.2), and is given by
the Bass-Guivarc'h formula:
X
(4)
d(SN ) =
dim(C k (SN ))
k≥0

{C k (S

where
N )}k is the descending central series of SN .
The limit c(ρ) is equal to the volume volS (C) of the limit shape C from Corollary
1.5 once we make the right choice of Haar measure on a Lie shadow S of G. Let
us explain this choice. Recall that according to Theorem 1.2, G/K admits a cocompact subgroup H/K which embeds co-compactly in S. Starting with a Haar
measure volG on G, we get a Haar measure on G/K after fixing the Haar measure
of K to be of total mass 1, and we may then choose a Haar measure on H/K so
that the compact quotient G/H has volume 1. Finally we choose the Haar measure

8

EMMANUEL BREUILLARD

z

x

y

Figure 1. The asymptotic shape of large balls in the Cayley graph
of the Heisenberg group H(Z) = hx, y|[x, [x, y]] = [y, [x, y]] = 1i
viewed in exponential coordinates.

on S so that the other compact quotient S/(H/K) has volume 1. This gives the
desired Haar measure volS such that c(ρ) = volS (C).
Note that Haar measure on S is also invariant under the group of automorphisms T (S) and is thus left invariant for the nilshadow structure on S. It is also
left invariant for the graded nilshadow structure. In both exponential coordinates
of the first kind (on SN ) and of the second kind (as in Lemma 3.10), Haar measure
is just Lebesgue measure.
In the case of the discrete Heisenberg group of dimension 3 equipped with the
word metric given by the standard generators, it is possible to compute the constant c(ρ) and the volume of the limit shape as shown in Figure 1. In this case the
volume is 31
72 (see the Appendix). The 5-dimensional Heisenberg group can also be
worked out and the volume of its limit shape (associated to the word metric given
log 2
2009
+ 32805
. The fact that this number is
by standard generators) is equal to 21870
transcendental
implies
that
the
growth
series
of
this
group, i.e. the formal power
P
n
series n≥0 |Bρ (n)|z is not algebraic in the sense that it is not a solution of a
polynomial equation with rational functions in C(z) as coefficients (see [33, Prop.

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

9

3.3.]). This was observed by Stoll in [33] by more direct combinatorial means.
Stoll also shows there the interesting fact that the growth series can be rational
for some other choices of generating sets in the 5-dimensional Heisenberg group.
So rationality of the growth series depends on the generating set.
Another interesting feature is asymptotic invariance:
Corollary 1.7 (Asymptotic invariance). Let S be a simply connected solvable
Lie group with polynomial growth and ρ a periodic pseudodistance on S. Let ∗ be
the new Lie product on S given by the nilshadow group structure (or the graded
nilshadow group structure). Then ρ(e, g ∗ x)/ρ(e, x) → 1 as x → ∞ for every
g ∈ S.
This follows immediately from Theorem 1.4, when ∗ is the graded nilshadow
product, and from Theorem 6.2 below in the case ∗ is the nilshadow group structure.
It is worth observing that we may not in general replace ∗ by the ordinary
product on S. Indeed, let for instance S = R ⋉ R2 be the universal cover of the
group of motions of the Euclidean plane, then S, like its nilshadow R3 , admits
a lattice Γ ≃ Z3 . The quotient S/Γ is diffeomorphic to the 3-torus R3 /Z3 and
it is easy to find Riemannian metrics on this torus so that their lift to R3 is not
invariant under rotation around the z-axis. Hence this metric, viewed on the Lie
group S will not be asymptotically invariant under left translation by elements of
S. Nevertheless, if the metric is left-invariant and not just periodic, then we have
the following corollary of the proof of Theorem 1.4.
Corollary 1.8 (Left-invariant pseudodistances are asymptotic to subFinsler metrics). Let S be a simply connected solvable Lie group of polynomial growth and ρ
be a periodic pseudodistance on S which is invariant under all left-translations by
elements of S (e.g. a left-invariant coarsely geodesic metric on S). Then there
is a left-invariant subFinsler metric d on S which is asymptotic to ρ in the sense
ρ(e,g)
→ 1 as g → ∞.
that d(e,g)
We already mentioned above that determining the exact limit shape of a word
metric on S is a difficult task. Consequently so is the task of telling when two
distinct word metrics are asymptotic. The above statement says that in any case
every word metric on S is asymptotic to some left-invariant subFinsler metric. So
the set of possible limit shapes is no richer for word metrics than for left-invariant
subFinsler metrics.
We note that in the case of nilpotent Lie groups (where K is trivial), Theorem
1.4 shows that every periodic metric is asymptotic to a left-invariant metric. It is
still an open problem to determine whether every coarsely geodesic periodic metric
is at a bounded distance from a left-invariant metric (this is Burago's theorem in
Rn , more about it below).
Theorems 1.2 and 1.4 allow us to describe the asymptotic cone of (G, ρ) for any
periodic pseudodistance ρ on any locally compact group with polynomial growth.

10

EMMANUEL BREUILLARD

Corollary 1.9 (Asymptotic cone). Let G be a locally compact group with polynomial growth and ρ a periodic pseudodistance on G. Then the sequence of pointed
metric spaces {(G, n1 ρ, e)}n≥1 converges in the Gromov-Hausdorff topology. The
limit is the metric space (N, d∞ , e), where N is a graded simply connected nilpotent Lie group and d∞ a left invariant subFinsler metric on N . Moreover the Lie
group N is (up to isomorphism) independent of ρ. The space (N, d∞ ) is isometric
to "the asymptotic cone" associated to (G, ρ). This asymptotic cone is independent
of the choice of ultrafilter used to define it.
This corollary is a generalization of Pansu's theorem ((10) in [27]). We refer
the reader to the book [18] for the definitions of the asymptotic cone and the
Gromov-Hausdorff convergence. We discuss in Section 8 the speed of convergence
(in the Gromov-Hausdorff metric) in this theorem and its corollaries about volume
growth. In particular there is a major difference between the discrete nilpotent case
and the solvable non nilpotent case. In the former, one can find a polynomial rate
of convergence [9], while in the latter no such rate exist in general (see Theorem
8.1).
1.3. Folner sets and ergodic theory. A consequence of Corollary 1.6 is that
sequences of balls with radius going to infinity are Folner sequences, namely:
Corollary 1.10. Let G be a locally compact group with polynomial growth and
ρ a periodic pseudodistance on G. Let Bρ (t) be the ρ-ball of radius t in G. Then
{Bρ (t)}t>0 form a Folner family of subsets of G namely, for any compact set F
in G, we have (∆ denotes the symmetric difference)
(5)

volG (F Bρ (t)∆Bρ (t))
=0
t→+∞
volG (Bρ (t))
lim

Proof. Indeed F Bρ (t)∆Bρ (t) ⊂ Bρ (t + c)\Bρ (t) for some c > depending on F .
Hence (5) follows from (3).

This settles the so-called "localization problem" of Greenleaf for locally compact
groups of polynomial growth (see [16]), i.e. determining whether the powers of
a compact generating set {Ωn }n form a Folner sequence. At the same time it
implies that the ergodic theorem for G-actions holds along any sequence of balls
with radius going to infinity.
Theorem 1.11. (Ergodic Theorem) Let be given a locally compact group G with
polynomial growth together with a measurable G-space X endowed with a Ginvariant ergodic probability measure m. Let ρ be a periodic pseudodistance on
G and Bρ (t) the ρ-ball of radius t in G. Then for any p, 1 ≤ p < ∞, and any
function f ∈ Lp (X, m) we have
Z
Z
1
f dm
f (gx)dg =
lim
t→+∞ volG (Bρ (t)) B (t)
X
ρ
for m-almost every x ∈ X and also in Lp (X, m).

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

11

In fact, Corollary 1.10 above, was the "missing block" in the proof of the ergodic
theorem on groups of polynomial growth. So far and to my knowledge, Corollary
1.10 and Theorem 1.11 were known only along some subsequence of balls {Bρ (tn )}n
chosen so that (5) holds (see for instance [10] or [34]). This issue was drawn to
my attention by A. Nevo and was my initial motivation for the present work. We
refer the reader to the A. Nevo's survey paper [26] Section 5.
It later turned out that the mere fact that balls are Folner in a given polynomial
growth locally compact group can also be derived from the fact these groups are
doubling metric spaces (which is an easier result than the precise asymptotics
vol(Ωn ) ∼ cΩ nd(G) proved in this paper and only requires lower and upper bounds
of the form c1 nd(G) ≤ vol(Ωn ) ≤ c2 nd(G) ). This was observed by R. Tessera
[35] who rediscovered a cute argument of Colding and Minicozzi [11, Lemma 3.3.]
showing that the volume of spheres Ωn+1 \ Ωn is at most some O(n−δ ) times the
volume of the ball Ωn , where δ > 0 is a positive constant depending only on the
doubling constant the word metric induced by Ω in G.
In [9], we give a better upper bound (which depends only on the nilpotency class
and not on the doubling constant) for the volume of spheres in the case of finitely
generated nilpotent groups. This is done by showing the following error term in
the asymptotics of the volume of balls: we have vol(Ωn ) = cΩ nd(G) + O(nd(G)−αr ),
where αr > 0 depends only on the nilpotency class r of G. We refer the reader to
Section 8 and to the preprint [9] for more information on this. We only note here
that although the above Colding-Minicozzi-Tessera upper bound on the volume of
spheres holds generally for all locally compact groups G with polynomial growth,
unless G is nilpotent, there is no error term in general in the asymptotics of the
volume of balls. An example with arbitrarily small speed is given in §8.1.
1.4. A conjecture of Burago and Margulis. In [7] D. Burago and G. Margulis
conjectured that any two word metrics on a finitely generated group which are
asymptotic (in the sense that ρρ12 (e,γ)
(e,γ) tends to 1 at infinity) must be at a bounded
distance from one another (in the sense that |ρ1 (e, γ) − ρ2 (e, γ)| = O(1)). This
holds for abelian groups. An analogous result was proved by Abels and Margulis
for word metrics on reductive groups [1]. S. Krat [23] established this property
for word metrics on the Heisenberg group H3 (Z). However using Theorem 1.4
(which in this particular case of finitely generated nilpotent groups is just Pansu's
theorem [27]) we will show in Section 8.3, that there are counter-examples and
exhibit two word metrics on H3 (Z) × Z which are asymptotic and yet are not at
a bounded distance. For more on this counter-example, and how to adequately
modify the conjecture of Burago and Margulis, we refer the interested reader to
[9].
1.5. Organization of the paper. Sections 2-4 are devoted to preliminaries. In
Section 2 we present the basic nilpotent theory as can be found in Guivarc'h's
thesis [21]. In particular, a full proof of the Bass-Guivarc'h formula is given. In
Section 3, we recall the construction of the nilshadow of a solvable Lie group.

12

EMMANUEL BREUILLARD

In Section 4 we set up the axioms and basic properties of the (pseudo)distance
functions that are studied in this paper.
Sections 5-7 contain the core of the proof of the main theorems. In Section 5, we
assume that G is a simply connected solvable Lie group and reduce the problem to
the nilpotent case. In Section 6, we assume that G is a simply connected nilpotent
Lie group and prove Theorem 1.4 in this case following the strategy used by Pansu
in [27]. In Section 7, we prove Theorem 1.2 for general locally compact groups
and reduce the proof of the results of the introduction to the Lie case.
In the last section we make further comments about the speed of convergence.
In particular we give examples answering negatively the aforementioned question
of Burago and Margulis.
The Appendix is devoted to the discrete Heisenberg groups of dimension 3 and
5. We compute their limit balls, explain Figure 1, and recover the main result of
Stoll [33].
The reader who is mainly interested in the nilpotent group case can read directly
Section 6 while keeping an eye on Sections 2 and 4 for background notations and
elementary facts.
Finally, let us mention that the results and methods of this paper were largely
inspired by the works of Y. Guivarc'h [21] and P. Pansu [27].
1.6. Nota Bene. A version of this article circulated since 2007. The present version contains essentially the same material, only the exposition has been improved
and several somewhat sketchy arguments have been replaced by full fledged proofs
(in particular in Sections 3 and 7). This delay is due to the fact that I was planning for a long time to improve Section 6 and show an error term in the volume
asymptotics of balls in nilpotent groups. E. Le Donne and I recently managed to
achieve this and it has now become an independent joint paper [9].
2. Quasi-norms and the geometry of nilpotent Lie groups
In this section, we review the necessary background material on nilpotent Lie
groups. In paragraph 2.4, we give some crucial properties of homogeneous quasi
norms and reproduce some lemmas originally due to Y. Guivarc'h which will be
used in the sequel. Meanwhile, we prove the Bass-Guivarc'h formula for the degree of polynomial growth of nilpotent Lie groups, following Guivarc'h's original
argument.
2.1. Carnot-Caratheodory metrics. Let G be a connected Lie group with Lie
algebra g and let m1 be a vector subspace of g. We denote by k*k a norm on m1 .
We now recall the definition of a left-invariant Carnot-Carathéodory metric also
called subFinsler metric on G. Let x, y ∈ G. We consider all possible piecewise
smooth paths ξ : [0, 1] → G going from ξ(0) = x to ξ(1) = y. Let ξ ′ (u) be the
tangent vector which is pulled back to the identity by a left translation, i.e.
(6)

dξ
= ξ(u) * ξ ′ (u)
du

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

13

where ξ ′ (u) ∈ g and the notation ξ(u) * ξ ′ (u) means the image of ξ ′ (u) under
the differential at the identity of the left translation by the group element ξ(u).
We say that the path ξ is horizontal if the vector ξ ′ (u) belongs to m1 for all
u ∈ [0, 1]. We denote by H the set of piecewise smooth horizontal paths. The
Carnot-Carathéodory metric associated to the norm k*k is defined by:
Z 1
ξ ′ (u) du, ξ ∈ H, ξ(0) = x, ξ(1) = y}
d(x, y) = inf{
0

where the infimum is taken over all piecewise smooth paths ξ : [0, 1] → N with
ξ(0) = x, ξ(1) = y that are horizontal in the sense that ξ ′ (u) ∈ m1 for all u. If
k * k is a Euclidean norm, the metric d(x, y) is also called subRiemannian. In this
paper however the norm k * k will typically not be Euclidean (it can be polyhedral
like in the case of word metrics on finitely generated nilpotent groups) and d(x, y)
will only be subFinsler. If m1 = g, and k*k is a Euclidean (resp. arbitrary) norm
on g, then d is simply the usual left-invariant Riemannian (resp. Finsler) metric
associated to k*k .
Chow's theorem (e.g. see [19] or [25]) tells us that d(x, y) is finite for all x and
y in G if and only if the vector subspace m1 , together with all brackets of elements
of m1 , generates the full Lie algebra g. If this condition is satisfied, then d is a
distance on G which induces the original topology of G.
In this paper, we will only be concerned with Carnot-Caratheodory metrics on
a simply connected nilpotent Lie group N . In the sequel, whenever we speak of a
Carnot-Carathéodory metric on N, we mean one that is associated to a norm k*k
on a subspace m1 such that n = m1 ⊕ [n, n] where n = Lie(N ). It is easy to check
that any such m1 generates the Lie algebra n.
Remark 2.1. Let us observe here that for such a metric d on N, we have the
following description of the unit ball for k*k
ff

π1 (x)
, x ∈ N \{e}
{v ∈ m1 , kvk ≤ 1} =
d(e, x)
where π1 is the linear projection from n (identified with N via exp) to m1 with
kernel [n, n]. Indeed, π1 gives rise to a homomorphism from N to the vector space
m1 . And if ξ(u) is a horizontal path from e to x, then applying π1 to (6) we
R1
d
π1 (ξ(u)) = ξ ′ (u), hence π1 (x) = 0 ξ ′ (u)du. Hence kπ1 (x)k ≤ d(e, x) with
get du
equality if x ∈ m1 .
2.2. Dilations on a nilpotent Lie group and the associated graded group.
We now focus on the case of simply connected nilpotent Lie groups. Let N be
such a group with Lie algebra n and nilpotency class r. For background about
analysis on such groups, we refer the reader to the book [12]. The exponential
map is a diffeomorphism between n and N . Most of the time, if x ∈ n, we will
abuse notation and denote the group element exp(x) simply by x. We denote
by {C p (n)}p the central descending series for n, i.e. C p+1 (n) = [n, C p (n)] with
C 0 (n) = n and C r (n) = {0}.

14

EMMANUEL BREUILLARD

Let (mp )p≥1 be a collection of vector subspaces of n such that for each p ≥ 1,
(7)

C p−1 (n) = C p (n) ⊕ mp .

Then n = ⊕p≥1 mp and in this decomposition, any element x in n (or N by abuse
of notation) will be written in the form
X
x=
πp (x)
p≥1

where πp (x) is the linear projection onto mp .
To such a decomposition is associated a one-parameter group of dilations (δt )t>0 .
These are the linear endomorphisms of n defined by
δt (x) = tp x
for any x ∈ mp and for every p. Conversely, the one-parameter group (δt )t≥0
determines the (mp )p≥1 's since they appear as eigenspaces of each δt , t 6= 1. The
dilations δt do not preserve a priori the Lie bracket on n. This is the case if and
only if
(8)

[mp , mq ] ⊆ mp+q

for every p and q (where [mp , mq ] is the subspace spanned by all commutators of
elements of mp with elements of mq ). If (8) holds, we say that the (mp )p≥1 form a
stratification of the Lie algebra n, and that n is a stratified (or homogeneous) Lie
algebra. It is an exercise to check that (8) is equivalent to require [m1 , mp ] = mp+1
for all p.
If (8) does not hold, we can however consider a new Lie algebra structure on
the real vector space n by defining the new Lie bracket as [x, y]∞ = πp+q ([x, y])
if x ∈ mp and y ∈ mq . This new Lie algebra n∞ is stratified and has the same
underlying vector space as n. We denote by N∞ the associated simply connected
Lie group. Moreover the (δt )t>0 form a one-parameter group of automorphisms of
n∞ . In fact the original Lie bracket [x, y] on n can be deformed continuously to
[x, y]∞ through a continuous family of Lie algebra structures by setting
(9)

[x, y]t = δ 1 ([δt x, δt y])
t

and letting t → +∞. Note that conversely, if the δt 's are automorphisms of n,
then [x, y] = πp+q ([x, y]) for all x ∈ mp and y ∈ mq , and n = n∞ .
The graded Lie algebra associated to n is by definition
M
gr(n) =
C p (n)/C p+1 (n)
p≥0

endowed with the Lie bracket induced from that of n. The quotient map mp →
C p (n)/C p+1 (n) gives rise to a linear isomorphism between n and gr(n), which is
a Lie algebra isomorphism between the new Lie algebra structure n∞ and gr(n).
Hence stratified Lie algebra structures induced by a choice of supplementary subspaces (mp )p≥1 as in (7) are all isomorphic to gr(n).

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

15

On N∞ the left-invariant subFinsler metrics d∞ associated to a choice of norm
on m1 are of special interest. The one-parameter group of dilations {δt }t is an
automorphism of N∞ and that
(10)

d∞ (δt x, δt y) = td∞ (x, y)

for any x, y ∈ N∞ . The metric space (N∞ , d∞ ) is called a Carnot group.
If on the other hand the simply connected nilpotent Lie group N is not stratified,
then the group of dilations (δt )t associated to a choice of supplementary vector
subspaces mi 's as in (7) will not consist of automorphisms of N and the relation
(10) will not hold.
Note also that if we are given two different choices of supplementary subspaces
mi 's and m′i 's as in (7), then the left-invariant Carnot-Caratheodory metrics on
the corresponding stratified Lie groups are isometric if and only if (m1 , k*k) and
(m′1 , k*k′ ) are isometric (a linear isomorphism from m1 to m′1 that sends k*k to
k*k′ extends to an isometry of the two Carnot groups).
2.3. The Campbell-Hausdorff formula. The exponential map exp : n → N
is a diffeomorphism. In the sequel, we will often abuse notation and identify N
and n without further notice. In particular, for two elements x and y of n (or
N equivalently) xy will denote their product in N , while x + y denotes the sum
in n. Let (δt )t be a one-parameter group of dilations associated to a choice of
supplementary subspaces mi 's as in (7). We denote the corresponding stratified
Lie algebra by n∞ as above and the Lie group by N∞ . The product on N∞ is
denoted by x ∗ y. On N∞ the dilations (δt )t are automorphisms.
The Campbell-Hausdorff formula (see [12]) allows to give a more precise form of
the product in N. Let (ei )1≤i≤d be a basis of n adapted to the decomposition into
mi 's, that is mi = span{ej , ej ∈ mi }. Let x = x1 e1 + ... + xd ed the corresponding
decomposition of an element x ∈ n. Then define the degree di = deg(ei ) to be the
largest j such that ei ∈ C j−1 (n). If α = (α1 , ..., αd ) ∈ Nd is a multi-index, then let
dα = deg(e1 )α1 + ... + deg(ed )αd .
The Campbell-Hausdorff formula yields
X
(11)
(xy)i = xi + yi +
Cα,β xα y β
where Cα,β are real constants and the sum is over all multi-indices α and β such
that dα + dβ ≤ deg(ei ), dα ≥ 1 and dβ ≥ 1.
From (9), it is easy to give the form of the associated stratified Lie group law:
X
(12)
(x ∗ y)i = xi + yi +
Cα,β xα y β
where the sum is restricted to those α's and β's such that dα + dβ = deg(ei ),
dα ≥ 1 and dβ ≥ 1.

2.4. Homogeneous quasi-norms and Guivarc'h's theorem on polynomial
growth. Let n be a finite dimensional real nilpotent Lie algebra and consider a
decomposition
n = m1 ⊕ ... ⊕ mr

16

EMMANUEL BREUILLARD

by supplementary vector subspaces as in (7). Let (δt )t>0 be the one parameter
group of dilations associated to this decomposition, that is δt (x) = ti x if x ∈ mi .
We now introduce the following definition.
Definition 2.2 (Homogeneous quasi-norm). A continuous function | * | : n → R+
is called a homogeneous quasi-norm associated to the dilations (δt )t , if it satisfies
the following properties:
(i) |x| = 0 ⇔ x = 0.
(ii) |δt (x)| = t|x| for all t > 0.
Example 2.3. (1) Quasi-norms of supremum type, i.e. |x| = maxp kπp (x)k1/p
p
where k*kp are ordinary norms on the vector space mp and πp is the projection on
mp as above.
(2) |x| = d∞ (e, x), where d∞ is a Carnot-Carathéodory metric on a stratified
nilpotent Lie group (as the relation (10) shows).
Clearly, a quasi-norm is determined by its sphere of radius 1 and two quasinorms (which are homogeneous with respect to the same group of dilations) are
always equivalent in the sense that
1
|*| ≤ |*|2 ≤ c |*|1
(13)
c 1
for some constant c > 0 (indeed, by continuity, | * |2 admits a maximum on the
"sphere" {|x|1 = 1}). If the two quasi-norms are homogeneous with respect to
two distinct semi-groups of dilations, then the inequalities (13) continue to hold
outside a neighborhood of 0, but may fail near 0.
Homogeneous quasi-norms satisfy the following properties:
Proposition 2.4. Let | * | be a homogeneous quasi-norm on n, then there are
constants C, C1 , C2 > 0 such that
(a) |xi | ≤ C * |x|deg(ei ) if x = x1 e1 + ... + xn en in an adapted basis (ei )i .
(b) |x−1 | ≤ C * |x|.
(c) |x + y| ≤ C * (|x| + |y|)
(d) |xy| ≤ C1 (|x| + |y|) + C2 .
Properties (a), (b) and (c) are straightforward from the fact that |x| = maxp kπp (x)k1/p
p
is a homogeneous quasi-norm and from (13). Property (d) justifies the term "quasinorm" and follows from Lemma 2.5 below. It can be a problem that the constant
C1 in (d) may not be equal to 1. In fact, this is why we use the word quasi-norm
instead of just norm, because we do not require the triangle inequality axiom to
hold. However the following lemma of Guivarc'h is often a good enough remedy
to this situation. Let k*kp be an arbitrary norm on the vector space mp .
Lemma 2.5. (Guivarc'h, [21] lemme II.1) Let ε > 0. Up to rescaling each k*kp
into a proportional norm λp k*kp (λp > 0) if necessary, the quasi-norm |x| =
satisfies
maxp kπp (x)k1/p
p
(14)

|xy| ≤ |x| + |y| + ε

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

17

for all x, y ∈ N . If N is stratified with respect to (δt )t we can take ε = 0.
This lemma is crucial also for computing the coarse asymptotics of volume
growth. For the reader's convenience, we reproduce here Guivarc'h's argument,
which is based on the Campbell-Hausdorff formula (11).
Proof. We fix λ1 = 1 and we are going to give a condition on the λi 's so that (14)
holds. The λi 's will be taken to be smaller and smaller as i increases. We set
|x| = maxp kπp (x)k1/p
and let |x|λ = maxp kλp πp (x)k1/p
for any r-tuple of λi 's.
p
p
We want that for any index p ≤ r,
(15)

λp kπp (xy)kp ≤ (|x|λ + |y|λ + ε)p

By (11) we have πp (xy) = πp (x) + πp (y) + Pp (x, y) where Pp is a polynomial map
into mp depending only on the πi (x) and πi (y) with i ≤ p − 1 such that
X
kPp (x, y)kp ≤ Cp *
Mp−1 (x)l Mp−1 (y)m
l,m≥1,l+m≤p

1/i

where Mk (x) := maxi≤k kπi (x)ki and Cp > 0 is a constant depending on Pp and
on the norms k*ki 's. Since ε > 0, when expanding the right hand side of (15) all
terms of the form |x|lλ |y|m
λ with l + m ≤ p appear with some positive coefficient,
p
say εl,m . The terms |x|λ and |y|pλ appear with coefficient 1 and cause no trouble
since we always have λp kπp (x)kp ≤ |x|pλ and λp kπp (y)kp ≤ |y|pλ . Therefore, for
(15) to hold, it is sufficient that
λp Cp Mp−1 (x)l Mp−1 (y)m ≤ εl,m |x|lλ |y|m
λ
for all remaining l and m. However, clearly Mk (x) ≤ Λk * |x|λ where Λk :=
1/i
maxi≤k {1/λi } ≥ 1. Hence a sufficient condition for (15) to hold is
λp ≤

ε
Cp Λpp−1

where ε = min εl,m . Since Λp−1 depends only on the first p − 1 values of the λi 's, it
is obvious that such a set of conditions can be fulfilled by a suitable r-tuple λ. 
Remark 2.6. The constant C2 in Property (d) above can be taken to be 0 when N
is stratified with respect to the mi 's (i.e. the δt 's are automorphisms), as is easily
seen after changing x and y into their image under δt . And conversely, if C2 = 0
for some δt -homogeneous quasi-norm on N, then N admits a stratification. Indeed,
from (11) and (12), we see that if the δt 's are not automorphisms, then one can
find x, y ∈ N such that, when t is small enough, |δt (xy) − δt (x)δt (y)| ≥ ct(r−1)/r
for some c > 0. However, combining Properties (c) and Property (d) with C2 = 0
above we must have |δt (xy) − δt (x)δt (y)| = O(t) near t = 0. A contradiction.
Guivarc'h's lemma enables us to show:
Theorem 2.7. (Guivarc'h ibid.) Let Ω be a compact neighborhood of the identity
in a simply connected nilpotent Lie group N and ρΩ (x, y) = inf{n ≥ 1, x−1 y ∈ Ωn }.

18

EMMANUEL BREUILLARD

Then for any homogeneous quasi-norm | * | on N, there is a constant C > 0 such
that
1
|x| ≤ ρΩ (e, x) ≤ C|x| + C
(16)
C
Proof. Since any two homogeneous quasi-norms (w.r.t the same one-parameter
group of dilations) are equivalent, it is enough to do the proof for one of them,
so we consider the quasi-norm obtained in Lemma 2.5 with the extra property
(14). The lower bound in (16) is a direct consequence of (14) and one can take
there C to be max{|x|, x ∈ Ω} + ε. For the upper bound, it suffices to show
that there is C ∈ N such that for all n ∈ N, if |x| ≤ n then x ∈ ΩCn . To
achieve this, we proceed by induction of the nilpotency length of N. The result
is clear when N is abelian. Otherwise, by induction we obtain C0 ∈ N such that
x = ω1 * ... * ωC0 n * z where ωi ∈ Ω and z ∈ C r−1 (N ) whenever |x| ≤ n. Hence
|z| ≤ |x| + C0 n * max |ωi−1 | + εC0 * n ≤ C1 n for some other constant C1 ∈ N. So we
have reduced the problem to x = z ∈ mr = C r−1 (N ) which is central in N. We
r
have z = z1n where |z1 | = |z|/n ≤ C1 . Since Ω is a neighborhood of the identity
in N, the set U of all products of at most dim(mr ) simple commutators of length
r of elements in Ω is a neighborhood of the identity in C r−1 (N ) (e.g. see [19],
p113). It follows that there is a constant C2 ∈ N such that z1 is in U C2 , hence the
product of at most C2 dim(mr ) simple commutators. Then we are done because z
itself will be equal to the same product of commutators where each letter xi ∈ Ω
is replaced by xni . This last fact follows from the following lemma:
Lemma 2.8. Let G be a nilpotent group of nilpotency class r and n1 , ..., nr be
positive integers. Then for any x1 , ..., xr ∈ G
[xn1 1 , [xn2 2 , [..., xnr r ]...] = [x1 , [x2 , [..., xr ]...]n1 *...*nr
To prove the lemma it suffices to use induction and the following obvious fact:
if [x, y] commutes to x and y then [xn , y] = [x, y]n .

Finally, we obtain:
Corollary 2.9. Let Ω be a compact neighborhood of the identity in N. Then there
are positive constants C1 and C2 such that for all n ∈ N,
C1 nd ≤ volN (Ωn ) ≤ C2 nd
where d is given by the Bass-Guivarc'h formula:
X
(17)
d=
i * dim mi
i≥1

Proof. By Theorem 2.7, it is enough to estimate the volume of the quasi-norm
balls. By homogeneity of the quasi-norm, we have volN {x, |x| ≤ t} = td volN {x, |x| ≤
1}.

Remark 2.10. The use of Malcev's embedding theorem allows, as Guivarc'h observed, to deduce immediately that the analogous result holds for virtually nilpotent
finitely generated groups. This fact that was also proven independently by H. Bass

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

19

[3] by a direct combinatorial argument. See also Tits' appendix to Gromov's paper [17]. In fact Guivarc'h's Theorem 2.7 seems to have been rediscovered several
times in the past 40 years, including by Pansu in his thesis [27], the latest example
of that being [22].
3. The nilshadow
The goal of this section is to introduce the nilshadow of a simply connected
solvable Lie group G. We will assume that G has polynomial growth, although
this last assumption is not necessary for almost everything we do in this section.
The only statement which will be used afterwards in the paper (in Section 5) is
Lemma 3.12 below. The reader familiar with the nilshadow can jump directly to
the statement of this lemma and skip the forthcoming discussion.
3.1. Construction of the nilshadow. The nilshadow of G is a simply connected
nilpotent Lie group GN , which is associated to G in a natural way. This notion
was first introduced by Auslander and Green in [2] in their study of flows on
solvmanifolds. They defined it as the unipotent radical of a semi-simple splitting
of G. However, we are going to follow a different approach for its construction by
working first at the Lie algebra level. We refer the reader to the book [13] where
this approach is taken up.
Let g be a solvable real Lie algebra and n the nilradical of g. We have [g, g] ⊂ n.
If x ∈ g, we write ad(x) = ads (x) + adn (x) the Jordan decomposition of ad(x) in
GL(g). Since ad(x) ∈ Der(g), the space of derivations of g, and Der(g) is the Lie
algebra of the algebraic group Aut(g), the Jordan components ads (x) and adn (x)
also belong to Der(g). Moreover, for each x ∈ g, ads (x) sends g into n (because
so does ad(x) and ads (x) is a polynomial in ad(x)). Let h be a Cartan subalgebra
of g, namely a nilpotent self-normalizing subalgebra. Recall that the image of
a Cartan subalgebra by a surjective Lie algebra homomorphism is again a Cartan subalgebra. Now since g/n is abelian, it follows that h maps onto g/n, i.e.
h + n = g. Moreover ads (x)|h = 0 if x ∈ h, because h is nilpotent.
Now pick any real vector subspace v of h in direct sum with n. Then the
following two conditions hold:
(i) v ⊕ n = g .
(ii) ads (x)(y) = 0 for all x, y ∈ v.
From (i) and (ii), it follows easily that ads (x) commutes with ad(y), ads (y) and
adn (y), for all x, y in v. We have:
Lemma 3.1. The map v → Der(g) defined by x 7→ ads (x) is a Lie algebra
homomorphism.
Proof. First let us check that this map is linear. Let x, y ∈ v. By the above
ads (y) and ads (x) commute with each other (hence their sum is semi-simple) and
commute with adn (x) + adn (y). From the uniqueness of the Jordan decomposition

20

EMMANUEL BREUILLARD

it remains to check that adn (x) + adn (y) is nilpotent if x, y in v. To see this, apply
the following obvious remark twice to a = adn (x) and V = ad(n) first and then to
a = adn (y) and V = span{adn (x), ad((ad(y))n x), n ≥ 1} : Let V be a nilpotent
subspace of GL(g) and a ∈ GL(g) nilpotent, i.e. V n = 0 and am = 0 for some
n, m ∈ N and assume [a, V ] ⊂ V. Then (a + V )nm = 0.
The fact that this map is a Lie algebra homomorphism follows easily from the
fact that all ads (x), x ∈ v commute with one another and with [g, g] ⊂ n.

We define a new Lie bracket on g by setting:
(18)

[x, y]N = [x, y] − ads (xv )(y) + ads (yv )(x)

where xv is the linear projection of x on v according to the direct sum v⊕n = g. The
Jacobi identity is checked by a straightforward computation where the following
fact is needed: ads (ads (x)(y)) = 0 for all x, y ∈ g. This holds because, as we just
saw, ads (x)(g) ⊂ n for all x ∈ g, and ads (a) = 0 if a ∈ n.
Definition 3.2. Let gN be the vector space g endowed with the new Lie algebra
structure [*, *]N given by (18). The nilshadow GN of G is defined to be the simply
connected Lie group with Lie algebra gN .
It is easy to check that gN is a nilpotent Lie algebra. To see this, note first that
[gN , gN ]N ⊂ n, and if x ∈ gN and y ∈ n then [x, y]N = (adn (xv ) + ad(xn ))(y).
However, adn (xv ) + ad(xn ) is a nilpotent endomorphism of n as follows from the
same remark used in the proof of Lemma 3.1. Hence gN is a nilpotent.
The nilshadow Lie product on GN will be denoted by ∗ in order to distinguish
it from the original Lie product on G. In the sequel, we will often identify G (resp.
GN ) with its Lie algebra g (resp. gN ) via their respective exponential map. Since
the underlying space of gN was g itself, this gives an identification (although not
a group isomorphism) between G and GN . Then the nilshadow Lie product can
be expressed in terms of the original product as follows:
g ∗ h = g * (T (g −1 )h)
Here T is the Lie group homomorphism G → Aut(G) induced by the above
choice of supplementary subspace v as follows.
(19)

T (ea )(eb ) = exp(eads (av ) b) ∀a, b ∈ g.

In other words, T is the unique Lie group homomorphism whose differential
at the identity is the Lie algebra homomorphism de T : g → Der(g) given by
de T (a)(b) = ads (av )b, that is the composition of the map v → Der(g) from
Lemma 3.1 with the linear projection g → g/n ≃ v.
It is easy to check that this definition of the new product is compatible with
the definition of the new Lie bracket.
It can also be checked that two choices of supplementary spaces v as above yield
isomorphic Lie structures (see [13, Chap. III]). Hence by abuse of language, we

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

21

speak of the nilshadow of g, when we mean the Lie structure on G induced by a
choice of v as above.
The following example shows several of the features of a typical solvable Lie
group of polynomial growth.
Example 3.3 (Nilshadow of a semi-direct product). Let G = R ⋉φ Rn where
φt ∈ GLn (R) is some one parameter subgroup given by φt = exp(tA) = kt ut where
A is some matrix in Mn (R) and A = As + Au is its Jordan decomposition, giving
rise to kt = exp(tAs ) and ut = exp(tAu ). The group G is diffeomorphic to Rn+1 ,
hence simply connected. If all eigenvalues of As are purely imaginary, then G has
polynomial growth. However G is not nilpotent unless As = 0. So let us assume
that neither As nor Au is zero. Then the nilshadow GN is the semi-direct product
R ⋉u Rn where ut is the unipotent part of φt .
It is easy to compute the homogeneous dimension of G (or GN ) in terms of the
dimension of the Jordan blocs of Au . If nk is the number of Jordan blocks of Au
of size k, then
X k(k + 1)
nk
d(G) = 1 +
2
k≥1

3.2. Basic properties of the nilshadow. We now list in the form of a few
lemmas some basic properties of the nilshadow.
Lemma 3.4. The image of T : G → Aut(G) is abelian and relatively compact.
Moreover T (T (g)h) = T (h) for any g, h ∈ G.
Proof. Since G has polynomial growth it is of type (R) by Guivarc'h's theorem.
Hence all ads (x) have purely imaginary eigenvalues. It follows that K is compact.
Since T factors through the nilradical, its image is abelian. The last equality
follows from (19) and the fact that ∀x, y ∈ g, ads (ads (x)(y)) = 0.

Lemma 3.5. T (G) also belongs to Aut(GN ) and T is a group homomorphism
GN → Aut(GN ).
Proof. The first assertion follows from (19) and the fact that de T is a derivation
of gN as one can check from (18) and the fact that ∀x, y ∈ g, ads (ads (x)(y)) = 0.
The second assertion then follows from Lemma 3.4.

We denote by K the closure of T (G) in Aut(G) = Aut(g).
Lemma 3.6 (K-action on gN ). K preserves v and acts trivially on it. It also
preserves the ideals n and the central descending series {C i (gN )}i of gN .
Proof. It suffices to check that ads (v) preserves n and C i (gN ). It preserves n
because ad(x) preserves n for all x ∈ g. It preserves C i (gN ) because it acts as a
derivation of gN as we have already checked in the proof of Lemma 3.5.

Remark 3.7 (Well-definedness of π1 ). It is also easy to check from the definition
of the nilshadow bracket that the commutator subalgebra [gN , gN ] and in fact each
term of the central descending series C i (gN ) is an ideal in g and does not depend
on the choice of supplementary subspace v used to defined the nilshadow bracket.

22

EMMANUEL BREUILLARD

In particular the projection map π1 : gN → gN /[gN , gN ] is a well defined linear
map on g = gN (i.e. independently of the choice involved in the construction of
the nilshadow Lie bracket).
Lemma 3.8 (Exponential map). The respective exponential maps exp : g → G
and expN : gN → GN coincide on n and on v.
Proof. Since the two Lie products coincide on N = exp(n), so do their exponential
map. For the second assertion, note that T (e−tv )v = v for every v ∈ v because
ads (x)(y) = 0 for all x, y ∈ ν. It follows that {etv }t is a one-parameter subgroup
for both Lie structures, hence it is equal to {expN (tv)}t .

Remark 3.9 (Surjectivity of the exponential map). The exponential map is not
e of the group E
always a diffeomorphism, as the example of the universal cover E
of motions of the plane shows (indeed any 1-parameter subgroup of E is either a
translation subgroup or a rotation subgroup, but the rotation subgroup is compact
hence a torus, so its lift will contain the (discrete) center of E, hence will miss
every lift of a non trivial translation). In fact, it is easy to see that if g is the Lie
algebra of a solvable (non-nilpotent) Lie group of polynomial growth, then g maps
surjectively on the Lie algebra of E. Hence, for a simply connected solvable and
non-nilpotent Lie group of polynomial growth, the exponential map is never onto.
Nevertheless its image is easily seen to be dense.
However, exponential coordinates of the second kind behave nicely. Note that
[gN , gN ] ⊂ n.
Lemma 3.10 (Exponential coordinates of the second kind). Let {C i (gN )}i≥0
be the central descending series of gN (with C 1 (gN ) = [gN , gN ]) and pick linear
subspaces mi in gN such that C i (gN ) = mi ⊕ C i−1 (gN ) for i ≥ 2. Let l be a
supplementary subspace of C 1 (gN ) in n. Define exponential coordinates of the
second kind by setting
mr ⊕ ... ⊕ m2 ⊕ l ⊕ v → G
(ξr , ..., ξ1 , v) 7→ expN (ξr ) ∗ . . . ∗ expN (ξ1 ) ∗ expN (v)
This map is a diffeomorphism. Moreover expN (ξr ) ∗ . . . ∗ expN (ξ1 ) ∗ expN (v) =
eξr * ... * eξ1 * ev for all choices of v ∈ v and ξi ∈ mi .
Proof. By Lemma 3.8 the exponential maps of G and GN coincide on n and on v.
Moreover g ∗ h = g * h whenever g belongs to the nilradical exp(n) of G. Hence
expN (ξr )∗. . .∗expN (ξ1 )∗expN (v) = expN (ξr )*. . .*expN (ξ1 )*expN (v) = eξr *...*eξ1 *ev .
The restriction of the map to n is a diffeomorphism onto exp(n), because this map
and its inverse are explicit polynomial maps (the ξi 's are coordinates of the second
kind, see the book [12]). Now the map n ⊕ v → G sending (n, v) to en * ev is a
diffeomorphism, because G is simply connected and hence the quotient group
G/ exp(n) isomorphic to a vector space and hence to exp(v).

Lemma 3.11 ("Bi-invariant" Riemannian metric). There exists a Riemannian
metric on G which is left invariant under both Lie structures.

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

23

Proof. Indeed it suffices to pick a scalar product on g which is invariant under the
compact subgroup K = T (G) ⊂ Aut(g).

We identify K = {T (g), g ∈ G} with its image in Aut(g) under the canonical
isomorphism between Aut(G) and Aut(g). Recall that, according to Lemma 3.6,
the central descending series of gN is invariant under ads (x) for all x ∈ v and
consists of ideals of g. The same holds for n. It follows that these linear subspaces
also invariant under K. However since K is compact, its action on g is completely
reducible. Therefore we have proved:
Lemma 3.12 (K-invariant stratification of the nilshadow). Let g be the Lie algebra
of a simply connected Lie group G with polynomial growth. Let gN be the nilshadow
Lie algebra obtained from a splitting g = n ⊕ v as above (i.e. n is the nilradical and
v satisfies ads (x)(y) = 0 for every x, y ∈ v). Let K := {T (g), g ∈ G} ⊂ Aut(G),
where T is defined by (19). Then there is a choice of linear subspaces mi 's and l
such that
(20)

gN = mr ⊕ . . . m2 ⊕ l ⊕ v,

where each term is K-invariant, m1 := l ⊕ v and the central descending series of
gN satisfies C i (gN ) = mi ⊕ C i−1 (gN ). Moreover the action on K can be read off
on the exponential coordinates of second kind in this decomposition, namely:


= k(eξr ) * ... * k(eξ0 ) = ek(ξr ) * ... * ek(ξ0 )
k eξr * ... * eξ0
= expN (k(ξr )) ∗ ... ∗ expN (k(ξ0 ))

4. Periodic metrics
In this section, unless otherwise stated, G will denote an arbitrary locally compact group.
4.1. Definitions. By a pseudodistance (or metric) on a topological space X, we
mean a function ρ : X × X → R+ satisfying ρ(x, y) = ρ(y, x) and ρ(x, z) ≤
ρ(x, y) + ρ(y, z) for any triplet of points of X. However ρ(x, y) may be equal to 0
even if x 6= y.
We will require our pseudodistances to be locally bounded, meaning that the
image under ρ of any compact subset of G × G is a bounded subset of R+ . To
avoid irrelevant cases (for instance ρ ≡ 0) we will also assume that ρ is proper, i.e.
the map y 7→ ρ(e, y) is a proper map, namely the preimage of a bounded set is
bounded (we do not ask that the map be continuous). When ρ is locally bounded
then it is proper if and only if y 7→ ρ(x, y) is proper for any x ∈ G.
A pseudodistance ρ on G is said to be asymptotically geodesic if for every ε > 0
there exists s > 0 such that for any x, y ∈ G one can find a sequence of points
x1 = x, x2 , ..., xn = y in G such that
(21)

n−1
X

ρ(xi , xi+1 ) ≤ (1 + ε)ρ(x, y)

i=1

and ρ(xi , xi+1 ) ≤ s for all i = 1, ..., n − 1.

24

EMMANUEL BREUILLARD

We will consider exclusively pseudodistances on a group G that are invariant
under left translations by all elements of a fixed closed and co-compact subgroup
H of G, meaning that for all x, y ∈ G and all h ∈ H, ρ(hx, hy) = ρ(x, y).
Combining all previous axioms, we set the following definition.
Definition 4.1. Let G be a locally compact group. A pseudodistance ρ on G will
be said to be a periodic metric (or H-periodic metric) if it satisfies the following
properties:
(i) ρ is invariant under left translations by a closed co-compact subgroup H.
(ii) ρ is locally bounded and proper.
(iii) ρ is asymptotically geodesic.
Remark 4.2. The assumption that ρ is symmetric, i.e. ρ(x, y) = ρ(y, x) is here
only for the sake of simplicity, and most of what is proven in this paper can be
done without this hypothesis.
4.2. Basic properties. Let ρ be a periodic metric on G and H some co-compact
subgroup of G. The following properties are straighforward.
(1) ρ is at a bounded distance from its restriction to H. This means that if F
is a bounded fundamental domain for H in G and for an arbitrary x ∈ G, if hx
denotes the element of H such that x ∈ hx F, then |ρ(x, y) − ρ(hx , hy )| ≤ C for
some constant C > 0.
(2) ∀t > 0 there exists a compact subset Kt of G such that, ∀x, y ∈ G, ρ(x, y) ≤
t ⇒ x−1 y ∈ Kt . And conversely, if K is a compact subset of G, ∃t(K) > 0 s.t.
x−1 y ∈ K ⇒ ρ(x, y) ≤ t(K).
(3) If ρ(x, y) ≥ s, the xi 's in (21) can be chosen in such a way that s ≤
ρ(xi , xi+1 ) ≤ 2s (one can take a suitable subset of the original xi 's).
(4) The restriction of ρ to H × H is a periodic pseudodistance on H. This
means that the xi 's in (21) can be chosen in H.
(5) Conversely, given a periodic pseudodistance ρH on H, it is possible to extend
it to a periodic pseudodistance on G by setting ρ(x, y) = ρH (hx , hy ) where x =
hx F for some bounded fundamental domain F for H in G.
4.3. Examples. Let us give a few examples of periodic pseudodistances.
(1) Let Γ be a finitely generated torsion free nilpotent group which is embedded
as a co-compact discrete subgroup of a simply connected nilpotent Lie group N .
Given a finite symmetric generating set S of Γ, we can consider the corresponding
word metric dS on Γ which gives rise to a periodic metric on N given by ρ(x, y) =
dS (γx , γy ) where x ∈ γx F and y ∈ γy F if F is some fixed fundamental domain for
Γ in N.
(2) Another example, given in [27], is as follows. Let N/Γ be a nilmanifold with
universal cover N and fundamental group Γ. Let g be a Riemannian metric on
N/Γ. It can be lifted to the universal cover and thus gives rise to a Riemannian
metric e
g on N . This metric is Γ-invariant, proper and locally bounded. Since Γ is
co-compact in N, it is easy to check that it is also asymptotically geodesic hence
periodic.

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

25

(3) Any word metric on G. That is, if Ω is a compact symmetric generating
subset of G, let ∆Ω (x) = inf{n ≥ 1, x ∈ Ωn }. Then define ρ(x, y) = ∆Ω (x−1 y).
Clearly ρ is a pseudodistance (although not a distance) and it is G-invariant on the
left, it is also proper, locally bounded and asymptotically geodesic, hence periodic.
(4) If G is a connected Lie group, any left invariant Riemannian metric on G.
Here again H = G and we obtain a periodic distance. Similarly, any left invariant
Carnot-Carathéodory metric on G will do.
Remark 4.3 (Berestovski's theorem). According to a result of Berestovski [5]
every left-invariant geodesic distance on a connected Lie group is a subFinsler
metric as defined in Paragraph 2.1.
4.4. Coarse equivalence between invariant pseudodistances. The following
proposition is basic:
Proposition 4.4. Let ρ1 and ρ2 be two periodic pseudodistances on G. Then there
is a constant C > 0 such that for all x, y ∈ G
1
ρ2 (x, y) − C ≤ ρ1 (x, y) ≤ Cρ2 (x, y) + C
(22)
C
Proof. Clearly it suffices to prove the upper bound. Let s > 0 be the number corresponding to the choice ε = 1 in (21) for ρ2 . From 4.2 (2), there exists a compact
subset Ks in G such that ρ2 (x, y) ≤ 2s ⇒ x−1 y ∈ K2s , and there is a constant
t = t(K2s ) > 0 such that x−1 y ∈ K2s ⇒ ρ1 (x, y) ≤ t. Let C = max{2t/s, t}, and
let x, y ∈ G. If ρ2 (x, y) ≤ s then ρ1 (x, y) ≤ t so the right hand side of (22) holds.
If ρ2 (x, y) ≥ s then, from (21) and 4.2 (3), we get a sequence of xi 's in G from x
P
to y such that s ≤ ρ2 (xi , xi+1 ) ≤ 2s and N
(xi , xi+1 ) ≤ 2ρ2 (x, y). It follows
1 ρ2P
that ρ1 (xi , xi+1 ) ≤ t for all i. Hence ρ1 (x, y) ≤
ρ1 (xi , xi+1 ) ≤ N t ≤ 2s tρ2 (x, y)
and the right hand side of (22) holds. 
In the particular case when G = N is a simply connected nilpotent Lie group,
the distance to the origin x 7→ ρ(e, x) is also coarsely equivalent to any homogeneous quasi-norm on N. We have,
Proposition 4.5. Suppose N is a simply connected nilpotent Lie group. Let ρ1 be
a periodic pseudodistance on N and | * | be a homogeneous quasi-norm, then there
exists C > 0 such that for all x ∈ N
1 −1
|x y| − C ≤ ρ1 (x, y) ≤ C|x−1 y| + C
(23)
C
Moreover, if ρ2 is a periodic pseudodistance on the stratified nilpotent group N∞
associated to N, then again, there is a constant C > 0 such that
1
(24)
ρ2 (e, x) − C ≤ ρ1 (e, x) ≤ Cρ2 (e, x) + C
C
The proposition follows at once from Guivarc'h's theorem (see Corollary 2.7
above), the equivalence of homogeneous quasi-norms, and the fact that left-invariant
Carnot-Caratheodory metrics on N∞ are homogeneous quasi norms. However,
since the group structures on N and N∞ differ, (24) cannot in general be replaced
by the stronger relation (22) as simple examples show.

26

EMMANUEL BREUILLARD

The next proposition is of fundamental importance for the study of metrics on
Lie groups of polynomial growth:
Proposition 4.6. Let G be a simply connected solvable Lie group of polynomial
growth and GN its nilshadow. Let ρ and ρN be arbitrary periodic pseudodistances
on G and GN respectively. Then there is a constant C > 0 such that for all
x, y ∈ G
(25)

1
ρN (x, y) − C ≤ ρ(x, y) ≤ CρN (x, y) + C
C

Proof. According to Proposition 4.4, it is enough to show (25) for some choice of
periodic metrics on G and GN . But in Lemma 3.11 we constructed a Riemannian
metric on G which is left invariant for both G and GN . We are done.

4.5. Right invariance under a compact subgroup. Here we verify that, given
a compact subgroup of G, any periodic metric is at bounded distance from another
periodic metric which is invariant on the right by this compact subgroup. Let K
be a compact subgroup of G and ρ a periodic pseudodistance on G. We average ρ
with the help of the normalized Haar measure on K to get:
Z
K
ρ(xk1 , yk2 )dk1 dk2
(26)
ρ (x, y) =
K×K

Then the following holds:
Lemma 4.7. There is a constant C0 > 0 depending only on ρ and K such that
for all k1 , k2 ∈ K and all x, y ∈ G
(27)

|ρ(xk1 , yk2 ) − ρ(x, y)| ≤ C0

Proof. From 4.2 (2), ∃t = t(K) > 0 s.t. ∀x ∈ G, ρ(x, xk) ≤ t. Applying the
triangle inequality, we are done.

Hence we obtain:
Proposition 4.8. The pseudodistance ρK is periodic and lies at a bounded distance from ρ. In particular, as x tends to infinity in G the following limit holds
(28)

ρK (e, x)
=1
x→∞ ρ(e, x)
lim

Proof. From Lemma 4.7 and 4.2 (3), it is easy to check that ρK must be asymptotically geodesic, and periodic. Integrating (27) we get that ρK is at a bounded
distance from ρ and (28) is obvious.

If K is normal in G, we thus obtain a periodic metric ρK on G/K such that
ρK (p(x), p(y)) is at a bounded distance from ρ(x, y), where p is the quotient map
G → G/K.

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

27

5. Reduction to the nilpotent case
In this section, G denotes a simply connected solvable Lie group of polynomial
growth. We are going to reduce the proof of the theorems of the Introduction
to the case of a nilpotent G. This is performed by showing that any periodic
pseudodistance ρ on G is asymptotic to some associated periodic pseudodistance
ρN on the nilshadow GN . We state this in Proposition 5.1 below.
The key step in the proof is Proposition 5.2 below, which shows the asymptotic
invariance of ρ under the "semisimple part" of G. The crucial fact there is that the
displacement of a distant point under a fixed unipotent automorphism is negligible
compared to the distance from the identity (see Lemmas 5.4, 5.5), so that the
action of the semisimple part of large elements can be simply approximated by
their action by left translation.
5.1. Asymptotic invariance under a compact group of automorphisms
of G. The main result of this section is the following. Let G be a connected and
simply connected solvable Lie group with polynomial growth and GN its nilshadow
(see Section 3).
Proposition 5.1. Let H be a closed co-compact subgroup of G and ρ an Hperiodic pseudodistance (see Definition 4.1) on G. There exist a closed subset HK
containing H which is a co-compact subgroup for both G and GN , and an HK periodic (for both Lie structures) pseudodistance ρK such that
(29)

lim

x→∞

ρK (e, x)
=1
ρ(e, x)

The closed subgroup HK will be taken to be the closure of the group generated
by all elements of the form k(h), where h belongs to H and k belongs to the
closure K in the group Aut(G) of the image of H under the homomorphism
T : G → Aut(G) introduced in Section 3. It is easy to check from the definition
of the nilshadow product (1) that this is indeed a subgroup in both G and its
nilshadow GN .
The new pseudodistance ρK is defined as follows, using a double averaging
procedure:
(30)

ρK (x, y) :=

Z

H\HK

Z

ρ(gk(x), gk(y))dkdμ(g)

K

Here the measure μ is the normalized Haar measure on the coset space H\HK
and dk is the normalized Haar measure on the compact group K. Recall that
all closed subgroups of S are unimodular (since they have polynomial growth by
[21][Lemme I.3.]). Hence the existence of invariant measures on the coset spaces.
An essential part of the proof of Proposition 5.1 is enclosed in the following
statement:

28

EMMANUEL BREUILLARD

Proposition 5.2. Let ρ be a periodic pseudodistance on G which is invariant
under a co-compact subgroup H. Then ρ is asymptotically invariant under the
action of K = {T (h), h ∈ H} ⊆ Aut(G). Namely, (uniformly) for all k ∈ K,
(31)

lim

x→∞

ρ(e, k(x))
=1
ρ(e, x)

The proof of Proposition 5.2 splits into two steps. First we show that it is
enough to prove (31) for a dense subset of k's. This is a consequence of the following
continuity statement:
Lemma 5.3. Let ε > 0, then there is a neighborhood U of the identity in K such
that, for all k ∈ U,
ρ(x, k(x))
limx→∞
<ε
ρ(e, x)
Then we show that the action of T (g) can be approximated by the conjugation
by g, essentially because the unipotent part of this conjugation does not move x
very much when x is far. This is the content of the following lemma:
Lemma 5.4. Let ρ be a periodic pseudodistance on G which is invariant under
a co-compact subgroup H. Then for any ε > 0, and any compact subset F in H
there is s0 > 0 such that
|ρ(e, T (h)x) − ρ(e, hx)| ≤ ερ(e, x)
for any h ∈ F and as soon as ρ(e, x) > s0 .
Proof of Proposition 5.2 modulo Lemmas (5.3) and (5.4): As ρ is assumed to
be H-invariant, for every h ∈ H, we have ρ(e, h−1 x)/ρ(e, x) → 1. The proof of
the proposition then follows immediately from the combination of the last two
lemmas.

5.2. Proof of Lemmas (5.3) and (5.4). We choose K-invariant subspaces mi 's
and l of the nilshadow gN of g as in Lemma 3.12 from Section 3. In particular
gN = mr ⊕ . . . ⊕ m2 ⊕ l ⊕ v,
where each term is K-invariant, n = [gN , gN ] ⊕ l and C i (gN ) = mi ⊕ C i−1 (gN ).
Moreover δt (x) = ti x if x ∈ mi (here m1 = l ⊕ v).
1/d
We also set v(x) = maxi kξi ki i if x = expN (ξr ) ∗ . . . ∗ expN (ξ0 ) and di = i if
i > 0 and d0 = 1. And we let |x| := maxi kxi k1/di if x = xr + . . . + x1 + x0 in the
above direct sum decomposition.
Note that | * | is a δt -homogeneous quasi-norm. Moreover, it is straightforward
to verify (using the Campbell-Hausdorff formula (12) and Proposition 2.4) that
v(x) ≤ C|x| + C for some constant C > 0. In particular ξi /|x|di remains bounded
as |x| becomes large.
Proof of Lemma 5.3. Combining Propositions 4.5 and 4.6, there is a constant
C > 0 such that for all x, y ∈ G, ρ(x, y) ≤ C|x∗−1 ∗ y| + C. Therefore we have

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

29

reduced to prove the statement for | * | instead of ρ, namely it is enough to show
that |x∗−1 ∗ k(x)| becomes negligible compared to |x| as |x| goes to infinity and k
tends to 1.
It follows from the Campbell-Baker-Hausdorff formula (11) and (12) that, if
x, y ∈ GN and |x|, |y| are O(t), then |δ 1 (x ∗ y) − δ 1 (x) ∗ δ 1 (y)| = O(t−1/r ), and
t

t

t

similarly |δ 1 (x1 ∗ . . . ∗ xm ) − δ 1 (x1 ) ∗ . . . ∗ δ 1 (xm )| = Om (t−1/r ), for m elements
t
t
t
xi with |xi | = O(t). Hence when writing x = expN (ξr ) ∗ ... ∗ expN (ξ0 ), and setting
t = |x|, we thus obtain that the following quantity
δ 1 (x∗−1 ∗ k(x)) −
t

∗
Y

expN (−t−di ξi ) ∗

∗
Y

expN (t−dr−i k(ξr−i ))

0≤i≤r

0≤i≤r

is a O(t−1/r ). Indeed recall from Lemma 3.12 that k(x) = expN (k(ξr )) ∗ ... ∗
expN (k(ξ0 )). As x gets larger, each t−di ξi remains in a compact subset of mi .
Therefore, as k tends to the identity in K, each t−di k(ξi ) becomes uniformly close
to t−di ξi independently of the choice of x ∈ GN as long as t = |x| is large. The
result follows. 
Proof of Lemma 5.4. Recall that hx = h ∗ T (h)x for all x, h ∈ G (see (1).
By the triangle inequality it is enough to bound ρ(y, h ∗ y), where y = T (h)x.
From Propositions 4.5 and 4.6, ρ is comparable (up to multiplicative and additive
constants to the homogeneous quasi-norm | * |. Hence the Lemma follows from the
following:
Lemma 5.5. Let N be a simply connected nilpotent Lie group and let | * | be a
homogeneous quasi norm on N associated to some 1-parameter group of dilations
(δt )t . For any ε > 0 and any compact subset F of N, there is a constant s2 > 0
such that
|x−1 gx| ≤ ε|x|
for all g ∈ F and as soon as |x| > s2 .
Proof. Recall, as in the proof of the last lemma, that for any c1 > 0 there is
a c2 > 0 such that if t > 1 and x, y ∈ N are such that |x|, |y| ≤ c1 t, then
|δ 1 (xy) − δ 1 (x) ∗ δ 1 (y)| ≤ c2 t−1/r . In particular, if we set t = |x|, then
t

t

t

δ 1 (x−1 gx) − δ 1 (x)−1 ∗ δ 1 (g) ∗ δ 1 (x) ≤ c2 t−1/r
t

t

t

t

On the other hand, as g remains in the compact set F, δ 1 (g) tends uniformly to
t
the identity when t = |x| goes to infinity, and δ 1 (x) remains in a compact set.
t

By continuity, we see that δ 1 (x)−1 ∗ δ 1 (g) ∗ δ 1 (x) becomes arbitrarily small as t
t
t
t
increases. We are done.



30

EMMANUEL BREUILLARD

5.3. Proof of Proposition 5.1. First we prove the following continuity statement:
Lemma 5.6. Let ρ be a periodic pseudodistance on G and ε > 0. Then there
exists a neighborhood of the identity U in G and s3 > 0 such that
1−ε≤

ρ(e, gx)
≤1+ε
ρ(e, x)

as soon g ∈ U and ρ(e, x) > s3 .
Proof. Let ρN be a left invariant Riemannian metric on the nilshadow GN .
|ρ(e, x) − ρ(e, gx)| ≤ ρ(x, gx) ≤ ρ(x, g ∗ x) + ρ(g ∗ x, gx)
However ρ(a, b) ≤ CρN (a, b) + C for some C > 0 by Proposition 4.6. Moreover by
(1) we have gx = g ∗ T (g)x. Hence
|ρ(e, x) − ρ(e, gx)| ≤ CρN (x, g ∗ x) + CρN (x, T (g)x) + 2C
To complete the proof, we apply Lemmas 5.5 and 5.3 to the right hand side above.

We proceed with the proof of Proposition 5.1. Let L be the set of all g ∈ G
such that ρ(e, gx)/ρ(e, x) tends to 1 as x tends to infinity in G. Clearly L is a
subgroup of G. Lemma 5.6 shows that L is closed. The H-invariance of ρ insures
that L contains H. Moreover, Proposition 5.2 implies that L is invariant under K.
Consequently L contains HK , the closed subgroup generated by all k(h), k ∈ K,
h ∈ H. This, together with Proposition 5.2, grants pointwise convergence of the
integrand in (29). Convergence of the integral follows by applying Lebesgue's
dominated convergence theorem.
The fact that ρK is invariant under left multiplication by H and invariant under
precomposition by automorphisms from K insures that ρK is invariant under ∗left multiplication by any element h ∈ H, where ∗ is the multiplication in the
nilshadow GN . Moreover we check that T (g) ∈ K if g ∈ HK , hence HK is a
subgroup of GN . It is clearly co-compact in GN too (if F is compact and HF = G
then H ∗ FK = G where FK is the union of all k(F ), k ∈ K).
Clearly ρK is proper and locally bounded, so in order to finish the proof, we
need only to check that ρK is asymptotically geodesic. By H-invariance of ρK and
since H is co-compact in G, it is enough to exhibit aP
pseudogeodesic between e
and a point x ∈ H. Let x = z1 * ... * zn with zi ∈ H and
ρ(e, zi ) ≤ (1 + ε) * ρ(e, x).
Fix a compact fundamental domain F for H in HK so that integration in (29)
over H\HK is replaced by integration over F. Then for some constant CF > 0 we
have |ρ(g, gz) − ρ(e, gz)| ≤ CF for g ∈ F and z ∈ H. Moreover, it follows from
Proposition 5.2, Lemma 5.6 and the fact that HK ⊂ L, that
(32)

ρ(e, gk(z)) ≤ (1 + ε) * ρ(e, z)

for all g ∈ F, k ∈ K and as soon as z ∈ G is large enough. Fix s large enough
so that CF ≤ εs and so that (32) holds when ρ(e, z) ≥ s. As already observed in
the discussion following Definition 4.1 (property 4.2 (3)) we may take the zi 's so

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

31

that 2s ≤ ρ(e, zi ) ≤ s. Then nCF ≤ nsε ≤ 3ερ(e, x). Finally we get for ε < 1 and
x large enough
X
ρK (e, zi ) ≤ CF n + (1 + ε)2 ρ(e, x)
≤ CF n + (1 + ε)3 ρK (e, x)
≤ (1 + 10ε) * ρK (e, x)

where we have used the convergence ρK /ρ → 1 that we just proved. 
6. The nilpotent case
In this section, we prove Theorem 1.4 and its corollaries stated in the Introduction for a simply connected nilpotent Lie group. We essentially follow Pansu's
argument from [27], although our approach differs somewhat in its presentation.
Throughout the section, the nilpotent Lie group will be denoted by N, and its Lie
algebra by n.
Let m1 be any vector subspace of n such that n = m1 ⊕ [n, n]. Let π1 the
associated linear projection of n onto m1 . Let H be a closed co-compact subgroup
of N . To every H-periodic pseudodistance ρ on N we associate a norm k*k0 on
m1 which is the norm whose unit ball is defined to be the closed convex hull of all
elements π1 (h)/ρ(e, h) for all h ∈ H\{e}. In other words,

ff
π1 (h)
, h ∈ H\{e}
(33)
E := {x ∈ m1 , kxk0 ≤ 1} = CvxHull
ρ(e, h)
The set E is clearly a convex subset of m1 which is symmetric around 0 (since ρ
is symmetric). To check that E is indeed the unit ball of a norm on m1 it remains
to see that E is bounded and that 0 lies in its interior. The first fact follows
immediately from (23) and Example 2.3. If 0 does not lie in the interior of E,
then E must be contained in a proper subspace of m1 , contradicting the fact that
H is co-compact in N .
Taking large powers hn , we see that we can replace the set H \ {e} in the above
definition by any neighborhood of infinity in H. Similarly, it is easy to see that
the following holds:
Proposition 6.1. For s > 0 let Es be T
the closed convex hull of all π1 (x)/ρ(e, x)
with x ∈ N and ρ(e, x) > s. Then E = s>0 Es .

Proof. Since ρ is T
H-periodic, we have ρ(e, hn ) ≤ nρ(e, h) for all n ∈ N and h ∈ H.
This shows E ⊂ s>0 Es . The opposite inclusion follows easily from the fact that
ρ is at a bounded distance from its restriction to H, i.e. from 4.2 (1).

We now choose a set of supplementary subspaces (mi ) starting with m1 as in
Paragraph 2.2. This defines a new Lie product ∗ on N so that N∞ = (N, ∗) is
stratified. We can then consider the ∗-left invariant Carnot-Carathéodory metric
associated to the norm k*k0 as defined in Paragraph 2.1 on the stratified nilpotent
Lie group N∞ . In this section, we will prove Theorem 1.4 for nilpotent groups in
the following form:

32

EMMANUEL BREUILLARD

Theorem 6.2. Let ρ be a periodic pseudodistance on N and d∞ the CarnotCarathéodory metric defined above, then as x tends to infinity in N
ρ(e, x)
=1
(34)
lim
d∞ (e, x)
Note that d∞ is left-invariant for the N∞ Lie product, but not the original Lie
product on N .
Before going further, let us draw some simple consequences.
(1) In Theorem 6.2 we may replace d∞ (e, x) by d(e, x), where d is the left
invariant Carnot-Caratheodory metric on N (rather than N∞ ) defined by the
norm k*k0 (as opposed to d∞ which is ∗-left invariant). Hence ρ, d and d∞ are
asymptotic. This follows from the combination of Theorem 6.2 and Remark 2.1.
(2) Observe that the choice of m1 was arbitrary. Hence two Carnot-Carathéodory
metrics corresponding to two different choices of a supplementary subspace m1
with the same induced norm on n/[n, n], are asymptotically equivalent (i.e. their
ratio tends to 1), and in fact isometric (see Remark 2.1). Conversely, if two
Carnot-Carathéodory metrics are associated to the same supplementary subspace
m1 and are asymptotically equivalent, they must be equal. This shows that the
set of all possible norms on the quotient vector space n/[n, n] is in bijection with
the set of all classes of asymptotic equivalence of Carnot-Carathéodory metrics on
N∞ .
(3) As another consequence we see that if a locally bounded proper and asymptotically geodesic left-invariant pseudodistance on N is also homogeneous with
respect to the 1-parameter group (δt )t (i.e. ρ(e, δt x) = tρ(e, x)) then it has to be
of the form ρ(x, y) = d∞ (e, x−1 y) where d∞ is a Carnot-Carathéodory metric on
N∞ .
6.1. Volume asymptotics. Theorem 6.2 also yields a formula for the asymptotic
volume of ρ-balls of large radius. Let us fix a Haar measure on N (for example
Lebesgue measure on n gives rise to a Haar measure on N under exp). Since d∞
is homogeneous, it is straightforward to compute the volume of a d∞ -ball:
vol({x ∈ N, d∞ (e, x) ≤ t}) = td(N ) vol({x ∈ N, d∞ (e, x) ≤ 1})
P
where d(N ) = i≥1 dim(C i (n)) is the homogeneous dimension of N. For a pseudodistance ρ as in the statement of Theorem 6.2, we can define the asymptotic volume of ρ to be the volume of the unit ball for the associated Carnot-Carathéodory
metric d∞ .
AsV ol(ρ) = vol({x ∈ N, d∞ (e, x) ≤ 1})
Then we obtain as an immediate corollary of Theorem 6.2:
Corollary 6.3. Let ρ be periodic pseudodistance on N. Then
1
vol({x ∈ N, ρ(e, x) ≤ t}) = AsV ol(ρ) > 0
lim
t→+∞ td(N )
Finally, if Γ is an arbitrary finitely generated nilpotent group, we need to take
care of the torsion elements. They form a normal finite subgroup T and applying
Theorem 6.2 to Γ/T , we obtain:

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

33

Corollary 6.4. Let S be a finite symmetric generating set of Γ and S n the ball
of radius n is the word metric ρS associated to S, then
lim

n→+∞

1
nd(N )

#S n = #T *

AsV ol(ρS )
>0
vol(N/Γ)

where N is the Malcev closure of Γ = Γ/T , the torsion free quotient of Γ, and dS
is the word pseudodistance associated to S, the projection of S in Γ.
Moreover, it is possible to be a bit more precise about AsV ol(ρS ). In fact,
the norm k*k0 on m1 used to define the limit Carnot-Carathéodory distance d∞
associated to ρS is a simple polyhedral norm defined by
{kxk0 ≤ 1} = CvxHull (π1 (s), s ∈ S)
More generally the following holds. Let H be any closed, co-compact subgroup
of N. Choose a Haar measure on H so that volN (N/H) = 1. Theorem 6.2 yields:
Corollary 6.5. Let Ω be a compact symmetric (i.e. Ω = Ω−1 ) neighborhood of
the identity, which generates H. Let k*k0 be the norm on m1 whose unit ball is
CvxHull{π1 (Ω)} and let d∞ be the corresponding Carnot-Carathéodory metric on
N∞ . Then we have the following limit in the Hausdorff topology
lim δ 1 (Ωn ) = {g ∈ N, d∞ (e, g) ≤ 1}

n→+∞

n

and
volH (Ωn )
= volN ({g ∈ N, d∞ (e, g) ≤ 1})
n→+∞
nd(N )
lim

6.2. Outline of the proof. We first devise some standard lemmas about piecewise approximations of horizontal paths (Lemmas 6.6, 6.7, 6.10). Then it is shown
(Lemma 6.11) that the original product on N and the product in the associated
graded Lie group are asymptotic to each other, namely, if (δt )t is a 1-parameter
group of dilations of N, then after renormalization by δ 1 , the product of O(t)
t
elements lying in some bounded subset of N, is very close to the renormalized
product of the same elements in the graded Lie group N∞ . This is why all complications due to the fact that N may not be a priori graded and the δt 's may
not be automorphisms disappear when looking at the large scale geometry of the
group. Finally, we observe (Lemma 6.13), as follows from the very definition of
the unit ball E for the limit norm k*k0 , that any vector in the boundary of E,
can be approximated, after renormalizing by δ 1 by some element x ∈ N lying in
s
a fixed annulus s(1 − ε) ≤ ρ(e, x) ≤ s(1 + ε). This enables us to assert that any
ρ-quasi geodesic gives rise, after renormalization, to a d∞ -geodesic (this gives the
lower bound in Theorem 6.2). And vice-versa, that any d∞ -geodesic can be approximated uniformly by some renormalized ρ-quasi geodesic (this gives the upper
bound in Theorem 6.2).

34

EMMANUEL BREUILLARD

6.3. Preliminary lemmas.
Lemma 6.6. Let G be a Lie group and let k*ke be a Euclidean norm on the Lie
algebra of G and de (*, *) the associated left invariant Riemannian metric on G.
Let K be a compact subset of G. Then there is a constant C0 = C0 (de , K) > 0
such that whenever de (e, u) ≤ 1 and x, y ∈ K
|de (xu, yu) − de (x, y)| ≤ C0 de (x, y)de (e, u)
Proof. The proof reduces to the case when u and x−1 y are in a small neighborhood
of e. Then the inequality boils down to the following k[X, Y ]ke ≤ c kXke kY ke for
some c > 0 and every X, Y in Lie(G).

Lemma 6.7. Let G be a Lie group, let k*k be some norm on the Lie algebra of
G and let de (*, *) be a left invariant Riemannian metric on G. Then for every
L > 0 there is a constant C = C(de , k*k , L) > 0 with the following property.
Assume ξ1 , ξ2 : [0, 1] → G are two piecewise smooth paths in the Lie group G
with ξ1 (0) = ξ2 (0) = e. Let ξi′ ∈ Lie(G) be the tangent vector pulled back at the
identity by a left translation of G. Assume that supt∈[0,1] kξ1′ (t)k ≤ L, and that
R1 ′
′
0 kξ1 (t) − ξ2 (t)k dt ≤ ε. Then
de (ξ1 (1), ξ2 (1)) ≤ Cε

Proof. The function f (t) = de (ξ1 (t), ξ2 (t)) is piecewise smooth. For small dt we
may write, using Lemma 6.6
f (t + dt) − f (t) ≤ de (ξ1 (t)ξ1′ (t)dt, ξ1 (t)ξ2′ (t)dt) + de (ξ1 (t)ξ2′ (t)dt, ξ2 (t)ξ2′ (t)dt) − f (t) + o(dt)
≤ ξ1′ (t) − ξ2′ (t) e dt + C0 f (t) ξ2′ (t)dt e + o(dt)
≤ ε(t)dt + C0 Lf (t)dt + o(dt)
where ε(t) = kξ1′ (t) − ξ2′ (t)ke . In other words,
f ′ (t) ≤ ε(t) + C0 Lf (t)
R1
Since f (0) = 0, Gronwall's lemma implies that f (1) ≤ eC0 L 0 ε(s)e−C0 Ls ds ≤ Cε.

From now on, we will take G to be the stratified nilpotent Lie group N∞ , and
de (*, *) will denote a left invariant Riemannian metric on N∞ while d∞ (*, *) is a left
invariant Carnot-Caratheodory Finsler metric on N∞ associated to some norm k*k
on m1 .
1

r
Remark 6.8. There is c0 > 0 such that c−1
0 de (e, x) ≤ d∞ (e, x) ≤ c0 de (e, x) in a
neighborhood of e. Hence in the situation of the lemma we get d∞ (ξ1 (1), ξ2 (1)) ≤
1
C1 ε r for some other constant C1 = C1 (L, d∞ , de ).

Lemma 6.9. Let N ∈ N and dN (x, y) be the function in N∞ defined in the
following way:
Z 1
ξ ′ (u) du, ξ ∈ HP L(N ) , ξ(0) = x, ξ(1) = y}
dN (x, y) = inf{
0

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

35

where HP L(N ) is the set of horizontal paths ξ which are piecewise linear with at
most N possible values for ξ ′ . Then we have dN → d∞ uniformly on compact
subsets of N∞ .
Proof. Note that it follows from Chow's theorem (e.g. see [25] or [19]) that there
exists K0 ∈ N such that A := supd∞ (e,x)=1 dK0 (e, x) < ∞. Moreover, since piecewise linear paths are dense in L1 , it follows for example from Lemma 6.7 that for
each fixed x, dn (e, x) → d∞ (e, x). We need to show that dN (e, x) → d∞ (e, x) uniformly in x satisfying d∞ (e, x) = 1. By contradiction, suppose there is a sequence
(xn )n such that d∞ (e, xn ) = 1 and dn (e, xn ) ≥ 1 + ε0 for some ε0 > 0. We may
assume that (xn )n converges to say x. Let yn = x−1 ∗ xn and tn = d∞ (e, yn ). Then
dK0 (e, yn ) = tn dK0 (e, δ 1 (yn )) ≤ Atn . Thus dn (e, xn ) ≤ dn (e, x) + dn (e, yn ) ≤
tn

dn (e, x) + Atn as soon as n ≥ K0 . As n tends to ∞, we get a contradiction.



This lemma prompts the following notation. For ε > 0, we let Nε ∈ N be the
first integer such that 1 ≤ dNε (e, x) ≤ 1 + ε for all x with d∞ (e, x) = 1. Then we
have:
Lemma 6.10. For every x ∈ N∞ with d∞ (e, x) = 1, and all ε > 0 there exists a
path ξ : [0, 1] → N∞ in HP L(Nε ) with unit speed (i.e. kξ ′ k = 1) such that ξ(0) = e
and d∞ (x, ξ(1)) ≤ C2 ε and ξ ′ has at most one discontinuity on any subinterval of
[0, 1] of length εr /Nε .
Proof. We know that there is a path in HP L(Nε ) connecting e to x with length
l ≤ 1 + ε. Reparametrizing the path so that it has unit speed, we get a path
ξ0 : [0, l] → N∞ in HP L(Nε ) with d∞ (x, ξ0 (1)) = d∞ (ξ0 (l), ξ0 (1)) ≤ ε. The derivative ξ0′ is constant on at most Nε different intervals say [ui , ui+1 ). Let us remove
all such intervals of length ≤ εr /Nε by merging them to an adjacent interval
and let us change the value of ξ0′ on these intervals to the value on the adjacent interval (it doesn't matter if we choose the interval on the left or on the
right). We obtain a new path ξ : [0, 1] → N∞ in HP L(Nε ) with unit speed and
such that ξ ′ has at most one discontinuity on any subinterval of [0, 1] of length
R1
εr /Nε . Moreover 0 kξ ′ (t) − ξ0′ (t)k dt ≤ εr . By Lemma 6.7 and Remark 6.3, we
have d∞ (ξ(1), ξ0 (1)) ≤ C1 ε, hence
d∞ (ξ(1), x) ≤ d∞ (x, ξ0 (1)) + d∞ (ξ0 (1), ξ(1)) ≤ (C1 + 1)ε

Lemma 6.11 (Piecewise horizontal approximation of paths). Let x ∗ y denote the
product inside the stratified Lie group N∞ and x * y the ordinary product in N .
Let n ∈ N and t ≥ n. Then for any compact subset K of N , and any x1 , ..., xn
elements of K, we have
1
de (δ 1 (x1 * ... * xn ), δ 1 (x1 ∗ ... ∗ xn )) ≤ c1
t
t
t
and
1
de (δ 1 (x1 ∗ ... ∗ xn ), δ 1 (π1 (x1 ) ∗ ... ∗ π1 (xn ))) ≤ c2
t
t
t

36

EMMANUEL BREUILLARD

where c1 , c2 depend on K and de only.
Proof. Let k*k be a norm on the Lie algebra of N. For k = 1, ..., n let zk =
x1 * ... * xk−1 and yk = xk+1 ∗ ... ∗ xn . Since all xi 's belong to K, it follows from (24)
that as soon as t ≥ n, all δ 1 (zk ) and δ 1 (yk ) for k = 1, ..., n remain in a bounded set
t
t
depending only on K. Comparing (12) and (11), we see that whenever y = O(1)
and δ 1 (x) = O(1), we have
t

1
)
t2
On the other hand, from (12) it is easy to verify that right ∗-multiplication by a
bounded element is Lipschitz for k*k and the Lipschitz constant is locally bounded.
It follows that there is a constant C1 > 0 (depending only on K and k*k) such
that for all k ≤ n
δ 1 (xy) − δ 1 (x ∗ y) = O(

(35)

t

t

δ 1 ((zk * xk ) ∗ yk ) − δ 1 (zk ∗ xk ∗ yk ) ≤ C1 δ 1 (zk * xk ) − δ 1 (zk ∗ xk )
t

t

t

t

Applying n times the relation (35) with x = x1 * ... * xk−1 and y = xk , we finally
obtain
1
n
δ 1 (x1 * ... * xn ) − δ 1 (x1 ∗ ... ∗ xn ) = O( 2 ) = O( )
t
t
t
t
where O() depends only on K. On the other hand, using (11), it is another simple
verification to check that if x, y lie in a bounded set, then c12 de (x, y) ≤ kx − yk
≤ c2 de (x, y) for some constant c2 > 0. The first inequality follows.
For the second inequality, we apply Lemma 6.7 to the paths ξ1 and ξ2 starting
π1 (xk )
at e and with derivative equal on [ nk , k+1
for ξ2 .
n ) to nδ 1t (xk ) for ξ1 and to n
t
We get
1
de (δ 1 (x1 ∗ ... ∗ xn ), δ 1 (π1 (x1 ) ∗ ... ∗ π1 (xn )) = O( ).
t
t
t

Remark 6.12. From Remark 6.3 we see that if we replace de by d∞ in the above
1
lemma, we get the same result with 1t replaced by t− r .
Lemma 6.13 (Approximation in the abelianized group). Recall that k*k0 is the
norm on m1 defined in (33). For any ε > 0, there exists s0 > 0 such that for every
s > s0 and every v ∈ m1 such that kvk0 = 1, there exists h ∈ H such that
(1 − ε)s ≤ ρ(e, h) ≤ (1 + ε)s
and

π1 (h)
−v
ρ(e, h)

≤ε
0

Proof. Let ε > 0 be fixed. Considering a finite ε-net in E, we see that there exists
a finite symmetric subset {g1 , ..., gp } of H\{e} such that, if we consider the closed
convex hull of F = {fi = π1 (gi )/ρ(e, gi )|i = 1, ..., p} and k*kε the associated norm
on m1 , then k*k0 ≤ k*kε ≤ (1 + 2ε) k*k0 . Up to shrinking F if necessary, we may
assume that kfi kε = 1 for all i's. We may also assume that the fi 's generate m1 as

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

37

a vector space. The sphere {x, kxkε = 1} is a symmetric polyhedron in m1 and to
each of its facets corresponds d = dim(m1 ) vertices lying in F and forming a vector
basis of m1 . Let f1 , ..., fd , say, be such vertices for a given facet. If x ∈ m1 is of the
P
P
form x = di=1 λi fi with λi ≥ 0 for 1 ≤ i ≤ d then we see that kxkε = di=1 λi ,
because the convex hull of f1 , ..., fd is precisely that facet, hence lies on the sphere
{x, kxkε = 1}.
Now let v ∈ m1 , kvk0 = 1, and let s > 0. The half line tv, t > 0, hits the
sphere {x, kxkε = 1} in one point. This point belongs to some facet and there
are d linearly independent elements of F, say f1 , ..., fd , the vertices of that facet,
such that this point belongs to the convex hull of f1 , ..., fd . The point sv then lies
in the convex cone generated by π1 (g1 ), ..., π1 (gd ). Moreover, there is a constant
Cε > 0 (Cε ≤ d2 max1≤i≤p ρ(e, gi )) such that
sv −

d
X

ni π1 (gi )

i=1

≤ Cε
ε

for some non-negative integers n1 , ..., nd depending on s > 0. Hence
d

1X
ni ρ(e, gi ) =
s
i=1

d
1 X
ni π1 (gi )
s
i=1

ε

1
≤ (ksvkε + Cε )
s

Cε
≤ 1 + 2ε +
≤ 1 + 3ε
s
where the last inequality holds as soon as s > Cε /ε.
P
Now let h = g1n1 * ... * gdnd ∈ H. We have π1 (h) = di=1 ni π1 (gi )
ρ(e, h) ≥ kπ1 (h)k0 ≥ s − Cε ≥ s(1 − ε)

Moreover
ρ(e, h) ≤

d
X

ni ρ(e, gi ) ≤ s(1 + 3ε)

i=1

Changing ε into say 5ε and for say ε < 12 , we get the desired result with s0 (ε) =
d
ε max1≤i≤p ρ(e, gi ). 
6.4. Proof of Theorem 6.2. We need to show that as x → ∞ in N
ρ(e, x)
ρ(e, x)
≤ lim
≤1
1 ≤ lim
d∞ (e, x)
d∞ (e, x)
First note that it is enough to prove the bounds for x ∈ H. This follows from
(4.2) (1).
Let us begin with the lower bound. We fix ε > 0 and s = s(ε) as in the definition
of an asymptotically geodesic metric (see (21)). We know by 4.2 (3) and (4) that
as soon
x) ≥ s we may find x1 , ..., xn in H with s ≤ ρ(e, xi ) ≤ 2s such that
Q as ρ(e, P
x = xi and
ρ(e, xi ) ≤ (1 + ε)ρ(e, x). Let t = d∞ (e, x), then n ≤ 1+ε
s ρ(e, x),
C
hence n ≤ s(ε) t where C is a constant depending only on ρ (see (23)). We may

38

EMMANUEL BREUILLARD

then apply Lemma 6.11 (and the remark following it) to get, as t ≥ n as soon as
s(ε) ≥ C,
1

d∞ (δ 1 (x), δ 1 (π1 (x1 ) ∗ ... ∗ π1 (xn ))) ≤ c′1 t− r
t

t

But for each i we have kπ1 (xi )k0 ≤ ρ(e, xi ) by definition of the norm, hence
X
1
t = d∞ (e, x) ≤
kπ1 (xi )k0 + d∞ (x, π1 (x1 ) ∗ ... ∗ π1 (xn )) ≤ (1 + ε)ρ(e, x) + c′1 t1− r
Since ε was arbitrary, letting t → ∞ we obtain
lim

ρ(e, x)
≥1
d∞ (e, x)

We now turn to the upper bound. Let t = d∞ (e, x) and ε > 0. According to
Lemma 6.10, there is a horizontal piecewise linear path {ξ(u)}u∈[0,1] with unit
r
speed such that d∞ (δ 1 (x), ξ(1)) ≤ C2 ε and no interval of length ≥ Nε ε contains
t
more than one change of direction. Let s0 (ε) be given by Lemma 6.13 and assume
t > s0 (εr )Nε /εr . We split [0, 1] into n subintervals of length u1 , ..., un such that
ξ ′ is constant equal to yi on the i-th subinterval and s0 (εr ) ≤ tui ≤ 2s0 (εr ). We
have ξ(1) = u1 y1 ∗ ... ∗ un yn . Lemma 6.13 yields points xi ∈ H such that
yi −

π1 (xi )
≤ εr
tui

and ρ(e, xi ) ∈ [(1 − εr )tui , (1 + εr )tui ] (note that tui > s0 (εr )). Let ξ be the
piecewise linear path [0, 1] → N∞ with the same discontinuities as ξ and where the
value yi is replaced by π1tu(xi i ) . Then according to Lemma 6.7, d∞ (ξ(1), ξ(1)) ≤ Cε.
Since ρ(e, xi ) ≤ 4s0 (εr ) for each i, we may apply Lemma 6.11 (and the remark
following it) and see that if y = x1 * ... * xn ,
1

d∞ (ξ(1), δ 1 (y)) ≤ c′1 (ε)t− r
t

1

Hence d∞ (δ 1 (x), δ 1 (y)) ≤ (C2 +C)ε+c′1 (ε)t− r and ρ(e, y) ≤
t

t

P

ρ(e, xi ) ≤ (1+εr )t

while ρ(x, y) ≤ C ′ td∞ (e, δ 1 (x−1 y)) + C ′ ≤ t(Cd∞ (δ 1 (x), δ 1 (y)) + oε (1)). Hence
t

t

t

ρ(e, x) ≤ t + oε (t)

Remark 6.14. In the last argument we used the fact that δ 1 (xu) − δ 1 (x ∗ u) =
O(

1
1
tr

t

t

) if δ 1 (x) and δ 1 (u) are bounded, in order to get for y = xu,
t

t

d∞ (e, δ 1 (u)) ≤ d∞ (δ 1 (x), δ 1 (xu)) + d∞ (δ 1 (xu), δ 1 (x ∗ u))
t

t

t

≤ d∞ (δ 1 (x), δ 1 (y)) + o(1).
t

t

t

t

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

39

7. Locally compact G and proofs of the main results
In this section, we prove Theorem 1.2 and complete the proof of Theorem 1.4
and its corollaries. We begin with the latter.
Proof of Theorem 1.4. It is the combination of Proposition 5.1, which reduces the
problem to nilpotent Lie groups, and Theorem 6.2, which treats the nilpotent case.
It only remains to justify the last assertion that d∞ is invariant under T (H).
Since K = T (H) stabilizes m1 (see Lemma 3.12 for the definition of m1 ) and acts
by automorphisms of the nilpotent (nilshadow) structure (Lemma 3.5), given any
k ∈ K, the metric d∞ (k(x), k(y)) is nothing else but the left invariant subFinsler
metric on the nilshadow associated to the norm kk(v)k for v ∈ m1 (if k * k denotes
the norm associated to d∞ ).
However, d∞ is asymptotically invariant under K, because of Proposition 5.1.
Namely d∞ (e, k(x))/d∞ (e, x) tends to 1 as x tends to infinity. Finally d∞ (e, v) =
kvk and d∞ (e, k(v)) = kk(v)k for all v ∈ m1 . Two asymptotic norms on a vector
space are always equal. It follows that the norms k * k and kk(*)k on m1 coincide.
Hence d∞ (e, k(x)) = d∞ (e, k(x)) for all x ∈ S as claimed.

Proof of Corollary 1.8. First some initial remark (see also Remark 2.1). If d is
a left-invariant subFinlser metric on a simply connected nilpotent Lie group N
induced by a norm k * k on a supplementary subspace m1 of the commutator
subalgebra, then it follows from the very definition of subFinsler metrics (see
Paragraph 2.1) that π1 is 1-Lipschitz between the Lie group and the abelianization
of it endowed with the norm k*k, namely kπ1 (x)k ≤ d(e, x), with equality if x ∈ m1 .
From this and considering the definition of the limit norm in (33), we conclude
that k * k coincides with the limit norm of d. In particular Theorem 6.2 implies
that d is asymptotic to the ∗-left invariant subFinsler metric d∞ induced by the
same norm k * k on the graded Lie group (N∞ , ∗).
We can now prove Corollary 1.8. By the above remark, the limit metric d∞
on the graded nilshadow of S is asymptotic to the subFinsler metric d induced
by the same norm k * k on the same (K-invariant) supplementary subspace m1
of the commutator subalgebra of the nilshadow, and which is left invariant for
the nilshadow structure on S. However, it follows from Theorem 1.4 that d∞
and the norm k * k are K-invariant. This implies that d is also left-invariant
with respect to the original Lie group structure of S. Indeed, by (1), we can
write d(gx, gy) = d(g ∗ (T (g)x), g ∗ (T (g)y)) = d(T (g)x, T (g)y) = d(x, y), where ∗
denotes this time the nilshadow product structure. We are done.

Proof of Corollary 1.7. This follows immediately from Theorem 1.4, when ∗ denotes the graded nilshadow product. If ∗ denotes the nilshadow group structure,
then it follows from Theorem 6.2 and the remark we just made in the proof of
Corollary 1.8 (see also Remark 2.1).

7.1. Proof of Theorem 1.2. Let G be a locally compact group of polynomial
growth. We will show that G has a compact normal subgroup K such that G/K

40

EMMANUEL BREUILLARD

contains a closed co-compact subgroup, which can be realized as a closed cocompact subgroup of a connected and simply connected solvable Lie group of type
(R) (i.e. of polynomial growth). The proof will follow in several steps.
(a) First we show that up to moding out by a normal compact subgroup, we may
assume that G is a Lie group whose connected component of the identity has no
compact normal subgroup. Indeed, it follows from Losert's refinement of Gromov's
theorem ([24] Theorem 2) that there exists a normal compact subgroup K of G
such that G/K is a Lie group. So we may now assume that G is a Lie group (not
necessarily connected) of polynomial growth. The connected component G0 of G
is a connected Lie group of polynomial growth. Recall the following classical fact:
Lemma 7.1. Every connected Lie group has a unique maximal compact normal
subgroup. By uniqueness it must be a characteristic Lie subgroup.
Proof. Clearly if K1 and K2 are compact normal subgroups, then K1 K2 is again
a compact normal subgroup. Considering G/K, where K is a compact normal
subgroup of maximal dimension, we may assume that G has no compact normal
subgroup of positive dimension. But every finite normal subgroup of a connected
group is central. Hence the closed group generated by all finite normal subgroups is
contained in the center of G. The center is an abelian Lie subgroup, i.e. isomorphic
to a product of a vector space Rn , a torus Rm /Zm , a free abelian group Zk and a
finite abelian group. In such a group, there clearly is a unique maximal compact
subgroup (namely the product of the finite group and the torus). It is also normal,
and maximal in G.

The maximal compact normal subgroup of G0 is a characteristic Lie subgroup
of of G0 . It is therefore normal in G and we may mod out by it. We therefore have
shown that every locally compact (compactly generated) group with polynomial
growth admits a quotient by a compact normal subgroup, which is a Lie group G
whose connected component of the identity G0 has polynomial growth and contains no compact normal subgroup. We will now show that a certain co-compact
subgroup of G has the embedding property of Theorem 1.2.
(b) Second we show that, up to passing to a co-compact subgroup, we may
assume that the connected component G0 is solvable. For this purpose, let Q be
the solvable radical of G0 , namely the maximal connected normal Lie subgroup
of G0 . Note that it is a characteristic subgroup of G0 and therefore normal in G.
Moreover G0 /Q is a semisimple Lie group. Since G0 has polynomial growth, it
follows that G0 /Q must be compact. Consider the action of G by conjugation on
G0 /Q, namely the map φ : G → Aut(G0 /Q). Since G0 /Q is compact semisimple,
its group of automorphisms is also a compact Lie group. In particular, the kernel
ker φ is a co-compact subgroup of G.
The connected component of the identity of Aut(G0 /Q) is itself semisimple and
hence has finite center. However the image of the connected component (ker φ)0
of ker φ in G0 /Q modulo Q is central. Therefore it must be trivial. We have
shown that (ker φ)0 is contained in Q and hence is solvable. Moreover (ker φ)0

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

41

has no compact normal subgroup, because otherwise its maximal normal compact
subgroup, being characteristic in (ker φ)0 , would be normal in G (note that (ker φ)0
is normal in G).
Changing G into the co-compact subgroup ker φ, we can therefore assume that
G0 is solvable, of polynomial growth, and has no non trivial compact normal subgroup. The group G/G0 is discrete, finitely generated, and has polynomial growth.
By Gromov's theorem, it must be virtually nilpotent, in particular virtually polycyclic.
(c) We finally prove the following proposition.
Proposition 7.2. Let G be a Lie group such that its connected component of the
identity G0 is solvable, admits no compact normal subgroup, and with G/G0 virtually polycyclic. Then G has a closed co-compact subgroup, which can be embedded
as a closed co-compact subgroup of a connected and simply connected solvable Lie
group.
The proof of this proposition is mainly an application of a theorem of H.C.
Wang, which is a vast generalization of Malcev's embedding theorem for torsion
free finitely generated nilpotent groups. Wang's theorem [36] states that any Sgroup can be embedded as a closed co-compact subgroup of a simply connected real
linear solvable Lie group with only finitely many connected components. Wang
defines a S-group to be any real Lie group G, which admits a normal subgroup
A such that G/A is finitely generated abelian and A is a torsion-free nilpotent
Lie group whose connected components group is finitely generated. In particular
any S-group has a finite index (hence co-compact) subgroup which embeds as a
co-compact subgroup in a connected and simply connected solvable Lie group.
In order to prove Proposition 7.2, it therefore suffices to establish that G has a
co-compact S-group.
We first recall the following simple fact:
Lemma 7.3. Every closed subgroup F of a connected solvable Lie group S is
topologically finitely generated.
Proof. We argue by induction on the dimension of S. Clearly there is an epimorphism π : S → R. By induction hypothesis F ∩ ker π is topologically finitely
generated. The image of F is a subgroup of R. However every subgroup of R
contains either one or two elements, whose subgroup they generate has the same
closure as the original subgroup. We are done.

Next we show the existence of a nilradical.
Lemma 7.4. Let G be as in Proposition 7.2. Then G has a unique maximal
normal nilpotent subgroup GN .
Proof. The subgroup generated by any two normal nilpotent subgroups of any
given group is itself nilpotent (Fitting's lemma, see e.g. [30][5.2.8]). Let GN be
the closure of the subgroup generated by all nilpotent subgroups of G. We need
to show that GN is nilpotent. For this it is clearly enough to prove that it is

42

EMMANUEL BREUILLARD

topologically finitely generated (because any finitely generated subgroup of GN is
nilpotent by the remark we just made). Since G/G0 is virtually polycyclic, every
subgroup of it is finitely generated ([29][4.2]). Hence it is enough to prove that
GN ∩ G0 is topologically finitely generated. This follows from Lemma 7.3.

Incidently, we observe that the connected component of the identity (GN )0
coincides with the nilradical N of G0 (it is the maximal normal nilpotent connected
subgroup of G0 ).
We now claim the following:
Lemma 7.5. The quotient group G/GN is virtually abelian.
The proof of this lemma is inspired by the proof of the fact, due to Malcev,
that polycyclic groups have a finite index subgroup with nilpotent commutator
subgroup (e.g. see [30][ 15.1.6]).
Proof. We will show that G has a finite index normal subgroup whose commutator
subgroup is nilpotent. This clearly implies the lemma, for this nilpotent subgroup
will be normal, hence contained in GN .
First we observe that the group G admits a finite normal series Gm ≤ Gm−1 ≤
. . . ≤ G1 = G, where each Gi is a closed normal subgroup of G such that Gi /Gi+1
is either finite, or isomorphic to either Zn , Rn or Rn /Zn . This see it pick one of the
Gi 's to be the connected component G0 and then treat G/G0 and G0 separately.
The first follows from the definition of a polycyclic group (G/G0 has a normal
polycyclic subgroup of finite index). While for G0 , observe that its nilradical N is
a connected and simply connected nilpotent Lie group and it admits such a series
of characteristic subgroups (pick the central descending series), and G0 /N is an
abelian connected Lie group, hence isomorphic to the direct product of a torus
Rn /Zn and a vector group Rn . The torus part is characteristic in G0 /N , hence its
preimage in G0 is normal in G.
The group G acts by conjugation on each partial quotient Qi := Gi /Gi+1 . This
yields a map G → Aut(Qi ). Now note that in order to prove our lemma, it is
enough to show that for each i, there is a finite index subgroup of G whose commutator subgroup maps to a nilpotent subgroup of Aut(Qi ). Indeed, taking the
intersection of those finite index subgroup, we get a finite index normal subgroups
whose commutator subgroup acts nilpotently on each Qi , hence is itself nilpotent
(high enough commutators will all vanish).
Now Aut(Qi ) is either finite (if Qi is finite), or isomorphic to GLn (Z) (in case
Qi is either Zn or Rn /Zn ) or to GLn (R) (when Qi ≃ Rn ). The image of G in
Aut(Qi ) is a solvable subgroup. However, every solvable subgroup of GLn (R)
contains a finite index subgroup, whose commutator subgroup is unipotent (hence
nilpotent). This follows from Kolchin's theorem for example, that a connected
solvable algebraic subgroup of GLn (C) is triangularizable. We are done.

In the sequel we assume that G/G0 is torsion-free polycyclic. It is legitimate
to do so in the proof of Proposition 7.2, because every virtually polycyclic group
has a torsion-free polycyclic subgroup of finite index (see e.g. [29][Lemma 4.6]).
We now claim the following:

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

43

Lemma 7.6. GN is torsion-free.
Proof. Since G/G0 is torsion-free, it is enough to prove that GN ∩ G0 is torsionfree. However the set of torsion elements in GN forms a subgroup of GN (if x, y are
torsion, then xy is too because hx, yi is nilpotent). Clearly it is a characteristic
subgroup of GN . Hence its intersection with G0 is normal in G0 . Taking the
closure, we obtain a nilpotent closed normal subgroup T of G0 which contains a
dense set of torsion elements. Recall that G0 has no normal compact subgroup.
From this it quickly follows that T is trivial, because first it must be discrete (the
connected component T0 is compact and normal in G0 ), hence finitely generated
(by Lemma 7.3), hence made of torsion elements. But a finitely generated torsion
nilpotent group is finite. Again since G0 has no compact normal subgroup, T must
be trivial, and GN is torsion-free.

Now observe that the group of connected components of GN , namely GN /(GN )0
is finitely generated. Indeed, since G/G0 is finitely generated (as any polycyclic
group), it is enough to prove that (G0 ∩ GN )/(GN )0 is finitely generated, but this
follows from the fact that G0 ∩ GN is topologically finitely generated (Lemma 7.3).
Now we are almost done. Note that G is topologically finitely generated (Lemma
7.3), therefore so is G/GN . By Lemma 7.5 G/GN is virtually abelian, hence has
a finite index normal subgroup isomorphic to Zn × Rm . It follows that G/GN
has a co-compact subgroup isomorphic to a free abelian group Zn+m . Hence after
changing G by a co-compact subgroup, we get that G is an extension of GN (a
torsion-free nilpotent Lie group with finitely generated group of connected components) by a finitely generated free abelian group. Hence it is an S-group in the
terminology of Wang [36]. We apply Wang's theorem and this ends the proof of
Proposition 7.2.
(d) We can now conclude the proof of Theorem 1.2. By (a) and (b) G has
a quotient by a compact group which admits a co-compact subgroup satisfying
the assumptions of Proposition 7.2. Hence to conclude the proof it only remains
to verify that the simply connected solvable Lie group in which a co-compact
subgroup of G/K embeds has polynomial growth (i.e. is of type (R)). But this
follows from the following lemma (see [21][Thm. I.2]).
Lemma 7.7. Let G be a locally compact group. Then G has polynomial growth if
and only if some (resp. any) co-compact subgroup of it has polynomial growth.
Proof. First one checks that G is compactly generated if and only if some (resp.
any) co-compact subgroup is. This is by the same argument which shows that
finite index subgroups of a finitely generated group are finitely generated. In
particular, if Ω is a compact symmetric generating set of G and H is a co-compact
subgroup, then there is n0 ∈ N such that Ωn0 H = G. Then H ∩ Ω3n0 generates
H.
If G has polynomial growth and H is any compactly generated closed subgroup,
then H has polynomial growth. Indeed (see [21][Thm I.2]), if ΩH denotes a compact generating set for H, and K a compact neighborhood of the identity in G,

44

EMMANUEL BREUILLARD

then
volG (K)volH (ΩnH ) ≤ volH (KK −1 ∩ H)volG (ΩnH K).
This inequality
follows by integrating over a left Haar measure of G the function
R
φ(x) := Ωn 1K (h−1 x)dh, where dh is a left Haar measure on H. This integral
H
equals the left handside of the above displayed equation, while it is pointwise
bounded by volH (xK −1 ∩ H) inside HK and by zero outside HK.
In the other direction, if H has polynomial growth, then G also has, because
one can write Ωn ⊂ ΩnH K for some compact generating set ΩH of H and some
compact neighborhood K of the identity in G (see Proposition 4.4). Then the
result follows from the following inequality
−1
volH (ΩH )volG (ΩnH K) ≤ volH (Ωn+1
H )volG (ΩH K),

which itself is a direct consequence of the fact that the function
Z
1Ω−1 K (h−1 x)dh,
ψ(x) :=
Ωn+1
H

H

R
−1
where dh is a left Haar measure on H, satisfies G ψ(x)dx = volH (Ωn+1
H )volG (ΩH K)
n
on the one hand and is bounded below by volH (ΩH ) for every x ∈ ΩH K on the
other hand.

Note that the above proof would be slightly easier if we already knew that both
G and H were unimodular, in which case G/H has an invariant measure. But
we know this only a posteriori, because the polynomial growth condition implies
unimodularity ([21]).
Similar considerations show that G has polynomial growth if and only if G/K
has polynomial growth, given any normal compact subgroup K (e.g. see [21]).

We end this paragraph with a remark and an example, which we mentioned in
the Introduction.
Remark 7.8 (Discrete subgroups are virtually nilpotent). Suppose Γ is a discrete
subgroup of a connected solvable Lie group of type (R) (i.e. of polynomial growth).
Then Γ is virtually nilpotent. Indeed, a similar argument as in Lemma 7.3 shows
that every subgroup of Γ is finitely generated. It follows that Γ is polycyclic. However Wolf [37] proved that polycyclic groups with polynomial growth are virtually
nilpotent.
Example 7.9 (A group with no nilpotent co-compact subgroup). Let G be the
connected solvable Lie group G = R ⋉ (R2 × R2 ), where R acts as a dense oneparameter subgroup of SO(2, R) × SO(2, R). Then G is of type (R). It has no
compact subgroup. And it has no nilpotent co-compact subgroup. Indeed suppose H
is a closed co-compact nilpotent subgroup. Then it has a non-trivial center. Hence
there is a non identity element whose centralizer is co-compact in G. However a
simple examination of the possible centralizers of elements of G shows that none
of them is co-compact.

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

45

7.2. Proof of Corollary 1.6 and Theorem 1.1. Let G be an arbitrary locally
compact group of polynomial growth and ρ a periodic pseudodistance on G.
Claim 1: Corollary 1.6 holds for a co-compact subgroup H of G, if and only
if it holds for G. By Lemma 7.7, the groups G and H are unimodular, and hence
G/H bears a G-invariant Radon measure volG/H , which is finite since H is cocompact. Now let F be a bounded Borel fundamental domain for H inside G. And
let ρ be the periodic pseudodistance on G induced by the restriction of ρ to H, that
is ρ(x, y) := ρ(hx , hy ) where hx is the unique element of H such that x ∈ hx F. By
4.2 (1) and (4), ρ and ρ are at a bounded distance from each other. In particular,
Bρ (r − C) ⊂ Bρ (r) ⊂ Bρ (r + C). Hence if the limit (3) holds for ρ, it also holds for
ρ with the same limit. However, Bρ (r) = {x ∈ G, ρ(e, hx ) ≤ r} = BρH (r)F where
ρH is the restriction of ρ to H. Hence volG (Bρ (r)) = volH (BρH (r)) * volG/H (F ).
By 4.2 (4), ρH is a periodic pseudodistance on H. So the result holds for (H, ρH )
if and only if it holds for (G, ρ). Conversely, if ρ0 is a periodic pseudodistance
on H, then ρ0 (x, y) := ρ0 (hx , hy ) is a periodic pseudodistance on G, hence again
volG (Bρ0 (r)) = volH (Bρ0 (r)) * volG (F ) and the result will hold for (H, ρ0 ) if and
only if it holds for (G, ρ0 ).
Claim 2: If Corollary 1.6 holds for G/K, where K is some compact normal
subgroup, then it holds for G as well. Indeed, if ρ is a periodic pseudodistance on
G, then the K-average ρK , as defined in (26), is at a bounded distance from G
according to Lemma 4.7. Now ρK induces a periodic pseudodistance ρK on G/K
and BρK (r) = BρK (r)K. Hence, volG (BρK (r)) = volG/K (BρK (r)) * volK (K). And
if the limit (3) holds for ρK , it also holds for ρK , hence for ρ too.
Thus the discussion above combined with Theorem 1.2 reduces Corollary 1.6 to
the case when G is simply connected and solvable, which was treated in Section 5
and 6.

7.3. Proof of Proposition 1.3 and Corollary 1.9.
Proof of Proposition 1.3. We say that two metric spaces (X, dX ) and (Y, dY ) are
at a bounded distance if they are (1, C)-quasi-isometric for some finite C. This is
an equivalence relation. Now if ρ is H-periodic with H co-compact, then (G, ρ)
is at a bounded distance from (H, ρ|H). Hence we may assume that H = G, i.e.
that ρ is left invariant on G.
Now Theorem 1.2 gives the existence of a normal compact subgroup K, a cocompact subgroup H containing K and a simply connected solvable Lie group S
such that H/K is isomorphic to a co-compact subgroup of S.
Lemma 4.7 shows that (G, ρ) is at a bounded distance from (G, ρK ), where ρK
is defined as in (26). Now ρK induces a left invariant periodic metric on G/K,
and (G/K, ρK ) is clearly at a bounded distance from (G, ρK ). Now by 4.2, its
restriction to H/K is at a bounded distance and is left invariant. Now we set
ρS (s1 , s2 ) = ρK (h1 , h2 ), where (given a bounded fundamental domain F for the

46

EMMANUEL BREUILLARD

left action of H/K on S) hi is the unique element of H/K such that si ∈ hi F .
Clearly then (S, ρS ) is at a bounded distance from (H/K, ρK ). We are done. 
We note that our construction of S here depends on the stabilizer of ρ in G.
Certainly not every choice of Lie shadow can be used for all periodic metrics (think
that R3 is a Lie shadow of the universal cover of the group of motions of the plane).
Perhaps a single one can be chosen for all, but we have not checked that.
Proof of Corollary 1.9. Proposition 1.3 reduces the proof to a periodic metric ρ
on a simply connected solvable Lie group S. Let d∞ the subFinsler metric on S
(left invariant for the graded nilshadow group structure SN ) as given by Theorem
1.4. Let {δt }t is the group of dilations in the graded nilshadow SN of S as defined
in Section 3. By definition of the pointed Gromov-Hausdorff topology (see [18]),
it is enough to prove the
Claim. The following quantity
1
| ρ(s1 , s2 ) − d∞ (δ 1 (s1 ), δ 1 (s2 ))|
n
n
n
converges to zero as n tends to +∞ uniformly for all s1 , s2 in a ball of radius O(n)
for the metric ρ.
Now this follows in three steps. First ρ is at a bounded distance from its
restriction to the (co-compact) stabilizer H of ρ (cf. 4.2 (1), 4.2 (4)). Then
for h1 , h2 ∈ H, we can write ρ(h1 , h2 ) = ρ(e, h−1
1 h2 ). However Proposition 5.1
implies the existence of another periodic distance ρK on S, which is invariant
under left translations by elements of H for both the original Lie structure and
tends to 1 as x tends to
the nilshadow Lie structure on S, such that ρρ(e,x)
K (e,x)

∗−1
∞. Hence ρK (e, h−1
1 h2 ) = ρK (h1 , h2 ) = ρK (e, h1 h2 ), where ∗ is the nilshadow
∗−1
1
1
product on S. Hence | n ρ(h1 , h2 ) − n ρK (e, h1 h2 )| tends to zero uniformly as h1
and h2 vary in a ball of radius O(n) for ρ.
∗−1
1
Finally Theorem 6.2 implies that | n1 ρK (e, h∗−1
1 h2 ) − n d∞ (e, h1 h2 )| tends to
zero and the claim follows, as one verifies from the Campbell Hausdorff formula
by comparing (11) and (12) as we did in (35), that

|d∞ (δ 1 (h1 ), δ 1 (h2 )) − d∞ (e, δ 1 (h∗−1
1 h2 )|
n

n

n

converges to zero.
The fact that the graded nilpotent Lie group does not depend (up to isomorphism) on the periodic metric ρ but only on the locally compact group G follows from Pansu's theorem [28] that if two Carnot groups (i.e. a graded simply
connected nilpotent Lie group endowed with left-invariant subRiemannian metric
induced by a norm on a supplementary subspace to the commutator subalgebra)
are bi-Lipschitz, the underlying Lie groups must be isomorphic. This deep fact
relies on Pansu's generalized Rademacher theorem, see [28]. Indeed, two different periodic metrics ρ1 and ρ2 on G are quasi-isometric (see Proposition 4.4),
and hence their asymptotic cones are bi-Lipschitz (and bi-Lipschitz to any Carnot
group metric on the same graded group, by (13)).


ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

47

8. Coarsely geodesic distances and speed of convergence
Under no further assumption on the periodic pseudodistance ρ, the speed of
convergence in the volume asymptotics can be made arbitrarily small. This is
easily seen if we consider examples of the following type: define ρ(x, y) = |x − y| +
|x − y|α on R where α ∈ (0, 1). It is periodic and vol(Bρ (t)) = t − tα + o(tα ).
However, many natural examples of periodic metrics, such as word metrics or
Riemannian metrics, are in fact coarsely geodesic. A pseudodistance on G is said
to be coarsely geodesic, if there is a constant C > 0 such that any two points can
be connected by a C-coarse geodesic, that is, for any x, y ∈ G there is a map
g : [0, t] → G with t = ρ(x, y), g(0) = x and g(t) = y, such that
|ρ(g(u), g(v)) − |u − v|| ≤ C
for all u, v ∈ [0, t].
This is a stronger requirement than to say that ρ is asymptotically geodesic
(see 21). This notion is invariant under coarse isometry. In the case when G
is abelian, D. Burago [6] proved the beautiful fact that any coarsely geodesic
periodic metric on G is at a bounded distance from its asymptotic norm. In
particular volG (Bρ (t)) = c * td + O(td−1 ) in this case. In the remarkable paper [32],
M. Stoll proved that such an error term in O(td−1 ) holds for any finitely generated
2-step nilpotent group. Whether O(td−1 ) is the right error term for any finitely
generated nilpotent group remains an open question.
The example below shows on the contrary that in an arbitrary Lie group of
polynomial growth no universal error term can be expected.
Theorem 8.1. Let εn > 0 be an arbitrary sequence of positive numbers tending
to 0. Then there exists a group G of polynomial growth of degree 3 and a compact
generating set Ω in G and c > 0 such that
(36)

volG (Ωn )
≤ 1 − εn
c * n3

holds for infinitely many n, although

1
volG (Ωn )
c*n3

→ 1 as n → +∞.

The example we give below is a semi-direct product of Z by R2 and the metric
is a word metric. However, many similar examples can be constructed as soon as
the map T : G → K defined in Paragraph 5.1 in not onto. For example, one can
consider left invariant Riemannian metrics on G = R * (R2 × R2 ) where R acts
by via a dense one-parameter subgroup of the 2-torus S 1 × S 1 . Incidently, this
group G is known as the Mautner group and is an example of a wild group in
representation theory.
8.1. An example with arbitrarily small speed. In this paragraph we describe
the example of Theorem 8.1. Let Gα = Z * R2 where the action of Z is given by
the rotation Rα of angle πα, α ∈ [0, 1). The group Gα is quasi-isometric to R3
and hence of polynomial growth of order 3 and it is co-compact in the analogously
fα = R ⋉ R2 . Its nilshadow is isomorphic to R3 . The point is
defined Lie group G

48

EMMANUEL BREUILLARD

1.0

0.8

0.6

0.4
−2
0.2

−2

−1
−1

0.0
00
−0.2
1
2

1
−0.4
2

3
x_1

−0.6
3
−0.8

x_2

−1.0

Figure 2. The union of the two cones, with basis the disc of radius
2, represents the limit shape of the balls Ωn in the group Z ⋉ R2 ,
where Z acts by an irrational rotation, with generating set Ω =
{(±1, 0, 0)} ∪ {(0, x1 , x2 ), 41 x21 + x22 ≤ 1}.

that if α is a suitably chosen Liouville number, then the balls in Gα will not be
well approximated by the limit norm balls.
Elements of Gα are written (k, x) where k ∈ Z and x ∈ R2 . Let kxk2 = 41 x21 + x22
be a Euclidean norm on R2 , and let Ω be the symmetric compact generating set
given by {(±1, 0)} ∪ {(0, x), kxk ≤ 1}. It induces a word metric ρΩ on G. It follows
from Theorem 1.4 and the definition of the asymptotic norm that ρΩ (e, (k, x)) is
asymptotic to the norm on R3 given by ρ0 (e, (k, x)) := |k| + kxk0 where kxk0 is
the rotation invariant norm on R2 defined by kxk20 = 41 (x21 + x22 ). The unit ball of
k*k0 is the convex hull of the union of all images of the unit ball of k*k under all
rotations Rkα , k ∈ Z.
We are going to choose α as a suitable Liouville number so that (36) holds. Let
δn = (4εn )1/3 and choose α so that the following holds for infinitely many n's:
(37)

1
d(kα, Z + ) ≥ 2δn
2

for
P all nki ∈ Z, |k| ≤ n. This is easily seen to be possible if we choose α of the form
1/3 for some suitable lacunary increasing sequence of (ni )i .
Note that, since kxk0 ≥ kxk , we have ρΩ ≥ ρ0 . Let Sn be the piece of R2 defined
by Sn = {|θ| ≤ δn } where θ is the angle between the point x and the vertical axis

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

49

Re2 . We claim that if x ∈ Sn , ρ0 (e, (k, x)) ≤ n and n satisfies (37), then
δn2
) kxk0
4
It follows easily from the claim that volG (Ωn ) ≤ (1 − εn ) * volG (Bρ0 (n)). Moreover
volG (Bρ0 (n)) = c * n3 + O(n2 ), where c = 4π
3 if volG is given by the Lebesgue
measure.
Proof of claim. Here is the idea to prove the claim. To find a short path between
the identity and a point on the vertical axis, we have to rotate by a Rkα such that
kα is close to 21 , hence go up from (0, 0) to (k, 0) first, thus making the vertical
direction shorter. However if (37) holds, the vertical direction cannot be made as
short as it could after rotation by any of the Rkα with |k| ≤ n.
P
Note that if ρ0 (e, (k, x)) ≤ n then |k| ≤ n and ρΩ (e, (k, x)) ≥ |k|+infP kRki α xi k
where the infimum is taken over all paths x1 , ..., xN such that x =
xi and all
rotations Rki α with |ki | ≤ n. Note that if δn is small enough and (37) holds
then forPevery x ∈ Sn we have kRkα xk ≥ (1 + δn2 ) kxk0 . On the other hand
kxk0 = kxi k0 cos(θi ) where θi is the angle between xi and the x. Hence
X
X
X
kRki α xi k
kRki α xi k +
kRki α xi k ≥
ρΩ (e, (k, x)) ≥ |k| + (1 +

|θi |>δn

|θi |≤δn

≥ (1 + δn2 )

X

kxi k0 cos(θi ) +

|θi |≤δn

≥ (1 +

δn2
4

X
1
kxi k0 cos(θi )
cos(δn )
|θi |>δn

) * kxk0


8.2. Limit shape for more general word metrics on solvable Lie groups
of polynomial growth. The determination of the limit shape of the word metric
in Paragraph 8.1 was possible due to the rather simple nature of the generating
set. In general, using the identity (see (1))
(38)

ω1 * . . . * ωm = ω1 ∗ (T (ω1 )ω2 ) ∗ . . . ∗ (T (ωm−1 * . . . * ω1 )ωm )

it is easy to check that the unit ball of the limit norm k * k∞ inducing the limit
subFinsler metric d∞ on the nilshadow associated to a given word metric with
generating set Ω is contained in the K-orbit of the convex hull of the projection
of Ω to the abelianized nilshadow, namely the convex hull of K * π1 (Ω).
In the example of Paragraph 8.1, we even had equality between the two. However this is not the case in general. For example, the limit shape is always Kinvariant, but clearly the limit shape associated to a generating set Ω coincides
with the one associated with a conjugate gΩg−1 of it, while the convex hull of the
respective K-orbits may not be the same.
Of course if the generating set Ω is K-invariant to begin with, then Ωn = Ω∗n
and we are back in the nilpotent case, where we know that the unit ball of the
limit norm is just the convex hull of the projection of the generating set to the
abelianization. In general however it is a challenging problem to determine the

50

EMMANUEL BREUILLARD

precise asymptotic shape of a word metric on a general solvable Lie group with
polynomial growth, and there seems to be no simple description analogous to what
we have in the nilpotent case.
Even in the above example Gα = Z ⋉α R2 , or in the universal cover of the group
of motions of the plane (in which Gα embeds co-compactly), it is not that simple.
In general the shape is determined by solving an optimization problem in which
one has to find the path which maximizes the coordinates of the endpoint. In
order to illustrate this, we treat without proof the following simple example.
Suppose Ω is a symmetric compact neighborhood of the identity in Gα = Z⋉α R2
of the form Ω = (0, Ω0 ) ∪ (1, Ω1 ) ∪ (1, Ω1 )−1 , where Ω0 , Ω1 ⊂ R2 . Then the
limit shape of the word metric ρΩ associated to Ω is the solid body (rotationally
symmetric around the vertical axis as in Figure 2) made of two copies (upper and
lower) of a truncated cone with base a disc on (0, R2 ) of radius max{r0 , r1 } and
top (resp. bottom) a disc on the plane (1, R2 ) (resp. (−1, R2 )) of radius r2 , where
the radii are given by
r0 = max{kxk, x ∈ Ω0 }, r1 =

1
diam(Ω1 ),
2

where diam(Ω1 ) is the diameter of Ω1 and r2 is given by the integral
Z 2π
dθ
max{πθ (Ω1 )} ,
(39)
r2 =
2π
0
where πθ (Ω1 ) is the orthogonal projection on the x-axis of image of Ω1 ⊂ R2 by a
rotation of angle θ around the origin. It is indeed convex (note that r2 ≤ r1 ).
For example if Ω1 is made of only one point, then the limit shape is the same
as in the previous paragraph and as in Figure 2, namely two copies of a cone.
However if Ω1 is made of two points {a, b}, then the upper part of the limit shape
(which is the
will be a truncated cone with an upper disc of radius r2 = ka−bk
π
result of the computation of the above integral).
Let us briefly explain the formula (39). A path of length n reaching the highest
z-coordinate in Gα is a word of the form (1, ω1 ) * . . . * (1, ωn ), with ωi ∈ Ω1 . By
(38) this word equals
n
X
Rαi−1 ωi ).
(n,
1

Here ωi can take any value in Ω1 . In order to maximize the norm of the second
coordinate, or equivalently (by rotation invariance) its x-coordinate, one has to
choose ωi ∈ Ω1 at each stage in such a way that the x-coordinate of Rαi−1 ωi is
maximized. Formula (39) now follows from the fact that {Rαi−1 }1≤i≤n becomes
equidistributed in SO(2, R) as n tends to infinity.
In order to show that max{r0 , r1 } is the radius of the base disc and more
generally that the limit shape is no bigger than this double truncated cone, one
needs to argue further by considering
all possible paths of the form (ε1 , ω1 ) * . . . *
P
(εn , ωn ) where εi ∈ {0, ±1} and
εi is prescribed.

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

51

8.3. Bounded distance versus asymptotic metrics. In this paragraph we answer a question of D. Burago and G. Margulis (see [7]). Based on the abelian case
and the reductive case (Abels-Margulis [1]), Burago and Margulis had conjectured
that every two asymptotic word metrics should be at a bounded distance. We give
below a counterexample to this. We first give an example (A) of a nilpotent Lie
group endowed with two left invariant subFinsler metrics d∞ and d′∞ that are
asymptotic to each other, i.e. d∞ (e, x)/d′∞ (e, x) → 1 as x → ∞ but such that
|d∞ (e, x) − d′∞ (e, x)| is not uniformly bounded. Then we exhibit (B) a word metric that is not at a bounded distance from any homogeneous quasi-norm. Finally
these examples also yield (C) two word metrics ρ1 and ρ2 on the same finitely
generated nilpotent group which are asymptotic but not at a bounded distance.
Note that the group Gα with ρ0 and ρΩ from the last paragraph also provides
an example of asymptotic metrics which are not at a bounded distance (but this
group was not discrete).
(A) Let N = R × H3 (R) where H3 is classical Heisenberg group and Γ =
Z × H3 (Z) a lattice in N . In the Lie algebra n = RV ⊕ h3 we pick two different
supplementary subspaces of [n, n] = RZ, i.e. m1 = span{V, X, Y } and m′1 =
span{V + Z, X, Y }, where h3 is the Lie algebra of H3 (R) spanned by X, Y and
Z = [X, Y ]. We consider the L1 -norm on m1 (resp. m′1 ) corresponding to the basis
(V, X, Y ) (resp. (V + Z, X, Y )). Both norms induce the same norm on n/[n, n].
They give rise to left invariant Carnot-Caratheodory Finsler metrics on N , say
d∞ (resp. d′∞ ). We use the coordinates (v, x, y, z) = exp(vV + xX + yY + zZ).
According to Remark (2) after Theorem 6.2, d∞ and d′∞ are asymptotic. Let
us show that they are not at a bounded distance. First observe that, since V
is central, d∞ (e, (v; (x, y, z))) = |v| + dH3 (e, (x, y, z)) where dH3 is the CarnotCaratheodory Finsler metric on H3 (R) defined by the standard L1 -norm on the
span{X, Y }. Similarly d′∞ (e, (v; (x, y, z))) = |v| + dH3 (e, (x, y, z − v))). If d∞ and
d′∞ were at a bounded distance, we would have a C > 0 such that for all t > 0
|d∞ (e, (t; (0, 0, t))) − t| ≤ C
Hence |dH3 (e, (0, 0, t))| ≤ C, which is a contradiction.
(B) Now let Ω = {(1; (0, 0, 1))±1 , (1; (0, 0, −1))±1 , (0; (1, 0, 0))±1 , (0; (0, 1, 0))±1 }
be a generating set for Γ and ρΩ the word metric associated to it. Let | * | be
a homogeneous quasi-norm on N which is at a bounded distance from ρΩ , i.e.
|ρΩ (e, g) − |g|| is bounded. Then | * | is asymptotic to ρΩ , hence is equal to the
Carnot-Caratheodory Finsler metric d asymptotic to ρΩ and homogeneous with
respect to the same one parameter group of dilations {δt }t>0 . Let m1 = {v ∈ n,
δt (v) = tv}. Then d is induced by some norm k*k0 on m1 , whose unit ball is
given, according to Theorem 1.4 by the convex hull of the projections to m1 of the
generators in Ω. There is a unique vector in m1 of the form V + z0 Z. Its k*k0 -norm
is 1 and d(e, (1; (0, 0, z0 ))) = 1. However d(e, (v; (x, y, z))) = |v| + dH3 (e, (x, y, z −
vz0 )). Since ρΩ (e, (n; (0, 0, n))) = n, we get
d(e, (n; (0, 0, n))) − ρΩ (e, (n; (0, 0, n))) = dH3 (e, (0, 0, n(1 − z0 )))

52

EMMANUEL BREUILLARD

If this is bounded, this forces z0 = 1. But we can repeat the same argument with
(n; (0, 0, −n)) which would force z0 = −1. A contradiction.
(C) Let now Ω2 := {(1; (0, 0, 0))±1 , (0; (1, 0, 0))±1 , (0; (0, 1, 0))±1 } and ρΩ2 the
associated word metric on Γ. Then again ρΩ and ρΩ2 are asymptotic by Theorem
6.2 because the convex hull of their projection modulo the z-coordinate coincide.
However ρΩ2 is a product metric, namely we have ρΩ2 (e, (v; (x, y, z))) = |v| +
ρ(e, (x, y, z)), where ρ is the word metric on the discrete Heisenberg group H3 (Z)
with standard generators {(1, 0, 0)±1 , (0, 1, 0)±1 }. In particular
ρΩ (e, (n; (0, 0, n))) − ρΩ2 (e, (n; (0, 0, n))) = ρ(e, (0, 0, n))
which is unbounded.
Remark 8.2 (An abnormal geodesic). We refer the reader to [9] for more on
these examples. In particular we show there that ρ1 and ρ2 above are not (1, C)quasi-isometric for any C > 0. The key phenomenon behind this example is
the presence of an abnormal geodesic (see [25]), namely the one-parameter group
{(t; (0, 0, 0))}t .
Remark 8.3 (Speed of convergence in the nilpotent case). The slow speed phenomenon in Theorem 8.1 relied crucially on the presence of a non-trivial semisimple part in Gα ; this doesn't occur in nilpotent groups. In [9], we show that for
word metrics on finitely generated nilpotent groups, the convergence in Theorem
2
6.2 has a polynomial speed with an error term at least as good as O(d∞ (e, x)− 3r ),
where r is the nilpotency class. We conjecture there that the optimal exponent is 21 .
This involves refining quantitatively the estimates of the above proof of Theorem
6.2.
9. Appendix: the Heisenberg groups
Here we show how to compute the asymptotic shape of balls in the Heisenberg
groups H3 (Z) and H5 (Z) and their volume, thus giving another approach to the
main result of Stoll [33]. The leading term for the growth of H3 (Z) is rational
for all generating sets (Prop. 9.1 below), whereas in H5 (Z) with its standard
generating set, it is transcendental. This explains how our Figure 1 was made
(compare with the odd [22] Fig. 1).
9.1. 3-dim Heisenberg group. Let us first consider the Heisenberg group
H3 (Z) = ha, b|[a, [a, b]] = [b, [a, b]] = 1i .
We see it as the lattice generated by a = exp(X) and b = exp(Y ) in the real
Heisenberg group H3 (R) with Lie algebra h3 generated by X, Y and spanned by
X, Y, Z = [X, Y ]. Let ρΩ be the standard word metric on H3 (Z) associated to
the generating set Ω = {a±1 , b±1 }. According to Theorem 1.4, the limit shape of
the n-ball Ωn in H3 (Z) coincides with the unit ball C3 = {g ∈ H3 (R), d∞ (e, g) ≤
1} for the Carnot-Caratheodory metric d∞ induced on H3 (R) by the l1 -norm
kxX + yY k0 = |x| + |y| on m1 = span{X, Y } ⊂ h3 .

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

53

Computing this unit ball is a rather simple task. Exchanging the roles of X
and Y , we see that C3 is invariant under the reflection z 7→ −z. Then clearly C3 is
of the form {xX + yY + zZ, with |x| + |y| ≤ 1 and |z| ≤ z(x, y)}. Changing X to
−X and Y to −Y, we get the symmetries z(x, y) = z(−x, y) = z(x, −y) = z(y, x).
Hence when determining z(x, y), we may assume 0 ≤ y ≤ x ≤ 1, x + y ≤ 1.
The following well known observation is crucial for computing z(x, y). If ξ(t) is a
horizontal path in H3 (R) starting from id, then ξ(t) = exp(x(t)X +y(t)Y +z(t)Z),
where ξ ′ (t) = x(t)X + y(t)Y and z(t) is the "balayage" area of the between the
path {x(s)X + y(s)Y }0≤s≤t and the chord joining 0 to x(t)X + y(t)Y.
Therefore, z(x, y) is given by the solution to the "Dido isoperimetric problem"
(see [25]): find a path in the X, Y -plane between 0 and xX + yY of k*k0 -length 1
that maximizes the "balayage area". Since k*k0 is the l1 -norm in the X, Y -plane,
as is well-known (see [8]), such extremal curves are given by arcs of square with
sides parallel to the X, Y -axes. There is therefore a dichotomy: the arc of square
has either 3 or 4 sides (it may have 1 or 2 sides, but these are included are limiting
cases of the previous ones).
If there are 3 sides, they have length l, x and y + l with y + l ≤ x. Hence
1 = l + x + y + l and z(x, y) = lx + 21 xy. Therefore this occurs when y ≤ 3x − 1
.
and we then have z(x, y) = x(1−x)
2
If there are 4 sides, they have length l, x + u, y + l and u, with l + y = x + u.
Hence 1 = 2l + 2u + x + y and z(x, y) = (l + y)(x + u) − xy
2 . This occurs when
2

y ≥ 3x − 1 and we then have z(x, y) = (1+x+y)
−
16
Hence if 0 ≤ y ≤ x ≤ 1 and x + y ≤ 1

(40)

z(x, y) = 1y≤3x−1

xy
2 .

x(1 − x)
(1 + x + y)2 xy
+ 1y>3x−1
−
2
16
2

The unit ball C3 drawn in Figure 1 is the solid body C3 = {xX + yY + zZ, with
|x| + |y| ≤ 1 and |z| ≤ z(x, y)}.
31
in the Lebesgue measure dxdydz.
A simple calculation shows that vol(C3 ) = 72
Since H3 (Z) is easily seen to have co-volume 1 for this Haar measure on H3 (R)
(actually {xX +yY +zZ, x ∈ [0, 1), y ∈ [0, 1), z ∈ [0, 1)} is a fundamental domain),
it follows that
31
#(Ωn )
= vol(C3 ) =
n→∞
n4
72
lim

We thus recover a well-known result (see [4], [31] where even the full growth series
is computed and shown to be rational).
One can also determine exactly which points of the sphere ∂C3 are joined to id
by a unique geodesic horizontal path. The reader will easily check that uniqueness
fails exactly at the points (x, y, ±z(x, y)) with |x| < 31 and y = 0, or |y| < 31 and
x = 0, or else at the points (x, y, z) with |x| + |y| = 1 and |z| < z(x, y).
The above method also yields the following result.

54

EMMANUEL BREUILLARD

Proposition 9.1. Let Ω be any symmetric generating set for H3 (Z). Then the
leading coefficient in #(Ωn ) is rational, i.e.
#(Ωn )
=r
n→∞
n4
lim

is a rational number.
Proof. We only sketch the proof here. We can apply the method above and compute r as the volume of the unit CC-ball C(Ω) of the limit CC-metric d∞ defined in Theorem 1.4. Since we know what is the norm k*k in the (x, y)-plane
m1 = span hX, Y i that generates d∞ (it is the polygonal norm given by the convex hull of the points of Ω), we can compute C(Ω) explicitly. We need to know
the solution to Dido's isoperimetric problem for k*k in m1 , and as is well known
(see [8]) it is given by polygonal lines from the dual polygon rotated by 90◦ . Since
the polygon defining k*k is made of rational lines (points in Ω have integer coordinates), any vector with rational coordinates has rational k*k-length, and the dual
polygon is also rational. The equations defining z(x, y) will therefore have only
rational coefficients, and z(x, y) will be piecewisely given by a rational quadratic
form in x and y, where the pieces are rational triangles in the (x, y)-plane. The
total volume of C(Ω) will therefore be rational. 
9.2. 5-dim Heisenberg group. The Heisenberg group H5 (Z) is the group generated by a1 , b1 , a2 , b2 ,c with relations c = [a1 , b1 ] = [a2 , b2 ], a1 and b1 commute with
±1
a2 and b2 and c is central. Let Ω = {a±1
i , bi , i = 1, 2}. Let us describe the limit
n
shape of Ω . Again, we see H5 (Z) as a lattice of co-volume 1 in the group H5 (R)
with Lie algebra h5 spanned by X1 , Y1 X2 , Y2 and Z = [Xi , Yi ]. By Theorem 1.4,
the limit shape is the unit ball C5 for the Carnot-Caratheodory metric on H5 (R)
induced by the l1 -norm kx1 X1 + y1 Y1 + x2 X2 + y2 Y2 k0 = |x1 | + |y1 | + |x2 | + |y2 |.
Since X1 , Y1 commute with X2 , Y2 , in any piecewise linear horizontal path in
H5 (R), we can swap the pieces tangent to X1 or Y1 with those tangent to X2 or
Y2 without changing the end point of the path. Therefore if ξ(t) = exp(x1 (t)X1 +
y1 (t)Y1 + x2 (t)X2 + y2 (t)Y2 + z(t)Z) is a horizontal path, then z(t) = z1 (t) +
z2 (t), where zi (t), i = 1, 2, is the "balayage area" of the plane curve {xi (s)Xi +
yi (s)Yi }0≤s≤t .
Since, just like for H3 (Z), we know the curve maximizing this area, we can
compute the unit ball C5 explicitly. In exponential coordinates it will take the
form C5 = {exp(x1 X1 + y1 Y1 + x2 X2 + y2 Y2 + zZ), |x1 | + |y1 | + |x2 | + |y2 | ≤ 1 and
|z| ≤ z(x1 , y1 , x2 , y2 )}. Then z(x1 , y1 , x2 , y2 ) = sup0≤t≤1 {zt (x1 , y1 ) + z1−t (x2 , y2 )},
where zt (x, y) is the maximum "balayage area" of a path of length t between 0
and xX + yY. It is easy to see that zt (x, y) = t2 z(x/t, y/t) where z is given by (40).
Hence zt is a piecewise quadratic function of t. Again z(x1 , y1 , x2 , y2 ) is invariant
under changing the signs of the xi ,yi 's, and swapping x and y, or else swapping
1 and 2. We may thus assume that the xi ,yi 's lie in D = {0 ≤ yi ≤ xi ≤ 1 and
x1 +y1 +x2 +y2 ≤ 1, and x2 −y2 ≥ x1 −y1 }. We may therefore determine explicitly
the supremum z(x1 , y1 , x2 , y2 ), which after some straightforward calculations takes

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

55

on D the following form:
z(x1 , y1 , x2 , y2 ) = 1A max{d1 , d2 } + 1B max{d1 , c1 } + 1C max{c1 , c2 }
1
1 y1
(1 + x1 + y1 − x2 − y2 )2 + x2 y2 −x
,
where d1 = x12y1 + x22 (1 − x1 − y1 − x2 ), c1 = 16
2
and d2 and c2 are obtained from d1 and c1 by swapping the indices 1 and 2. The
sets A, B and C form the following partition of D : A = D ∩ {m ≤ x1 − y1 },
B = D ∩ {x1 − y1 < m < x2 − y2 } and C = D ∩ {x2 − y2 ≤ m}, where m =
(1 − x1 − x2 − y1 − y2 )/2.
Since C5 has such an explicit form, it is possible to compute its volume. The fact
that z(x1 , y1 , x2 , y2 ) is piecewisely given by the maximum of two quadratic forms
makes the computation of the integral somewhat cumbersome but tractable. Our
equations coincide (fortunately!) with those of Stoll (appendix of [33]), where he
computed the main term of the asymptotics of #(Ωn ) by a different method. Stoll
did calculate that integral and obtained

log(2)
2009
#(Ωn )
+
= vol(C5 ) =
6
n→∞
n
21870
32805
which is transcendental. It is also easy to see by this method that if we change
±1 ±1 ±1
the generating set to Ω0 = {a±1
1 b1 a2 b2 }, then we get a rational volume. Hence
the rationality of the growth series of H5 (Z) depends on the choice of generating
set, which is Stoll's theorem.
One advantage of our method is that it can also apply to fancier generating
sets. The case of Heisenberg groups of higher dimension with the standard generating set is analogous: the function z({xi }, {yi }) is again piecewisely defined as
the maximum
Pof finitely many explicit quadratic forms on a linear partition of the
l1 -unit ball
|xi | + |yi | ≤ 1.
lim

Acknowledgments. I would like to thank Amos Nevo for his hospitality at the
Technion of Haifa in December 2005, where part of this work was conducted, and
for triggering my interest in this problem by showing me the possible implications
of Theorem 1.1 to Ergodic Theory. My thanks are also due to V. Losert for
pointing out an inaccuracy in my first proof of Theorem 1.2 and for his other
remarks on the manuscript. Finally I thank Y. de Cornulier, M. Duchin, E. Le
Donne, Y. Guivarc'h, A. Mohammadi, P. Pansu and R. Tessera for several useful
conversations.
References
[1] H. Abels and G. Margulis. Coarsely geodesic metrics on reductive groups. In Modern dynamical systems and applications, pages 163–183. Cambridge Univ. Press, Cambridge, 2004.
[2] L. Auslander and L. W. Green, G-induced flows, Amer. J. Math. 88 (1966), 43–60.
[3] H. Bass, The degree of polynomial growth of finitely generated nilpotent groups, Proc. London
Math. Soc. (3) 25 (1972), 603–614.
[4] M. Benson, On the rational growth of virtually nilpotent groups, In: S.M. Gersten, Stallings
(eds), Combinatorial Group Theory and Topology, Ann. Math. Studies, vol 111, PUP (1987).
[5] V. N. Berestovskiı̆. Homogeneous manifolds with an intrinsic metric I, Sibirsk. Mat. Zh.,
29(6):17–29, 1988.

56

EMMANUEL BREUILLARD

[6] D. Yu. Burago, Periodic metrics, in Representation Theory and Dynamical Systems, 205–
210, Adv. Soviet Math. 9 Amer. Math. Soc. (1992).
[7] D. Yu. Burago, G.A. Margulis, Problem Session, in Oberwolfach Report, Geometric Group
Theory, Hyperbolic Dynamics and Symplectic Geometry, 2006.
[8] H. Busemann, The isoperimetric problem in the Minkowski plane, AJM 69 (1947), 863–871.
[9] E. Breuillard and E. Le Donne, On the rate of convergence to the asymptotic cone for
nilpotent groups and subFinsler geometry, preprint 2012.
[10] A. Calderon, A general ergodic theorem, Annals of Math. 57 (1953), pp. 182-191.
[11] T. H. Colding and W. P. Minicozzi, II. Liouville theorems for harmonic sections and applications. Comm. Pure Appl. Math., 51(2):113–138, 1998.
[12] L. Corwin and F. P. Greenleaf, Representations of nilpotent Lie groups and their applications,
Part I, Basic theory and examples, Cambridge Univ. Press, (1990) 269pp.
[13] N. Dungey, A. F. M ter Elst, and D. W. Robinson, Analysis on Lie groups with polynomial
growth, Progress in Math. 214, Birkhauser, (2003) 312pp.
[14] W. R. Emerson, The pointwise ergodic theorem for amenable groups, Amer. J. Math 96
(1974), 472–487.
[15] J. W. Jenkins, A characterization of growth in locally compact groups, Bull. Amer. Math.
Soc. 79 (1973), 103–106.
[16] F. P. Greenleaf, Invariant means on topological groups and their applications, Van Nostrand
Mathematical Studies, no 16 (1969) 113pp.
[17] M. Gromov, Groups of polynomial growth and expanding maps, Publications Mathématiques
de l'IHES, no 53 (1981), 53-73.
[18] M. Gromov. Metric structures for Riemannian and non-Riemannian spaces, volume 152 of
Progress in Mathematics. Birkhäuser Boston Inc., Boston, MA, 1999. Based on the 1981
French original, With appendices by M. Katz, P. Pansu and S. Semmes.
[19] M. Gromov, Carnot-Carathéodory spaces seen from within, in Sub-Riemannian Geometry,
edited by A. Bellaiche and J-J. Risler, 79-323, Birkauser (1996).
[20] M. Gromov, Asymptotic invariants of infinite groups, in Geometric group theory, Vol. 2
(Sussex, 1991), 1–295, London Math. Soc. Lecture Note Ser., 182, CUP (1993).
[21] Y. Guivarc'h, Croissance polynômiale et périodes des fonctions harmoniques, Bull. Sc. Math.
France 101, (1973), p. 353-379.
[22] R. Karidi, Geometry of balls in nilpotent Lie groups, Duke Math. J. 74 (1994), no. 2, 301–317.
[23] S. A. Krat. Asymptotic properties of the Heisenberg group. Zap. Nauchn. Sem. S.-Peterburg.
Otdel. Mat. Inst. Steklov. (POMI), 261(Geom. i Topol. 4):125–154, 268, 1999.
[24] V. Losert, On the structure of groups with polynomial growth, Math. Z. 195 (1987), no 1,
109–117.
[25] R. Montgomery, A tour of sub-riemannian geometry, AMS book 2002.
[26] A. Nevo, Pointwise ergodic theorems for actions of connected Lie groups, Handbook of Dynamical Systems, Eds. B. Hasselblatt and A. Katok, to appear.
[27] P. Pansu, Croissance des boules et des géodésiques fermées dans les nilvariétés, Ergodic
Theory Dynam. Systems 3 (1983), no. 3, 415–445.
[28] P. Pansu, Mtriques de Carnot-Carathodory et quasiisomtries des espaces symtriques de rang
un, Ann. of Math. (2) 129 (1989), no. 1, 160.
[29] M. S. Raghunathan, Discrete subgroups of Lie groups, Springer Verlag (1972).
[30] D. Robinson, A course in the theory of groups, Springer-Verlag.
[31] M. Shapiro, A geometric approach to almost convexity and growth of some nilpotent groups,
Math. Ann, 285, 601-624 (1989).
[32] M. Stoll, On the asymptotic of the growth of 2-step nilpotent groups, J. London Math. Soc
(2) 58 (1998), no 1, 38–48.
[33] M. Stoll, Rational and transcendental growth series for higher Heisenberg groups, Invent.
math. 126, 85-109 (1996).
[34] A. Tempelman, Ergodic theorems for group actions, Mathematics and its applications, 78,
Kluwer Academic publishers (1992).

ASYMPTOTIC SHAPE OF BALLS IN GROUPS WITH POLYNOMIAL GROWTH

57

[35] R. Tessera, Volumes of spheres in doubling measures metric spaces and groups of polynomial
growth, Bull. Soc. Math. France, 135(1):47–64, 2007.
[36] H.C. Wang, Discrete subgroups of solvable Lie groups, Annals of Math, (1956), 64, 1-19.
[37] J. Wolf, Growth of finitely generated solvable groups and curvature of Riemanniann manifolds, J. Differential Geometry, 2 (1968) p. 421–446.
E-mail address: emmanuel.breuillard@math.u-psud.fr
Université Paris-Sud 11, Laboratoire de Mathématiques, 91405 Orsay, France

