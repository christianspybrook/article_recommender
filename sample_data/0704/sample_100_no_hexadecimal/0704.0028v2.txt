arXiv:0704.0028v2 [math.CA] 26 Feb 2008

Pfaffians, hafnians and produ ts of real linear
fun tionals
∗

Péter E. Frenkel

Alfréd Rényi Institute of Mathemati s
Hungarian A ademy of S ien es
P.O.B. 127, 1364 Budapest, Hungary

frenkelprenyi.hu

Abstra t
We prove pfaffian and hafnian versions of Lieb's inequalities on determinants and permanents of positive semi-definite matri es. We use the
hafnian inequality to improve the lower bound of Révész and Sarantopoulos on the norm of a produ t of linear fun tionals on a real Eu lidean
spa e (this subje t is sometimes alled the `real linear polarization onstant' problem).
Mathemati s Subje t Classifi ation: 46C05, 15A15
Keywords: polarization onstant, real Eu lidean spa e, hafnian, pfaffian, positive semi-definite matrix

-1. Introdu tion
The ontents of this paper are as follows. In Se tion 0, we sket h one part of
the histori ba kground: lassi al inequalities on determinants and permanents
of positive semi-definite matri es. In Se tion 1, we prove pfaffian and hafnian
versions of these inequalities, and we formulate Conje ture 1.5, another hafnian
inequality. In Se tion 2, we apply the hafnian inequality of Theorem 1.4 to
our main goal: improving the lower bound of Révész and Sarantopoulos on the
norm of a produ t of linear fun tionals on a real Eu lidean spa e (this subje t
is sometimes alled the `real linear polarization onstant' problem, its history is
sket hed at the end of the paper). This is a hieved in Theorem 2.3. We point
out that Conje ture 1.5 would be suffi ient to ompletely settle the real linear
polarization onstant problem.
∗ Partially supported by OTKA grants T 046365, K 61116 and NK 72523.

1

0. Old inequalities on determinants and permanents
Re all that the determinant and the permanent of an n × n matrix A = (ai,j )
are defined by
det A =

X

π∈Sn

(−1)π

n
Y

ai,π(i) ,

per A =

n
X Y

ai,π(i) ,

π∈Sn i=1

i=1

where Sn is the symmetri group on n elements. Throughout this se tion, we
assume that A is a positive semi-definite Hermitian n × n matrix (we write
A ≥ 0). For su h A, Hadamard proved that
det A ≤

n
Y

ai,i ,

i=1

with equality if and only if A has a zero row or is a diagonal matrix. Fis her
generalized this to
det A ≤ det A′ * det A′′
for

A=

A′
B∗



B
A′′



(1)

≥ 0,

with equality if and only if det A′ * det A′′ * B = 0.
Con erning the permanent of a positive semi-definite matrix, Mar us [Mar1,
Mar2℄ proved that
n
Y
ai,i ,
per A ≥
(2)
i=1

with equality if and only if A has a zero row or is a diagonal matrix. Lieb [L℄
generalized this to
per A ≥ per A′ * per A′′
(3)

for A as in (1), with equality if and only if A has a zero row or B = 0. Moreover,
he proved that in the polynomial P (λ) of degree n′ (=size of A′ ) defined by
′

P (λ) = per

 ′
λA
B∗

B
A′′



=

n
X

ct λt ,

t=0

all oeffi ients ct are real and non-negative. This is indeed a stronger theorem
sin e it implies
′

per A = P (1) =

n
X
t=0

ct ≥ cn′ = per A′ * per A′′ .

fiokovi¢ [D, Mi℄ gave a simple proof of Lieb's inequalities, and showed also that if
A′ and A′′ are positive definite then cn′ −t = 0 if and only if all subpermanents of
2

B of order t vanish. Lieb [L℄ also states an analogous (and analogously provable)
theorem for determinants: for A as in (1), let
′

 ′
λA
D(λ) = det
B∗

B
A′′



=

n
X

dt λt .

t=0

If det A′ * det A′′ = 0, then D(λ) = 0. If A′ and A′′ are positive definite, then
(−1)t dn′ −t is positive for t ≤ rk B and is zero for t > rk B .
Remark. In all of Lieb's inequalities mentioned above, the ondition that
the matrix A is positive semi-definite an be repla ed by the weaker ondition
that the diagonal blo ks A′ and A′′ are positive semi-definite. The proof goes
through virtually un hanged. Alternatively, this stronger form of the inequalities an be easily dedu ed from the seemingly weaker form above.

1 New inequalities on pfaffians and hafnians
For an n × n matrix A = (ai,j ) and subsets S , T of N := {1, . . . , n}, we write
AS,T := (ai,j )i∈S,j∈T . If |T | = 2t is even, we write
(−1)T := (−1)t+

P

j∈T

j

.

1.1 Pfaffians
As far as the appli ations in Se tion 2 are on erned, this subse tion may be
skipped.
Re all that the pfaffian of a 2n × 2n antisymmetri matrix C = (ci,j ) is
defined by
pf C =

X
1
(−1)π cπ(1),π(2) * * * cπ(2n−1),π(2n) .
n!2n
π∈S2n

2

We have (pf C) = det C .
For antisymmetri A and symmetri B , both of size n × n, we onsider the
polynomial

 ⌊n/2⌋
X
−λA B
⌊n/2⌋
(−1)
pf
=
pt λt .
−B A
t=0

Let A and B be real n × n matri es with A antisymmetri and B
symmetri . If B is positive semi-definite, then pt ≥ 0 for all t. If B is positive
definite, then pt > 0 for t ≤ (rk A)/2 and pt = 0 for t > (rk A)/2.
Theorem 1.1

Proof. If B = (bi,j ) is positive semi-definite, then there exist ve tors x1 , . . . , xn

in a real Eu lidean spa e V su h that (xi , xj ) = bi,j . Re all that in the exterior

3

V
tensor algebra V a positive definite inner produ t (and the orresponding
Eu lidean norm) is defined by
^
^ 
vi ,
wj := det((vi , wj )).

We have

pt =

X

X

(−1)S (−1)T pf AS,S * pf AT,T * det BN \S,N \T =

|S|=2t |T |=2t

=

X

X

|S|=2t |T |=2t



(−1)S pf AS,S *
=

^

i6∈S

xi , (−1)T pf AT,T *

X

(−1)S pf AS,S *

|S|=2t

^

j6∈T

^



xj  =
2

xi

≥ 0.

i6∈S

Assume that B is positive definite.
Then the ve tors xi are linearly independent.
V
It follows that the tensors i6∈S xi are also linearly independent as S runs over
the subsets of N . Thus pt = 0 if and only if pf AS,S = 0 for all |S| = 2t, i.e., if
and only if 2t > rk A.


Let A and B be real n × n matri es with A antisymmetri and
B symmetri . Let λ ≥ 0. If B is positive semi-definite, then


−λA B
⌊n/2⌋
(−1)
pf
≥ det B.
−B A
Theorem 1.2

If B is positive definite, then equality o urs if and only if λA = 0.
Proof. The left hand side is
p0 + p1 λ + * * * + p⌊n/2⌋ λ⌊n/2⌋ .

The right hand side is p0 .



I am grateful to the anonymous referee of this paper for the idea of the
following alternative proof of Theorems 1.1 and 1.2. We may assume B > 0,
sin e every positive semi-definite matrix is a limit of positive definite ones.
The matrix B −1/2 AB −1/2 being real and antisymmetri , there exists a unitary
that D := U −1√B −1/2 AB −1/2 U is diagonal with purely imaginary
matrix U su h √
eigenvalues a1 −1, . . . , an −1. The real multiset {a1 , . . . , an } is invariant
under a ↔ −a. We have
√


 √

X
2
−λA B
−λ BU DU −1 B √
B √
pt λt = det
= det
=
−B A
−B
BU DU −1 B


  −1 √
√
−λD 1
U
BU √ 0
B
0√
=
= det
−1 D
BU
0
0
U −1 B


√
n
n
Y
√ 4 Y
−λai −1
√1
= det B *
det
(1 + a2i λ).
= det B 2 *
−1
ai −1
i=1

i=1

4

Extra ting square roots, and hoosing the sign in a ordan e with p0 = + det B ,
we get


X
Y
−λA B
pt λt = (−1)⌊n/2⌋ pf
= det B *
(1 + a2i λ),
−B A
ai >0

when e both theorems immediately follow, sin e det B > 0.

1.2 Hafnians
Re all that the hafnian of a 2n × 2n symmetri matrix C = (ci,j ) is defined by
X
1
haf C =
cπ(1),π(2) * * * cπ(2n−1),π(2n) .
n
n!2
π∈S2n

For symmetri A and B , both of size n × n, we onsider the polynomial

 ⌊n/2⌋
X
λA B
haf
=
ht λt .
B A
t=0

Let A and B be symmetri real n × n matri es. If B is positive
semi-definite, then ht ≥ 0 for all t. If B is positive definite, then ht = 0 if and
only if all 2t × 2t subhafnians of A vanish.
Theorem 1.3

Proof. If B = (bi,j ) is positive semi-definite, then there exist ve tors x1 , . . . , xn

in a real Eu lidean spa e V su h that (xi , xj ) = bi,j . Re all [Mar1, Mar2, MN,
Mi℄ that in the symmetri tensor algebra SV a positive definite inner produ t
(and the orresponding Eu lidean norm) is defined by
Y Y 
vi ,
wj := per ((vi , wj )).
We have

ht =

X

X

|S|=2t |T |=2t

haf AS,S * haf AT,T * per BN \S,N \T =
2

=

X

|S|=2t

haf AS,S *

Y

i6∈S

xi

≥ 0.

Assume that B is positive definite.
Then the ve tors xi are linearly independent.
Q
It follows that the tensors i6∈S xi are also linearly independent as S runs over
the subsets of N . Thus ht = 0 if and only if haf AS,S = 0 for all |S| = 2t.


Let A and B be symmetri real n × n matri es. Let λ ≥ 0. If B
is positive semi-definite, then
Theorem 1.4



λA B
haf
≥ per B.
B A

If B is positive definite, then equality o urs if and only if A is a diagonal matrix
or λ = 0.
5

Proof. The left hand side is
h0 + h1 λ + * * * + h⌊n/2⌋ λ⌊n/2⌋ .

The right hand side is h0 .



Setting A = B and λ = 1, and ombining with Mar us's inequality (2), we
arrive at ase p = 1 of

If A = (ai,j ) is a positive semi-definite symmetri real n × n
matrix, then the hafnian
Q of the 2pn × 2pn matrix onsisting of 2p × 2p blo ks A
is at least (2p − 1)!!n api,i , with equality if and only if A has a zero row or is
a diagonal matrix.

Conje ture 1.5

2 Produ ts of real linear fun tionals

In this se tion, we apply Theorem 1.4 to produ ts of jointly normal random
variables and then to produ ts of real linear fun tionals, whi h was the main
motivation for this work. The ideas in this se tion are analogous to those that
Arias-de-Reyna [A℄ used in the omplex ase.
Let ξ1 , . . . , ξd denote independent random variables with standard Gaussian
distribution,
i.e., with joint density fun tion (2π)−d/2 exp(−|ξ|2 /2), where |ξ|2 =
P 2
ξk . We write Ef (ξ) for the expe tation of a fun tion f = f (ξ) = f (ξ1 , . . . , ξd ).
Re all that
Eξk2p = (2p − 1)!! = (2p − 1)(2p − 3) * * * 3 * 1
for k = 1, . . . , d (easy indu tive proof via integration by parts), and thus
E

d
Y

ξk2pk =

k=1

d
Y

(2pk − 1)!!.

k=1

On Rd , we write (*, *) for the standard Eu lidean inner produ t. We re all
the well-known [B2, G, S, Z℄
Wi k formula.

((xi , xj )). Then

Let x1 , . . . , xn be ve tors in Rd with Gram matrix A =
E

n
Y

(xi , ξ) = haf A.

(4)

i=1

(For odd n, we define haf A = 0.)

Proof. Both sides are multilinear in the xi , so we may assume that ea h xi is

an element of the standard orthonormal basis e1 , . . . , ed . If there is an ek that
o urs an odd number of times among the xi , then
Qdboth sides are zero. If ea h
ek o urs 2pk times, then the left hand side is E k=1 ξk2pk , and the right hand
Q
side is dk=1 (2pk − 1)!!, whi h are equal.

6

The following theorems are easy orollaries of Theorem 1.4 together with
the Wi k formula (4) and Mar us's theorem (2).

If X1 , . . . , Xn are jointly normal random variables with zero
expe tation, then

2
2
2
2

Theorem 2.1

E X1 * * * Xn ≥ EX1 * * * EXn .

Equality holds if and only if they are independent or at least one of them is
almost surely zero.

Proof. The variables an be written as Xi = (xi , ξ) with ξ of standard normal
distribution and the xi onstant ve tors with a positive semi-definite Gram
matrix A = (ai,j ) = ((xi , xj )). Then
E

n
Y

Xi2 = E

n
Y
(xi , ξ)2 =

i=1

i=1



n
Y
A A
ai,i =
= haf
≥ per A ≥
A A
=

n
Y

E(xi , ξ)2 =

i=1
n
Y

EXi2 ,

i=1

i=1

with equality if and only if A is a diagonal matrix or has a zero row, i.e., the xi
are pairwise orthogonal or at least one of them is zero.

The generalization of Theorem 2.1 to an arbitrary even exponent 2p is equivalent to Conje ture 1.5.
Q
d
Theorem 2.2 For any x1 , . . . , xn ∈ R , |xi | = 1, the average of
(xi , ξ)2 on
d
the unit sphere {ξ ∈ R : |ξ| = 1} is at least
(d − 2)!!
1
Γ(d/2)
=
=
,
2n Γ(d/2 + n)
(d + 2n − 2)!!
d(d + 2)(d + 4) . . . (d + 2n − 2)

with equality if and only if the ve tors xi are pairwise orthogonal.

Proof. The average on the unit sphere is the onstant in the theorem times

the expe tation w.r.t. the standard Gaussian measure (see e.g. [B1℄). By Theorem 2.1, the latter expe tation is minimal if and only if the xi are pairwise
orthogonal, in whi h ase it is 1.

Theorem 2.3

For real linear fun tionals fi on a real Eu lidean spa e,
||f1 || * * * ||fn ||
.
||f1 * * * fn || ≥ p
n(n + 2)(n + 4) * * * (3n − 2)

Here || * || means supremum of the absolute value on the unit sphere. In the
infinite-dimensional ase, fun tionals with infinite norm may be allowed. Then
the onvention 0 * ∞ = 0 should be used on the right hand side.
7

Proof. We may assume that the spa e is Rd with d ≤ n, and the fun tionals are
2
given by fiQ
(ξ) = (xi , ξ)
i || = |xi | = 1. Then ||f1 * * * fn || is at least the
Q with ||f
2
2
average of fi (ξ) = (xi , ξ) on the unit sphere, whi h by Theorem 2.2 and
d ≤ n is at least 1/(n(n + 2)(n + 4) * * * (3n − 2)).


It is an unsolved problem, raised by Benítez, Sarantopoulos and Tonge [BST℄
(1998), whether Theorem 2.3 is true with nn under the square root sign in the
denominator on the right hand side. This is alled the `real linear polarization
onstant' problem. In the omplex ase, the affirmative answer was proved by
Arias-de-Reyna [A℄ in 1998, based on the omplex analog of the Wi k formula
[A, B2, G℄ and on Lieb's inequality (3).1 Keith Ball [Ball℄ gave another proof
of the affirmative answer in the omplex ase by solving the omplex plank
problem.
In the real ase, the affirmative answer for n ≤ 5 was proved by Pappas and
Révész [PR℄ in 2004. For general n, the best estimate known before the present
paper was that of Révész and Sarantopoulos [RS℄ (2004), based on results of
[MST℄, with (2n)n /4 under the square root sign. See [Mat1, Mat2, MM, R℄ for
a ounts on this and related questions. Note that
n(n + 2)(n + 4) * * * (3n − 2) =
= exp (log n + log(n + 2) + log(n + 4) + * * * + log(3n − 2)) <

 Z 3n
1
log u * du =
< exp
2 n

= exp [u(log u − 1)]3n
n /2 = exp((3n log 3n − 3n − n log n + n)/2) =
√ !n
n(2 log n + 3 log 3 − 2)
3 3
= exp
=
n ,
2
e
√
and 3 3/e < 3 * 1.8/2.7 = 2, so Theorem 2.3 is an improvement. Note also that
the statement with nn under the square root sign would follow from Conje ture 1.5.

A knowledgements
I am grateful to Péter Major, Máté Matol si and Szilárd Révész for helpful
dis ussions, and to the anonymous referee for useful omments.

Referen es
[A℄ J. Arias-de-Reyna, Gaussian variables, polynomials and permanents, Lin.
Alg. Appl. 285 (1998), 107114.
1 The referee of the present paper alled my attention to the fa t that Arias-de-Reyna used
only the spe ial ase of (3) where the matrix A′ is of rank 1. This is mu h simpler than (3) in
general, it an be proved essentially by the argument Mar us used in [Mar1, Mar2℄ to prove
the even more spe ial ase n′ = 1, whi h still implies inequality (2).

8

[Ball℄ K. M. Ball, The omplex plank problem, Bull. London. Math. So . 33
(2001), 433442.
[B1℄ A. Barvinok, Estimating L∞ norms by L2k norms for fun tions on orbits,
Found. Comput. Math. 2 (2002), 393412.
[B2℄ A. Barvinok, Integration and optimization of multivariate polynomials by
restri tion onto a random subspa e, arXiv preprint: math.OC/0502298
[BST℄ C. Benítez, Y. Sarantopoulos, A. Tonge, Lower bounds for norms of
produ ts of polynomials, Math. Pro . Camb. Phil. So . 124 (1998), 395408.
[D℄ D. . fiokovi¢, Simple proof of a theorem on permanents, Glasgow Math. J.
10 (1969), 5254.
[G℄ L. Gurvits, Classi al omplexity and quantum entanglement, J. Comput.
System S i. 69 (2004), no. 3, 448484.
[L℄ E. H. Lieb, Proofs of some onje tures on permanents, J. Math. Me h. 16
(1966), 127134.
[Mar1℄ M. Mar us, The permanent analogue of the Hadamard determinant theorem, Bull. Amer. Math. So . 69 (1963), 494496.
[Mar2℄ M. Mar us, The Hadamard theorem for permanents, Pro . Amer. Math.
So . 15 (1964), 967973.
[MN℄ M. Mar us, M. Newman, The permanent fun tion as an inner produ t,
Bull. Amer. Math. So . 67 (1961), 223224.
[Mat1℄ M. Matol si, A geometri estimate on the norm of produ t of fun tionals,
Lin. Alg. Appl. 405 (2005), 304310.
[Mat2℄ M. Matol si, The linear polarization onstant of Rn , A ta Math. Hungar.
108 (2005), no. 1-2, 129136.
[MM℄ M. Matol si, G. A. Muñoz, On the real linear polarization onstant problem, Math. Inequal. Appl. 9 (2006), no. 3, 485494.
[Mi℄ H. Min , Permanents, En y lopedia of Mathemati s and its Appli ations,
Addison-Wesley, 1978
[MST℄ G. A. Muñoz, Y. Sarantopoulos, A. Tonge, Complexifi ations of real
Bana h spa es, polynomials and multilinear maps, Studia Math. 134 (1999),
no. 1, 133.

9

[PR℄ A. Pappas, Sz. Révész, Linear polarization onstants..., J. Math. Anal.
Appl. 300 (2004), 129146.
[R℄ Sz. Gy. Révész, Inequalities for multivariate polynomials, Annals of the
Marie Curie Fellowships 4 (2006), http://www.marie urie.org/annals/, arXiv
preprint: math.CA/0703387
[RS℄ Sz. Gy. Révész, Y. Sarantopoulos, Plank problems, polarization and Chebyshev onstants, J. Korean Math. So . 41 (2004) 157174.
[S℄ B. Simon, The P(φ)2 Eu lidean (Quantum) Field Theory, Prin eton Series
in Physi s, Prin eton University Press, 1974
[Z℄ A. Zvonkin, Matrix integrals and map enumeration: an a esible introdu tion, Combinatori s and physi s (Marseille, 1995), Math. Comput. Modelling
26 (1997), 281304.

10

