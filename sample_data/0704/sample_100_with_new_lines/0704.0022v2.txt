stochastic lie group integrators
arxiv07040022v2 mathna 16 oct 2007
simon ja malham and anke wiese
abstract we present lie group integrators for nonlinear stochastic differential equations with
noncommutative vector fields whose solution evolves on a smooth finite dimensional manifold given
a lie group action that generates transport along the manifold we pull back the stochastic flow on
the manifold to the lie group via the action and subsequently pull back the flow to the corresponding
lie algebra via the exponential map we construct an approximation to the stochastic flow in the
lie algebra via closed operations and then push back to the lie group and then to the manifold
thus ensuring our approximation lies in the manifold we call such schemes stochastic munthekaas
methods after their deterministic counterparts we also present stochastic lie group integration
schemes based on castellgaines methods these involve using an underlying ordinary differential
integrator to approximate the flow generated by a truncated stochastic exponential lie series they
become stochastic lie group integrator schemes if we use munthekaas methods as the underlying
ordinary differential integrator further we show that some castellgaines methods are uniformly
more accurate than the corresponding stochastic taylor schemes lastly we demonstrate our methods
by simulating the dynamics of a free rigid body such as a satellite and an autonomous underwater
vehicle both perturbed by two independent multiplicative stochastic noise processes
key words stochastic lie group integrators stochastic differential equations on manifolds
ams subject classifications 60h10 60h35 93e20
1 introduction we are interested in designing lie group numerical schemes
for the strong approximation of nonlinear stratonovich stochastic differential equations of the form
yt  y0 
d z
vi y    dwi 
here w 1      w d are d independent scalar wiener processes and wt0  t we suppose
that the solution y evolves on a smooth ndimensional submanifold m of rn with
n  n and vi  m  r 
ptn m i  0 1     d are smooth vector fields which in
local coordinates are vi  j1 vij yj  the flowmap t  m  m of the integral
equation 11 is defined as the map taking the initial data y0 to the solution yt at
time t ie yt  t  y0 
our goal in this paper is to show how the lie group integration methods developed
by munthekaas and coauthors can be extended to stochastic differential equations
on smooth manifolds see crouch and grossman 8 and munthekaas 40 suppose
we know that the exact solution of a given system of stochastic differential equations
evolves on a smooth manifold m see malliavin 36 or emery 14 but we can only
find the solution pathwise numerically how can we ensure that our approximate
numerical solution also lies in the manifold
suppose we are given a finite dimensional lie group g and lie group action y0
that generates transport across the manifold m from the starting point y0  m via
elements of g then with any given elements  in the lie algebra g corresponding to
the lie group g we can associate the infinitesimal action  using the lie group action
y0  the map  7  is a lie algebra homomorphism from g to xm the lie algebra
 maxwell institute for mathematical sciences and school of mathematical and computer sciences
heriotwatt university edinburgh eh14 4as uk sjmalhammahwacuk awiesehwacuk
16102007
malham and wiese
of vector fields over the manifold m further the lie subalgebra   xm    g
is isomorphic to a finite dimensional lie algebra with the same structure constants
see olver 42 p 56
conversely suppose we know that the lie algebra generated by the set of governing vector fields vi  i  0 1     d on m is finite dimensional call this xf m then
we know there exists a finite dimensional lie group g whose lie algebra g has the
same structure constants as xf m relative to some basis and there is a lie group
action y0 such that vi  i  i  0 1     d for some i  g see olver 42 p 56 or
kunita 30 p 194 the choice of group and action is not unique
in this paper we assume that there is a finite dimensional lie group g and action
y0 such that our set of governing vector fields vi  i  0 1     d are each infinitesimal
lie group actions generated by some element in g via y0  ie vi  i for some i  g
i  0 1     d they are said to be fundamental vector fields this means that we can
write down the set of governing vector fields xi for a system of stochastic differential
equations on the lie group g that via the lie group action y0  generates the flow
governed by the set of vector fields vi on the manifold the vector fields vi on m are
simply the push forward of the vector fields xi on g via the lie group action y0 
typically the flow on the lie group also needs to be computed numerically we thus
want the approximation to remain in the lie group so that the lie group action takes
us back to the manifold
to achieve this we pull back the set of governing vector fields xi on g to the set
of governing vector fields vi on g via the exponential map exp from g to g thus
the stochastic flow generated on g by the vector fields vi generates the stochastic flow
on g generated by the xi  the set of governing vector fields on g are for each   g
vi   
ad k  i 
where bk is the kth bernoulli number and the adjoint operator ad is a closed operator
on g in fact ad      the lie bracket on g now the essential point is that
i  g and so the series on the right or any truncation of it is closed in g hence
if we construct an approximation to our stochastic differential equation on g using
the vector fields vi or an approximation of them achieved by truncating the series
representation then that approximation must reside in the lie algebra g we can then
push the approximation in the lie algebra forward onto the lie group and then onto
the manifold provided we compute the exponential map and action appropriately our
approximate solution lies in the manifold to within machine accuracy in summary
for a given   g and any y0  m we have the following commutative diagram
exp
g  xg 0 xm
exp
we have implicitly separated the governing set of vector fields vi  i  0 1     d
from the driving path process w  w 1      w d  together they generate the unique
solution process y  m to the stochastic differential equation 11 when there
is only one driving wiener process d  1 the it map w 7 y is continuous in
the topology of uniform convergence when there are two or more driving processes
stochastic lie group integrators
d  2 the universal limit theorem tells us that the it map w 7 y is continuous
in the pvariation topology in particular for 2  p  3 see lyons 32 lyons and
qian 33 and malliavin 36 a wiener path with d  2 has finite pvariation for
p  2 this means that from a pathwise perspective approximations to y constructed
using successively refined approximations to w are only guaranteed to converge to
the correct solution y if we include information about the lvy chordal areas of
the driving path process note however that the l2 norm of the 2variation of a
wiener process is finite in the lie group integration procedure prescribed above we
must solve a stochastic differential system on the lie algebra g defined by the set
of governing vector fields vi and the driving path process w  w 1      w d  in
light of the universal limit theorem and with stepsize adaptivity in mind in future
see gaines and lyons 20 we for instance use in our examples order 1 stochastic
numerical methodsthat include the lvy chordal areato solve for the flow on the
lie algebra g
we have thus explained the idea behind munthekaas methods and how they can
be generalized to the stochastic setting the first half of this paper formalizes this
procedure
in the second half of this paper we consider autonomous vector fields and construct stochastic lie group integration schemes using castellgaines methods this
approach proceeds as follows we truncate the stochastic exponential lie series expansion corresponding to the flow t of the solution process y to the stochastic differential
equation 11 we then approximate the driving path process w  w 1      w d  by
replacing it by a suitable nearby piecewise smooth path in the appropriate variation
topology an approximation to the solution yt requires the exponentiation of the
approximate truncated exponential lie series this can be achieved by solving the
system of ordinary differential equations driven by the vector field that is the approximate truncated exponential lie series if we use ordinary munthekaas methods as
the underlying ordinary differential integrator the castellgaines method becomes a
stochastic lie group integrator
further based on the castellgaines approach we then present uniformly accurate
exponential lie series integrators that are globally more accurate than their stochastic
taylor counterpart schemes these are investigated in detail in lord malham and
wiese 31 for linear stochastic differential equations they require the assumption
that a sufficiently accurate underlying ordinary differential integrator is used that
integrator could for example be an ordinary lie group munthekaas method in
the case of two driving wiener processes we derive the order 12 and in the case
of one driving wiener process the order 1 uniformly accurate exponential lie series
integrators as a consequence we confirm the asymptotic efficiency properties for
both these schemes proved by castell and gaines 8 see newton 41 for more details
on the concept of asymptotic efficiency we also present in the case of one driving
wiener process a new order 32 uniformly accurate exponential lie series integrator
also see lord malham and wiese 31
we present two physical applications that demonstrate the advantage of using
stochastic munthekaas methods first we consider a free rigid body which for example could model the dynamics of a satellite we suppose that it is perturbed by
two independent multiplicative stochastic noise processes the governing vector fields
are noncommutative and the corresponding exact stochastic flow evolves on the unit
sphere we show that the stochastic munthekaas method with an order 1 stochastic
taylor integrator used to progress along the corresponding lie algebra preserves the
malham and wiese
approximate solution in the unit sphere manifold to within machine error however
when an order 1 stochastic taylor integrator is used directly the solution leaves the
unit sphere the contrast between these two methods is more emphatically demonstrated in our second application here we consider an autonomous underwater vehicle
that is also perturbed by two independent multiplicative stochastic noise processes
the exact stochastic flow evolves on the manifold which is the dual of the euclidean
lie algebra se3 two independent casimirs are conserved by the exact flow again
the stochastic munthekass method preserves the casimirs to within machine error
however the order 1 stochastic taylor integrator is not only unstable for large stepsizes but the approximation drifts off the manifold and makes a dramatic excursion
off to infinity in the embedding space r6 
preserving the approximate flow on the manifold of the exact dynamics may be a
required property for physical or financial systems driven by smooth or rough paths
for general references see iserles munthekaas nrsett and zanna 25 hairer lubich
and wanner 22 elworthy 13 lyons and qian 33 and milstein and tretyakov 38
stochastic lie group integrators in the form of magnus integrators for linear stochastic
differential equations were investigated by burrage and burrage 5 they were also
used in the guise of mbius schemes see schiff and shnider 43 to solve stochastic
riccati equations by lord malham and wiese 31 where they outperformed direct
stochastic taylor methods further applications where they might be applied include
backward stochastic riccati equations arising in optimal stochastic linearquadratic
control kohlmann and tang 28 jump diffusion processes on matrix lie groups
for bayesian inference srivastava miller and grenander 44 fractional brownian
motions on lie groups baudoin and coutin 3 and stochastic dynamics triggered
by dna damage chickarmane ray sauro and nadim 10
our paper is outlined as follows in section 2 we present the basic geometric setup
sans stochasticity in particular we present a generalized right translation vector field
on a lie group that forms the basis of our subsequent transformation from the lie
group to the manifold using a lie group action this vector field pushes forward
to an infinitesimal lie group action vector field that generates a flow on the smooth
manifold in section 3 we specialize to the case of a matrix lie group and using
the exponential map derive the pullback of the generalized right translation vector
field on the lie group to the corresponding vector field on the lie algebra to help
give some context to our overall scheme we provide in section 4 illustrative examples
of manifolds and natural choices for associated lie groups and actions that generate
flows on those manifolds then in section 5 we show how a flow on a smooth manifold
corresponding to a stochastic differential equation can be generated by a stochastic
flow on a lie algebra via a lie algebra action we explicitly present stochastic munthekaas lie group integration methods in section 6 we start the second half of our
paper by reviewing the exponential lie series for stochastic differential equations in
section 7 we show in section 8 how to construct geometric stochastic castellgaines
numerical methods in particular we also present uniformly accurate exponential lie
series numerical schemes that not only can be used as geometric stochastic integrators
but also are always more accurate than stochastic taylor numerical schemes of the
corresponding order in section 9 we present our concrete numerical examples finally
in section 10 we conclude and present some further future applications and directions
2 lie group actions suppose m is a smooth finite ndimensional submanifold
of rn with n  n  we use xm to denote the lie algebra of vector fields on the
manifold m equipped with the liejacobi bracket u v   u  v  v  u  for all
stochastic lie group integrators
u v  xm let g denote a finite dimensional lie group
definition 21 lie group action a left lie group action of a lie group g on a
manifold m is a smooth map   g  m  m satisfying for all y  m and r s  g
1 id y  y 2 r s y  rs y we denote y  s  s y
hereafter we suppose y0  m is fixed and focus on the action map y0  gm
we assume that the lie group action  is transitive ie transport across the manifold
from any point y0  m to any other point y  m can always be achieved via a group
element s  g with y  y0  s marsden and ratiu 37 p 310
we define the lie algebra g associated with the lie group g to be the vector space
of all right invariant vector fields on g by standard construction this is isomorphic
to the tangent space to g at the identity id  idg see olver 42 p 48 or marsden
and ratiu 37 p 269
definition 22 generalized right translation vector field suppose we are
given a smooth map   mg with each such map  we associate a vector field
x  g  xg defined as follows
x  s   exp  y0  s s  0
for s  g where exp is the usual local diffeomorphism exp  g  g from a neighbourhood of the zero element o  g to a neighbourhood of id  g
definition 23 infinitesimal lie group action we associate with each vector
field x  gxg a vector field   mxm as the push forward of x from g to
m by y0  ie   y0  x  so that if s  g and y  y0  s  m then
  y   y0    0 
where t  g 0  s and     x    the flow generated on g by the
vector field x starting at s  g naturally as a vector field  is linear and also
  y  lx  y0  s 
the lie derivative of y0 along x at s  g
remarks
1 the map s  mm defined by y 7 s  y  y  s represents a
flow on
 m hence if y  s  y0  the push forward of  by s is given by
s    ads  marsden and ratiu 37 p 317
2 we define the isotropy subgroup at y0  m by gy0  s  g  y0 s  y0  it
is a closed subgroup of g see helgason 23 p 121 or warner 48 p 123 we define
the global isotropy subgroup by gm  y0 m gy0  s  g  y0  s  y0  y0  m
it is a normal subgroup of g see olver 42 p 38
3 a lie group action is said to be is effectivefaithful if the map s 7 s from
g to diffm the group of diffeomorphisms on m is onetoone this is equivalent
to the condition that different group elements have different actions ie gm  idg 
a lie group action is said to be free if gy0  idg  for all y0  m ie y0 is a
diffeomorphism from g to m for more details see marsden and ratiu 37 p 310
and olver 42 p 38
4 the map   ggy0 m defined by   s  gy0 7 y0  s is a diffeomorphism
ie m 
 ggy0 for any y0  m a manifold m with a lie group action   g mm
defined over it is thus diffeomorphic to a homogeneous manifold  see warner 48
p 123 or olver 42 p 40 further the induced action of ggm on m is effective
hence if  is not an effective action of g we can replace it without loss of generality
by the induced action of ggm see olver 42 p 38
malham and wiese
5 our definition for the generalized right translation vector field x on g is
motivated by the standard right translation vector field used to identify g the vector
space of right invariant vector fields on g with tid g the tangent space to g at the
identity when   g is constant x  xg is right invariant and a lie bracket
on tid g can be defined via right extension by the corresponding liejacobi bracket
for the vector fields x on xg unless   g is constant x is not in general
right invariant for further details see varadarajan 47 olver 42 or marsden and
ratiu 37
6 the infinitesimal generator map  7  from g to xm is a lie algebra
homomorphism if we identify g as the vector space of left invariant vector fields on g
this map becomes an antihomomorphism the liejacobi bracket as defined above
gives the right rather than left lie algebra stucture over the group of diffeomorphisms
on m if in addition we take the liejacobi bracket to be minus that defined above
associated with the left lie algebra structurethen the infinitesimal generator map
becomes a homomorphism again see for example marsden and ratiu 37 p 324 or
munthekaas 40
7 the image of g under the infinitesimal generator map  7  forms a finite
dimensional lie algebra of vector fields on m which is isomorphic to the lie algebra of
the effectively acting quotient group ggm see olver 42 p 56 thus the tangent
space to m at any point is g and m inherents a connection from ggm  connections
are necessary to define martingales on manifolds but not for defining semimartingales
our focus here see malliavin 36 and emery 14
8 a comprehensive study of the systematic construction of symmetry lie groups
from given vector fields can be found in olver 42
9 we assumed above that the vector fields x and  are autonomous however
all results in this and subsequent sections up to section 7 can be straightforwardly
extended to nonautonomous vector fields generated by   m  rg with y t 7
y t for all y  m and t  r
10 for full generality we want to suspend reference to embedding spaces as far as
possible however in subsequent sections to be concise we will more explicitly reclaim
this context
3 pull back to the lie algebra for ease of presentation we will assume in
this section that g is a matrix lie group recall that the exponential map exp  g  g
is a local diffeomorphism from a neighbourhood of o  g to a neighbourhood of id  g
let v  gg be the pull back of the vector field x  gxg from g to g via the
exponential mapping exp  gg ie v    exp x   if   g then
v    dexp1
   y0  exp  
here dexp1
  gg is the inverse of the righttrivialized tangent map of the exponential
dexp  gg defined as follows if   is a curve in g such that 0   and
  0    g then dexp  g  gg is the local smooth map varadarajan 47 p 108
dexp     exp   0 exp
expad   id
note that as a tangent map dexp  gg is linear the inverse operator dexp1
 is the
operator series 12 generated by considering the reciprocal of dexp 
stochastic lie group integrators
to show that 31 is true if exp  gg with  7 s  exp  and    g with
0   and     v    then
exp v  s   exp   0
 dexp  v   exp
 x  s 
since exp is a diffeomorphism in a neighbourhood of o  g this push forward calculation establishes the pull back 31 for all   g in that neighbourhood
4 illustrative examples suppose the vector field v  m  rxm generates a flow solution yt  m starting from y0  m then assume there exists a
1 lie group g with corresponding lie algebra g
2 lie group action y0  gm for which a starting point y0  m is fixed
3 vector field   m  rxm such that v    ie v is a fundamental
vector field corresponding to the action y0 
let us suppose g is a matrix lie group or can be embedded into a matrix lie
group for example the euclidean group se3 is naturally embedded into the special
linear group sl4 r we have for all s  g and t  r
x s t   y0 s t s 
if v   for some   mg some lie group g and corresponding action y0  then
the flow generated by x on g drives the flow generated by v on m in each of the
examples below given the manifold m we present a natural lie group and action
associated with the manifold structure and identify vector fields which generate flows
on the manifold via the lie group
stiefel manifold vnk  suppose m  vnk  y  rnk  y t y  i take
g  son the special orthogonal group and y0 s  sy0  the action of left
multiplication the corresponding lie algebra g  son then by direct calculation
 y  y t y hence if the given vector field v y t  y t y then the push
forward of the flow generated by x s t on g in 41 is the flow generated by v on
m note that the unit sphere s2 
 v31  ie s2 is just a particular stiefel manifold
in section 9 as an application we consider rigid body dynamics evolving on s2 
isospectral manifold sn  suppose m  sn  y  rnn  y t  y the set of
n  n real symmetric matrices take g  on the orthogonal group and y0 s 
sy0 s t  which is an isospectral action munthekaas 40 the corresponding lie
algebra is g  son again by direct calculation  y  y t y  y y t hence
if the given vector field v y t  y t y  y y t then the push forward of the flow
generated by x s t on g in 41 is the flow generated by v on m
dual of the euclidean algebra se3  suppose m  se3
 r3  the dual
of the euclidean algebra se3 of the euclidean group se3  s   se3  s 
so3   r3  take g  se3 so g  se3 and   ad  g  g g  the
coadjoint action of g on g  then by direct calculation  y  ad y since
 y in linear in  and  y   y it follows that if v y  ad y then
the push forward of the flow generated by x s t   y0 s t s on g is the
flow generated by v on m for more details see section 9 where we investigate the
dynamics of an autonomous underwater vehicle evolving on se3 
malham and wiese
grassmannian manifold grk n the grassmannian manifold m  grk n
is the space of kdimensional subspaces of rn  take g  gln the general linear
matrix group where if s  gln we identify
where the block matrices    and  are sizes k  k k  n  k n  k  k and
n  k  n  k respectively see schiff and shnider 43 munthekaas 40 we
choose the action of gln on grk n to be the generalized mbius transformation
y0 s  y0  y0  1  hence if
at bt
ct dt
then direct calculation reveals that  y  aty  bt  ycty  ydt hence if the
given vector field v y  aty  bt  ycty  ydt then the push forward of the
flow generated by x s t  t s on g is the flow generated by v on grk n
5 stochastic lie group integration we show that if a lie group action
  g  mm exists then for y0  m fixed the lie algebra action y0  exp  gm
carries a flow on g to a flow on m
theorem 51 suppose there exists a lie group action   g  mm then if
there exists a process   g and a stopping time t such that on 0 t   satisfies
the stratonovich stochastic differential equation
d z
vi   dwi 
then the process y  y0  exp   m satisfies the stratonovich stochastic differential
equation on 0 t 
yt  y0 
d z
i  y dwi 
proof using its lemma if t  g satisfies 51 then y0  exp t satisfies
y0  exp t  y0  exp o 
d z
lvi  y0  exp  dwi 
now recall that for each i  0 1     d xi is the push forward of vi from g to g via
the exponential map and that i is the push forward of xi from g to m via y0
and so the lie derivative
lvi  y0  exp t  i  yt 
then since yt  y0  exp t  we conclude that y  m is a process satisfying the
stochastic differential equation 52
corollary 52 suppose that for each i  0 1     d there exists i  mg such
that the vector field vi  mxm and i  mxm can be identified ie
vi  i 
stochastic lie group integrators
then the push forward by y0 exp of the flow on the lie algebra manifold g generated
by the stochastic differential equation 51 is the flow on the smooth manifold m
generated by the stochastic differential equation 52 whose solution can be expressed
in the form yt  y0  exp t 
remark if the action is free then y0  exp is a diffeomorphism from a neighbourhood of o  g to a neighbourhood of y0  m
6 stochastic munthekaas methods assuming that the vector fields in our
original stochastic differential equation 11 are fundamental and satisfy 53 then
stochastic munthekaas methods are constructed as follows
1 subdivide the global interval of integration 0 t  into subintervals tn  tn1 
2 starting with t0  0 repeat the next two steps over successive intervals
tn  tn1  until tn1  t 
3 compute an approximate solution tn tn1 to 51 across tn  tn1  using a
stochastic taylor stochastic rungekutta or castellgaines method
4 compute the approximate solution ytn1  ytn  exp tn tn1 
note that by construction tn tn1  g because the stochastic differential equation 51 or any stochastic taylor or other sensible approximation evolves the solution locally on the lie algebra g via the vector fields vi  gg suitable methods
for approximating the exponential map to ensure it maps g to g appropriately can be
found in iserles and zanna 26 then by construction ytn1  m
for example with two wiener processes and autonomous vector fields vi   an
order 1 stochastic taylor munthekaas method is based on
tn tn1  j0 v0  j1 v1  j2 v2  12 j12 v21  j12 v1 v2  j21 v2 v1  12 j22 v22  o  61
evaluated at the zero element o  g typically dexp1
  is truncated to only include
the necessary low order terms to maintain the order of the numerical scheme
remark it is natural to invoke ados theorem see for example olver 42 p 54
any finite dimensional lie algebra is isomorphic to a lie subalgebra of gln the
general linear algebra for some n  n however as munthekaas 40 points out
directly using a matrix representation for the given lie group might not lead to the
optimal computational implementation other data structures might do so
7 exponential lie series the stochastic taylor series is known in different
contexts as the neumann series peanobaker series or feynmandyson path ordered
exponential if the vector fields in the stochastic differential equation 11 are autonomous which we assume henceforth ie for all i  0 1     d vi  vi y only
then the stochastic taylor series for the flow is
m0 pm
j1 m t v1    vm 
here pm is the set of all combinations of multiindices   1      m  of length m
with i  0 1     d and
j1 m t 
are multiple stratonovich integrals
dwm1    dw1m
malham and wiese
the logarithm of t is the exponential lie series magnus expansion magnus 34
or chenstrichartz formula chen 9 strichartz 45 in other words we can express
the flow map in the form t  exp t  where
ji tvi 
2 jij
ji0
 jji tvi  vj     
is the exponential lie series for our system and    is the liejacobi bracket on
xm see yamato 49 kunita 29 ben arous 1 and castell 7 for the derivation
and convergence of the exponential lie series expansion in the stochastic context
strichartz 45 for the full explicit expansion sussmann 46 for a related product
expansion and lyons 32 for extensions to rough paths
let us denote the truncated exponential lie series by
j c 
where qm denotes the finite set of multiindices  for which kj kl2 is of order up to
and including tm  where m  12 1 32    the terms c are linear combinations
of finitely many length  products of the smooth vector fields vi  i  0 1     d
the following asymptotic convergence result can be established along the lines of the
proof for linear stochastic differential equations in lord malham and wiese 31 we
provide a proof in appendix a
theorem 71 assume the vector fields vi have 2m1 uniformly bounded derivatives for all i  0 1     d then for t  1 the flow exp t  y0 is squareintegrable
where t is the truncated lie series 71 further if y is the solution
of the stochastic
differential equation 11 there exists a constant c m ky0 k2 such that
yt  exp t  y0
 c m ky0 k2 tm12 
8 geometric castellgaines methods consider the truncated exponential
lie series tn tn1 across the interval tn  tn1  we approximate higher order multiple
stratonovich integrals across each timestep by their expectations conditioned on the
increments of the wiener processes on suitable subdivisions gaines and lyons 20
an approximation to the solution of the stochastic differential equation 11 across
the interval tn  tn1  is given by the flow generated by the truncated and conditioned
exponential lie series tn tn1 via
ytn1  exp tn tn1  ytn 
hence the solution to the stochastic differential equation 11 can be approximately
computed by solving the ordinary differential system see castell and gaines 8
misawa 39
u    tn tn1  u 
across the interval   0 1 then if u0  ytn we will get u1  ytn1  we
must choose a sufficiently accurate ordinary differential integrator to solve 81we
implicitly assume this henceforth
stochastic lie group integrators
the set of governing vector fields vi  i  0 1     d prescribes a map from the
driving path process w  w 1      w d  to the unique solution process y  m to the
stochastic differential equation 11 the map w 7 y is called the it map recall
that we assume the vector fields are smooth when there is only one driving wiener
process d  1 the it map is continuous in the topology of uniform convergence
theorem 111 in lyons and qian 33 when there are two or more driving processes d  2 the universal limit theorem theorem 622 in lyons and qian 33
tells us that the it map is continuous in the pvariation topology in particular for
2  p  3 a wiener path with d  2 has pvariation with p  2 and the pvariation
metric in this case includes information about the lvy chordal areas of the path
lyons 32 hence we must choose suitable piecewise smooth approximations to the
driving path process w the following result follows from the corresponding result
for ordinary differential equations in hairer lubich and wanner 22 p 112 as well
as directly from chapter viii in malliavin 36 on the transfer principle see also
emery 15
lemma 81 a necessary and sufficient condition for the solution to the stochastic
differential equation 11 to evolve on a smooth ndimensional submanifold m of
rn n  n  up to a stopping time t is that vi y t  ty m for all y  m i 
0 1     d
hence the stochastic taylor expansion for the flow t is a diffeomorphism on m
however a truncated version of the stochastic taylor expansion for the flow t will not
in general keep you on the manifold ie if y0  m then t  y0 need not necessarily
lie in m on the other hand the exponential lie series t  or any truncation t of
it lies in xm by lemma 81 this is a necessary and sufficient condition for the
corresponding flowmap exp t to be a diffeomorphism on m hence if u0  ytn 
m then ytn1  u1  m when solving the ordinary differential equation 81
classical geometric integration methods for example lie group integrators such as
rungekutta munthekaas methods over the interval   0 1 will numerically
ensure ytn1 stays in m additionally as the following result reveals numerical
methods constructed using the castellgaines lie series approach can also be more
accurate a proof is provided in appendix b we define the strong global error at
time t associated with an approximate solution t as e  kyt  t kl2 
theorem 82 in the case of two independent wiener processes and under the
assumptions of theorem 71 for any initial condition y0  m and a sufficiently
small fixed stepsize h  tn1  tn  the order 12 lie series integrator is globally more
accurate in l2 than the order 12 stochastic taylor integrator in addition in the
case of one wiener process the order 1 and 32 uniformly accurate exponential lie
series integrators generated by tn tn1  j0 v0  j1 v1  h12 v1  v1  v0  and
tn tn1  j0 v0  j1 v1  12 j01  j10 v0  v1  
v1  v1  v0  
respectively are globally more accurate in l2 than their corresponding stochastic tayls
lor integrators in other words if em
denotes the global error of the exponential lie
series integrators of order m above and em
is the global error of the stochastic taylor
integrators of the corresponding order then em
 em
for m  12 1 32
remarks
1 the result for  32 is new that the order12 lie series integrator for two
wiener processes and the order 1 integrator generated by  1 are uniformly more
accurate confirms the asymptotically efficient properties of these schemes proved by
malham and wiese
castell and gaines 8 the proof follows along the lines of an analogous result for
linear stochastic systems considered in lord malham and wiese 31
2 consider the order 12 exponential lie series with no vector field commutations solving the ordinary differential equation 81 using an ordinary euler
munthekaas method and approximating dexp1
  id is equivalent to the order 12
stochastic taylor munthekaas method for the same lie group and action
9 numerical examples
91 rigid body we consider the dynamics of a rigid body such as a satellite
see marsden and ratiu 37 we will suppose that the rigid body is perturbed by two
independent multiplicative stochastic processes w 1 and w 2 with the corresponding
vector fields vi y  i y y for i  0 1 2 with i  so3 if we normalize the initial
data y0 so that y0   1 then the dynamics evolves on m  s2  we naturally suppose
g  so3 and y0 s  sy0 so that i y  i y y and we can pull back the
flow generated by v on m to the flow on g generated by xi s t  i y0 s s
i  0 1 2 we use the following matrix representation for the i y  so3
y3 i3 y2 i2
y1 i1  
i y   y3 i3
y2 i2 y1 i1
where the constants ij for j  1 2 3 are chosen so that the vector fields vi and
matrices i do not commute for i  0 1 2 01  3 02  1 03  2 11  1
12  12 13  32 21  14 22  1 23  12 the vector fields vi satisfy
the conditions of theorem 71 since the manifold is compact in this case
we will numerically solve 11 using three different order 1 methods stochastic
taylor stochastic taylor munthekaas based on 61 and castellgaines a standard nongeometric rungekutta method is used to solve the ordinary differential
equation 81 the vector field compositions vi vj needed for the stochastic taylor
and castellgaines methods are readily computed for the munthekaas method we
note that we have vi  o  i y0  and
vi vj  o  y0  y0  i  j   21 i y0  j y0  
here o  so3 is the zero element on the lie algebra and for all y z  r3 we define
 y2 z3
y 3 z2 1 
2  3  1
y z
y z
ay z     3 31  1 13  12  
y1 z2
y 2 z1 1
1  2
and   r3 so3 denotes the vector space isomorphism  7  where
3 2
1  
   3
2 1
note that  z  y  z see marsden and ratiu 37 note also since   so3
exp   so3 can be conveniently and cheaply computed using rodrigues formula
see marsden and ratiu 37 or iserles et al 25
in figure 91 we show the distance from
s2 of each the three approx manifold
 the
imations we start with initial data y0   2 2 0  the stochastic taylor munthekaas method can be seen to preserve the solution in the unit sphere to within machine
stochastic lie group integrators
logdistance from manifold
stochastic taylor
castellgaines
munthekaas
time
fig 91 rigid body we show the logdistance of the approximate solution to the unit sphere
as a function of time for each of the methods below we show the approximate solutions as a function
of time for the stochastic taylor blue and munthekaas methods magenta the trajectory starts
at the top right and eventually drifts over the left horizon
malham and wiese
error we also see that the stochastic taylor method clearly drifts off the sphere as
the integration time progresses as does the nongeometric castellgaines method
which does however remain markedly closer to the manifold than the stochastic taylor
scheme
stochastic taylor
castellgaines
munthekaas
logerror in casimirs
time
number of sampled paths100
stochastic taylor
castellgaines
munthekaas
log10global error
log stepsize
fig 92 autonomous underwater vehicle we show the logdistance of the approximate solution
to the two casimirs c1    p dotted line and c2  p2 solid line as a function of time for each
of the methods below we also show the global error as a function of stepsize
stochastic lie group integrators
92 autonomous underwater vehicle the dynamics of an ellipsoidal autonomous underwater vehicle is prescribed by the state y   p  se3 where
  so3 is its angular momentum and p  r3  its linear momentum see holmes
jenkins and leonard 24 egeland dalsmo and srdalen 12 and marsden and
ratiu 37 we suppose that the vehicle is perturbed by two independent multiplicative stochastic processes the governing vector fields are for i  0 1 2
vi y  adi  y 
here i y  i y ui y  se3 where i y  ii1  and ui y  mi1 p are the
angular and linear velocity and ii  diagi1  i2  i3  and mi  diagi1  i2  i3 
are the constant moment of inertia and mass matrices respectively explicitly for
  se3 we have
ad  y      p  u p   
the system of vector fields vi  i  0 1 2 represents the liepoisson dynamics on
m  se3 marsden and ratiu 37 there are two independent casimir functions
ck  se3 r k  1 2 namely c1    p and c2  p2  these are conserved by the
flow on se3  note that the hamiltonian ie total kinetic energy 21     p  u
is also exactly conserved and helpful for establishing the sufficiency conditions in
theorem 71 but that is not our focus here
if g  se3 
 so3  r3  then the coadjoint action of se3 on se3 
ad  se3  se3 se3 is defined for all s  s   se3 where s  so3
and   r3  and y  se3 by y  s  ads 1  y  s    sp sp  the
corresponding infinitesimal action   se3  se3 se3 for all   se3 and y 
se3 is given by see marsden and ratiu 37 p 477
  y  ad  y 
since ad y   y   y the governing set of vector fields on se3 are
vi y  i  y 
we can now pull back this flow on se3 to a flow on se3 via y0  the corresponding flow on se3 is generated by the governing set of vector fields for i  0 1 2
xi  s   i y  s i y    ui y 
with y  y0 s
to aid implementation note that se3  s   se3  s  so3   r3
embeds into sl4 r via the map
s  s  7
ot 1
where o is the threevector of zeros also se3 is isomorphic to a lie subalgebra of
sl4 r with elements of the form
    7
malham and wiese
hence the governing vector fields on se3 are of the form xi  i y s where
i  ui p
i y 
the governing vector fields on se3 are vi   dexp  i y0 exp   again the
vector field compositions vi vj needed for the stochastic taylor and castellgaines
methods can be computed straightforwardly direct calculation also reveals that in
block matrix form
0  0  i  j   p0  p0  i  j  a0  p0  i  j 
vi vj o 
 21 i y0  j y0  
here ay z   is defined as for the rigid body example note that the exponential
map expse3  se3se3 is defined for all      se3 by
expso3  f 
expse3  
where expso3 is the exponential map from so3 to so3 which can be computed
using rodrigues formula and see bullo and murray 4 p 5
f   i33  1  cos kkkk2  1  sin kkkk 2 kk2 
in figure 92 we show the distance from the manifold se3 of each the three approximations in particular how far the individual trajectories stray
from thecasimirs
c1    p and c2  p2  we start with the initial data y0   2 2 0 0 2 2t 
as before the stochastic taylor munthekaas method can be seen to preserve the
casimirs to within machine error we also see that the stochastic taylor method
clearly drifts off the manifold as the integration time progresses and at a particular
time depending on the wiener path shoots off very rapidly away from the manifold
note also that for large stepsizes the stochastic taylor method is unstable however
the nongeometric castellgaines and stochastic munthekaas methods still give reliable results in that regime lastly although the the stochastic munthekaas method
adheres to the manifold to within machine error the error of the nongeometric
castellgaines method is actually smaller
10 conclusions we have established and implemented stochastic lie group
integrators based on stochastic munthekaas methods and also derived geometric
castellgaines methods we have also revealed several aspects of these integrators
that require further investigation
1 we could construct a stochastic nonlinear magnus method by approximating
the solution to the stochastic differential equation 51 on the lie algebra using picard
iterations see casas and iserles 6
2 we would like to develop a practical procedure for implementing ordinary
munthekaas methods for higher order castellgaines integrators we need to determine the element   mg so that in 81 we have    
3 we need to determine the properties of the local and global errors for the
stochastic munthekaas methods also a thorough investigation of the stability properties of the stochastic munthekaas and castellgaines methods is required for
the autonomous underwater vehicle simulations they were both superior to the direct
stochastic taylor method especially for larger stepsizes we also need to compare the
relative efficiency of the methods concerned in particular to compare an optimally
efficient geometric castellgaines method with the stochastic munthekaas method
stochastic lie group integrators
4 although we have chiefly confined ourselves to driving paths that are wiener
processes we can extend munthekaas and castellgaines methods to rougher driving paths lyons and qian 33 friz 18 friz and victoir 19 further what happens when we consider processes involving jumps for example srivastava miller and
grenander 44 consider jump diffusion processes on matrix lie groups for bayesian
inference or what if we consider fractional brownian driving paths baudoin and
coutin 3 investigate fractional brownian motions on lie groups
5 schiff and shnider 43 have used lie group methods to derive mbius schemes
for numerically integrating deterministic riccati systems beyond finite time removable
singularities and numerical instabilities they integrate a linear system of equations
on the general linear group gln which corresponds to a riccati flow on the grassmannian manifold grk n via the mbius action map lord malham and wiese 31
implemented stochastic mbius schemes and show that they can be more accurate and
cost effective than directly solving stochastic riccati systems using stochastic taylor
methods we would like to investigate further their effectiveness for stochastic riccati equations arising in kalman filtering kloeden and platen 27 and to backward
stochastic riccati equations arising in optimal stochastic linearquadratic control see
for example kohlmann and tang 28 and estrade and pontier 16
6 other areas of potential application of the methods we have presented in this
paper are for example termstructure interest rate models evolving on finite dimensional invariant manifolds see filipovic and teichmann 17 stochastic dynamics
triggered by dna damage chickarmane ray sauro and nadim 10 and stochastic
symplectic integrators for which the gradient of the solution evolves on the symplectic
lie group see milstein and tretyakov 38
acknowledgments we thank alex dragt peter friz anders hansen terry
lyons perchristian moan and hans munthekaas for stimulating discussions we
also thank the anonymous referees whose suggestions and encouragement improved
the original manuscript significantly sjam would like to acknowledge the invaluable facilities of the isaac newton institute where some of the final touches to this
manuscript were completed
appendix a proof of theorem 71 we follow the proof for linear stochastic
differential equations in lord malham and wiese 31 where further technical details
on estimates for multiple stratonovich integrals can be found suppose t  t m
is the truncated lie series 71 first we show that exp t  y0  l2  we see that
for any number k t  y0 is a sum of qm k terms each of which is a kmultiple
product of terms j c  y0  it follows that
 y0
max kc  y0 k
i qm
kj1 j2    jk kl2 
i1k
note that the maximum of the norm of the compositions of vector fields c y0 is taken
over a finite set repeated application of the product rule reveals that for i  1     k
each term j1 j2    jk  in a1 is the sum of at most 22mk1 stratonovich integrals
j  where for t  1 kj kl2  24mk1 tk2  since the right hand side of equation a1
consists of qm k 22mk1 stratonovich integrals j  we conclude that
 y0
max kc  y0 k  qm   26m  t12
malham and wiese
hence exp t  y0 is squareintegrable
second we prove 72 let t denote the stochastic taylor series solution truncated to included terms of order up to and including tm  we have
yt  exp t  y0
 yt  t
 t  exp t  y0
we know yt  l see lemma iii21 in gihman and skorohod 21 note that
the assumptions there are fulfilled since the uniform boundedness of the derivatives
implies uniform lipschitz continuity of the vector fields by the mean value theorem
and uniform lipschitz continuity in turn implies a linear growth condition for the
vector fields since they are autonomous note that t is a strong approximation to
yt up to and including terms of order tm  with the remainder consisting of otm12 
terms see proposition 591 in kloeden and platen 27 it follows from the definition
of the exponential lie series as the logarithm of the stochastic taylor series that the
terms of order up to and including tm in exp t  y0 correspond with t  the error
consists of otm12  terms
appendix b proof of theorem 82 our proof follows along the lines of that
for uniformly accurate magnus integrators for linear constant coefficient systems see
lord malham  wiese 31 and malham and wiese 35 let tn tn1 and tn tn1
denote the exact and approximate flowmaps constructed on the interval tn  tn1  of
length h we define the local flow remainder as
rtn tn1  tn tn1  tn tn1 
and so the local remainder is rtn tn1  ytn  let rls and rst denote the local flow
remainders corresponding to the exponential lie series and stochastic taylor approximations respectively
b1 order 12 integrator two wiener processes for the global order 12
integrators we have to leading order rls  21 j12  j21 v1  v2  and rst  j12 v1 v2 
j21 v2 v1  note that we have included the terms j11 v12 and j22 v22 in the integrators
a direct calculation reveals that
e rst  y0 t rst  y0  e rls  y0 t rls  y0  h2m u t bu  o h2m 2  b1
here m  12 for the order 12 integrators u  v1 v2  y0  v2 v1  y0 t  r2n  and
b  r2n2n consists of n  n diagonal blocks of the form bij inn where
1 1 1
b 4
1 1
and inn is the nn identity matrix since b is positive semidefinite the matrix b 
binn is positive semidefinite hence the order 12 exponential lie series integrator
is locally more accurate than the corresponding stochastic taylor integrator
b2 order 1 integrator one wiener process for the global order 1 integrators we have to leading order rls  21 j01  j10 v0  v1  and rst  j01 v0 v1 
j10 v1 v0  j111 v13  41 h2 v0 v12  v12 v0  the terms of order h2 shown are significant
when we consider the global error in section b4 below the estimate b1 also
applies in this case with m  1 and u  v0 v1  y0  v1 v0  y0  v13  y0 t  r3n  and
b  r3n3n consists of n  n diagonal blocks of the form bij inn where
3 3 3
3 3 3 
b  12
3 3 5
stochastic lie group integrators
since b is positive semidefinite the matrix b  b  inn is positive semidefinite
hence the order 1 exponential lie series integrator is locally more accurate than the
corresponding stochastic taylor integrator
b3 order 32 integrator one
 wiener process the local flow remainders
are rls  61 j110 2j101 j011  12 h2 v1  v1  v0  and rst  j011 v0 v12 j101 v1 v0 v1 
j110 v12 v0  j1111 v14  41 h2 v0 v12  v12 v0  12 v14  the terms of order h2 shown are
significant when we consider the global errorbut for a different reason this timesee
section b4 below again the estimate b1 applies in this case with m  32 and
u  v0 v12  y0  v1 v0 v1  y0  v12 v0  y0  v14  y0 t  r4n  and b  r4n4n consists of
n  n diagonal blocks of the form bij inn where
11 8 5 12
8 8 12
1 8
b  144
 5 8 11 12 
12 12 12 24
again b is positive semidefinite and the order 32 exponential lie series integrator
is locally more accurate than the corresponding stochastic taylor integrator
b4 global error recall that we define the strong global error at time t
associated with an approximate solution t as e  kyt  t kl2  the exact and
approximate solutions can be constructed by successively applying the exact and
approximate flow maps tn tn1 and tn tn1 on the successive intervals tn  tn1  to
the initial data y0  a straightforward calculation shows for a small fixed stepsize h
e 2  e r  y0 t r  y0 
pn 1
up to higher order terms where r  n0 tn1 tn  rtn tn1  t0 tn is the standard
accumulated local error contribution to the global error the important conclusion is
that when we construct the global error b2 the terms of leading order in the local
flow remainders rls or rst with zero expectation lose only a half order of convergence
in this accumulation effect hence in the local flow remainders shown above for the
terms of zero expectation the local superior accuracy for the lie series integrators
transfers to the corresponding global errors see lord malham and wiese 31 for
more details terms of nonzero expectation however behave like deterministic error terms losing a whole order in the local to global convergence they contribute
to the global error through their expectations hence we include such terms of order h2 in the order 32 integrators above and they appear as the terms subtracted
from the remainders shown for the order 1 integrators we do not need to include
the order h2 terms in the integrator to obtain the correct meansquare convergence
however to guarantee that the global error for the exponential lie series integrator
is always smaller than that for the stochastic taylor scheme we include this term in
the integrator
references
1 g ben arous flots et series de taylor stochastiques probab theory related fields 81
1989 pp 2977
2 f baudoin an introduction to the geometry of stochastic flows imperial college press 2004
3 fbaudoin and l coutin selfsimilarity and fractional brownian motions on lie groups
arxivmathpr0603199 v1 2006
malham and wiese
4 f bullo and r m murray proportional derivative pd control on the euclidean group
cds technical report 95010 1995
5 k burrage and p m burrage high strong order methods for noncommutative stochastic ordinary differential equation systems and the magnus formula phys d 133 1999
pp 3448
6 f casas and a iserles explicit magnus expansions for nonlinear equations cambridge na
reports 2005
7 f castell asymptotic expansion of stochastic flows probab theory related fields 96
1993 pp 225239
8 f castell and j gaines an efficient approximation method for stochastic differential equations by means of the exponential lie series math comp simulation 38 1995 pp 1319
9 k t chen integration of paths geometric invariants and a generalized bakerhausdorff
formula annals of mathematics 651 1957 pp 163178
10 v chickarmane a ray h m sauro and a nadim a model for p53 dynamics triggered
by dna damage siam j applied dynamical systems 61 2007 pp6178
11 p e crouch and r grossman numerical integration of ordinary differential equations on
manifolds j nonlinear sci 3 1993 pp 133
12 o egeland m dalsmo and o j srdalen feedback control of a nonholonomic underwater vehicle with a constant desired configuration the international journal of robotics
research 151 1996 pp 2435
13 k d elworthy stochastic differential equations on manifolds london mathematical society
lecture note series 70 cambridge university press 1982
14 m emery stochastic calculus on manifolds universitext springerverlag 1989
 on two transfer principles in stochastic differential geometry sminaire de probabilits
strasbourg 24 1990 pp 407441
16 a estrade and m pontier backward stochastic differential equations in a lie group
sminaire de probabilits strasbourg 35 2001 pp 241259
17 d filipovi and j teichmann on the geometry of the term structure of interest rates proc
r soc lond a 460 2004 pp 129167
18 p friz continuity of the itmap for hlder rough paths with applications to the support
theorem in hlder norm arxivmathpr0304501 v2 2003
19 p friz and n victoir euler estimates for rough differential equations preprint 2007
20 j g gaines and t j lyons variable step size control in the numerical solution of stochastic
differential equations siam j appl math 575 1997 pp 14551484
21 i i gihman and a v skorohod the theory of stochastic processes iii springer 1979
22 e hairer c lubich and g wanner geometric numerical integration springer series
in computational mathematics 2002
23 s helgason differential geometry lie groups and symmetric spaces academic press 1978
24 p holmes j jenkins and n e leonard dynamics of the kirchoff equations i coincident
centers of gravity and bouyancy phys d 118 1998 pp 311342
25 a iserles h z munthekaas s p nrsett and a zanna liegroup methods acta
numer 2000 pp 215365
26 a iserles and a zanna efficient computation of the matrix exponential by generalized polar
decompositions siam j numer anal 425 2005 pp 22182256
27 p e kloeden and e platen numerical solution of stochastic differential equations
springer 1999
28 m kohlmann and s tang multidimensional backward stochastic riccati equations and applications siam j control optim 416 2003 pp 16961721
29 h kunita on the representation of solutions of stochastic differential equations lnm 784
springerverlag 1980 pp 282304
 stochastic flows and stochastic differential equations cambridge university press 1990
31 g lord s ja malham and a wiese efficient strong integrators for linear stochastic
systems 2006 submitted
32 t lyons differential equations driven by rough signals rev mat iberoamericana 142
1998 pp 215310
33 t lyons and z qian system control and rough paths oxford university press 2002
34 w magnus on the exponential solution of differential equations for a linear operator comm
pure appl math 7 1954 pp 649673
35 s ja malham and a wiese universal optimal stochastic expansions 2007 preprint
36 p malliavin stochastic analysis grundlehren der mathematischen wissenschaften 313
springer 1997
37 j e marsden and t s ratiu introduction to mechanics and symmetry second edition
stochastic lie group integrators
springer 1999
38 g n milstein and m v tretyakov stochastic numerics for mathematical physics
springer 2004
39 t misawa a lie algebraic approach to numerical integration of stochastic differential equations siam j sci comput 233 2001 pp 866890
40 h munthekaas high order rungekutta methods on manifolds appl numer math 29
1999 pp 115127
41 n j newton asymptotically efficient rungekutta methods for a class of it and
stratonovich equations siam j appl math 51 1991 pp 542567
42 p j olver equivalence invariants and symmetry cambridge university press 1995
43 j schiff and s shnider a natural approach to the numerical integration of riccati differential equations siam j numer anal 365 1999 pp 13921413
44 a srivastava m i miller and u grenander jumpdiffusion processes on matrix lie
groups for bayesian inference preprint 2000
45 r s strichartz the campbellbakerhausdorffdynkin formula and solutions of differential equations j funct anal 72 1987 pp 320345
46 h j sussmann product expansions of exponential lie series and the discretization of stochastic differential equations in stochastic differential systems stochastic control theory
and applications w fleming and j lions eds springer ima series vol 10 1988
pp 563582
47 v s varadarajan lie groups lie algebras and their representations springer 1984
48 f w warner foundations of differentiable manifolds and lie groups graduate texts in
mathematics springerverlag 1983
49 y yamato stochastic differential equations and nilpotent lie algebras z wahrsch verw
gebiete 472 1979 pp 213229
