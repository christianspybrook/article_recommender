determinant stirling cycle numbers counts unlabeledarxiv07040004v1 mathco 31 mar 2007acyclic singlesource automatadavid callandepartment statisticsuniversity wisconsinmadison1300 university avemadison wi 537061532callanstatwiscedumarch 30 2007abstractdeterminant stirling cycle numbers counts unlabeled acyclicsinglesource automata proof involves bijection automatacertain marked lattice paths signreversing involution evaluate determinantintroductionchief purpose paper bijectivelydeterminant stirling cycle numbers counts unlabeled acyclic singlesource automatai1 2specifically let ak n denote kn kn matrix j entry i1 1ijstirling cycle number number permutations j cyclesexamplea2 51 0 0 0 00 1 3 2 0 0 0 0 0 00 0 1 3 2 0 0 0 0 00 0 0 1 6 11 6 0 0 00 0 0 0 1 6 11 6 0 00 0 0 0 0 1 10 35 50 240 0 0 0 0 0 1 10 35 500 0 0 0 0 0 0 1 15 850 0 0 0 0 0 0 0 1 151 1 0 0 0evident example ak n formed k copies rows 2 n 1stirling cycle triangle arranged nonzero entry row 1row 1 occurs main diagonal words ak nhessenberg matrix 1s infradiagonalmain theorem determinant ak n number unlabeled acyclic singlesource automata n transient states k 1letter input alphabetsection 2 reviews basic terminology automata recurrence relations countfinite acyclic automata section 3 introduces columnmarked subdiagonal pathsplay intermediate role way code section 4 presents bijectioncolumnmarked subdiagonal paths unlabeled acyclic singlesource automata finally section 5 evaluates det ak n signreversing involution showsdeterminant counts codes columnmarked subdiagonal pathsautomatacomplete deterministic automaton consists set states input alphabetletters transform states letter state producestate possibly finite automaton finite set states finite input alphabetk letters represented kregular directed multigraph ordered edgesvertices represent states second edge vertex effectsecond alphabet letter state finite automaton acyclicusual sense cycles pick vertex follow path pathultimately hit previously encountered vertex creating cycle termacyclic looser sense vertex called sink involvedcycles means edges sink loop safelyomitted paths feed sinknonsink state called transient size acyclic automaton numbertransient states acyclic automaton size n transient states label1 2 n sink labeled n 1 liskovets 1 uses inclusionexclusion principleobtain following recurrence relation number ak nacyclic automata size n kletter input alphabet k 1ak 0 1ak nnj1j 1knjak jn 1source vertex incoming edges finite acyclic automatonsource path traversed backward v1 v2 v3 distinctvertices continue indefinitely automaton singlesource initiallyconnected source let bk n denote set singlesource acyclicfinite saf automata kletter input alphabet vertices 1 2 n 1 1source n 1 sink set bk n bk n twoline representationautomaton bk n 2 kn matrix columns list edges orderexample1 1 1 2 2 2 3 3 3 4 4 4 5 5 52 4 6 6 6 6 6 6 6 3 5 3 2 2 6b3 5 sourcetosink paths b include 1 2 6 1 4 3 6 14 5 2 6 alphabet b cproposition 1 number bk n saf automata size n kletter input alphabetn k 1 givenbk n1kni akremark formula bit succinct recurrence 1 theoremproofconsider set acyclic automata transient vertices n 1 2 n1 source 2 3 n interior vertices x 2 n letf x automata set interior vertices includes xgx automata set interior vertices precisely xf x2 n gxy xy 2n gymbius inversion 2 lattice subsetsy xy 2n x yf y x y mbius functionlattice x y 1y x x y particular1 y f yy 2nlet y n 1 n y consists entirely sources verticesn 1y incident edges form subautomaton transient statesak edges n vertices comprising y directlyn 1y 1kni choices f y 1kni ak definition gnumber automata 1 source g bk nproposition follows 1unlabeled saf automaton equivalence class saf automata relabelinginterior vertices liskovets notes 1 prove bk nnontrivial automorphisms n 1 relabelings interior verticesb bk n produces different automaton unlabeled saf automata size nkletter alphabet countedb nn1 kresult establishes canonicalrepresentative relabeling classproposition 2 equivalence class bk n relabeling interior verticessize n 1 contains exactly saf automaton occurrences increasing property occurrences interior vertices2 3 nin rowtwoline representation occur orderproofassertion follows fact interior vertices automaton b bk n distinguished intrinsically independent labelingmark source 1 mark new label v1 observeexists interior vertex incoming edges sourcecurrently marked vertex cycle presentinterior vertex v choose edge marked vertex v builtinordering edges determines order vertices mark orderv2 v3 vj j 2 remain unmarked interior verticesincoming edges marked vertex cycle presentvertex use incoming edge marked vertex edgesarranged order initial vertex vi builtin order breaking ties ordermark vertices vj1 vj2 proceed similarly interior vertices markedexample1 1 1 2 2 2 3 3 3 4 4 4 5 5 52 4 6 6 6 6 6 6 6 3 5 3 2 2 6v1 1 interior vertex 4 incoming edgesource v2 4 4 marked vertex incoming edges3 5 marked vertices edges builtin order comesplay 4 5 4 3 putting vertices 3 5 order 5 3 v3 5 v4 3finally v5 2 proves assertion construction vs relabelinginterior vertex subscript corresponding v produces automaton bk noccurrences increasing property relabelingexample yields1 1 1 2 2 2 3 3 3 4 4 4 5 5 55 2 6 4 3 4 5 5 6 6 6 6 6 6 6let ck n denote set canonical saf automata bk n representing unlabeled automata ck nb nn1 khenceforth identify unlabeled automaton canonical representativecolumnmarked subdiagonal pathssubdiagonal k n ppath lattice path steps e 1 0 n 0 1 eeast n north 0 0 kn p rise line y k1 x letck n p denote set pathsfor k 1 clear ck n p nonempty0 p n known generalized ballot theoremkn kp 1 kn p 1ck n pkn p 1path p ck n n coded heights e steps line y 1gives sequence bi kni1 subject restrictions 1 b1 b2 bknbi ikcolumnmarked subdiagonal k n ppath 1 knlattice squares ith e step horizontal line y 1 markedlet ck n p denote set marked pathsb 84y 12 xy 1path c2 4 3marked path p ck n n coded sequence pairs ai bibi kncode underlying path p ai 1 bi gives positionith column example coded 1 1 1 1 1 2 2 2 1 2 3 3 1 3 2 3explicit sum ck n nck n nb1 b2 bkn1b1 b2 bknbi iksummand b1 b2 bkn number ways insert s underlyingpath coded bi kni1possible obtain recurrence ck n p prop 1analytically ck n n ck1 n pleasantbijection section particular number safautomata 2letter alphabetc2 n c1 n nb1 b2 bn 1 3 16 127 1363 n11b1 b2 bnbisequence a082161 3bijection paths automatasection exhibit bijection ck n n ck1 n illustratedpath working example k 2 n 4b 84y 12 xy 1construct row twoline representation consisting k 1 1s 2sn s number left right1 2 3 4 5 6 7 8 9 10 11 121 1 1 2 2 2 3 3 3 4 4 4step path necessarily n step second n stepspath count number steps following gives sequence i1 i2 in1satisfying 1 i1 i2 in1 ij k 1j j circle positionsi1 i2 in1 twoline representation insert boldface 2 3 nsecond row circled positions1 1 1 2 2 2 3 3 3 4occurrences 2 3 n second row workingcolumn path blanks second row left rightfollows count number squares path including squareadd number nearest boldface number left current blank entryboldface numbers left add number 1 insert resultcurrent blank square example numbers squares 23121211yielding1 1 1 2 2 2 3 3 3 42 4 5 3 3 5 4 5 4 5blank entries note s row correspondsink n1 labels second row finally insert n1 remainingblank space image automaton1 1 1 2 2 2 3 3 3 4 4 42 4 5 3 3 5 4 5 4 5 5 5process fully reversible map bijectionevaluation det aknsimplicity treat case k 1 leaving generalization arbitrary knottoodifficultexercise interested reader write a1 n2ijdefinition det sum signed products1ijndet total weight certain lists permutations list carryingweight 1 weightreversing involution cancels 1 weights reducesproblem counting surviving lists surviving lists essentially codespaths c1 n p main theorem follows 4permutations giving nonzero contribution detsgnci ni1aii define code permutation n list ci10 j 1ci 1 j entry 2iji1 known 2n1 permutations correspondingcompositions n codes characterized following conditions ci 0ii c1 1 iii ci 1 immediately followed ci 1 zeros listiv ni1 ci n let list padded composition n deleting zerosbijection ordinary compositions n example 3 0 0 1 2 0 paddedcomposition 6 permutation padded composition code c nonzeroentries c cycle lengths sgn parity n cyclesgiven 1 0s cdetsgndeti1 aiisgn0s cqni1 2ii1 cisum restricted padded compositions c n ci a002083i1i1c0 cihenceforth let write permutations standard cycle form smallestentry occurs cycle smallest entries increase left rightdashes separating cycles 154236 standard cycle form permutation15 22 36 41 54 63 define nonfirst entry start cyclepreceding permutation 3 nonfirst entries 546 note number nonfirstentries 0 identity permutation denote identity permutationsizedefinition stirling cycle number product 2 counts lists ni1 permutations permutation 1 1 ci cycles equivalently cinonfirst entries define ln set lists permutations ni1permutation 1 nonfirst entries 1 transposition 12nonidentity permutation immediately followed ci 1 s ci 1number nonfirst entries total number nonfirst entries n assignweight ln wt 1 sdetdefine weightreversing involution ln given ln scanlist component permutations 1 1 2 2 3 left right stopnonfirst entry ii nonfirst entry bb maximum nonfirst entry m permutation list kpermutation stopcase decrement decrease 1 number s list splitting knonidentity permutations follows let m largest nonfirst entry klet l predecessor replace k successor list necessarilyfollowing permutations transposition l m second permutationobtained k erasing m cycle turning singletonexamples case recall permutations standard cycle form claritysingleton cycles shown5 612 13 23 1425312 13 23 25 142312 23 14 1324 2312 23 14 24 13 23reader readily check sends case case iicase ii k transposition b b maximum nonfirst entry m k1case increment number s list combining k k1 singlepermutation followed k1 b singleton delete singleton insert bimmediately k1 cycle reader check reversesresult examples general sends case ii casemap alters number s list 1 clearly weightreversing map failslists consist entirely transpositions forma1 b1 a2 b2 bn b1 b2 bnlists weight 1 det number lists ai bisatisfying1 ai bi 1 1 n b1 b2 bn subtracting 1bi lists code paths c1 n n 4 det c1 n n c2 nreferences1 valerytomataliskovetsexactdisc appl mathenumerationpressdeterministic2006 earlier version availablehttpwwwi3sunicefrfpsacfpsac03articleshtmlacyclic2 j h van lint r m wilson course combinatorics 2nd ed cambridgeuniversity press ny 20013 neil j sloane founder maintainer online encyclopedia integer sequences httpwwwresearchattcom80 njassequencesindexhtmlblank1