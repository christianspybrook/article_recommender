JOURNAL OF LATEX CLASS FILES, VOL. XX, NO. XX, MAY 4, 2021

1

Scattering Properties of Spherical Time-Varying
Conductive Shells

arXiv:2105.00058v1 [physics.optics] 30 Apr 2021

Kurt Schab, Member, IEEE, Bradley Shirley, Student Member, IEEE, and K.C. Kerby-Patel Senior Member, IEEE

Abstract-Harmonic generation in the scattered fields produced by a dielectric sphere coated with a time-varying conductive shell is studied using a Mie theory approach hybridized
with conversion matrix methods. Analytic results are derived for
plane wave incidence as well as in a more general transition
matrix setting. An equivalent transmission line approach is also
discussed. Numerical examples validate the derived expressions
through comparison with purely numerical methods and convergence characteristics are explored. Several additional examples
illustrate unique trends in far- and near-field scattering.
Index Terms-Time-varying systems, Mie theory, scattering
analysis, electromagnetic theory

I. I NTRODUCTION

T

IME-VARYING electromagnetic devices exhibit frequency conversion, i.e., the generation of spectral content
not existing in an applied excitation. Historically, time-varying
elements have been commonplace within circuit systems used
to perform up- or down-conversion. More recently, spatiotemporally (space-time) modulated materials have been applied
to bring about similar frequency conversion phenomena in
distributed systems. The analytic study of space-time materials
has, so far, been largely driven by methods involving homogeneous media [1]–[3], the polarizability of single particles
[4], guided wave systems [5], planar structures [6]–[15], or
systems with inherent cylindrical symmetry [16], [17].
Many of these analytic studies, explicitly or implicitly,
apply conversion matrix techniques [18] commonly used in the
study of time-varying circuits to analyze harmonic generation.
Within this framework, linear, time-varying components or
materials act as coupling elements between otherwise decoupled linear, time-invariant physical problems at multiple
frequencies. Recently, this approach was integrated with the
method of moments as an alternative to the finite difference
time domain (FDTD) method for the analysis of arbitrary
time-varying electromagnetic systems [19], [20]. Despite the
flexibility of FDTD and other numerical methods as computational tools for studying time-varying systems, analytic
or quasi-analytic methods remain attractive due to their low
computational cost and their ability to accurately model many
problems based on canonical geometries.
In this work, we develop an analytic solution for the fields
scattered by a dielectric sphere coated with a thin shell of
Manuscript received May 4, 2021; revised May 4, 2021.
K. Schab and B. Shirley are with the Department of Electrical and
Computer Engineering, Santa Clara University, Santa Clara, CA, USA (email: kschab@scu.edu).
K. C. Kerby-Patel is with the Engineering Department, University of
Massachusetts Boston, Boston, MA USA (e-mail: kc.kerby-patel@umb.edu).

time-varying conductivity. This study is motivated by the possible implementation of time-varying surfaces through dense
networks of lumped time-varying components (e.g., switches)
or through the modulation of inherently surface-based materials (e.g., carbon nanostructures [11]). The solution leverages
aspects of both classical Mie scattering theory [21] as well
as conversion matrix [18] methodologies. It shares many
features with the solution of analogous problems involving
static impedance boundary conditions [22], [23], time-varying
planar and cylindrical structures [16], [17], [24], time-varying
dielectric spheres [25], and spheres constructed from nonlinear media [26], [27]; though the formulation and examples
studied here are unique to the spherical shell configuration.
In an effort to establish connections between the timevarying shell geometry and other scattering problems (both
simpler and more complex), we carry out this analysis by
several means, each with a unique engineering perspective,
generality, and adaptability to other problems. We begin by
approaching the problem via classical Mie theory for the
special case of plane wave incidence using explicit forms
of all field components. We then generalize the approach
to arbitrary external excitation to arrive at a transition (T-)
matrix formulation compatible with general external excitation
and multi-scatterer systems [28]. Finally, we adapt the Tmatrix formulation into a transmission line problem giving
rise to a conversion matrix form of the reflection coefficient
observed at an impedance interface. Several examples are then
discussed and validated against numerical methods, namely
conversion matrix method of moments (CMMoM). Trends
in far-field scattering and near-field focusing behavior are
explored through supplementary examples.

II. S CATTERING DUE TO A PLANE WAVE
Throughout this work we consider a sphere of radius a
containing a core of homogeneous material with permittivity
εd = εr ε0 and permeability μd = μr μ0 . The surface of
this sphere has a time-varying surface conductivity σ(t) with
ˆ as shown in Fig. 1. We begin
Fourier representation σ(ω),
by considering a situation where the sphere is illuminated by
a multi-frequency incident plane wave ei (t) and hi (t) with
Fourier components of the form
E i (ω) = x̂E(ω)e−jkz ,

H i (ω) = ŷη −1 E(ω)e−jkz ,

(1)

where k is the free space wavenumber at frequency ω and
η is the free space wave impedance. At each frequency this

JOURNAL OF LATEX CLASS FILES, VOL. XX, NO. XX, MAY 4, 2021

2

es (t)
ei (t)

Hθs (ω) = −

εd



P1n (cos θ)
dP1n (cos θ)
(2)0
an Ĥ(2)
+
b
j
Ĥ
(kr)
(kr)
n
n
n
sin θ
dθ

z
σ(t)

∞
E0 sin φ X
ηkr n=1

μd

Hφs (ω) = −
Fig. 1. A sphere of radius a contains a static, non-dispersive material with
permittivity and permeability εd = εr ε0 and μd = μr μ0 , respectively. The
surface of the sphere is coated with a time-varying surface conductivity σ(t).

(8)

∞
E0 cos φ X
ηkr n=1



dP1n (cos θ)
P1n (cos θ)
(2)
(2)0
+ bn jĤn (kr)
an Ĥn (kr)
dθ
sin θ

(9)

and for the internal field we have
wave may be expanded into spherical harmonics, leading to
the tangential field components [21, §7.4.3]
∞
E0 g(ω) cos φ X −n 2n + 1
j
kr
n(n + 1)
n=1


1
dPn (cos θ)
P1n (cos θ)
0
× jĴn (kr)
+ Ĵn (kr)
dθ
sin θ

(2)
Eφd (ω) =

Eφi (ω) =

Hθi (ω)

∞
E0 g(ω) sin φ X −n 2n + 1
j
=−
ηkr
n(n + 1)
n=1


P1 (cos θ)
dP1 (cos θ)
× Ĵn (kr) n
+ jĴ0n (kr) n
sin θ
dθ
∞
E0 g(ω) cos φ X −n 2n + 1
j
ηkr
n(n + 1)
n=1


1
dPn (cos θ)
P1n (cos θ)
0
× Ĵn (kr)
+ jĴn (kr)
dθ
sin θ

(3)
Hθd (ω) = −

(4)
Hφd (ω) = −

dθ

+

P1n (cos θ)
bn Ĥ(2)
(kr)
n

(5)



sin θ

∞
E0 sin φ X
Eφs (ω) =
kr n=1


P1n (cos θ)
dP1n (cos θ)
(2)
(2)0
an jĤn (kr)
+ bn Ĥn (kr)
sin θ
dθ

∞
E0 cos φ X
ηd kd r n=1



dP1n (cos θ)
P1n (cos θ)
0
cn Ĵn (kd r)
+ dn jĴn (kd r)
. (13)
dθ
sin θ

∞
E0 cos φ X
kr
n=1

dP1n (cos θ)
an jĤ(2)0
(kr)
n

∞
E0 sin φ X
ηd kd r n=1



P1 (cos θ)
dP1 (cos θ)
cn Ĵn (kd r) n
+ dn jĴ0n (kd r) n
(12)
sin θ
dθ

where Ĵn are spherical Riccati-Bessel functions and P1n are
associated Legendre polynomials. Here E0 represents a reference field magnitude while the unitless factor g(ω) indicates
spectral weighting.
We may also expand the unknown scattered and internal
fields at each frequency into similar spherical harmonics,
matching the form of terms in the spherical wave expansion of
the incident plane wave. For the scattered field, this expansion
reads



∞
E0 sin φ X
kd r n=1



dP1n (cos θ)
P1n (cos θ)
0
+ dn Ĵn (kd r)
cn jĴn (kd r)
(11)
sin θ
dθ

Hφi (ω) = −

Eθs (ω) = −

∞
E0 cos φ X
kd r n=1



dP1n (cos θ)
P1n (cos θ)
0
cn jĴn (kd r)
+ dn Ĵn (kd r)
(10)
dθ
sin θ

Eθi (ω) = −

∞
E0 g(ω) sin φ X −n 2n + 1
j
kr
n(n + 1)
n=1


1
Pn (cos θ)
dP1n (cos θ)
0
× jĴn (kr)
+ Ĵn (kr)
sin θ
dθ

Eθd (ω) = −

(6)

(7)

In the above expressions, kd and ηd denote the wavenumber
and characteristic impedance of the core material, respectively.
The coefficients {an } and {cn } are associated with transverse
magnetic (TM) modes, while {bn } and {dn } correspond to
transverse electric (TE) modes.
Tangential field continuity at the boundary of the sphere
gives rise to four boundary conditions that must hold for all
times t, specifically
eiθ (t) + esθ (t) = edθ (t)

(14)

eiφ (t) + esφ (t) = edφ (t)

(15)

hiθ (t) + hsθ (t) = hdθ (t) + σ(t)edφ (t)

(16)

hiφ (t) + hsφ (t) = hdφ (t) − σ(t)edθ (t).

(17)

Within the magnetic field boundary conditions (16) and (17),
terms of the form σ(t)edx (t) represent a surface current density.
Temporal phase matching gives analogous conditions on each
Fourier component of the fields. Applying the series forms of

JOURNAL OF LATEX CLASS FILES, VOL. XX, NO. XX, MAY 4, 2021

3

i
√
√ −1 h√
(2)
0
(2)0
ε
μ
Ĥ
(ka)
Ĵ
(k
a)
−
ε
Ĥ
(ka)
Ĵ
(k
a)
cn
gn = j−1 μ−1
r
r
d
r
n
d
r
n
n
n
√

+ ω εr μr

incident, internal, and scattered fields in the frequency domain
and matching terms of like tangential dependence, the first pair
of boundary conditions (14) and (15) gives
gn Ĵ0n (ka) + an Ĥ(2)0
n (ka) =

k
cn Ĵ0n (kd a)
kd

(18)

gn Ĵn (ka) + bn Ĥ(2)
n (ka) =

k
dn Ĵn (kd a)
kd

(19)

where
gn = g(ω)j−n

2n + 1
n(n + 1)

(20)

μ
gn Ĵn (ka) + an Ĥ(2)
cn Ĵn (kd a)
n (ka) =
μd
Z ∞
− jkη
kd◦−1 σ̂(ω − ω ◦ )cn (ω ◦ )Ĵ0n (kd◦ a)dω ◦ , (21)
−∞

μ
dn Ĵ0n (kd a)
gn Ĵ0n (ka) + bn Ĥ(2)0
n (ka) =
μd
Z ∞
+ jkη
kd◦−1 σ̂(ω − ω ◦ )dn (ω ◦ )Ĵn (kd◦ a)dω ◦ . (22)
−∞

Here is used to mark integration variables as 0 is already
used to denote differentiation of a function with respect
to its argument. Considering the functions gn , an , bn , cn ,
and dn described by a basis of monochromatic signals, we
may interpret all terms in the above boundary conditions as
diagonal operators, with the exception of the convolution terms
which naturally give rise to cross frequency coupling. As
expected, we see that the TE and TM excitation coefficients
are fully decoupled.
We first consider the system of equations governing the TM
coefficients. Solving (18) for the external coefficients an gives


k
1
0
0
cn Ĵn (kd a) − gn Ĵn (ka) .
(23)
an = (2)0
Ĥn (ka) kd
Using this expression to eliminate the external coefficients
from (21) and collecting terms leads to (24), where the RiccatiBessel function Wronskian identity [29]
0
(2)
Ĵn (z)Ĥ(2)0
n (z) − Ĵn (z)Ĥn (z) = −j

Z

∞

−∞

ω ◦−1 ησ̂(ω − ω ◦ )cn (ω ◦ )Ĵ0n (kd◦ a)dω ◦ . (24)

and
√
−1
Bn x = ω εr μr Ĥ(2)0
n (ka)
Z ∞
ω ◦−1 ησ̂(ω − ω ◦ )x(ω ◦ )Ĵ0n (kd◦ a)dω ◦
×

(27)

−∞

gn = (An + Bn ) cn .

(28)

Again, with respect to a basis of monochromatic signals,
the operator An is always diagonal, whereas the operator
Bn associated with the surface conductivity is, in general,
not diagonal. From this reduced operator expression, we
immediately recognize simplifications arising from several
important special cases. First, when the surface conductivity is
identically zero the operator Bn vanishes, yielding the classical
TM scattering coefficients for a dielectric sphere. Similarly, if
the surface conductivity is purely static (not varying in time)
the operator Bn becomes diagonal [22]. Additionally, if the
inner medium has the same material properties as the external
medium (i.e., εr = μr = 1), then An becomes the identity
operator. Two special cases reduce the above system to one of
a PEC sphere, either σ(t) → ∞ for all time or εr → −j∞.
Repeating the above analysis for TE modes we find the
external coefficients to be


k
1
bn = (2)
dn Ĵn (kd a) − gn Ĵn (ka)
(29)
Ĥn (ka) kd
and the internal coefficients given by
gn = (Cn + Dn )dn

(30)

where
√ −1
Cn x = j−1 μ−1
εr
r
h√
i
√
0
×
εr Ĥ(2)
μr Ĥ(2)0
n (ka)Ĵn (kd a) −
n (ka)Ĵn (kd a) x (31)
and
√
−1
Dn x = ω εr μr Ĥ(2)
n (ka)
Z ∞
×
ω ◦−1 ησ̂(ω − ω ◦ )x(ω ◦ )Ĵn (kd◦ a)dω ◦ . (32)
−∞

III. F OURIER SERIES EXPANSION OF SURFACE
PARAMETERS

(25)

has been used. Defining the operators
√ −1
An x = j−1 μ−1
εr
r
h√
i
√
(2)
×
μr Ĥn (ka)Ĵ0n (kd a) − εr Ĥ(2)0
n (ka)Ĵn (kd a) x

Ĥ(2)0
n (ka)

allows for a condensed form of (24) to be written as

and the frequency dependence of gn , an , bn , cn , and dn
has been suppressed. Due to multiplication in time mapping
to convolution in frequency, the second set of boundary
conditions in (16) and (17) is more complex, reading

◦

−1

(26)

The preceding formulation involves integral operators
whose kernels depend on the frequency domain representation
of the surface conductivity σ̂(ω). In order to systematically
solve these equations, we consider the special case in which
the time-variation of the surface conductivity is periodic. The
aim of this simplification is to recast (28) and (30) as matrix

JOURNAL OF LATEX CLASS FILES, VOL. XX, NO. XX, MAY 4, 2021

4



(2)0
ω−K Ĥn (k −K a)
0
0
0


(2)0

0
ω−K+1 Ĥn (k −K+1 a) 0
0
√
−1 

Bn = η εr μr 
..


.


0
0
0
(2)0
0
0
0 ωK Ĥn (k K a)
  −1 0 −K
 0
ω−K Ĵn (kd a)
0
σ̂
σ̂ 1
...
σ̂ 2K
−1
−K+1
0
2K−1  
0
 σ̂ −1
σ̂
.
.
.
σ̂
0
ω
Ĵ
a)
−K+1 n (kd


 ..
..
..
..  
 .
.
.
. 
0
0
−2K
−2K+1
σ̂
σ̂
...
σ̂ 0
0
0



(2)
ω−K Ĥn (ω−K a/c)
0
0
0


(2)

0
ω−K+1 Ĥn (ω−K+1 a/c) 0
0
√
−1 


Dn = η εr μr 
..

.


0
0
0
(2)
0
0
0 ωK Ĥn (ωK a/c)
 0
  −1
0
ω−K Ĵn (kd−K a)
σ̂
σ̂ 1
...
σ̂ 2K
−K+1
−1
−1
0
2K−1
 σ̂

σ̂
.
.
.
σ̂
Ĵ
a)
0
ω
−K+1 n (kd


 ..
..
..
..  
 .
.
.
. 
0
0
−2K
−2K+1
σ̂
σ̂
...
σ̂ 0
0
0

equations, similar to the construction of conversion matrices
in time-varying circuit analysis [18].
Let the surface conductivity be expressible in terms of a
Fourier series with fundamental frequency ωσ , i.e.,
σ̂(ω) =

K
X
q=−K

σ̂ q δ(ω − qωσ ).

Bn x = ωη εr μr
×

K
X

q=−K

−1

Apn

(34)

Bnpq

p=−K

(35)

gnp = Apn cpn +

q=−K

Bnpq cp−q
n ,

0
−1 0
ωK
Ĵn (kdK a)

0
0







(43)

0
−1
Ĵn (kdK a)
ωK


√

p
p
0
μr Ĥ(2)
n (k a)Ĵn (kd a)

√


, (37)

p
p
εr Ĥ(2)0
n (k a)Ĵn (kd a)

√
−1
p−q
−1
p
q 0
a)ωp−q
= ωp η εr μr Ĥ(2)0
n (k a)σ̂ Ĵn (kd

gn = (An + Bn ) cn

(36)

(38)

where

 −K
An
 0

An = 
 0
0

0
An−K+1
0
0

0
0
..
.
0

(39)

0
0 


0 
AK
n

(40)

and the matrix Bn is given in factored form in (41).
Similarly for the TE coefficients we may write
gn = (Cn + Dn ) dn

Using these assumptions, (28) evaluated at frequency ωp =
ω0 + pωσ may be written,
K
X

0



 (41)


where k p and kdp are the wavenumbers at frequency ωp in
the exterior and core materials, respectively. A set of 2K + 1
equations of this form may be collected into the system

where c and cd are the speed of light in vacuum and the
dielectric core, respectively. Further, assume that the excitation
has a center frequency ω0 and a baseband representation that
is periodic in the fundamental frequency ωσ , i.e.,
gnp δ(ω − ω0 − pωσ ).

=

√ −1
εr
j−1 μ−1
r

−

σ̂ q (ω − qωσ )−1 Ĵ0n ((ω − qωσ )a/cd )x(ω − qωσ ),

gn (ω) =

0
0
..
.



and

Ĥ(2)0
n (ωa/c)

K
X

0

0
0

with cpn = cn (ωp ),

(33)

Substitution into the operator Bn gives, via the sifting property
of the Dirac delta,
√

0
0
..
.

where

 −K
Cn
 0

Cn = 
 0
0

0
Cn−K+1
0
0

0
0
..
.
0

(41)

0
0 


0 
CnK

(42)

JOURNAL OF LATEX CLASS FILES, VOL. XX, NO. XX, MAY 4, 2021

5

and the matrix Dn is given in (43). The form of the inner
matrix

 0
σ̂
σ̂ 1
...
σ̂ 2K
 σ̂ −1
σ̂ 0
. . . σ̂ 2K−1 


(44)
σ= .
.
..
.. 
..
 ..
.
. 
σ̂ −2K σ̂ −2K+1 . . .
σ̂ 0
closely resembles that of the conversion matrix describing
multi-harmonic coupling in time-varying circuit analysis [18]
or method of moments problems involving time-varying loads
and materials [20]. Interpretation of this quantity as the
conversion matrix representation of a time-varying admittance
is discussed further in Sec. VI.
Together (39) and (41) allow for the calculation of the
internal Fourier components cn and dn , from which the
external terms an and bn are obtained via (23) and (29),
respectively. Adopting the alternative modal normalization of
Bohren and Huffman [30], we define new sets of external
coefficients
n(n + 1)
n(n + 1)
ãn = −an −n
, b̃n = −bn −n
. (45)
j (2n + 1)
j (2n + 1)
Assuming a monochromatic incident wave of power density S0
at frequency ω0 , this renormalization leads to a familiar form
for the normalized net scattered power (scattering efficiency)
at each frequency,
∞
h
i
p
Psc
2c2 X
p
p 2
p 2
Qsc =
=
(2n
+
1)
|ã
|
+
|
b̃
|
. (46)
n
n
S0 πa2
ωp2 a2 n=1
The normalized extinction power (extinction efficiency) takes
on a similar form
∞
n
o
P0
2c2 X
Q0ext = ext 2 = 2 2
(2n + 1)Re ã0n + b̃0n . (47)
S0 πa
ω0 a n=1
By assuming monochromatic incidence, the extinction efficiency is only defined for the p = 0 harmonic. Because the
time-varying scattering processes considered here are linear,
extended definitions of polychromatic scattering and extinction
efficiencies may be constructed similarly to those used to
describe polarization conversion processes in scattering cross
section analyses.

The time-variation of the surface conductivity σ(t) may be
alternatively described using surface resistance r(t) = σ(t)−1 .
Note that simple time-variations in one parameter may be
problematic or ill-defined in terms of the other. For example,
the simple time-varying surface resistance
γ≤1

α
(1)
uα

where
are vector spherical harmonics associated with
Riccati-Bessel functions of the first kind, see App. A. By the
addition theorem for vector spherical waves, this expansion is
capable of representing any incident field produced by sources
at locations r 0 outside of the region of interest, i.e., r < r0 [21,
Eq. 7.5.14]. In a similar manner, the scattered and internal
fields may be expanded as
X
E s (ω, r) =
u(4)
(50)
α (kr)fα
α

E d (ω, r) =

X

u(1)
α (kd r)hα

(51)

α
(4)

where uα are vector spherical harmonics associated with
Riccati-Hankel functions of the second kind. The property [31,
Eq. 7.2.4]
(χ)
∇ × u(χ)
(52)
α = kuᾱ
relates two classes of spherical vector waves with dual superindices α and ᾱ [32]. By virtue of this property, the
magnetic fields associated with incident, scattered, and internal
electric fields are given by
X (1)
H i (ω, r) = jη −1
uᾱ (kr)gα
(53)
α
s

H (ω, r) = jη −1

X

(4)

uᾱ (kr)fα

(54)

α

H d (ω, r) = jηd−1

X

(1)

uᾱ (kd r)hα .

(55)

α

Tangential electric field continuity in (14) and (15) at the
sphere's boundary leads to
(4)
(1)
gα R(1)
α (ka) + fα Rα (ka) = hα Rα (kd a),

(56)

(p)

IV. S URFACE RESISTANCE AND CONDUCTIVITY

r(t) = r0 (1 + γ cos ωσ t) ,

V. T RANSITION MATRIX FORMULATION
In preceding sections we explicitly considered incident
fields of the form of plane waves. The formulation may
be extended to more general illuminations through the use
of transition (T-) matrix formalism [28], [31]. Consider an
incident field of the form
X
E i (ω, r) =
u(1)
(49)
α (kr)gα

where Rα describe the radial dependence of spherical waves
(χ)
uα , see App. A. Similarly, the magnetic field boundary
conditions in (16) and (17) lead to
(1)

(4)

(48)

has a well-behaved Fourier spectrum, however the associated
surface conductivity tends toward a train of Dirac delta functions as γ → 1 and r0 → ∞. This, in turn, necessitates the use
of extreme numbers of frequencies in the solution of scattered
fields which may lead to non-convergent results. Throughout
this paper we consider examples using conductance and resistance of the above form to examine this behavior.

η
(1)
hα Rᾱ (kd a)
ηd
h
i
− jηγα σ̂ ? hα R(1)
(k
a)
d
α

gα Rᾱ (ka) + fα Rᾱ (ka) =

(57)

where the identity
(χ)

r̂ × r̂ × uᾱ (r̂) = r̂ × γα u(χ)
α (r̂),

γα = −1τ

(58)

has been employed to relate tangential field components of
harmonics with dual superindices. Eliminating the external
coefficients fα gives
gα = (Pα + Qα )hα

(59)

JOURNAL OF LATEX CLASS FILES, VOL. XX, NO. XX, MAY 4, 2021

 −K
Wα
 0

Qα = −jηγα 
 0
0

0

0
0
..
.

Wα−K+1
0
0

0


σ̂ 0
σ̂ −1
..
.





σ̂ −2K

6


−1  (4) −K
Rα (k a)
0
0
0
0


(4)
0 

0
Rα (k −K+1 a) 0
0
 

 
.


..
0  

0
0
0
(4)
WαK
0
0
0 Rα (k K a)
  (1) −K
Rα (kd a)
0
0
σ̂ 1
...
σ̂ 2K
(1) −K+1
0
2K−1  
σ̂
. . . σ̂
0
Rα (kd
a) 0

..
..
..  
..

.
.
. 
.
0
0
−2K+1
0
σ̂
...
σ̂
0
0
0

where the operators Pα and Qα have the forms
Pα x =


η (4)
(1)
(4)
−1
(1)
Wα
R (ka)Rᾱ (kd a) − Rᾱ (ka)Rα (kd a) x
ηd α
Qα x =
jηWα−1 γα R(4)
α

Z

∞

(60)

(61)

h
i
(1)
(4)
(1)
Wα x = Rᾱ (ka)R(4)
(ka)
−
R
(ka)R
(ka)
x.
ᾱ
α
α

(62)

−∞

with

Adopting the Fourier series representations used in Sec. III,
we may convert the continuous operator equation in (59) into
a matrix equation of the form
gα = (Pα + Qα ) hα

(63)

where the matrix Pα is diagonal with elements
Pαp = Wαp,−1


η (4) p
(1)
(4)
p
Rα (k a)Rᾱ (kdp a) − Rᾱ (k p a)R(1)
(k
a)
×
α
d
ηd

(64)

fα = Tα gα

(66)

h
i
−1
Tα = R−1
− Rα,1
α,4 Rα,1d (Pα + Qα )

(67)

where

with
Rα,χ

0
..
.

0



0

0

(χ)
Rα (k K a)






(χ)
Rα (kd−K a)

=
0

0

0
..
.

0

(68)

0

Here we consider an alternative transmission line perspective of the scattering problem presented in Secs. II, III,
and V. In general, we may consider the free space around
the sphere as a spherical waveguide, in which each mode
has an associated characteristic impedance or admittance [33].
(χ)
The wave admittance Yα of a spherical wave defined by an
(χ)
electric field of the form uα relates the magnitudes of the
tangential electric and magnetic fields via
tan
(χ)
H tan
α = Yα r̂ × E α .

−1
Yα,χm = jγα ηm
Rᾱ,χm (Rα,χm )−1 ,

(70)

(69)

(71)

where, following the notation of (68) and (69), the subscript
χm may be either χ for waves of the χth kind in free space or
χd for waves in the dielectric core. Similarly, the impedance
ηm is either that of free space or the dielectric core. The
sign constant γα is ±1 as given in (58), which produces an
appropriate sign for TE and TM modes.
The electric field continuity equation of (56) may be written
in terms of incident, reflected, and transmitted "voltages" at
each frequency as
(72)

where the incident voltages are
vαi = gα R(1)
α (ka),




.
0

(χ)
Rα (kdK a)

(65)

The transition matrix in (66) fully describes the scattering
of multi-harmonic incident fields originating from sources
exterior to the sphere under consideration. Hence it is suitable, through proper application of the addition theorem, to
adaptation toward the scattering analysis of collections of nonoverlapping spherical structures.

vαi + vαr = vαt ,

and
Rα,χd






0
(1) K
Rα (kd a)

Using (49) and (53), (50) and (54), or (51) and (55) for the
incident, scattered, or internal fields respectively, we define a
diagonal multi-frequency wave admittance matrix

and the matrix Qα is given in factored form in (65). Here
the term Wαp corresponds to the coefficient in (62) evaluated
at frequency ωp . After some manipulations, this leads to a
transition matrix system


(χ)
Rα (k −K a)

=
0

0



VI. S PHERICAL WAVEGUIDE PERSPECTIVE

◦
◦
σ̂(ω − ω ◦ )x(ω ◦ )R(1)
α (kd a)dω

−

0
0

(73)

and similar forms are used for the reflected and transmitted
terms. Collecting equations of this kind at all frequencies we
obtain the system of equations
i
r
t
vα
+ vα
= vα
.

(74)

JOURNAL OF LATEX CLASS FILES, VOL. XX, NO. XX, MAY 4, 2021

Y1/4

***

7

Y1d

σ

***

Yin
r=a
Fig. 2. Schematic of transmission line scattering model. The left and right
transmission lines represent the exterior and interior regions, respectively,
while the shunt conductance represents the surface conductivity.

admittance matrix has off diagonal elements which account
for frequency conversion due to the time-varying conductivity.
Additionally, since the incident wave is represented by a
standing (Bessel) wave whose nominal propagation direction is
chosen outward, the sign of the magnetic field is the same for
all wave components so the "numerator" and "denominator"
both appear as subtractions. Lengthy manipulations, outlined
in App. B, demonstrate an equivalence between the result in
(79) and that obtained via transition matrix formulation in (67).
The intuitive construction of the equivalent circuit in Fig. 2
suggests that the study of more complex systems, e.g., layered
media or shells, may be facilitated through the use of similar
transmission line methods.

Using the same voltage definitions along with admittance
matrices of the form of (71), the magnetic field continuity
equation of (57) may be written as
i
r
t
Yα,1 vα
+ Yα,4 vα
= Yα,1d vα
+ σvt α ,

(75)

where the convolution term in (57) is represented by crossfrequency (off-diagonal) terms in the conversion matrix σ.
Interpreting (56) and (75) as the voltage and current boundary conditions at a transmission line junction, it is clear that the
surface of the sphere appears as a time-varying conductance
in parallel with the input admittance "looking into" the core.
This configuration is depicted in Fig. 2, where a compressed
notation is used to depict wave impedances in each region.
Because of the orthogonality of vector spherical harmonics,
no mode conversion occurs at the surface of the sphere, but
the time-varying boundary condition does result in frequency
conversion. Thus, while each harmonic frequency satisfies
(72) independently, (75) relates multiple harmonic frequencies
simultaneously and cannot be separated into an independent
equation for each frequency.
r
We now set out to derive the scattered modal voltage vα
using classical transmission line techniques. Let
r
i
vα
= Γα vα
,

(76)

where Γα is a multi-frequency reflection coefficient matrix
that relates the incident and scattered wave amplitudes in the
α mode at all frequencies. By combining (56), (75), and (76)
i
and eliminating vα
, we obtain
Yα,in (1 + Γα ) = (Yα,1 + Yα,4 Γα ),

(77)

where the input admittance conversion matrix looking into the
combined core-shell structure at each frequency is
Yα,in = Yα,1d + σ.

(78)

Collecting terms and solving for the reflection coefficient
matrix Γα we obtain
Γα = (Yα,4 − Yα,in )−1 (Yα,in − Yα,1 ).

(79)

The expression for the multi-frequency reflection coefficient
matrix in (79) has the same form as that arising from an LTI
transmission line interface, with the major distinction that (79)
represents a multi-harmonic system with conversion between
frequencies. Again we note that the incident and outwardgoing wave admittances are diagonal matrices, while the input

VII. C ONVERGENCE AND COMPARISON TO OTHER
METHODS

Here we consider two sets of examples aimed at examining
the accuracy and convergence of the methods presented in this
work. For brevity, we restrict our analyses to those based on
the special case of plane wave incidence, outlined in Sec. II.
A. Comparison to numerical methods, air-core shell
When the dielectric core material is assigned to be the same
as the exterior medium, the plane wave scattering problem
in Sec. II is readily evaluated using a hybridized conversion
matrix method of moments (CMMoM) technique [20] developed for the study of conducting structures loaded with
time-varying lumped elements or materials. Here we compare
these purely numerical results with those obtained using the
analytical formulation presented in this work.
As an example problem, we consider an air-core conducting
shell with conductivity of the form
σ(t) = σ0 (1 + γ cos ωσ t)

(80)

where σ0 = 1 Ω−1 , γ = 0.5, and ωσ = 0.11ω0 . The
incident field is a monochromatic plane wave whose frequency
ω0 is swept to cover a broad range of electrical sizes ka.
Scattering and extinction efficiencies are calculated via the
method presented in Sec. II, and via CMMoM where the
sphere is represented by 900 RWG basis functions and the
time-varying conductivity is modeled as a distributed timevarying surface resistance. In the CMMoM implementation, all
impedance and Gram matrices are generated using AToM [34].
CMMoM scattering and extinction efficiencies are calculated
via
p
IH
Psc
p Rp Ip
=
(81)
Qpsc =
S0 πa2
2S0 πa2
and
Qpext =

p
Re {IH
Pext
p Vp }
=
2
S0 πa
2S0 πa2

(82)

where Ip , Vp , and Rp are the induced current, excitation field,
and radiation operator at the pth harmonic represented in the
MoM basis.
Results obtained by the method presented in Sec. II (denoted
"Mie") and CMMoM are shown in Fig. 3, where qualitative
agreement is observed. At all frequencies, scattering in the

JOURNAL OF LATEX CLASS FILES, VOL. XX, NO. XX, MAY 4, 2021

102

Q0ext
Q0ext

(Mie)
(MoM)

Q0sca
Q0sca

8

k6=0
Qsca (Mie)

(Mie)

=0
Qk6sca

(MoM)

ka = 0.05
p=0

10−2

(MoM)

10−1

ka = 5

r(t)



Q

10−6

ka = 0.5
p 6= 0

10−4

10−10

10−7

10−14

10−10 −2
10

10−1

100

101

ka

10−18

σ(t)

0

20

40

60
K

80

100

120

Fig. 3. Comparison of scattering and extinction efficiencies calculated by
Mie (this paper) and CMMoM formulations with εr = μr = 1 and σ(t)
of the form of (80) where σ0 = 1 Ω−1 and γ = 0.5. At all frequencies,
ωσ = 0.11ω.

Fig. 4. Convergence properties of scattering efficiencies with respect to
increasing number of harmonics K using a air-core sphere surrounded by
a shell with surface conductivity or resistivity. The electrical size ka is given
relative to the frequency of the incident plane wave.

excitation (p = 0) harmonic far outweighs scattering in upand down-converted (p 6= 0) harmonics. Both methods agree
to within 4% in all reported quantities for small electrical
sizes ka < 5. More significant discrepancies appear for larger
electrical sizes where the number of CMMoM basis functions
limits the ability to accurately represent intricate higher-order
mode shapes, particularly in up-converted harmonics.

more (K ≈ 100) harmonics are required to reach numerical
precision.
These examples illustrate the basic convergence properties
of scattering from time-varying shells with simple resistance
and conductance properties. More importantly, however, they
demonstrate the increase in complexity and computational cost
when certain classes of surface conductivity Fourier spectra
are used. For analytical methods such as those presented
in this paper, the increase in computational complexity is
manageable, however this rapid scaling may quickly outpace computational resources in numerical methods, such as
CMMoM, where multi-frequency, N -port impedance matrices
with dimensions scaling linearly with both the number of
harmonics and number of ports must be computed, stored,
and inverted.

B. Convergence characteristics
As in circuit applications of conversion matrix methods, the
number of temporal harmonics must be sufficiently high to
ensure accurate field and efficiency calculations. We expect
the required number of temporal harmonics 2K + 1 to depend on many factors, and here we examine a few of these
dependencies using two simple test cases.
As an example of a system with relatively few harmonic
components in the matrix σ, we consider an air-core sphere
with surface conductivity of the form of (80) where σ0 =
1 Ω−1 , ωσ = 0.11ω0 , and γ = 0.99. The resulting matrix σ is
tridiagonal. The electrical size of the sphere is swept over the
values ka ∈ {0.05, 0.5, 5} and the multi-harmonic scattering
efficiencies Qpsc are recorded using increasing numbers of
temporal harmonics K. For all electrical sizes, a relative
convergence error
ε(K) =

|Qpsc (K) − Qpsc (K − 1)|
Qpsc (K − 1)

(83)

is calculated for each harmonic scattering efficiency. Errors for
all three electrical sizes are collected at each value of K and
plotted for the p ∈ {−2, ..., 2} harmonics in Fig. 4, labeled by
a circle annotated with σ(t). These results indicate that, for
all electrical sizes, this particular example converges rapidly
to numerical precision for K ≈ 15.
To model a system with much richer harmonic content, we
additionally examine a sphere with surface resistance of the
form of (48) with γ = 0.99, r0 = 500 Ω, and ωσ = 0.11ω.
Convergence results from this analysis are also shown on
Fig. 4, labelled by a circle annotated with r(t). In this case,
the Fourier spectrum of the corresponding surface conductivity
(truncated to K harmonics) is no longer sparse and many

VIII. S CATTERING BEHAVIOR
In Sec. VII, examples were selected to demonstrate the
accuracy or convergence of the method developed in this
paper. We now deviate from measures of accuracy and instead
leverage the speed of these analytic methods to examine in
detail the unique capabilities of scatterers with strong timevarying behavior.
A. Study of surface and core characteristics
Harmonic generation in the spherical system studied in this
paper depends on many system parameters. Here we maintain
the simple surface resistance time dependence in (48) with
γ = 0.9, ωσ = 1.5ω0 , and ka = 2π to examine the effect of
material parameters, namely the core relative permittivity εr
and surface resistance r0 , on harmonic scattering. In Fig. 5,
we plot the scattering efficiencies Qpsc for p ∈ {−2, ..., 2} as
functions of these two material parameters. For reference, the
limiting cases when the core is constructed of air (εr = 1),
the shell is PEC (σ(t) ≈ ∞), and the shell is non-existent
(σ(t) ≈ 0) are indicated by zig-zag boundaries in the top
panel of Fig. 5.
From this study, we observe that harmonic generation is
maximized near r0 ≈ η for all core permittivities. Comparing

JOURNAL OF LATEX CLASS FILES, VOL. XX, NO. XX, MAY 4, 2021

9

Qpsc /Qpsc,max

log10 r0 /η

0

0.25

0.5

σ(t) ≈ 0, no shell

2

0.75

1

Q−2
sc,max = 0.0157

0
εr = 1, air core

−2
1

1.5

σ(t) ≈ ∞, PEC shell
2

2.5

p = −2
3

3.5

log10 r0 /η

εr
Q−1
sc,max = 0.0169

2
0
A

−2
1

B
1.5

p = −1

2.5

2

3

3.5

log10 r0 /η

εr
Q0sc,max = 3.95

2
0

p=0

−2
1

1.5

2

2.5

3

3.5

log10 r0 /η

εr
Q1sc,max = 0.0535

2
0

p=1

−2
1

1.5

2

2.5

3

3.5

log10 r0 /η

εr
Q2sc,max = 0.0142

2
0

p=2

−2
1

1.5

2

2.5

3

3.5

εr
Fig. 5. Scattering efficiencies Qpsc for a dielectric core with relative permittivity εr coated with a shell with time-varying resistance given by (48) with
γ = 0.9, ωσ = 1.5ω, and ka = 2π.

scattering efficiencies in the air-core case as a function of
resistivity r0 , we observe very similar trends as obtained in the
study of an electrically small rectangular plate constructed of a
similar time-varying conductor [20], with harmonic scattering
efficiencies maximized near values of resistivity r0 producing
maximum net absorption.
Two particular sets of material parameters are labelled as
points A and B within the middle panel of Fig. 5. The scattered
electric field in each of the p ∈ {−2, ..., 2} harmonics at these
points are shown in Fig. 6. There, up- and down-conversion
is clearly visible through the modification of standing wave
spatial frequency, along with unique scattering behavior (e.g.,

directivity and overall intensity) within each harmonic. Note
that only the scattered field is shown. In the p = 0 excitation
frequency this is not the total field and, as expected, there
exists a field discontinuity at the boundary of the sphere. For
p 6= 0 harmonics, the scattered field is the total field and no
such discontinuity exists.
B. Harmonic near-field generation
Moving away from the study of scattering cross-sections, we
now turn our attention toward harmonic near-field generation.
We consider a sphere of electrical size ka = π/2 coated with a
resistive shell governed by (48) with γ = 0.9 and ωσ = 1.5ω0 .
Defining an observation point r obs = −ẑa/2 within the
core (see Fig. 8 for schematic of observation location), we
p
compute the normalized electric field magnitude |Esc
|/E0
within each harmonic again as a function of core relative
permittivity εr and surface resistivity r0 . This field magnitude
for the first up-converted harmonic (p = 1) is shown in
Fig. 7, where three distinct classes of behavior are apparent.
First, when the surface resistance r0 is very low, the system
behaves approximately as a PEC sphere with slight coupling
between internal and external fields. In this regime, we observe
that the p = 1 harmonic field magnitudes are maximized
at the observation location over extremely narrow ranges of
core permittivity corresponding to internal resonances of the
sphere, hence the name resonant coupling used to define this
mode of operation. As the surface resistance increases, the
Q-factor of these resonances decreases, eventually leading to
strong coupling of multi-mode field distributions in the range
0.1 ≤ r0 /η ≤ 10. Here the harmonics generated by the timevarying shell exist both inside the sphere and as outward
propagating scattered fields. As the resistance r0 becomes
very large, no currents are induced on the shell (making it
effectively transparent) and harmonic fields tend toward zero.
Though not visible in Fig. 7, in this weak coupling regime,
internal fields are maximized when the harmonic frequency of
interest coincides approximately with the external resonances
of the dielectric sphere in isolation.
In Fig. 8, field distributions at the excitation (p = 0) and
first harmonic (p = 1) frequencies are shown for a selection of
resistance and core permittivity values labeled as points A-E in
Fig. 7. Selected for their high internal field magnitude and low
values of resistance r0 , cases A, C, and D represent resonant
coupling between the excitation field and the first harmonic
internal fields. In these cases, the first harmonic internal
field distributions are effectively those corresponding to the
internal resonances of a dielectric-filled PEC shell. Because it
is unlikely (and not the case in any of these examples) that the
sphere has internal resonances at both the excitation and first
harmonic frequencies, we observe that the internal fields at the
excitation frequency are effectively zero. In contrast, cases B
and E exist in the strong coupling regime where the conductive
shell is semi-transparent and significant internal and external
fields exist at both excitation and harmonic frequencies.
C. Trends in harmonic detuning
Here we study the effective detuning of a sphere's natural
internal and external resonances due to up-conversion pro-

JOURNAL OF LATEX CLASS FILES, VOL. XX, NO. XX, MAY 4, 2021

p = −1

A

ẑ

p=0

A

p=1

A

1

p=2

A

ŷ

0.75

a

0.5
p = −2

B

p = −1

B

p=0

B

p=1

B

p=2

B

p
|Esc,φ
|/E0

p = −2

A

10

0.25
0

λ−2

1

λ−1

λ0

λ1

λ2

0

s magnitude produced by a sphere of radius ka = 2π with core relative permittivity ε and surface resistance
Fig. 6. Normalized scattered electric field Eφ
r
defined by r(t) = r0 (1 + γ cos ωσ t) with ωσ = 1.5ω0 and γ = 0.9. Results for two pairs of parameters (εr , r0 ) are shown corresponding to the labeled
points "A" (top, εr = 1, r0 /η = 2) and "B" (bottom, εr = 2.45, r0 /η = 2) in Fig. 5. Scale bars in the bottom row indicate the free-space wavelength at
each harmonic, valid for both rows of data.

weak coupling

log10 r0 /η

2
0

0.4

strong coupling

B

|E psc (r obs )|/E0

0.6

|E 1sc |/E0

E

0

C resonant coupling

A
1

2

3

4

ẑ

D
5

p=0

A

0.2

−2

0.25

0.5

0.75

p=1

A

ŷ
×

a

6

1

0

r obs

εr
Fig. 7. Electric near field magnitude at (0, 0, −a/2) in the p = 1 harmonic
as a function of surface resistance magnitude r0 and core relative permittivity
εr for a sphere of electrical size ka = π/2 at the excitation frequency, with
γ = 0.9 and ωσ = 1.5ω.

cesses enabled by a time-varying conductive shell. Following
the nomenclature of [25], we begin by defining external
resonances of an uncoated dielectric sphere as the set of
i
} producing maximal scattering efficiency.
frequencies {ωext
In the weak coupling regime, where surface currents can
be considered as a perturbation on an otherwise uncoated
dielectric sphere, we anticipate that if energy is coupled
into the harmonic ωp , the scattering efficiency Qpsc will be
maximized when that frequency corresponds to one of the
external resonances of the dielectric core, i.e., when
i
ωext
= ωp = ω0 + pωσ

B

p=0

×

C

p=0

p=1

C

×

D

p=0

p=1

D

×

(84)

is satisfied. In Fig. 9, we plot the scattering efficiency of the
first (p = 1) and second (p = 2) upconverted harmonics
as a function of excitation frequency ω and shell variation
frequency ωσ using a dielectric core with relative permittivity
εr = 6.25 and time-varying resistance following (48) with
r0 /η = 102 and γ = 0.25. The external resonance frequencies
i
{ωext
} are plotted as vertical dashed lines, while combinations
of excitation and shell frequencies satisfying (84) are drawn
as diagonal dashed lines. We observe that the maximum
scattering efficiencies typically align with the condition in

p=1

B

E

p=0

p=1

E

×

Fig. 8. Scattered fields in the excitation (p = 0) and first up-converted
frequency (p = 1) corresponding to the annotated positions in Fig. 7. All
fields are normalized to the incident field magnitude.

JOURNAL OF LATEX CLASS FILES, VOL. XX, NO. XX, MAY 4, 2021

2

2

σ

2.5

3

0

(84), though harmonic generation is enhanced particularly for
cases with ωσ ≈ 0 where both the harmonic frequency and
the excitation frequencies are near an external resonance.
Similarly, in the resonant coupling regime we expect that
internal field magnitudes will be maximized for the harmonic
frequency ωp when that frequency corresponds to one of the
i
internal resonances {ωint
} of the PEC-coated dielectric core,
i.e., when
i
ωint
= ωp = ω0 + pωσ
(85)
is satisfied. In Fig. 10, we plot the normalized field magnitude
sampled at r obs = −ẑa/2 in the first upconverted (p = 1)
harmonic and the first downconverted (p = −1) harmonic
using the same setup as in Fig. 9, with the exception that
now the resistance is assigned as r0 /η = 10−2 and the
diagonal dashed lines correspond to the condition prescribed
in (85). For both the p = 1 and the p = −1 cases, it is
clear that maximization of internal fields is governed by the
condition described in (85), with little dependence on the
electrical size at the excitation frequency. The opposing slopes
of the p = −1 case further show that maximization of the
internal field magnitudes also occurs when the downconverted
harmonic corresponds to the internal resonance of the system.
IX. C ONCLUSIONS
In this work, we develop a quasi-analytic solution to scattering problems involving spheres coated with time-varying
conductive or resistive shells. Implementation of the method
requires only the evaluation of special functions and the
inversion of relatively small matrices. This simplicity allows
for rapid exploration of high-dimensional parameterizations,
as demonstrated by the selected examples. Though the problem being studied is simple in nature, it represents a class
of likely realizations of time-varying structures, i.e., timevarying surface impedances implemented through the use of
densely patterned time-varying lumped components. Should
it be feasible to construct such a structure through the use

σ

3

−ω
0

0.2
0.1
0
1.5

0
×10−2

6

2

4
2
2.5

3

ka = ωa/c

ka = ωa/c
Fig. 9. Scattering efficiency in the p = 1 (top) and p = 2 (bottom) harmonics
from a sphere with relative core permittivity εr = 6.25 and time-varying shell
resistance given by (48) with r0 /η = 102 and γ = 0.25.

2.5

i =ω
ωint
0

2ω

2

ωσ a/c

+

Q2sc

ω0

ωσ a/c

=

i
= ω0
ωext

0
1.5

0.5

2

p = −1

i xt

0.1

0
1.5
0.3

0
×10−6

1

p=2

ωe

0.2

3

=ω

2.5

int

2

ωi

0
1.5
0.3

|E 1int (r obs )|/E0

ωσ a/c

σ

σ

Q1sc

4

+ω

+ω

0.1

0

0

4

6

=ω

6

0.2

i =ω
ωint
0

=ω

ωσ a/c

p=1

i

i

i
ωext
= ω0

0.1

8

8

ω int

ω ext

p=1

×10−2

0.3

|E −1
int (r obs )|/E0

×10−5

0.3
0.2

11

Fig. 10. Internal electric field magnitude in the p = 1 (top) and p = −1
(bottom) harmonics from a sphere with relative core permittivity εr = 6.25
and time-varying shell resistance given by (48) with r0 /η = 10−2 and γ =
0.25.

of switches or other elements, the results from the examples
presented here indicate that several interesting behaviors,
particularly up- and down-conversion in radiation and nearfields, could be engineered through careful choice of system
parameters. Additional behaviors may be uncovered through
further exploration of multi-sphere systems using the proposed
T-matrix formulation.
Several assumptions limit the proposed method to simple
homogeneous media and we hypothesize that some of these
assumptions may be lifted by more general treatments of the
problem. Specifically, the use of inhomogeneous or anisotropic
conductive shells, inclusion of layered media, adaptation to
time-varying reactive surfaces or impedance boundary conditions, and combination with methods derived for time-varying
dielectrics all stand as tasks for future work in this area. We
expect that the study of these generalizations will be aided
by a combination of the field, transmission line, and T-matrix
formulations presented in this work.
A PPENDIX A
S PECIAL FUNCTION NOTATION
Throughout this work we adopt the notation of [32] to
describe spherical vector harmonics. Here we clarify two
critical points regarding this notation.
The radial dependence of spherical harmonics' tangential
(χ)
field components are defined via the functions Rτ ` , where τ
and ` are two components of the superindex α = {τ σm`}.
For purposes of this work, we require only harmonics with
values of τ = 1, 2. These functions are given by
(χ)

(χ)

R1` = Z` (kr) =

(χ)

R2` =

(χ)

(χ)

Ẑn (kr)
kr

(86)

(χ)0

(krZ` (kr))0
Ẑ (kr)
= `
kr
kr

(87)

JOURNAL OF LATEX CLASS FILES, VOL. XX, NO. XX, MAY 4, 2021

12

(χ)

where Z` denotes spherical Bessel and Hankel functions of
(1)
(4)
(2)
varying kinds, most notably Z` = J` and Z` = H` . The
use of ˆ denotes the Ricatti-Bessel and Ricatti-Hankel form of
these functions. The use of dual superindices α and ᾱ indicates
a toggling of the value of τ between 1 and 2, i.e.,
α = 1σm`

→

ᾱ = 2σm`

(88)

α = 2σm`

→

ᾱ = 1σm`.

(89)

and

As suggested in by the appearance of these forms in expansions for electric and magnetic fields in Sec. V, the choice
(χ)
of τ corresponds to a given spherical harmonic uα being of
transverse electric (TE) or transverse magnetic (TM) type.
A PPENDIX B
R ECONCILING T- MATRIX AND TRANSMISSION LINE
APPROACHES

Here we outline the procedure for establishing equivalence
between the transition matrix and transmission line approaches
of Secs. V and VI. A change of variables in (66) from
modal coefficients to modal voltages relates the transition and
reflection matrices via
T = R−1
α,4 ΓRα,1 .

(90)

Rearranging the above expression and substituting (67) yields
h
i
−1
Γ = Rα,1d (Pα + Qα ) R−1
α,1 − 1 .

(91)

From the definition of the wave admittances in (71), we have
−1
Yα,4 − Yα,1d = −jγα η −1 Wα R−1
α,4 Pα Rα,1d .

(92)

Additionally, from the definition of the operator Qα in (65)
we may write
−1
Qα = −jηγα Wα
Rα,4 σRα,1d .

(93)

From the above expressions, we may construct the first term
on the right-hand side of (91) as
−1

Rα,1d (Pα + Qα )

R−1
α,1

−1
= −jγα η −1 Wα (Yα,4 − Yin )−1 R−1
α,4 Rα,1

(94)

Substituting this into the definition of Γ and rearranging gives
Γ = (Yα,4 − Yin )−1

−1
* −jγα η −1 Wα R−1
α,4 Rα,1 − Yα,4 + Yin



(95)

Expanding two of the central terms above using the definition
of the operator Wα in (60), several cancellations lead to
−1
−jγα η −1 Wα R−1
α,4 Rα,1 − Yα,4 = −Yα,1 ,

(96)

which, when substituted into (95) yields the expected form of
the reflection matrix in (79).

R EFERENCES
[1] A. G. Hayrapetyan, J. B. Götte, K. K. Grigoryan, S. Fritzsche, and R. G.
Petrosyan, "Electromagnetic wave propagation in spatially homogeneous
yet smoothly time-varying dielectric media," Journal of Quantitative
Spectroscopy and Radiative Transfer, vol. 178, pp. 158–166, 2016.
[2] C. Caloz and Z.-L. Deck-Léger, "Spacetime metamaterials-part I:
general concepts," IEEE Transactions on Antennas and Propagation,
vol. 68, no. 3, pp. 1569–1582, 2019.
[3] T. T. Koutserimpas and R. Fleury, "Electromagnetic fields in a timevarying medium: Exceptional points and operator symmetries," IEEE
Transactions on Antennas and Propagation, vol. 68, no. 9, pp. 6717–
6724, 2020.
[4] M. Mirmoosa, T. Koutserimpas, G. Ptitcyn, S. Tretyakov, and
R. Fleury, "Dipole polarizability of time-varying particles," arXiv
preprint arXiv:2002.12297, 2020.
[5] Y. Hadad and A. Shlivinski, "Soft temporal switching of transmission
line parameters: Wave-field, energy balance, and applications," IEEE
Transactions on Antennas and Propagation, vol. 68, no. 3, pp. 1643–
1654, 2020.
[6] F. Morgenthaler, "Velocity modulation of electromagnetic waves," IRE
Transactions on Microwave Theory and Techniques, vol. 6, no. 2, pp.
167–172, 1958.
[7] D. Holberg and K. Kunz, "Parametric properties of fields in a slab
of time-varying permittivity," IEEE Transactions on Antennas and
Propagation, vol. 14, no. 2, pp. 183–194, 1966.
[8] R. Fante, "On the propagation of electromagnetic waves through a timevarying dielectric layer," Flow Turbulence and Combustion, vol. 27, pp.
341–354, 1973.
[9] F. Harfoush and A. Taflove, "Scattering of electromagnetic waves by
a material half-space with a time-varying conductivity," IEEE Transactions on Antennas and Propagation, vol. 39, no. 7, pp. 898–906, 1991.
[10] Z. Wu and A. Grbic, "Serrodyne frequency translation using timemodulated metasurfaces," IEEE Transactions on Antennas and Propagation, vol. 68, no. 3, pp. 1599–1606, 2019.
[11] M. M. Salary, S. Jafar-Zanjani, and H. Mosallaei, "Electrically tunable
harmonics in time-modulated metasurfaces for wavefront engineering,"
New Journal of Physics, vol. 20, no. 12, p. 123023, 2018.
[12] S. Inampudi, M. M. Salary, S. Jafar-Zanjani, and H. Mosallaei, "Rigorous space-time coupled-wave analysis for patterned surfaces with
temporal permittivity modulation," Opt. Mater. Express, vol. 9, no. 1,
pp. 162–182, Jan 2019.
[13] P. A. Pantazopoulos and N. Stefanou, "Layered optomagnonic structures:
Time floquet scattering-matrix approach," Phys. Rev. B, vol. 99, p.
144415, Apr 2019.
[14] S. Taravati and A. A. Kishk, "Space-time modulation: Principles and
applications," IEEE Microwave Magazine, vol. 21, no. 4, pp. 30–56,
2020.
[15] H. Li and A. Alù, "Temporal switching to extend the bandwidth of thin
absorbers," Optica, vol. 8, no. 1, pp. 24–29, 2021.
[16] D. W. Wright and R. S. C. Cobbold, "Two-dimensional phononic crystals
with time-varying properties: a multiple scattering analysis," Smart
Materials and Structures, vol. 19, no. 4, p. 045006, Feb 2010.
[17] M. M. Salary, S. Jafar-Zanjani, and H. Mosallaei, "Time-varying
metamaterials based on graphene-wrapped microwires: Modeling and
potential applications," Phys. Rev. B, vol. 97, p. 115421, Mar 2018.
[18] S. A. Maas, Nonlinear microwave and RF circuits. Artech House,
2003.
[19] A. Palmer, "Investigation of a generalized frequency domain method for
modeling time-varying loads on antennas," Master's thesis, University
of Oklahoma, 2019.
[20] S. Bass, A. Palmer, K. Schab, K. Kerby-Patel, and J. Ruyle, "Conversion
matrix method of moments for time-varying electromagnetic analysis,"
arXiv preprint arXiv:2103.06135, 2021.
[21] J.-M. Jin, Theory and computation of electromagnetic fields. John Wiley
& Sons, 2011.
[22] J. R. Wait and C. M. Jackson, "Calculations of the bistatic scattering
cross section of a sphere with an impedance boundary condition," Radio
Sci. J. Res., vol. 69, pp. 299–315, 1965.
[23] A. Sihvola, D. C. Tzarouchis, P. Ylä-Oijala, H. Wallén, and B. Kong,
"Resonances in small scatterers with impedance boundary," Physical
Review B, vol. 98, no. 23, p. 235417, 2018.
[24] D. Censor, "Non-relativistic scattering by time-varying bodies and
media," Progress In Electromagnetics Research, vol. 48, pp. 249–278,
2004.

JOURNAL OF LATEX CLASS FILES, VOL. XX, NO. XX, MAY 4, 2021

[25] I. Stefanou, P. A. Pantazopoulos, and N. Stefanou, "Light scattering by a
spherical particle with a time-periodic refractive index," JOSA B, vol. 38,
no. 2, pp. 407–414, 2021.
[26] J. Dewitz, W. Hübner, and K. Bennemann, "Theory for nonlinear miescattering from spherical metal clusters," Zeitschrift für Physik D Atoms,
Molecules and Clusters, vol. 37, no. 1, pp. 75–84, 1996.
[27] Y. Pavlyukh and W. Hübner, "Nonlinear mie scattering from spherical
particles," Phys. Rev. B, vol. 70, p. 245434, Dec 2004.
[28] P. C. Waterman, "Matrix formulation of electromagnetic scattering,"
Proceedings of the IEEE, vol. 53, no. 8, pp. 805–812, 1965.
[29] M. Abramowitz and I. A. Stegun, Handbook of mathematical functions
with formulas, graphs, and mathematical tables.
US Government
printing office, 1948, vol. 55.
[30] C. F. Bohren and D. R. Huffman, Absorption and scattering of light by
small particles. John Wiley & Sons, 2008.
[31] W. C. Chew, Waves and fields in inhomogeneous media. Van Nostrand
Reinhold, 1990.
[32] V. Losenicky, L. Jelinek, M. Capek, and M. Gustafsson, "Method of
moments and t-matrix hybrid," arXiv preprint arXiv:2012.04303, 2020.
[33] R. Harrington, Time-harmonic Electromagnetic Fields, ser. IEEE Press
Series on Electromagnetic Wave Theory. IEEE Press, 2001.
[34] Antenna Toolbox for MATLAB (AToM), Czech Technical University in
Prague, Czech Technical University in Prague, 2017. [Online]. Available:
www.antennatoolbox.com

13

